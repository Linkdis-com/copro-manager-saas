function Nw(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();function _w(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var tg={exports:{}},d0={},rg={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ao=Symbol.for("react.element"),kw=Symbol.for("react.portal"),Ew=Symbol.for("react.fragment"),Sw=Symbol.for("react.strict_mode"),jw=Symbol.for("react.profiler"),Tw=Symbol.for("react.provider"),Cw=Symbol.for("react.context"),Fw=Symbol.for("react.forward_ref"),Aw=Symbol.for("react.suspense"),Dw=Symbol.for("react.memo"),Rw=Symbol.for("react.lazy"),am=Symbol.iterator;function Pw(e){return e===null||typeof e!="object"?null:(e=am&&e[am]||e["@@iterator"],typeof e=="function"?e:null)}var ng={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ag=Object.assign,sg={};function Si(e,t,r){this.props=e,this.context=t,this.refs=sg,this.updater=r||ng}Si.prototype.isReactComponent={};Si.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Si.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ig(){}ig.prototype=Si.prototype;function sd(e,t,r){this.props=e,this.context=t,this.refs=sg,this.updater=r||ng}var id=sd.prototype=new ig;id.constructor=sd;ag(id,Si.prototype);id.isPureReactComponent=!0;var sm=Array.isArray,lg=Object.prototype.hasOwnProperty,ld={current:null},og={key:!0,ref:!0,__self:!0,__source:!0};function cg(e,t,r){var n,a={},s=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(s=""+t.key),t)lg.call(t,n)&&!og.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:ao,type:e,key:s,ref:l,props:a,_owner:ld.current}}function Iw(e,t){return{$$typeof:ao,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function od(e){return typeof e=="object"&&e!==null&&e.$$typeof===ao}function Ow(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var im=/\/+/g;function J0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Ow(""+e.key):t.toString(36)}function sc(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case ao:case kw:l=!0}}if(l)return l=e,a=a(l),e=n===""?"."+J0(l,0):n,sm(a)?(r="",e!=null&&(r=e.replace(im,"$&/")+"/"),sc(a,t,r,"",function(u){return u})):a!=null&&(od(a)&&(a=Iw(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(im,"$&/")+"/")+e)),t.push(a)),1;if(l=0,n=n===""?".":n+":",sm(e))for(var o=0;o<e.length;o++){s=e[o];var c=n+J0(s,o);l+=sc(s,t,r,c,a)}else if(c=Pw(e),typeof c=="function")for(e=c.call(e),o=0;!(s=e.next()).done;)s=s.value,c=n+J0(s,o++),l+=sc(s,t,r,c,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Co(e,t,r){if(e==null)return e;var n=[],a=0;return sc(e,n,"","",function(s){return t.call(r,s,a++)}),n}function Lw(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Er={current:null},ic={transition:null},Mw={ReactCurrentDispatcher:Er,ReactCurrentBatchConfig:ic,ReactCurrentOwner:ld};function ug(){throw Error("act(...) is not supported in production builds of React.")}Ve.Children={map:Co,forEach:function(e,t,r){Co(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Co(e,function(){t++}),t},toArray:function(e){return Co(e,function(t){return t})||[]},only:function(e){if(!od(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ve.Component=Si;Ve.Fragment=Ew;Ve.Profiler=jw;Ve.PureComponent=sd;Ve.StrictMode=Sw;Ve.Suspense=Aw;Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Mw;Ve.act=ug;Ve.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=ag({},e.props),a=e.key,s=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,l=ld.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)lg.call(t,c)&&!og.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:ao,type:e.type,key:a,ref:s,props:n,_owner:l}};Ve.createContext=function(e){return e={$$typeof:Cw,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Tw,_context:e},e.Consumer=e};Ve.createElement=cg;Ve.createFactory=function(e){var t=cg.bind(null,e);return t.type=e,t};Ve.createRef=function(){return{current:null}};Ve.forwardRef=function(e){return{$$typeof:Fw,render:e}};Ve.isValidElement=od;Ve.lazy=function(e){return{$$typeof:Rw,_payload:{_status:-1,_result:e},_init:Lw}};Ve.memo=function(e,t){return{$$typeof:Dw,type:e,compare:t===void 0?null:t}};Ve.startTransition=function(e){var t=ic.transition;ic.transition={};try{e()}finally{ic.transition=t}};Ve.unstable_act=ug;Ve.useCallback=function(e,t){return Er.current.useCallback(e,t)};Ve.useContext=function(e){return Er.current.useContext(e)};Ve.useDebugValue=function(){};Ve.useDeferredValue=function(e){return Er.current.useDeferredValue(e)};Ve.useEffect=function(e,t){return Er.current.useEffect(e,t)};Ve.useId=function(){return Er.current.useId()};Ve.useImperativeHandle=function(e,t,r){return Er.current.useImperativeHandle(e,t,r)};Ve.useInsertionEffect=function(e,t){return Er.current.useInsertionEffect(e,t)};Ve.useLayoutEffect=function(e,t){return Er.current.useLayoutEffect(e,t)};Ve.useMemo=function(e,t){return Er.current.useMemo(e,t)};Ve.useReducer=function(e,t,r){return Er.current.useReducer(e,t,r)};Ve.useRef=function(e){return Er.current.useRef(e)};Ve.useState=function(e){return Er.current.useState(e)};Ve.useSyncExternalStore=function(e,t,r){return Er.current.useSyncExternalStore(e,t,r)};Ve.useTransition=function(){return Er.current.useTransition()};Ve.version="18.3.1";rg.exports=Ve;var T=rg.exports;const fg=_w(T),Bw=Nw({__proto__:null,default:fg},[T]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uw=T,zw=Symbol.for("react.element"),$w=Symbol.for("react.fragment"),Ww=Object.prototype.hasOwnProperty,Vw=Uw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Hw={key:!0,ref:!0,__self:!0,__source:!0};function dg(e,t,r){var n,a={},s=null,l=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)Ww.call(t,n)&&!Hw.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:zw,type:e,key:s,ref:l,props:a,_owner:Vw.current}}d0.Fragment=$w;d0.jsx=dg;d0.jsxs=dg;tg.exports=d0;var i=tg.exports,$u={},hg={exports:{}},qr={},mg={exports:{}},xg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(le,G){var q=le.length;le.push(G);e:for(;0<q;){var U=q-1>>>1,S=le[U];if(0<a(S,G))le[U]=G,le[q]=S,q=U;else break e}}function r(le){return le.length===0?null:le[0]}function n(le){if(le.length===0)return null;var G=le[0],q=le.pop();if(q!==G){le[0]=q;e:for(var U=0,S=le.length,z=S>>>1;U<z;){var F=2*(U+1)-1,M=le[F],W=F+1,ie=le[W];if(0>a(M,q))W<S&&0>a(ie,M)?(le[U]=ie,le[W]=q,U=W):(le[U]=M,le[F]=q,U=F);else if(W<S&&0>a(ie,q))le[U]=ie,le[W]=q,U=W;else break e}}return G}function a(le,G){var q=le.sortIndex-G.sortIndex;return q!==0?q:le.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var c=[],u=[],f=1,d=null,h=3,y=!1,g=!1,m=!1,p=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(le){for(var G=r(u);G!==null;){if(G.callback===null)n(u);else if(G.startTime<=le)n(u),G.sortIndex=G.expirationTime,t(c,G);else break;G=r(u)}}function b(le){if(m=!1,w(le),!g)if(r(c)!==null)g=!0,J(_);else{var G=r(u);G!==null&&ue(b,G.startTime-le)}}function _(le,G){g=!1,m&&(m=!1,x(R),R=-1),y=!0;var q=h;try{for(w(G),d=r(c);d!==null&&(!(d.expirationTime>G)||le&&!V());){var U=d.callback;if(typeof U=="function"){d.callback=null,h=d.priorityLevel;var S=U(d.expirationTime<=G);G=e.unstable_now(),typeof S=="function"?d.callback=S:d===r(c)&&n(c),w(G)}else n(c);d=r(c)}if(d!==null)var z=!0;else{var F=r(u);F!==null&&ue(b,F.startTime-G),z=!1}return z}finally{d=null,h=q,y=!1}}var E=!1,N=null,R=-1,j=5,L=-1;function V(){return!(e.unstable_now()-L<j)}function K(){if(N!==null){var le=e.unstable_now();L=le;var G=!0;try{G=N(!0,le)}finally{G?Y():(E=!1,N=null)}}else E=!1}var Y;if(typeof v=="function")Y=function(){v(K)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,B=H.port2;H.port1.onmessage=K,Y=function(){B.postMessage(null)}}else Y=function(){p(K,0)};function J(le){N=le,E||(E=!0,Y())}function ue(le,G){R=p(function(){le(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(le){le.callback=null},e.unstable_continueExecution=function(){g||y||(g=!0,J(_))},e.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<le?Math.floor(1e3/le):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(le){switch(h){case 1:case 2:case 3:var G=3;break;default:G=h}var q=h;h=G;try{return le()}finally{h=q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(le,G){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var q=h;h=le;try{return G()}finally{h=q}},e.unstable_scheduleCallback=function(le,G,q){var U=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?U+q:U):q=U,le){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=q+S,le={id:f++,callback:G,priorityLevel:le,startTime:q,expirationTime:S,sortIndex:-1},q>U?(le.sortIndex=q,t(u,le),r(c)===null&&le===r(u)&&(m?(x(R),R=-1):m=!0,ue(b,q-U))):(le.sortIndex=S,t(c,le),g||y||(g=!0,J(_))),le},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(le){var G=h;return function(){var q=h;h=G;try{return le.apply(this,arguments)}finally{h=q}}}})(xg);mg.exports=xg;var Xw=mg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gw=T,Gr=Xw;function me(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pg=new Set,_l={};function Ts(e,t){fi(e,t),fi(e+"Capture",t)}function fi(e,t){for(_l[e]=t,e=0;e<t.length;e++)pg.add(t[e])}var aa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wu=Object.prototype.hasOwnProperty,Kw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,lm={},om={};function qw(e){return Wu.call(om,e)?!0:Wu.call(lm,e)?!1:Kw.test(e)?om[e]=!0:(lm[e]=!0,!1)}function Yw(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Jw(e,t,r,n){if(t===null||typeof t>"u"||Yw(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Sr(e,t,r,n,a,s,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=l}var er={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){er[e]=new Sr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];er[t]=new Sr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){er[e]=new Sr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){er[e]=new Sr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){er[e]=new Sr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){er[e]=new Sr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){er[e]=new Sr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){er[e]=new Sr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){er[e]=new Sr(e,5,!1,e.toLowerCase(),null,!1,!1)});var cd=/[\-:]([a-z])/g;function ud(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(cd,ud);er[t]=new Sr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(cd,ud);er[t]=new Sr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(cd,ud);er[t]=new Sr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){er[e]=new Sr(e,1,!1,e.toLowerCase(),null,!1,!1)});er.xlinkHref=new Sr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){er[e]=new Sr(e,1,!1,e.toLowerCase(),null,!0,!0)});function fd(e,t,r,n){var a=er.hasOwnProperty(t)?er[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Jw(t,r,a,n)&&(r=null),n||a===null?qw(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ca=Gw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fo=Symbol.for("react.element"),zs=Symbol.for("react.portal"),$s=Symbol.for("react.fragment"),dd=Symbol.for("react.strict_mode"),Vu=Symbol.for("react.profiler"),gg=Symbol.for("react.provider"),vg=Symbol.for("react.context"),hd=Symbol.for("react.forward_ref"),Hu=Symbol.for("react.suspense"),Xu=Symbol.for("react.suspense_list"),md=Symbol.for("react.memo"),pa=Symbol.for("react.lazy"),yg=Symbol.for("react.offscreen"),cm=Symbol.iterator;function zi(e){return e===null||typeof e!="object"?null:(e=cm&&e[cm]||e["@@iterator"],typeof e=="function"?e:null)}var yt=Object.assign,Q0;function Qi(e){if(Q0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Q0=t&&t[1]||""}return`
`+Q0+e}var Z0=!1;function eu(e,t){if(!e||Z0)return"";Z0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),l=a.length-1,o=s.length-1;1<=l&&0<=o&&a[l]!==s[o];)o--;for(;1<=l&&0<=o;l--,o--)if(a[l]!==s[o]){if(l!==1||o!==1)do if(l--,o--,0>o||a[l]!==s[o]){var c=`
`+a[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=o);break}}}finally{Z0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Qi(e):""}function Qw(e){switch(e.tag){case 5:return Qi(e.type);case 16:return Qi("Lazy");case 13:return Qi("Suspense");case 19:return Qi("SuspenseList");case 0:case 2:case 15:return e=eu(e.type,!1),e;case 11:return e=eu(e.type.render,!1),e;case 1:return e=eu(e.type,!0),e;default:return""}}function Gu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $s:return"Fragment";case zs:return"Portal";case Vu:return"Profiler";case dd:return"StrictMode";case Hu:return"Suspense";case Xu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case vg:return(e.displayName||"Context")+".Consumer";case gg:return(e._context.displayName||"Context")+".Provider";case hd:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case md:return t=e.displayName||null,t!==null?t:Gu(e.type)||"Memo";case pa:t=e._payload,e=e._init;try{return Gu(e(t))}catch{}}return null}function Zw(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gu(t);case 8:return t===dd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Pa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function wg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function e4(e){var t=wg(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){n=""+l,s.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ao(e){e._valueTracker||(e._valueTracker=e4(e))}function bg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=wg(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Nc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ku(e,t){var r=t.checked;return yt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function um(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Pa(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Ng(e,t){t=t.checked,t!=null&&fd(e,"checked",t,!1)}function qu(e,t){Ng(e,t);var r=Pa(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Yu(e,t.type,r):t.hasOwnProperty("defaultValue")&&Yu(e,t.type,Pa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function fm(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Yu(e,t,r){(t!=="number"||Nc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Zi=Array.isArray;function ei(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Pa(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Ju(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(me(91));return yt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function dm(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(me(92));if(Zi(r)){if(1<r.length)throw Error(me(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Pa(r)}}function _g(e,t){var r=Pa(t.value),n=Pa(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function hm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function kg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?kg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Do,Eg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Do=Do||document.createElement("div"),Do.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Do.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function kl(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var sl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},t4=["Webkit","ms","Moz","O"];Object.keys(sl).forEach(function(e){t4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),sl[t]=sl[e]})});function Sg(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||sl.hasOwnProperty(e)&&sl[e]?(""+t).trim():t+"px"}function jg(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Sg(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var r4=yt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zu(e,t){if(t){if(r4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(me(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(me(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(me(61))}if(t.style!=null&&typeof t.style!="object")throw Error(me(62))}}function ef(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tf=null;function xd(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var rf=null,ti=null,ri=null;function mm(e){if(e=lo(e)){if(typeof rf!="function")throw Error(me(280));var t=e.stateNode;t&&(t=g0(t),rf(e.stateNode,e.type,t))}}function Tg(e){ti?ri?ri.push(e):ri=[e]:ti=e}function Cg(){if(ti){var e=ti,t=ri;if(ri=ti=null,mm(e),t)for(e=0;e<t.length;e++)mm(t[e])}}function Fg(e,t){return e(t)}function Ag(){}var tu=!1;function Dg(e,t,r){if(tu)return e(t,r);tu=!0;try{return Fg(e,t,r)}finally{tu=!1,(ti!==null||ri!==null)&&(Ag(),Cg())}}function El(e,t){var r=e.stateNode;if(r===null)return null;var n=g0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(me(231,t,typeof r));return r}var nf=!1;if(aa)try{var $i={};Object.defineProperty($i,"passive",{get:function(){nf=!0}}),window.addEventListener("test",$i,$i),window.removeEventListener("test",$i,$i)}catch{nf=!1}function n4(e,t,r,n,a,s,l,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var il=!1,_c=null,kc=!1,af=null,a4={onError:function(e){il=!0,_c=e}};function s4(e,t,r,n,a,s,l,o,c){il=!1,_c=null,n4.apply(a4,arguments)}function i4(e,t,r,n,a,s,l,o,c){if(s4.apply(this,arguments),il){if(il){var u=_c;il=!1,_c=null}else throw Error(me(198));kc||(kc=!0,af=u)}}function Cs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Rg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function xm(e){if(Cs(e)!==e)throw Error(me(188))}function l4(e){var t=e.alternate;if(!t){if(t=Cs(e),t===null)throw Error(me(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return xm(a),e;if(s===n)return xm(a),t;s=s.sibling}throw Error(me(188))}if(r.return!==n.return)r=a,n=s;else{for(var l=!1,o=a.child;o;){if(o===r){l=!0,r=a,n=s;break}if(o===n){l=!0,n=a,r=s;break}o=o.sibling}if(!l){for(o=s.child;o;){if(o===r){l=!0,r=s,n=a;break}if(o===n){l=!0,n=s,r=a;break}o=o.sibling}if(!l)throw Error(me(189))}}if(r.alternate!==n)throw Error(me(190))}if(r.tag!==3)throw Error(me(188));return r.stateNode.current===r?e:t}function Pg(e){return e=l4(e),e!==null?Ig(e):null}function Ig(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ig(e);if(t!==null)return t;e=e.sibling}return null}var Og=Gr.unstable_scheduleCallback,pm=Gr.unstable_cancelCallback,o4=Gr.unstable_shouldYield,c4=Gr.unstable_requestPaint,Tt=Gr.unstable_now,u4=Gr.unstable_getCurrentPriorityLevel,pd=Gr.unstable_ImmediatePriority,Lg=Gr.unstable_UserBlockingPriority,Ec=Gr.unstable_NormalPriority,f4=Gr.unstable_LowPriority,Mg=Gr.unstable_IdlePriority,h0=null,Bn=null;function d4(e){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(h0,e,void 0,(e.current.flags&128)===128)}catch{}}var Nn=Math.clz32?Math.clz32:x4,h4=Math.log,m4=Math.LN2;function x4(e){return e>>>=0,e===0?32:31-(h4(e)/m4|0)|0}var Ro=64,Po=4194304;function el(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Sc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~a;o!==0?n=el(o):(s&=l,s!==0&&(n=el(s)))}else l=r&~a,l!==0?n=el(l):s!==0&&(n=el(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Nn(t),a=1<<r,n|=e[r],t&=~a;return n}function p4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function g4(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var l=31-Nn(s),o=1<<l,c=a[l];c===-1?(!(o&r)||o&n)&&(a[l]=p4(o,t)):c<=t&&(e.expiredLanes|=o),s&=~o}}function sf(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Bg(){var e=Ro;return Ro<<=1,!(Ro&4194240)&&(Ro=64),e}function ru(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function so(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Nn(t),e[t]=r}function v4(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Nn(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function gd(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Nn(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var et=0;function Ug(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var zg,vd,$g,Wg,Vg,lf=!1,Io=[],Ea=null,Sa=null,ja=null,Sl=new Map,jl=new Map,va=[],y4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gm(e,t){switch(e){case"focusin":case"focusout":Ea=null;break;case"dragenter":case"dragleave":Sa=null;break;case"mouseover":case"mouseout":ja=null;break;case"pointerover":case"pointerout":Sl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":jl.delete(t.pointerId)}}function Wi(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=lo(t),t!==null&&vd(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function w4(e,t,r,n,a){switch(t){case"focusin":return Ea=Wi(Ea,e,t,r,n,a),!0;case"dragenter":return Sa=Wi(Sa,e,t,r,n,a),!0;case"mouseover":return ja=Wi(ja,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return Sl.set(s,Wi(Sl.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,jl.set(s,Wi(jl.get(s)||null,e,t,r,n,a)),!0}return!1}function Hg(e){var t=ts(e.target);if(t!==null){var r=Cs(t);if(r!==null){if(t=r.tag,t===13){if(t=Rg(r),t!==null){e.blockedOn=t,Vg(e.priority,function(){$g(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function lc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=of(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);tf=n,r.target.dispatchEvent(n),tf=null}else return t=lo(r),t!==null&&vd(t),e.blockedOn=r,!1;t.shift()}return!0}function vm(e,t,r){lc(e)&&r.delete(t)}function b4(){lf=!1,Ea!==null&&lc(Ea)&&(Ea=null),Sa!==null&&lc(Sa)&&(Sa=null),ja!==null&&lc(ja)&&(ja=null),Sl.forEach(vm),jl.forEach(vm)}function Vi(e,t){e.blockedOn===t&&(e.blockedOn=null,lf||(lf=!0,Gr.unstable_scheduleCallback(Gr.unstable_NormalPriority,b4)))}function Tl(e){function t(a){return Vi(a,e)}if(0<Io.length){Vi(Io[0],e);for(var r=1;r<Io.length;r++){var n=Io[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ea!==null&&Vi(Ea,e),Sa!==null&&Vi(Sa,e),ja!==null&&Vi(ja,e),Sl.forEach(t),jl.forEach(t),r=0;r<va.length;r++)n=va[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<va.length&&(r=va[0],r.blockedOn===null);)Hg(r),r.blockedOn===null&&va.shift()}var ni=ca.ReactCurrentBatchConfig,jc=!0;function N4(e,t,r,n){var a=et,s=ni.transition;ni.transition=null;try{et=1,yd(e,t,r,n)}finally{et=a,ni.transition=s}}function _4(e,t,r,n){var a=et,s=ni.transition;ni.transition=null;try{et=4,yd(e,t,r,n)}finally{et=a,ni.transition=s}}function yd(e,t,r,n){if(jc){var a=of(e,t,r,n);if(a===null)du(e,t,n,Tc,r),gm(e,n);else if(w4(a,e,t,r,n))n.stopPropagation();else if(gm(e,n),t&4&&-1<y4.indexOf(e)){for(;a!==null;){var s=lo(a);if(s!==null&&zg(s),s=of(e,t,r,n),s===null&&du(e,t,n,Tc,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else du(e,t,n,null,r)}}var Tc=null;function of(e,t,r,n){if(Tc=null,e=xd(n),e=ts(e),e!==null)if(t=Cs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Rg(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Tc=e,null}function Xg(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(u4()){case pd:return 1;case Lg:return 4;case Ec:case f4:return 16;case Mg:return 536870912;default:return 16}default:return 16}}var wa=null,wd=null,oc=null;function Gg(){if(oc)return oc;var e,t=wd,r=t.length,n,a="value"in wa?wa.value:wa.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===a[s-n];n++);return oc=a.slice(e,1<n?1-n:void 0)}function cc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Oo(){return!0}function ym(){return!1}function Yr(e){function t(r,n,a,s,l){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Oo:ym,this.isPropagationStopped=ym,this}return yt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Oo)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Oo)},persist:function(){},isPersistent:Oo}),t}var ji={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bd=Yr(ji),io=yt({},ji,{view:0,detail:0}),k4=Yr(io),nu,au,Hi,m0=yt({},io,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Hi&&(Hi&&e.type==="mousemove"?(nu=e.screenX-Hi.screenX,au=e.screenY-Hi.screenY):au=nu=0,Hi=e),nu)},movementY:function(e){return"movementY"in e?e.movementY:au}}),wm=Yr(m0),E4=yt({},m0,{dataTransfer:0}),S4=Yr(E4),j4=yt({},io,{relatedTarget:0}),su=Yr(j4),T4=yt({},ji,{animationName:0,elapsedTime:0,pseudoElement:0}),C4=Yr(T4),F4=yt({},ji,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),A4=Yr(F4),D4=yt({},ji,{data:0}),bm=Yr(D4),R4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},P4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},I4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function O4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=I4[e])?!!t[e]:!1}function Nd(){return O4}var L4=yt({},io,{key:function(e){if(e.key){var t=R4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=cc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?P4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nd,charCode:function(e){return e.type==="keypress"?cc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?cc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),M4=Yr(L4),B4=yt({},m0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nm=Yr(B4),U4=yt({},io,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nd}),z4=Yr(U4),$4=yt({},ji,{propertyName:0,elapsedTime:0,pseudoElement:0}),W4=Yr($4),V4=yt({},m0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),H4=Yr(V4),X4=[9,13,27,32],_d=aa&&"CompositionEvent"in window,ll=null;aa&&"documentMode"in document&&(ll=document.documentMode);var G4=aa&&"TextEvent"in window&&!ll,Kg=aa&&(!_d||ll&&8<ll&&11>=ll),_m=" ",km=!1;function qg(e,t){switch(e){case"keyup":return X4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ws=!1;function K4(e,t){switch(e){case"compositionend":return Yg(t);case"keypress":return t.which!==32?null:(km=!0,_m);case"textInput":return e=t.data,e===_m&&km?null:e;default:return null}}function q4(e,t){if(Ws)return e==="compositionend"||!_d&&qg(e,t)?(e=Gg(),oc=wd=wa=null,Ws=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Kg&&t.locale!=="ko"?null:t.data;default:return null}}var Y4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Em(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Y4[e.type]:t==="textarea"}function Jg(e,t,r,n){Tg(n),t=Cc(t,"onChange"),0<t.length&&(r=new bd("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var ol=null,Cl=null;function J4(e){o1(e,0)}function x0(e){var t=Xs(e);if(bg(t))return e}function Q4(e,t){if(e==="change")return t}var Qg=!1;if(aa){var iu;if(aa){var lu="oninput"in document;if(!lu){var Sm=document.createElement("div");Sm.setAttribute("oninput","return;"),lu=typeof Sm.oninput=="function"}iu=lu}else iu=!1;Qg=iu&&(!document.documentMode||9<document.documentMode)}function jm(){ol&&(ol.detachEvent("onpropertychange",Zg),Cl=ol=null)}function Zg(e){if(e.propertyName==="value"&&x0(Cl)){var t=[];Jg(t,Cl,e,xd(e)),Dg(J4,t)}}function Z4(e,t,r){e==="focusin"?(jm(),ol=t,Cl=r,ol.attachEvent("onpropertychange",Zg)):e==="focusout"&&jm()}function eb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return x0(Cl)}function tb(e,t){if(e==="click")return x0(t)}function rb(e,t){if(e==="input"||e==="change")return x0(t)}function nb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Sn=typeof Object.is=="function"?Object.is:nb;function Fl(e,t){if(Sn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!Wu.call(t,a)||!Sn(e[a],t[a]))return!1}return!0}function Tm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Cm(e,t){var r=Tm(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Tm(r)}}function e1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?e1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function t1(){for(var e=window,t=Nc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Nc(e.document)}return t}function kd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function ab(e){var t=t1(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&e1(r.ownerDocument.documentElement,r)){if(n!==null&&kd(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Cm(r,s);var l=Cm(r,n);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var sb=aa&&"documentMode"in document&&11>=document.documentMode,Vs=null,cf=null,cl=null,uf=!1;function Fm(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;uf||Vs==null||Vs!==Nc(n)||(n=Vs,"selectionStart"in n&&kd(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),cl&&Fl(cl,n)||(cl=n,n=Cc(cf,"onSelect"),0<n.length&&(t=new bd("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Vs)))}function Lo(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Hs={animationend:Lo("Animation","AnimationEnd"),animationiteration:Lo("Animation","AnimationIteration"),animationstart:Lo("Animation","AnimationStart"),transitionend:Lo("Transition","TransitionEnd")},ou={},r1={};aa&&(r1=document.createElement("div").style,"AnimationEvent"in window||(delete Hs.animationend.animation,delete Hs.animationiteration.animation,delete Hs.animationstart.animation),"TransitionEvent"in window||delete Hs.transitionend.transition);function p0(e){if(ou[e])return ou[e];if(!Hs[e])return e;var t=Hs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in r1)return ou[e]=t[r];return e}var n1=p0("animationend"),a1=p0("animationiteration"),s1=p0("animationstart"),i1=p0("transitionend"),l1=new Map,Am="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $a(e,t){l1.set(e,t),Ts(t,[e])}for(var cu=0;cu<Am.length;cu++){var uu=Am[cu],ib=uu.toLowerCase(),lb=uu[0].toUpperCase()+uu.slice(1);$a(ib,"on"+lb)}$a(n1,"onAnimationEnd");$a(a1,"onAnimationIteration");$a(s1,"onAnimationStart");$a("dblclick","onDoubleClick");$a("focusin","onFocus");$a("focusout","onBlur");$a(i1,"onTransitionEnd");fi("onMouseEnter",["mouseout","mouseover"]);fi("onMouseLeave",["mouseout","mouseover"]);fi("onPointerEnter",["pointerout","pointerover"]);fi("onPointerLeave",["pointerout","pointerover"]);Ts("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ts("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ts("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ts("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ts("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ts("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ob=new Set("cancel close invalid load scroll toggle".split(" ").concat(tl));function Dm(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,i4(n,t,void 0,e),e.currentTarget=null}function o1(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==s&&a.isPropagationStopped())break e;Dm(a,o,u),s=c}else for(l=0;l<n.length;l++){if(o=n[l],c=o.instance,u=o.currentTarget,o=o.listener,c!==s&&a.isPropagationStopped())break e;Dm(a,o,u),s=c}}}if(kc)throw e=af,kc=!1,af=null,e}function it(e,t){var r=t[xf];r===void 0&&(r=t[xf]=new Set);var n=e+"__bubble";r.has(n)||(c1(t,e,2,!1),r.add(n))}function fu(e,t,r){var n=0;t&&(n|=4),c1(r,e,n,t)}var Mo="_reactListening"+Math.random().toString(36).slice(2);function Al(e){if(!e[Mo]){e[Mo]=!0,pg.forEach(function(r){r!=="selectionchange"&&(ob.has(r)||fu(r,!1,e),fu(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Mo]||(t[Mo]=!0,fu("selectionchange",!1,t))}}function c1(e,t,r,n){switch(Xg(t)){case 1:var a=N4;break;case 4:a=_4;break;default:a=yd}r=a.bind(null,t,r,e),a=void 0,!nf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function du(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(l===4)for(l=n.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;l=l.return}for(;o!==null;){if(l=ts(o),l===null)return;if(c=l.tag,c===5||c===6){n=s=l;continue e}o=o.parentNode}}n=n.return}Dg(function(){var u=s,f=xd(r),d=[];e:{var h=l1.get(e);if(h!==void 0){var y=bd,g=e;switch(e){case"keypress":if(cc(r)===0)break e;case"keydown":case"keyup":y=M4;break;case"focusin":g="focus",y=su;break;case"focusout":g="blur",y=su;break;case"beforeblur":case"afterblur":y=su;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=wm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=S4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=z4;break;case n1:case a1:case s1:y=C4;break;case i1:y=W4;break;case"scroll":y=k4;break;case"wheel":y=H4;break;case"copy":case"cut":case"paste":y=A4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=Nm}var m=(t&4)!==0,p=!m&&e==="scroll",x=m?h!==null?h+"Capture":null:h;m=[];for(var v=u,w;v!==null;){w=v;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,x!==null&&(b=El(v,x),b!=null&&m.push(Dl(v,b,w)))),p)break;v=v.return}0<m.length&&(h=new y(h,g,null,r,f),d.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",y=e==="mouseout"||e==="pointerout",h&&r!==tf&&(g=r.relatedTarget||r.fromElement)&&(ts(g)||g[sa]))break e;if((y||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,y?(g=r.relatedTarget||r.toElement,y=u,g=g?ts(g):null,g!==null&&(p=Cs(g),g!==p||g.tag!==5&&g.tag!==6)&&(g=null)):(y=null,g=u),y!==g)){if(m=wm,b="onMouseLeave",x="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(m=Nm,b="onPointerLeave",x="onPointerEnter",v="pointer"),p=y==null?h:Xs(y),w=g==null?h:Xs(g),h=new m(b,v+"leave",y,r,f),h.target=p,h.relatedTarget=w,b=null,ts(f)===u&&(m=new m(x,v+"enter",g,r,f),m.target=w,m.relatedTarget=p,b=m),p=b,y&&g)t:{for(m=y,x=g,v=0,w=m;w;w=Os(w))v++;for(w=0,b=x;b;b=Os(b))w++;for(;0<v-w;)m=Os(m),v--;for(;0<w-v;)x=Os(x),w--;for(;v--;){if(m===x||x!==null&&m===x.alternate)break t;m=Os(m),x=Os(x)}m=null}else m=null;y!==null&&Rm(d,h,y,m,!1),g!==null&&p!==null&&Rm(d,p,g,m,!0)}}e:{if(h=u?Xs(u):window,y=h.nodeName&&h.nodeName.toLowerCase(),y==="select"||y==="input"&&h.type==="file")var _=Q4;else if(Em(h))if(Qg)_=rb;else{_=eb;var E=Z4}else(y=h.nodeName)&&y.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(_=tb);if(_&&(_=_(e,u))){Jg(d,_,r,f);break e}E&&E(e,h,u),e==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&Yu(h,"number",h.value)}switch(E=u?Xs(u):window,e){case"focusin":(Em(E)||E.contentEditable==="true")&&(Vs=E,cf=u,cl=null);break;case"focusout":cl=cf=Vs=null;break;case"mousedown":uf=!0;break;case"contextmenu":case"mouseup":case"dragend":uf=!1,Fm(d,r,f);break;case"selectionchange":if(sb)break;case"keydown":case"keyup":Fm(d,r,f)}var N;if(_d)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Ws?qg(e,r)&&(R="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(R="onCompositionStart");R&&(Kg&&r.locale!=="ko"&&(Ws||R!=="onCompositionStart"?R==="onCompositionEnd"&&Ws&&(N=Gg()):(wa=f,wd="value"in wa?wa.value:wa.textContent,Ws=!0)),E=Cc(u,R),0<E.length&&(R=new bm(R,e,null,r,f),d.push({event:R,listeners:E}),N?R.data=N:(N=Yg(r),N!==null&&(R.data=N)))),(N=G4?K4(e,r):q4(e,r))&&(u=Cc(u,"onBeforeInput"),0<u.length&&(f=new bm("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:u}),f.data=N))}o1(d,t)})}function Dl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Cc(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=El(e,r),s!=null&&n.unshift(Dl(e,s,a)),s=El(e,t),s!=null&&n.push(Dl(e,s,a))),e=e.return}return n}function Os(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Rm(e,t,r,n,a){for(var s=t._reactName,l=[];r!==null&&r!==n;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,a?(c=El(r,s),c!=null&&l.unshift(Dl(r,c,o))):a||(c=El(r,s),c!=null&&l.push(Dl(r,c,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var cb=/\r\n?/g,ub=/\u0000|\uFFFD/g;function Pm(e){return(typeof e=="string"?e:""+e).replace(cb,`
`).replace(ub,"")}function Bo(e,t,r){if(t=Pm(t),Pm(e)!==t&&r)throw Error(me(425))}function Fc(){}var ff=null,df=null;function hf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var mf=typeof setTimeout=="function"?setTimeout:void 0,fb=typeof clearTimeout=="function"?clearTimeout:void 0,Im=typeof Promise=="function"?Promise:void 0,db=typeof queueMicrotask=="function"?queueMicrotask:typeof Im<"u"?function(e){return Im.resolve(null).then(e).catch(hb)}:mf;function hb(e){setTimeout(function(){throw e})}function hu(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Tl(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Tl(t)}function Ta(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Om(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ti=Math.random().toString(36).slice(2),Ln="__reactFiber$"+Ti,Rl="__reactProps$"+Ti,sa="__reactContainer$"+Ti,xf="__reactEvents$"+Ti,mb="__reactListeners$"+Ti,xb="__reactHandles$"+Ti;function ts(e){var t=e[Ln];if(t)return t;for(var r=e.parentNode;r;){if(t=r[sa]||r[Ln]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Om(e);e!==null;){if(r=e[Ln])return r;e=Om(e)}return t}e=r,r=e.parentNode}return null}function lo(e){return e=e[Ln]||e[sa],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Xs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(me(33))}function g0(e){return e[Rl]||null}var pf=[],Gs=-1;function Wa(e){return{current:e}}function ot(e){0>Gs||(e.current=pf[Gs],pf[Gs]=null,Gs--)}function at(e,t){Gs++,pf[Gs]=e.current,e.current=t}var Ia={},hr=Wa(Ia),Ar=Wa(!1),xs=Ia;function di(e,t){var r=e.type.contextTypes;if(!r)return Ia;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Dr(e){return e=e.childContextTypes,e!=null}function Ac(){ot(Ar),ot(hr)}function Lm(e,t,r){if(hr.current!==Ia)throw Error(me(168));at(hr,t),at(Ar,r)}function u1(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(me(108,Zw(e)||"Unknown",a));return yt({},r,n)}function Dc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ia,xs=hr.current,at(hr,e),at(Ar,Ar.current),!0}function Mm(e,t,r){var n=e.stateNode;if(!n)throw Error(me(169));r?(e=u1(e,t,xs),n.__reactInternalMemoizedMergedChildContext=e,ot(Ar),ot(hr),at(hr,e)):ot(Ar),at(Ar,r)}var Yn=null,v0=!1,mu=!1;function f1(e){Yn===null?Yn=[e]:Yn.push(e)}function pb(e){v0=!0,f1(e)}function Va(){if(!mu&&Yn!==null){mu=!0;var e=0,t=et;try{var r=Yn;for(et=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Yn=null,v0=!1}catch(a){throw Yn!==null&&(Yn=Yn.slice(e+1)),Og(pd,Va),a}finally{et=t,mu=!1}}return null}var Ks=[],qs=0,Rc=null,Pc=0,nn=[],an=0,ps=null,Jn=1,Qn="";function Ja(e,t){Ks[qs++]=Pc,Ks[qs++]=Rc,Rc=e,Pc=t}function d1(e,t,r){nn[an++]=Jn,nn[an++]=Qn,nn[an++]=ps,ps=e;var n=Jn;e=Qn;var a=32-Nn(n)-1;n&=~(1<<a),r+=1;var s=32-Nn(t)+a;if(30<s){var l=a-a%5;s=(n&(1<<l)-1).toString(32),n>>=l,a-=l,Jn=1<<32-Nn(t)+a|r<<a|n,Qn=s+e}else Jn=1<<s|r<<a|n,Qn=e}function Ed(e){e.return!==null&&(Ja(e,1),d1(e,1,0))}function Sd(e){for(;e===Rc;)Rc=Ks[--qs],Ks[qs]=null,Pc=Ks[--qs],Ks[qs]=null;for(;e===ps;)ps=nn[--an],nn[an]=null,Qn=nn[--an],nn[an]=null,Jn=nn[--an],nn[an]=null}var Hr=null,Vr=null,ft=!1,yn=null;function h1(e,t){var r=sn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Bm(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Hr=e,Vr=Ta(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Hr=e,Vr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ps!==null?{id:Jn,overflow:Qn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=sn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Hr=e,Vr=null,!0):!1;default:return!1}}function gf(e){return(e.mode&1)!==0&&(e.flags&128)===0}function vf(e){if(ft){var t=Vr;if(t){var r=t;if(!Bm(e,t)){if(gf(e))throw Error(me(418));t=Ta(r.nextSibling);var n=Hr;t&&Bm(e,t)?h1(n,r):(e.flags=e.flags&-4097|2,ft=!1,Hr=e)}}else{if(gf(e))throw Error(me(418));e.flags=e.flags&-4097|2,ft=!1,Hr=e}}}function Um(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Hr=e}function Uo(e){if(e!==Hr)return!1;if(!ft)return Um(e),ft=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!hf(e.type,e.memoizedProps)),t&&(t=Vr)){if(gf(e))throw m1(),Error(me(418));for(;t;)h1(e,t),t=Ta(t.nextSibling)}if(Um(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(me(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Vr=Ta(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Vr=null}}else Vr=Hr?Ta(e.stateNode.nextSibling):null;return!0}function m1(){for(var e=Vr;e;)e=Ta(e.nextSibling)}function hi(){Vr=Hr=null,ft=!1}function jd(e){yn===null?yn=[e]:yn.push(e)}var gb=ca.ReactCurrentBatchConfig;function Xi(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(me(309));var n=r.stateNode}if(!n)throw Error(me(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(l){var o=a.refs;l===null?delete o[s]:o[s]=l},t._stringRef=s,t)}if(typeof e!="string")throw Error(me(284));if(!r._owner)throw Error(me(290,e))}return e}function zo(e,t){throw e=Object.prototype.toString.call(t),Error(me(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function zm(e){var t=e._init;return t(e._payload)}function x1(e){function t(x,v){if(e){var w=x.deletions;w===null?(x.deletions=[v],x.flags|=16):w.push(v)}}function r(x,v){if(!e)return null;for(;v!==null;)t(x,v),v=v.sibling;return null}function n(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function a(x,v){return x=Da(x,v),x.index=0,x.sibling=null,x}function s(x,v,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<v?(x.flags|=2,v):w):(x.flags|=2,v)):(x.flags|=1048576,v)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,v,w,b){return v===null||v.tag!==6?(v=bu(w,x.mode,b),v.return=x,v):(v=a(v,w),v.return=x,v)}function c(x,v,w,b){var _=w.type;return _===$s?f(x,v,w.props.children,b,w.key):v!==null&&(v.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===pa&&zm(_)===v.type)?(b=a(v,w.props),b.ref=Xi(x,v,w),b.return=x,b):(b=pc(w.type,w.key,w.props,null,x.mode,b),b.ref=Xi(x,v,w),b.return=x,b)}function u(x,v,w,b){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=Nu(w,x.mode,b),v.return=x,v):(v=a(v,w.children||[]),v.return=x,v)}function f(x,v,w,b,_){return v===null||v.tag!==7?(v=cs(w,x.mode,b,_),v.return=x,v):(v=a(v,w),v.return=x,v)}function d(x,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=bu(""+v,x.mode,w),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Fo:return w=pc(v.type,v.key,v.props,null,x.mode,w),w.ref=Xi(x,null,v),w.return=x,w;case zs:return v=Nu(v,x.mode,w),v.return=x,v;case pa:var b=v._init;return d(x,b(v._payload),w)}if(Zi(v)||zi(v))return v=cs(v,x.mode,w,null),v.return=x,v;zo(x,v)}return null}function h(x,v,w,b){var _=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return _!==null?null:o(x,v,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Fo:return w.key===_?c(x,v,w,b):null;case zs:return w.key===_?u(x,v,w,b):null;case pa:return _=w._init,h(x,v,_(w._payload),b)}if(Zi(w)||zi(w))return _!==null?null:f(x,v,w,b,null);zo(x,w)}return null}function y(x,v,w,b,_){if(typeof b=="string"&&b!==""||typeof b=="number")return x=x.get(w)||null,o(v,x,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Fo:return x=x.get(b.key===null?w:b.key)||null,c(v,x,b,_);case zs:return x=x.get(b.key===null?w:b.key)||null,u(v,x,b,_);case pa:var E=b._init;return y(x,v,w,E(b._payload),_)}if(Zi(b)||zi(b))return x=x.get(w)||null,f(v,x,b,_,null);zo(v,b)}return null}function g(x,v,w,b){for(var _=null,E=null,N=v,R=v=0,j=null;N!==null&&R<w.length;R++){N.index>R?(j=N,N=null):j=N.sibling;var L=h(x,N,w[R],b);if(L===null){N===null&&(N=j);break}e&&N&&L.alternate===null&&t(x,N),v=s(L,v,R),E===null?_=L:E.sibling=L,E=L,N=j}if(R===w.length)return r(x,N),ft&&Ja(x,R),_;if(N===null){for(;R<w.length;R++)N=d(x,w[R],b),N!==null&&(v=s(N,v,R),E===null?_=N:E.sibling=N,E=N);return ft&&Ja(x,R),_}for(N=n(x,N);R<w.length;R++)j=y(N,x,R,w[R],b),j!==null&&(e&&j.alternate!==null&&N.delete(j.key===null?R:j.key),v=s(j,v,R),E===null?_=j:E.sibling=j,E=j);return e&&N.forEach(function(V){return t(x,V)}),ft&&Ja(x,R),_}function m(x,v,w,b){var _=zi(w);if(typeof _!="function")throw Error(me(150));if(w=_.call(w),w==null)throw Error(me(151));for(var E=_=null,N=v,R=v=0,j=null,L=w.next();N!==null&&!L.done;R++,L=w.next()){N.index>R?(j=N,N=null):j=N.sibling;var V=h(x,N,L.value,b);if(V===null){N===null&&(N=j);break}e&&N&&V.alternate===null&&t(x,N),v=s(V,v,R),E===null?_=V:E.sibling=V,E=V,N=j}if(L.done)return r(x,N),ft&&Ja(x,R),_;if(N===null){for(;!L.done;R++,L=w.next())L=d(x,L.value,b),L!==null&&(v=s(L,v,R),E===null?_=L:E.sibling=L,E=L);return ft&&Ja(x,R),_}for(N=n(x,N);!L.done;R++,L=w.next())L=y(N,x,R,L.value,b),L!==null&&(e&&L.alternate!==null&&N.delete(L.key===null?R:L.key),v=s(L,v,R),E===null?_=L:E.sibling=L,E=L);return e&&N.forEach(function(K){return t(x,K)}),ft&&Ja(x,R),_}function p(x,v,w,b){if(typeof w=="object"&&w!==null&&w.type===$s&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Fo:e:{for(var _=w.key,E=v;E!==null;){if(E.key===_){if(_=w.type,_===$s){if(E.tag===7){r(x,E.sibling),v=a(E,w.props.children),v.return=x,x=v;break e}}else if(E.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===pa&&zm(_)===E.type){r(x,E.sibling),v=a(E,w.props),v.ref=Xi(x,E,w),v.return=x,x=v;break e}r(x,E);break}else t(x,E);E=E.sibling}w.type===$s?(v=cs(w.props.children,x.mode,b,w.key),v.return=x,x=v):(b=pc(w.type,w.key,w.props,null,x.mode,b),b.ref=Xi(x,v,w),b.return=x,x=b)}return l(x);case zs:e:{for(E=w.key;v!==null;){if(v.key===E)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){r(x,v.sibling),v=a(v,w.children||[]),v.return=x,x=v;break e}else{r(x,v);break}else t(x,v);v=v.sibling}v=Nu(w,x.mode,b),v.return=x,x=v}return l(x);case pa:return E=w._init,p(x,v,E(w._payload),b)}if(Zi(w))return g(x,v,w,b);if(zi(w))return m(x,v,w,b);zo(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(r(x,v.sibling),v=a(v,w),v.return=x,x=v):(r(x,v),v=bu(w,x.mode,b),v.return=x,x=v),l(x)):r(x,v)}return p}var mi=x1(!0),p1=x1(!1),Ic=Wa(null),Oc=null,Ys=null,Td=null;function Cd(){Td=Ys=Oc=null}function Fd(e){var t=Ic.current;ot(Ic),e._currentValue=t}function yf(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ai(e,t){Oc=e,Td=Ys=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Fr=!0),e.firstContext=null)}function cn(e){var t=e._currentValue;if(Td!==e)if(e={context:e,memoizedValue:t,next:null},Ys===null){if(Oc===null)throw Error(me(308));Ys=e,Oc.dependencies={lanes:0,firstContext:e}}else Ys=Ys.next=e;return t}var rs=null;function Ad(e){rs===null?rs=[e]:rs.push(e)}function g1(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Ad(t)):(r.next=a.next,a.next=r),t.interleaved=r,ia(e,n)}function ia(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ga=!1;function Dd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function v1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ea(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ca(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Xe&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,ia(e,r)}return a=n.interleaved,a===null?(t.next=t,Ad(n)):(t.next=a.next,a.next=t),n.interleaved=t,ia(e,r)}function uc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,gd(e,r)}}function $m(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=l:s=s.next=l,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Lc(e,t,r,n){var a=e.updateQueue;ga=!1;var s=a.firstBaseUpdate,l=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,u=c.next;c.next=null,l===null?s=u:l.next=u,l=c;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==l&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=c))}if(s!==null){var d=a.baseState;l=0,f=u=c=null,o=s;do{var h=o.lane,y=o.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:y,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,m=o;switch(h=t,y=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){d=g.call(y,d,h);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,h=typeof g=="function"?g.call(y,d,h):g,h==null)break e;d=yt({},d,h);break e;case 2:ga=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else y={eventTime:y,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=y,c=d):f=f.next=y,l|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(f===null&&(c=d),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);vs|=l,e.lanes=l,e.memoizedState=d}}function Wm(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(me(191,a));a.call(n)}}}var oo={},Un=Wa(oo),Pl=Wa(oo),Il=Wa(oo);function ns(e){if(e===oo)throw Error(me(174));return e}function Rd(e,t){switch(at(Il,t),at(Pl,e),at(Un,oo),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Qu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Qu(t,e)}ot(Un),at(Un,t)}function xi(){ot(Un),ot(Pl),ot(Il)}function y1(e){ns(Il.current);var t=ns(Un.current),r=Qu(t,e.type);t!==r&&(at(Pl,e),at(Un,r))}function Pd(e){Pl.current===e&&(ot(Un),ot(Pl))}var mt=Wa(0);function Mc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var xu=[];function Id(){for(var e=0;e<xu.length;e++)xu[e]._workInProgressVersionPrimary=null;xu.length=0}var fc=ca.ReactCurrentDispatcher,pu=ca.ReactCurrentBatchConfig,gs=0,gt=null,Ot=null,$t=null,Bc=!1,ul=!1,Ol=0,vb=0;function rr(){throw Error(me(321))}function Od(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Sn(e[r],t[r]))return!1;return!0}function Ld(e,t,r,n,a,s){if(gs=s,gt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fc.current=e===null||e.memoizedState===null?Nb:_b,e=r(n,a),ul){s=0;do{if(ul=!1,Ol=0,25<=s)throw Error(me(301));s+=1,$t=Ot=null,t.updateQueue=null,fc.current=kb,e=r(n,a)}while(ul)}if(fc.current=Uc,t=Ot!==null&&Ot.next!==null,gs=0,$t=Ot=gt=null,Bc=!1,t)throw Error(me(300));return e}function Md(){var e=Ol!==0;return Ol=0,e}function On(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $t===null?gt.memoizedState=$t=e:$t=$t.next=e,$t}function un(){if(Ot===null){var e=gt.alternate;e=e!==null?e.memoizedState:null}else e=Ot.next;var t=$t===null?gt.memoizedState:$t.next;if(t!==null)$t=t,Ot=e;else{if(e===null)throw Error(me(310));Ot=e,e={memoizedState:Ot.memoizedState,baseState:Ot.baseState,baseQueue:Ot.baseQueue,queue:Ot.queue,next:null},$t===null?gt.memoizedState=$t=e:$t=$t.next=e}return $t}function Ll(e,t){return typeof t=="function"?t(e):t}function gu(e){var t=un(),r=t.queue;if(r===null)throw Error(me(311));r.lastRenderedReducer=e;var n=Ot,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var l=a.next;a.next=s.next,s.next=l}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=l=null,c=null,u=s;do{var f=u.lane;if((gs&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=d,l=n):c=c.next=d,gt.lanes|=f,vs|=f}u=u.next}while(u!==null&&u!==s);c===null?l=n:c.next=o,Sn(n,t.memoizedState)||(Fr=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,gt.lanes|=s,vs|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function vu(e){var t=un(),r=t.queue;if(r===null)throw Error(me(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var l=a=a.next;do s=e(s,l.action),l=l.next;while(l!==a);Sn(s,t.memoizedState)||(Fr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function w1(){}function b1(e,t){var r=gt,n=un(),a=t(),s=!Sn(n.memoizedState,a);if(s&&(n.memoizedState=a,Fr=!0),n=n.queue,Bd(k1.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||$t!==null&&$t.memoizedState.tag&1){if(r.flags|=2048,Ml(9,_1.bind(null,r,n,a,t),void 0,null),Xt===null)throw Error(me(349));gs&30||N1(r,t,a)}return a}function N1(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=gt.updateQueue,t===null?(t={lastEffect:null,stores:null},gt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function _1(e,t,r,n){t.value=r,t.getSnapshot=n,E1(t)&&S1(e)}function k1(e,t,r){return r(function(){E1(t)&&S1(e)})}function E1(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Sn(e,r)}catch{return!0}}function S1(e){var t=ia(e,1);t!==null&&_n(t,e,1,-1)}function Vm(e){var t=On();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ll,lastRenderedState:e},t.queue=e,e=e.dispatch=bb.bind(null,gt,e),[t.memoizedState,e]}function Ml(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=gt.updateQueue,t===null?(t={lastEffect:null,stores:null},gt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function j1(){return un().memoizedState}function dc(e,t,r,n){var a=On();gt.flags|=e,a.memoizedState=Ml(1|t,r,void 0,n===void 0?null:n)}function y0(e,t,r,n){var a=un();n=n===void 0?null:n;var s=void 0;if(Ot!==null){var l=Ot.memoizedState;if(s=l.destroy,n!==null&&Od(n,l.deps)){a.memoizedState=Ml(t,r,s,n);return}}gt.flags|=e,a.memoizedState=Ml(1|t,r,s,n)}function Hm(e,t){return dc(8390656,8,e,t)}function Bd(e,t){return y0(2048,8,e,t)}function T1(e,t){return y0(4,2,e,t)}function C1(e,t){return y0(4,4,e,t)}function F1(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function A1(e,t,r){return r=r!=null?r.concat([e]):null,y0(4,4,F1.bind(null,t,e),r)}function Ud(){}function D1(e,t){var r=un();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Od(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function R1(e,t){var r=un();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Od(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function P1(e,t,r){return gs&21?(Sn(r,t)||(r=Bg(),gt.lanes|=r,vs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Fr=!0),e.memoizedState=r)}function yb(e,t){var r=et;et=r!==0&&4>r?r:4,e(!0);var n=pu.transition;pu.transition={};try{e(!1),t()}finally{et=r,pu.transition=n}}function I1(){return un().memoizedState}function wb(e,t,r){var n=Aa(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},O1(e))L1(t,r);else if(r=g1(e,t,r,n),r!==null){var a=Nr();_n(r,e,n,a),M1(r,t,n)}}function bb(e,t,r){var n=Aa(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(O1(e))L1(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var l=t.lastRenderedState,o=s(l,r);if(a.hasEagerState=!0,a.eagerState=o,Sn(o,l)){var c=t.interleaved;c===null?(a.next=a,Ad(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=g1(e,t,a,n),r!==null&&(a=Nr(),_n(r,e,n,a),M1(r,t,n))}}function O1(e){var t=e.alternate;return e===gt||t!==null&&t===gt}function L1(e,t){ul=Bc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function M1(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,gd(e,r)}}var Uc={readContext:cn,useCallback:rr,useContext:rr,useEffect:rr,useImperativeHandle:rr,useInsertionEffect:rr,useLayoutEffect:rr,useMemo:rr,useReducer:rr,useRef:rr,useState:rr,useDebugValue:rr,useDeferredValue:rr,useTransition:rr,useMutableSource:rr,useSyncExternalStore:rr,useId:rr,unstable_isNewReconciler:!1},Nb={readContext:cn,useCallback:function(e,t){return On().memoizedState=[e,t===void 0?null:t],e},useContext:cn,useEffect:Hm,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,dc(4194308,4,F1.bind(null,t,e),r)},useLayoutEffect:function(e,t){return dc(4194308,4,e,t)},useInsertionEffect:function(e,t){return dc(4,2,e,t)},useMemo:function(e,t){var r=On();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=On();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=wb.bind(null,gt,e),[n.memoizedState,e]},useRef:function(e){var t=On();return e={current:e},t.memoizedState=e},useState:Vm,useDebugValue:Ud,useDeferredValue:function(e){return On().memoizedState=e},useTransition:function(){var e=Vm(!1),t=e[0];return e=yb.bind(null,e[1]),On().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=gt,a=On();if(ft){if(r===void 0)throw Error(me(407));r=r()}else{if(r=t(),Xt===null)throw Error(me(349));gs&30||N1(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,Hm(k1.bind(null,n,s,e),[e]),n.flags|=2048,Ml(9,_1.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=On(),t=Xt.identifierPrefix;if(ft){var r=Qn,n=Jn;r=(n&~(1<<32-Nn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ol++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=vb++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},_b={readContext:cn,useCallback:D1,useContext:cn,useEffect:Bd,useImperativeHandle:A1,useInsertionEffect:T1,useLayoutEffect:C1,useMemo:R1,useReducer:gu,useRef:j1,useState:function(){return gu(Ll)},useDebugValue:Ud,useDeferredValue:function(e){var t=un();return P1(t,Ot.memoizedState,e)},useTransition:function(){var e=gu(Ll)[0],t=un().memoizedState;return[e,t]},useMutableSource:w1,useSyncExternalStore:b1,useId:I1,unstable_isNewReconciler:!1},kb={readContext:cn,useCallback:D1,useContext:cn,useEffect:Bd,useImperativeHandle:A1,useInsertionEffect:T1,useLayoutEffect:C1,useMemo:R1,useReducer:vu,useRef:j1,useState:function(){return vu(Ll)},useDebugValue:Ud,useDeferredValue:function(e){var t=un();return Ot===null?t.memoizedState=e:P1(t,Ot.memoizedState,e)},useTransition:function(){var e=vu(Ll)[0],t=un().memoizedState;return[e,t]},useMutableSource:w1,useSyncExternalStore:b1,useId:I1,unstable_isNewReconciler:!1};function gn(e,t){if(e&&e.defaultProps){t=yt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function wf(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:yt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var w0={isMounted:function(e){return(e=e._reactInternals)?Cs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Nr(),a=Aa(e),s=ea(n,a);s.payload=t,r!=null&&(s.callback=r),t=Ca(e,s,a),t!==null&&(_n(t,e,a,n),uc(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Nr(),a=Aa(e),s=ea(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Ca(e,s,a),t!==null&&(_n(t,e,a,n),uc(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Nr(),n=Aa(e),a=ea(r,n);a.tag=2,t!=null&&(a.callback=t),t=Ca(e,a,n),t!==null&&(_n(t,e,n,r),uc(t,e,n))}};function Xm(e,t,r,n,a,s,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,l):t.prototype&&t.prototype.isPureReactComponent?!Fl(r,n)||!Fl(a,s):!0}function B1(e,t,r){var n=!1,a=Ia,s=t.contextType;return typeof s=="object"&&s!==null?s=cn(s):(a=Dr(t)?xs:hr.current,n=t.contextTypes,s=(n=n!=null)?di(e,a):Ia),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=w0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function Gm(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&w0.enqueueReplaceState(t,t.state,null)}function bf(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Dd(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=cn(s):(s=Dr(t)?xs:hr.current,a.context=di(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(wf(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&w0.enqueueReplaceState(a,a.state,null),Lc(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function pi(e,t){try{var r="",n=t;do r+=Qw(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function yu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Nf(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Eb=typeof WeakMap=="function"?WeakMap:Map;function U1(e,t,r){r=ea(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){$c||($c=!0,Df=n),Nf(e,t)},r}function z1(e,t,r){r=ea(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Nf(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Nf(e,t),typeof n!="function"&&(Fa===null?Fa=new Set([this]):Fa.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function Km(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Eb;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Bb.bind(null,e,t,r),t.then(e,e))}function qm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ym(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ea(-1,1),t.tag=2,Ca(r,t,1))),r.lanes|=1),e)}var Sb=ca.ReactCurrentOwner,Fr=!1;function vr(e,t,r,n){t.child=e===null?p1(t,null,r,n):mi(t,e.child,r,n)}function Jm(e,t,r,n,a){r=r.render;var s=t.ref;return ai(t,a),n=Ld(e,t,r,n,s,a),r=Md(),e!==null&&!Fr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,la(e,t,a)):(ft&&r&&Ed(t),t.flags|=1,vr(e,t,n,a),t.child)}function Qm(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!Kd(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,$1(e,t,s,n,a)):(e=pc(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var l=s.memoizedProps;if(r=r.compare,r=r!==null?r:Fl,r(l,n)&&e.ref===t.ref)return la(e,t,a)}return t.flags|=1,e=Da(s,n),e.ref=t.ref,e.return=t,t.child=e}function $1(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(Fl(s,n)&&e.ref===t.ref)if(Fr=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Fr=!0);else return t.lanes=e.lanes,la(e,t,a)}return _f(e,t,r,n,a)}function W1(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(Qs,Br),Br|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,at(Qs,Br),Br|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,at(Qs,Br),Br|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,at(Qs,Br),Br|=n;return vr(e,t,a,r),t.child}function V1(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function _f(e,t,r,n,a){var s=Dr(r)?xs:hr.current;return s=di(t,s),ai(t,a),r=Ld(e,t,r,n,s,a),n=Md(),e!==null&&!Fr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,la(e,t,a)):(ft&&n&&Ed(t),t.flags|=1,vr(e,t,r,a),t.child)}function Zm(e,t,r,n,a){if(Dr(r)){var s=!0;Dc(t)}else s=!1;if(ai(t,a),t.stateNode===null)hc(e,t),B1(t,r,n),bf(t,r,n,a),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var c=l.context,u=r.contextType;typeof u=="object"&&u!==null?u=cn(u):(u=Dr(r)?xs:hr.current,u=di(t,u));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof l.getSnapshotBeforeUpdate=="function";d||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||c!==u)&&Gm(t,l,n,u),ga=!1;var h=t.memoizedState;l.state=h,Lc(t,n,l,a),c=t.memoizedState,o!==n||h!==c||Ar.current||ga?(typeof f=="function"&&(wf(t,r,f,n),c=t.memoizedState),(o=ga||Xm(t,r,o,n,h,c,u))?(d||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),l.props=n,l.state=c,l.context=u,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,v1(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:gn(t.type,o),l.props=u,d=t.pendingProps,h=l.context,c=r.contextType,typeof c=="object"&&c!==null?c=cn(c):(c=Dr(r)?xs:hr.current,c=di(t,c));var y=r.getDerivedStateFromProps;(f=typeof y=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==d||h!==c)&&Gm(t,l,n,c),ga=!1,h=t.memoizedState,l.state=h,Lc(t,n,l,a);var g=t.memoizedState;o!==d||h!==g||Ar.current||ga?(typeof y=="function"&&(wf(t,r,y,n),g=t.memoizedState),(u=ga||Xm(t,r,u,n,h,g,c)||!1)?(f||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,g,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,g,c)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),l.props=n,l.state=g,l.context=c,n=u):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return kf(e,t,r,n,s,a)}function kf(e,t,r,n,a,s){V1(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return a&&Mm(t,r,!1),la(e,t,s);n=t.stateNode,Sb.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=mi(t,e.child,null,s),t.child=mi(t,null,o,s)):vr(e,t,o,s),t.memoizedState=n.state,a&&Mm(t,r,!0),t.child}function H1(e){var t=e.stateNode;t.pendingContext?Lm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Lm(e,t.context,!1),Rd(e,t.containerInfo)}function ex(e,t,r,n,a){return hi(),jd(a),t.flags|=256,vr(e,t,r,n),t.child}var Ef={dehydrated:null,treeContext:null,retryLane:0};function Sf(e){return{baseLanes:e,cachePool:null,transitions:null}}function X1(e,t,r){var n=t.pendingProps,a=mt.current,s=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),at(mt,a&1),e===null)return vf(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,s?(n=t.mode,s=t.child,l={mode:"hidden",children:l},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=_0(l,n,0,null),e=cs(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Sf(r),t.memoizedState=Ef,e):zd(t,l));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return jb(e,t,l,n,o,a,r);if(s){s=n.fallback,l=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:n.children};return!(l&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Da(a,c),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=Da(o,s):(s=cs(s,l,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,l=e.child.memoizedState,l=l===null?Sf(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~r,t.memoizedState=Ef,n}return s=e.child,e=s.sibling,n=Da(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function zd(e,t){return t=_0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function $o(e,t,r,n){return n!==null&&jd(n),mi(t,e.child,null,r),e=zd(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function jb(e,t,r,n,a,s,l){if(r)return t.flags&256?(t.flags&=-257,n=yu(Error(me(422))),$o(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=_0({mode:"visible",children:n.children},a,0,null),s=cs(s,a,l,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&mi(t,e.child,null,l),t.child.memoizedState=Sf(l),t.memoizedState=Ef,s);if(!(t.mode&1))return $o(e,t,l,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(me(419)),n=yu(s,n,void 0),$o(e,t,l,n)}if(o=(l&e.childLanes)!==0,Fr||o){if(n=Xt,n!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|l)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,ia(e,a),_n(n,e,a,-1))}return Gd(),n=yu(Error(me(421))),$o(e,t,l,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Ub.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,Vr=Ta(a.nextSibling),Hr=t,ft=!0,yn=null,e!==null&&(nn[an++]=Jn,nn[an++]=Qn,nn[an++]=ps,Jn=e.id,Qn=e.overflow,ps=t),t=zd(t,n.children),t.flags|=4096,t)}function tx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),yf(e.return,t,r)}function wu(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function G1(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(vr(e,t,n.children,r),n=mt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&tx(e,r,t);else if(e.tag===19)tx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(at(mt,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Mc(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),wu(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Mc(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}wu(t,!0,r,null,s);break;case"together":wu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function hc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function la(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),vs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(me(153));if(t.child!==null){for(e=t.child,r=Da(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Da(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Tb(e,t,r){switch(t.tag){case 3:H1(t),hi();break;case 5:y1(t);break;case 1:Dr(t.type)&&Dc(t);break;case 4:Rd(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;at(Ic,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(at(mt,mt.current&1),t.flags|=128,null):r&t.child.childLanes?X1(e,t,r):(at(mt,mt.current&1),e=la(e,t,r),e!==null?e.sibling:null);at(mt,mt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return G1(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),at(mt,mt.current),n)break;return null;case 22:case 23:return t.lanes=0,W1(e,t,r)}return la(e,t,r)}var K1,jf,q1,Y1;K1=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};jf=function(){};q1=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,ns(Un.current);var s=null;switch(r){case"input":a=Ku(e,a),n=Ku(e,n),s=[];break;case"select":a=yt({},a,{value:void 0}),n=yt({},n,{value:void 0}),s=[];break;case"textarea":a=Ju(e,a),n=Ju(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Fc)}Zu(r,n);var l;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(_l.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(o=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(l in o)!o.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in c)c.hasOwnProperty(l)&&o[l]!==c[l]&&(r||(r={}),r[l]=c[l])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(_l.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&it("scroll",e),s||o===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};Y1=function(e,t,r,n){r!==n&&(t.flags|=4)};function Gi(e,t){if(!ft)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function nr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Cb(e,t,r){var n=t.pendingProps;switch(Sd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nr(t),null;case 1:return Dr(t.type)&&Ac(),nr(t),null;case 3:return n=t.stateNode,xi(),ot(Ar),ot(hr),Id(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Uo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,yn!==null&&(If(yn),yn=null))),jf(e,t),nr(t),null;case 5:Pd(t);var a=ns(Il.current);if(r=t.type,e!==null&&t.stateNode!=null)q1(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(me(166));return nr(t),null}if(e=ns(Un.current),Uo(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Ln]=t,n[Rl]=s,e=(t.mode&1)!==0,r){case"dialog":it("cancel",n),it("close",n);break;case"iframe":case"object":case"embed":it("load",n);break;case"video":case"audio":for(a=0;a<tl.length;a++)it(tl[a],n);break;case"source":it("error",n);break;case"img":case"image":case"link":it("error",n),it("load",n);break;case"details":it("toggle",n);break;case"input":um(n,s),it("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},it("invalid",n);break;case"textarea":dm(n,s),it("invalid",n)}Zu(r,s),a=null;for(var l in s)if(s.hasOwnProperty(l)){var o=s[l];l==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Bo(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Bo(n.textContent,o,e),a=["children",""+o]):_l.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&it("scroll",n)}switch(r){case"input":Ao(n),fm(n,s,!0);break;case"textarea":Ao(n),hm(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Fc)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kg(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[Ln]=t,e[Rl]=n,K1(e,t,!1,!1),t.stateNode=e;e:{switch(l=ef(r,n),r){case"dialog":it("cancel",e),it("close",e),a=n;break;case"iframe":case"object":case"embed":it("load",e),a=n;break;case"video":case"audio":for(a=0;a<tl.length;a++)it(tl[a],e);a=n;break;case"source":it("error",e),a=n;break;case"img":case"image":case"link":it("error",e),it("load",e),a=n;break;case"details":it("toggle",e),a=n;break;case"input":um(e,n),a=Ku(e,n),it("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=yt({},n,{value:void 0}),it("invalid",e);break;case"textarea":dm(e,n),a=Ju(e,n),it("invalid",e);break;default:a=n}Zu(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var c=o[s];s==="style"?jg(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Eg(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&kl(e,c):typeof c=="number"&&kl(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(_l.hasOwnProperty(s)?c!=null&&s==="onScroll"&&it("scroll",e):c!=null&&fd(e,s,c,l))}switch(r){case"input":Ao(e),fm(e,n,!1);break;case"textarea":Ao(e),hm(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Pa(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?ei(e,!!n.multiple,s,!1):n.defaultValue!=null&&ei(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Fc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return nr(t),null;case 6:if(e&&t.stateNode!=null)Y1(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(me(166));if(r=ns(Il.current),ns(Un.current),Uo(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ln]=t,(s=n.nodeValue!==r)&&(e=Hr,e!==null))switch(e.tag){case 3:Bo(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Bo(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ln]=t,t.stateNode=n}return nr(t),null;case 13:if(ot(mt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ft&&Vr!==null&&t.mode&1&&!(t.flags&128))m1(),hi(),t.flags|=98560,s=!1;else if(s=Uo(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(me(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(me(317));s[Ln]=t}else hi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;nr(t),s=!1}else yn!==null&&(If(yn),yn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||mt.current&1?Bt===0&&(Bt=3):Gd())),t.updateQueue!==null&&(t.flags|=4),nr(t),null);case 4:return xi(),jf(e,t),e===null&&Al(t.stateNode.containerInfo),nr(t),null;case 10:return Fd(t.type._context),nr(t),null;case 17:return Dr(t.type)&&Ac(),nr(t),null;case 19:if(ot(mt),s=t.memoizedState,s===null)return nr(t),null;if(n=(t.flags&128)!==0,l=s.rendering,l===null)if(n)Gi(s,!1);else{if(Bt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Mc(e),l!==null){for(t.flags|=128,Gi(s,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return at(mt,mt.current&1|2),t.child}e=e.sibling}s.tail!==null&&Tt()>gi&&(t.flags|=128,n=!0,Gi(s,!1),t.lanes=4194304)}else{if(!n)if(e=Mc(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Gi(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!ft)return nr(t),null}else 2*Tt()-s.renderingStartTime>gi&&r!==1073741824&&(t.flags|=128,n=!0,Gi(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(r=s.last,r!==null?r.sibling=l:t.child=l,s.last=l)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Tt(),t.sibling=null,r=mt.current,at(mt,n?r&1|2:r&1),t):(nr(t),null);case 22:case 23:return Xd(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Br&1073741824&&(nr(t),t.subtreeFlags&6&&(t.flags|=8192)):nr(t),null;case 24:return null;case 25:return null}throw Error(me(156,t.tag))}function Fb(e,t){switch(Sd(t),t.tag){case 1:return Dr(t.type)&&Ac(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return xi(),ot(Ar),ot(hr),Id(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Pd(t),null;case 13:if(ot(mt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(me(340));hi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ot(mt),null;case 4:return xi(),null;case 10:return Fd(t.type._context),null;case 22:case 23:return Xd(),null;case 24:return null;default:return null}}var Wo=!1,lr=!1,Ab=typeof WeakSet=="function"?WeakSet:Set,ke=null;function Js(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){bt(e,t,n)}else r.current=null}function Tf(e,t,r){try{r()}catch(n){bt(e,t,n)}}var rx=!1;function Db(e,t){if(ff=jc,e=t1(),kd(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var l=0,o=-1,c=-1,u=0,f=0,d=e,h=null;t:for(;;){for(var y;d!==r||a!==0&&d.nodeType!==3||(o=l+a),d!==s||n!==0&&d.nodeType!==3||(c=l+n),d.nodeType===3&&(l+=d.nodeValue.length),(y=d.firstChild)!==null;)h=d,d=y;for(;;){if(d===e)break t;if(h===r&&++u===a&&(o=l),h===s&&++f===n&&(c=l),(y=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=y}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(df={focusedElem:e,selectionRange:r},jc=!1,ke=t;ke!==null;)if(t=ke,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ke=e;else for(;ke!==null;){t=ke;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,p=g.memoizedState,x=t.stateNode,v=x.getSnapshotBeforeUpdate(t.elementType===t.type?m:gn(t.type,m),p);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(me(163))}}catch(b){bt(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,ke=e;break}ke=t.return}return g=rx,rx=!1,g}function fl(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&Tf(t,r,s)}a=a.next}while(a!==n)}}function b0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Cf(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function J1(e){var t=e.alternate;t!==null&&(e.alternate=null,J1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ln],delete t[Rl],delete t[xf],delete t[mb],delete t[xb])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Q1(e){return e.tag===5||e.tag===3||e.tag===4}function nx(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Q1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ff(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Fc));else if(n!==4&&(e=e.child,e!==null))for(Ff(e,t,r),e=e.sibling;e!==null;)Ff(e,t,r),e=e.sibling}function Af(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Af(e,t,r),e=e.sibling;e!==null;)Af(e,t,r),e=e.sibling}var Yt=null,vn=!1;function ma(e,t,r){for(r=r.child;r!==null;)Z1(e,t,r),r=r.sibling}function Z1(e,t,r){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(h0,r)}catch{}switch(r.tag){case 5:lr||Js(r,t);case 6:var n=Yt,a=vn;Yt=null,ma(e,t,r),Yt=n,vn=a,Yt!==null&&(vn?(e=Yt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Yt.removeChild(r.stateNode));break;case 18:Yt!==null&&(vn?(e=Yt,r=r.stateNode,e.nodeType===8?hu(e.parentNode,r):e.nodeType===1&&hu(e,r),Tl(e)):hu(Yt,r.stateNode));break;case 4:n=Yt,a=vn,Yt=r.stateNode.containerInfo,vn=!0,ma(e,t,r),Yt=n,vn=a;break;case 0:case 11:case 14:case 15:if(!lr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&Tf(r,t,l),a=a.next}while(a!==n)}ma(e,t,r);break;case 1:if(!lr&&(Js(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){bt(r,t,o)}ma(e,t,r);break;case 21:ma(e,t,r);break;case 22:r.mode&1?(lr=(n=lr)||r.memoizedState!==null,ma(e,t,r),lr=n):ma(e,t,r);break;default:ma(e,t,r)}}function ax(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Ab),t.forEach(function(n){var a=zb.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function xn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:Yt=o.stateNode,vn=!1;break e;case 3:Yt=o.stateNode.containerInfo,vn=!0;break e;case 4:Yt=o.stateNode.containerInfo,vn=!0;break e}o=o.return}if(Yt===null)throw Error(me(160));Z1(s,l,a),Yt=null,vn=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){bt(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ev(t,e),t=t.sibling}function ev(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(xn(t,e),An(e),n&4){try{fl(3,e,e.return),b0(3,e)}catch(m){bt(e,e.return,m)}try{fl(5,e,e.return)}catch(m){bt(e,e.return,m)}}break;case 1:xn(t,e),An(e),n&512&&r!==null&&Js(r,r.return);break;case 5:if(xn(t,e),An(e),n&512&&r!==null&&Js(r,r.return),e.flags&32){var a=e.stateNode;try{kl(a,"")}catch(m){bt(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,l=r!==null?r.memoizedProps:s,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Ng(a,s),ef(o,l);var u=ef(o,s);for(l=0;l<c.length;l+=2){var f=c[l],d=c[l+1];f==="style"?jg(a,d):f==="dangerouslySetInnerHTML"?Eg(a,d):f==="children"?kl(a,d):fd(a,f,d,u)}switch(o){case"input":qu(a,s);break;case"textarea":_g(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var y=s.value;y!=null?ei(a,!!s.multiple,y,!1):h!==!!s.multiple&&(s.defaultValue!=null?ei(a,!!s.multiple,s.defaultValue,!0):ei(a,!!s.multiple,s.multiple?[]:"",!1))}a[Rl]=s}catch(m){bt(e,e.return,m)}}break;case 6:if(xn(t,e),An(e),n&4){if(e.stateNode===null)throw Error(me(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){bt(e,e.return,m)}}break;case 3:if(xn(t,e),An(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Tl(t.containerInfo)}catch(m){bt(e,e.return,m)}break;case 4:xn(t,e),An(e);break;case 13:xn(t,e),An(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(Vd=Tt())),n&4&&ax(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(lr=(u=lr)||f,xn(t,e),lr=u):xn(t,e),An(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(ke=e,f=e.child;f!==null;){for(d=ke=f;ke!==null;){switch(h=ke,y=h.child,h.tag){case 0:case 11:case 14:case 15:fl(4,h,h.return);break;case 1:Js(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){bt(n,r,m)}}break;case 5:Js(h,h.return);break;case 22:if(h.memoizedState!==null){ix(d);continue}}y!==null?(y.return=h,ke=y):ix(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{a=d.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,c=d.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=Sg("display",l))}catch(m){bt(e,e.return,m)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){bt(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:xn(t,e),An(e),n&4&&ax(e);break;case 21:break;default:xn(t,e),An(e)}}function An(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Q1(r)){var n=r;break e}r=r.return}throw Error(me(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(kl(a,""),n.flags&=-33);var s=nx(e);Af(e,s,a);break;case 3:case 4:var l=n.stateNode.containerInfo,o=nx(e);Ff(e,o,l);break;default:throw Error(me(161))}}catch(c){bt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Rb(e,t,r){ke=e,tv(e)}function tv(e,t,r){for(var n=(e.mode&1)!==0;ke!==null;){var a=ke,s=a.child;if(a.tag===22&&n){var l=a.memoizedState!==null||Wo;if(!l){var o=a.alternate,c=o!==null&&o.memoizedState!==null||lr;o=Wo;var u=lr;if(Wo=l,(lr=c)&&!u)for(ke=a;ke!==null;)l=ke,c=l.child,l.tag===22&&l.memoizedState!==null?lx(a):c!==null?(c.return=l,ke=c):lx(a);for(;s!==null;)ke=s,tv(s),s=s.sibling;ke=a,Wo=o,lr=u}sx(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,ke=s):sx(e)}}function sx(e){for(;ke!==null;){var t=ke;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:lr||b0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!lr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:gn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Wm(t,s,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Wm(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&Tl(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(me(163))}lr||t.flags&512&&Cf(t)}catch(h){bt(t,t.return,h)}}if(t===e){ke=null;break}if(r=t.sibling,r!==null){r.return=t.return,ke=r;break}ke=t.return}}function ix(e){for(;ke!==null;){var t=ke;if(t===e){ke=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ke=r;break}ke=t.return}}function lx(e){for(;ke!==null;){var t=ke;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{b0(4,t)}catch(c){bt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){bt(t,a,c)}}var s=t.return;try{Cf(t)}catch(c){bt(t,s,c)}break;case 5:var l=t.return;try{Cf(t)}catch(c){bt(t,l,c)}}}catch(c){bt(t,t.return,c)}if(t===e){ke=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ke=o;break}ke=t.return}}var Pb=Math.ceil,zc=ca.ReactCurrentDispatcher,$d=ca.ReactCurrentOwner,ln=ca.ReactCurrentBatchConfig,Xe=0,Xt=null,It=null,Zt=0,Br=0,Qs=Wa(0),Bt=0,Bl=null,vs=0,N0=0,Wd=0,dl=null,Cr=null,Vd=0,gi=1/0,qn=null,$c=!1,Df=null,Fa=null,Vo=!1,ba=null,Wc=0,hl=0,Rf=null,mc=-1,xc=0;function Nr(){return Xe&6?Tt():mc!==-1?mc:mc=Tt()}function Aa(e){return e.mode&1?Xe&2&&Zt!==0?Zt&-Zt:gb.transition!==null?(xc===0&&(xc=Bg()),xc):(e=et,e!==0||(e=window.event,e=e===void 0?16:Xg(e.type)),e):1}function _n(e,t,r,n){if(50<hl)throw hl=0,Rf=null,Error(me(185));so(e,r,n),(!(Xe&2)||e!==Xt)&&(e===Xt&&(!(Xe&2)&&(N0|=r),Bt===4&&ya(e,Zt)),Rr(e,n),r===1&&Xe===0&&!(t.mode&1)&&(gi=Tt()+500,v0&&Va()))}function Rr(e,t){var r=e.callbackNode;g4(e,t);var n=Sc(e,e===Xt?Zt:0);if(n===0)r!==null&&pm(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&pm(r),t===1)e.tag===0?pb(ox.bind(null,e)):f1(ox.bind(null,e)),db(function(){!(Xe&6)&&Va()}),r=null;else{switch(Ug(n)){case 1:r=pd;break;case 4:r=Lg;break;case 16:r=Ec;break;case 536870912:r=Mg;break;default:r=Ec}r=cv(r,rv.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function rv(e,t){if(mc=-1,xc=0,Xe&6)throw Error(me(327));var r=e.callbackNode;if(si()&&e.callbackNode!==r)return null;var n=Sc(e,e===Xt?Zt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Vc(e,n);else{t=n;var a=Xe;Xe|=2;var s=av();(Xt!==e||Zt!==t)&&(qn=null,gi=Tt()+500,os(e,t));do try{Lb();break}catch(o){nv(e,o)}while(!0);Cd(),zc.current=s,Xe=a,It!==null?t=0:(Xt=null,Zt=0,t=Bt)}if(t!==0){if(t===2&&(a=sf(e),a!==0&&(n=a,t=Pf(e,a))),t===1)throw r=Bl,os(e,0),ya(e,n),Rr(e,Tt()),r;if(t===6)ya(e,n);else{if(a=e.current.alternate,!(n&30)&&!Ib(a)&&(t=Vc(e,n),t===2&&(s=sf(e),s!==0&&(n=s,t=Pf(e,s))),t===1))throw r=Bl,os(e,0),ya(e,n),Rr(e,Tt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(me(345));case 2:Qa(e,Cr,qn);break;case 3:if(ya(e,n),(n&130023424)===n&&(t=Vd+500-Tt(),10<t)){if(Sc(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Nr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=mf(Qa.bind(null,e,Cr,qn),t);break}Qa(e,Cr,qn);break;case 4:if(ya(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var l=31-Nn(n);s=1<<l,l=t[l],l>a&&(a=l),n&=~s}if(n=a,n=Tt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Pb(n/1960))-n,10<n){e.timeoutHandle=mf(Qa.bind(null,e,Cr,qn),n);break}Qa(e,Cr,qn);break;case 5:Qa(e,Cr,qn);break;default:throw Error(me(329))}}}return Rr(e,Tt()),e.callbackNode===r?rv.bind(null,e):null}function Pf(e,t){var r=dl;return e.current.memoizedState.isDehydrated&&(os(e,t).flags|=256),e=Vc(e,t),e!==2&&(t=Cr,Cr=r,t!==null&&If(t)),e}function If(e){Cr===null?Cr=e:Cr.push.apply(Cr,e)}function Ib(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!Sn(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ya(e,t){for(t&=~Wd,t&=~N0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Nn(t),n=1<<r;e[r]=-1,t&=~n}}function ox(e){if(Xe&6)throw Error(me(327));si();var t=Sc(e,0);if(!(t&1))return Rr(e,Tt()),null;var r=Vc(e,t);if(e.tag!==0&&r===2){var n=sf(e);n!==0&&(t=n,r=Pf(e,n))}if(r===1)throw r=Bl,os(e,0),ya(e,t),Rr(e,Tt()),r;if(r===6)throw Error(me(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Qa(e,Cr,qn),Rr(e,Tt()),null}function Hd(e,t){var r=Xe;Xe|=1;try{return e(t)}finally{Xe=r,Xe===0&&(gi=Tt()+500,v0&&Va())}}function ys(e){ba!==null&&ba.tag===0&&!(Xe&6)&&si();var t=Xe;Xe|=1;var r=ln.transition,n=et;try{if(ln.transition=null,et=1,e)return e()}finally{et=n,ln.transition=r,Xe=t,!(Xe&6)&&Va()}}function Xd(){Br=Qs.current,ot(Qs)}function os(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,fb(r)),It!==null)for(r=It.return;r!==null;){var n=r;switch(Sd(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ac();break;case 3:xi(),ot(Ar),ot(hr),Id();break;case 5:Pd(n);break;case 4:xi();break;case 13:ot(mt);break;case 19:ot(mt);break;case 10:Fd(n.type._context);break;case 22:case 23:Xd()}r=r.return}if(Xt=e,It=e=Da(e.current,null),Zt=Br=t,Bt=0,Bl=null,Wd=N0=vs=0,Cr=dl=null,rs!==null){for(t=0;t<rs.length;t++)if(r=rs[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var l=s.next;s.next=a,n.next=l}r.pending=n}rs=null}return e}function nv(e,t){do{var r=It;try{if(Cd(),fc.current=Uc,Bc){for(var n=gt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Bc=!1}if(gs=0,$t=Ot=gt=null,ul=!1,Ol=0,$d.current=null,r===null||r.return===null){Bt=1,Bl=t,It=null;break}e:{var s=e,l=r.return,o=r,c=t;if(t=Zt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var y=qm(l);if(y!==null){y.flags&=-257,Ym(y,l,o,s,t),y.mode&1&&Km(s,u,t),t=y,c=u;var g=t.updateQueue;if(g===null){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}else{if(!(t&1)){Km(s,u,t),Gd();break e}c=Error(me(426))}}else if(ft&&o.mode&1){var p=qm(l);if(p!==null){!(p.flags&65536)&&(p.flags|=256),Ym(p,l,o,s,t),jd(pi(c,o));break e}}s=c=pi(c,o),Bt!==4&&(Bt=2),dl===null?dl=[s]:dl.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=U1(s,c,t);$m(s,x);break e;case 1:o=c;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Fa===null||!Fa.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var b=z1(s,o,t);$m(s,b);break e}}s=s.return}while(s!==null)}iv(r)}catch(_){t=_,It===r&&r!==null&&(It=r=r.return);continue}break}while(!0)}function av(){var e=zc.current;return zc.current=Uc,e===null?Uc:e}function Gd(){(Bt===0||Bt===3||Bt===2)&&(Bt=4),Xt===null||!(vs&268435455)&&!(N0&268435455)||ya(Xt,Zt)}function Vc(e,t){var r=Xe;Xe|=2;var n=av();(Xt!==e||Zt!==t)&&(qn=null,os(e,t));do try{Ob();break}catch(a){nv(e,a)}while(!0);if(Cd(),Xe=r,zc.current=n,It!==null)throw Error(me(261));return Xt=null,Zt=0,Bt}function Ob(){for(;It!==null;)sv(It)}function Lb(){for(;It!==null&&!o4();)sv(It)}function sv(e){var t=ov(e.alternate,e,Br);e.memoizedProps=e.pendingProps,t===null?iv(e):It=t,$d.current=null}function iv(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Fb(r,t),r!==null){r.flags&=32767,It=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Bt=6,It=null;return}}else if(r=Cb(r,t,Br),r!==null){It=r;return}if(t=t.sibling,t!==null){It=t;return}It=t=e}while(t!==null);Bt===0&&(Bt=5)}function Qa(e,t,r){var n=et,a=ln.transition;try{ln.transition=null,et=1,Mb(e,t,r,n)}finally{ln.transition=a,et=n}return null}function Mb(e,t,r,n){do si();while(ba!==null);if(Xe&6)throw Error(me(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(me(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(v4(e,s),e===Xt&&(It=Xt=null,Zt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Vo||(Vo=!0,cv(Ec,function(){return si(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=ln.transition,ln.transition=null;var l=et;et=1;var o=Xe;Xe|=4,$d.current=null,Db(e,r),ev(r,e),ab(df),jc=!!ff,df=ff=null,e.current=r,Rb(r),c4(),Xe=o,et=l,ln.transition=s}else e.current=r;if(Vo&&(Vo=!1,ba=e,Wc=a),s=e.pendingLanes,s===0&&(Fa=null),d4(r.stateNode),Rr(e,Tt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if($c)throw $c=!1,e=Df,Df=null,e;return Wc&1&&e.tag!==0&&si(),s=e.pendingLanes,s&1?e===Rf?hl++:(hl=0,Rf=e):hl=0,Va(),null}function si(){if(ba!==null){var e=Ug(Wc),t=ln.transition,r=et;try{if(ln.transition=null,et=16>e?16:e,ba===null)var n=!1;else{if(e=ba,ba=null,Wc=0,Xe&6)throw Error(me(331));var a=Xe;for(Xe|=4,ke=e.current;ke!==null;){var s=ke,l=s.child;if(ke.flags&16){var o=s.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(ke=u;ke!==null;){var f=ke;switch(f.tag){case 0:case 11:case 15:fl(8,f,s)}var d=f.child;if(d!==null)d.return=f,ke=d;else for(;ke!==null;){f=ke;var h=f.sibling,y=f.return;if(J1(f),f===u){ke=null;break}if(h!==null){h.return=y,ke=h;break}ke=y}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var p=m.sibling;m.sibling=null,m=p}while(m!==null)}}ke=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,ke=l;else e:for(;ke!==null;){if(s=ke,s.flags&2048)switch(s.tag){case 0:case 11:case 15:fl(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,ke=x;break e}ke=s.return}}var v=e.current;for(ke=v;ke!==null;){l=ke;var w=l.child;if(l.subtreeFlags&2064&&w!==null)w.return=l,ke=w;else e:for(l=v;ke!==null;){if(o=ke,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:b0(9,o)}}catch(_){bt(o,o.return,_)}if(o===l){ke=null;break e}var b=o.sibling;if(b!==null){b.return=o.return,ke=b;break e}ke=o.return}}if(Xe=a,Va(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(h0,e)}catch{}n=!0}return n}finally{et=r,ln.transition=t}}return!1}function cx(e,t,r){t=pi(r,t),t=U1(e,t,1),e=Ca(e,t,1),t=Nr(),e!==null&&(so(e,1,t),Rr(e,t))}function bt(e,t,r){if(e.tag===3)cx(e,e,r);else for(;t!==null;){if(t.tag===3){cx(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Fa===null||!Fa.has(n))){e=pi(r,e),e=z1(t,e,1),t=Ca(t,e,1),e=Nr(),t!==null&&(so(t,1,e),Rr(t,e));break}}t=t.return}}function Bb(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Nr(),e.pingedLanes|=e.suspendedLanes&r,Xt===e&&(Zt&r)===r&&(Bt===4||Bt===3&&(Zt&130023424)===Zt&&500>Tt()-Vd?os(e,0):Wd|=r),Rr(e,t)}function lv(e,t){t===0&&(e.mode&1?(t=Po,Po<<=1,!(Po&130023424)&&(Po=4194304)):t=1);var r=Nr();e=ia(e,t),e!==null&&(so(e,t,r),Rr(e,r))}function Ub(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),lv(e,r)}function zb(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(me(314))}n!==null&&n.delete(t),lv(e,r)}var ov;ov=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ar.current)Fr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Fr=!1,Tb(e,t,r);Fr=!!(e.flags&131072)}else Fr=!1,ft&&t.flags&1048576&&d1(t,Pc,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;hc(e,t),e=t.pendingProps;var a=di(t,hr.current);ai(t,r),a=Ld(null,t,n,e,a,r);var s=Md();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dr(n)?(s=!0,Dc(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Dd(t),a.updater=w0,t.stateNode=a,a._reactInternals=t,bf(t,n,e,r),t=kf(null,t,n,!0,s,r)):(t.tag=0,ft&&s&&Ed(t),vr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(hc(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=Wb(n),e=gn(n,e),a){case 0:t=_f(null,t,n,e,r);break e;case 1:t=Zm(null,t,n,e,r);break e;case 11:t=Jm(null,t,n,e,r);break e;case 14:t=Qm(null,t,n,gn(n.type,e),r);break e}throw Error(me(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:gn(n,a),_f(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:gn(n,a),Zm(e,t,n,a,r);case 3:e:{if(H1(t),e===null)throw Error(me(387));n=t.pendingProps,s=t.memoizedState,a=s.element,v1(e,t),Lc(t,n,null,r);var l=t.memoizedState;if(n=l.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=pi(Error(me(423)),t),t=ex(e,t,n,r,a);break e}else if(n!==a){a=pi(Error(me(424)),t),t=ex(e,t,n,r,a);break e}else for(Vr=Ta(t.stateNode.containerInfo.firstChild),Hr=t,ft=!0,yn=null,r=p1(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(hi(),n===a){t=la(e,t,r);break e}vr(e,t,n,r)}t=t.child}return t;case 5:return y1(t),e===null&&vf(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,l=a.children,hf(n,a)?l=null:s!==null&&hf(n,s)&&(t.flags|=32),V1(e,t),vr(e,t,l,r),t.child;case 6:return e===null&&vf(t),null;case 13:return X1(e,t,r);case 4:return Rd(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=mi(t,null,n,r):vr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:gn(n,a),Jm(e,t,n,a,r);case 7:return vr(e,t,t.pendingProps,r),t.child;case 8:return vr(e,t,t.pendingProps.children,r),t.child;case 12:return vr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,l=a.value,at(Ic,n._currentValue),n._currentValue=l,s!==null)if(Sn(s.value,l)){if(s.children===a.children&&!Ar.current){t=la(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){l=s.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=ea(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),yf(s.return,r,t),o.lanes|=r;break}c=c.next}}else if(s.tag===10)l=s.type===t.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(me(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),yf(l,r,t),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===t){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}vr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,ai(t,r),a=cn(a),n=n(a),t.flags|=1,vr(e,t,n,r),t.child;case 14:return n=t.type,a=gn(n,t.pendingProps),a=gn(n.type,a),Qm(e,t,n,a,r);case 15:return $1(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:gn(n,a),hc(e,t),t.tag=1,Dr(n)?(e=!0,Dc(t)):e=!1,ai(t,r),B1(t,n,a),bf(t,n,a,r),kf(null,t,n,!0,e,r);case 19:return G1(e,t,r);case 22:return W1(e,t,r)}throw Error(me(156,t.tag))};function cv(e,t){return Og(e,t)}function $b(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sn(e,t,r,n){return new $b(e,t,r,n)}function Kd(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Wb(e){if(typeof e=="function")return Kd(e)?1:0;if(e!=null){if(e=e.$$typeof,e===hd)return 11;if(e===md)return 14}return 2}function Da(e,t){var r=e.alternate;return r===null?(r=sn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function pc(e,t,r,n,a,s){var l=2;if(n=e,typeof e=="function")Kd(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case $s:return cs(r.children,a,s,t);case dd:l=8,a|=8;break;case Vu:return e=sn(12,r,t,a|2),e.elementType=Vu,e.lanes=s,e;case Hu:return e=sn(13,r,t,a),e.elementType=Hu,e.lanes=s,e;case Xu:return e=sn(19,r,t,a),e.elementType=Xu,e.lanes=s,e;case yg:return _0(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case gg:l=10;break e;case vg:l=9;break e;case hd:l=11;break e;case md:l=14;break e;case pa:l=16,n=null;break e}throw Error(me(130,e==null?e:typeof e,""))}return t=sn(l,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function cs(e,t,r,n){return e=sn(7,e,n,t),e.lanes=r,e}function _0(e,t,r,n){return e=sn(22,e,n,t),e.elementType=yg,e.lanes=r,e.stateNode={isHidden:!1},e}function bu(e,t,r){return e=sn(6,e,null,t),e.lanes=r,e}function Nu(e,t,r){return t=sn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vb(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ru(0),this.expirationTimes=ru(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ru(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function qd(e,t,r,n,a,s,l,o,c){return e=new Vb(e,t,r,o,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=sn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dd(s),e}function Hb(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function uv(e){if(!e)return Ia;e=e._reactInternals;e:{if(Cs(e)!==e||e.tag!==1)throw Error(me(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(me(171))}if(e.tag===1){var r=e.type;if(Dr(r))return u1(e,r,t)}return t}function fv(e,t,r,n,a,s,l,o,c){return e=qd(r,n,!0,e,a,s,l,o,c),e.context=uv(null),r=e.current,n=Nr(),a=Aa(r),s=ea(n,a),s.callback=t??null,Ca(r,s,a),e.current.lanes=a,so(e,a,n),Rr(e,n),e}function k0(e,t,r,n){var a=t.current,s=Nr(),l=Aa(a);return r=uv(r),t.context===null?t.context=r:t.pendingContext=r,t=ea(s,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ca(a,t,l),e!==null&&(_n(e,a,l,s),uc(e,a,l)),l}function Hc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ux(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Yd(e,t){ux(e,t),(e=e.alternate)&&ux(e,t)}function Xb(){return null}var dv=typeof reportError=="function"?reportError:function(e){console.error(e)};function Jd(e){this._internalRoot=e}E0.prototype.render=Jd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(me(409));k0(e,t,null,null)};E0.prototype.unmount=Jd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ys(function(){k0(null,e,null,null)}),t[sa]=null}};function E0(e){this._internalRoot=e}E0.prototype.unstable_scheduleHydration=function(e){if(e){var t=Wg();e={blockedOn:null,target:e,priority:t};for(var r=0;r<va.length&&t!==0&&t<va[r].priority;r++);va.splice(r,0,e),r===0&&Hg(e)}};function Qd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function S0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function fx(){}function Gb(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=Hc(l);s.call(u)}}var l=fv(t,n,e,0,null,!1,!1,"",fx);return e._reactRootContainer=l,e[sa]=l.current,Al(e.nodeType===8?e.parentNode:e),ys(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var u=Hc(c);o.call(u)}}var c=qd(e,0,!1,null,null,!1,!1,"",fx);return e._reactRootContainer=c,e[sa]=c.current,Al(e.nodeType===8?e.parentNode:e),ys(function(){k0(t,c,r,n)}),c}function j0(e,t,r,n,a){var s=r._reactRootContainer;if(s){var l=s;if(typeof a=="function"){var o=a;a=function(){var c=Hc(l);o.call(c)}}k0(t,l,e,a)}else l=Gb(r,t,e,a,n);return Hc(l)}zg=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=el(t.pendingLanes);r!==0&&(gd(t,r|1),Rr(t,Tt()),!(Xe&6)&&(gi=Tt()+500,Va()))}break;case 13:ys(function(){var n=ia(e,1);if(n!==null){var a=Nr();_n(n,e,1,a)}}),Yd(e,1)}};vd=function(e){if(e.tag===13){var t=ia(e,134217728);if(t!==null){var r=Nr();_n(t,e,134217728,r)}Yd(e,134217728)}};$g=function(e){if(e.tag===13){var t=Aa(e),r=ia(e,t);if(r!==null){var n=Nr();_n(r,e,t,n)}Yd(e,t)}};Wg=function(){return et};Vg=function(e,t){var r=et;try{return et=e,t()}finally{et=r}};rf=function(e,t,r){switch(t){case"input":if(qu(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=g0(n);if(!a)throw Error(me(90));bg(n),qu(n,a)}}}break;case"textarea":_g(e,r);break;case"select":t=r.value,t!=null&&ei(e,!!r.multiple,t,!1)}};Fg=Hd;Ag=ys;var Kb={usingClientEntryPoint:!1,Events:[lo,Xs,g0,Tg,Cg,Hd]},Ki={findFiberByHostInstance:ts,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},qb={bundleType:Ki.bundleType,version:Ki.version,rendererPackageName:Ki.rendererPackageName,rendererConfig:Ki.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ca.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Pg(e),e===null?null:e.stateNode},findFiberByHostInstance:Ki.findFiberByHostInstance||Xb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ho=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ho.isDisabled&&Ho.supportsFiber)try{h0=Ho.inject(qb),Bn=Ho}catch{}}qr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kb;qr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qd(t))throw Error(me(200));return Hb(e,t,null,r)};qr.createRoot=function(e,t){if(!Qd(e))throw Error(me(299));var r=!1,n="",a=dv;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=qd(e,1,!1,null,null,r,!1,n,a),e[sa]=t.current,Al(e.nodeType===8?e.parentNode:e),new Jd(t)};qr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(me(188)):(e=Object.keys(e).join(","),Error(me(268,e)));return e=Pg(t),e=e===null?null:e.stateNode,e};qr.flushSync=function(e){return ys(e)};qr.hydrate=function(e,t,r){if(!S0(t))throw Error(me(200));return j0(null,e,t,!0,r)};qr.hydrateRoot=function(e,t,r){if(!Qd(e))throw Error(me(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",l=dv;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=fv(t,null,e,1,r??null,a,!1,s,l),e[sa]=t.current,Al(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new E0(t)};qr.render=function(e,t,r){if(!S0(t))throw Error(me(200));return j0(null,e,t,!1,r)};qr.unmountComponentAtNode=function(e){if(!S0(e))throw Error(me(40));return e._reactRootContainer?(ys(function(){j0(null,null,e,!1,function(){e._reactRootContainer=null,e[sa]=null})}),!0):!1};qr.unstable_batchedUpdates=Hd;qr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!S0(r))throw Error(me(200));if(e==null||e._reactInternals===void 0)throw Error(me(38));return j0(e,t,r,!1,n)};qr.version="18.3.1-next-f1338f8080-20240426";function hv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hv)}catch(e){console.error(e)}}hv(),hg.exports=qr;var Yb=hg.exports,dx=Yb;$u.createRoot=dx.createRoot,$u.hydrateRoot=dx.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ul(){return Ul=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ul.apply(this,arguments)}var Na;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Na||(Na={}));const hx="popstate";function Jb(e){e===void 0&&(e={});function t(n,a){let{pathname:s,search:l,hash:o}=n.location;return Of("",{pathname:s,search:l,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Xc(a)}return Zb(t,r,null,e)}function vt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Zd(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Qb(){return Math.random().toString(36).substr(2,8)}function mx(e,t){return{usr:e.state,key:e.key,idx:t}}function Of(e,t,r,n){return r===void 0&&(r=null),Ul({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Ci(t):t,{state:r,key:t&&t.key||n||Qb()})}function Xc(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ci(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Zb(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:s=!1}=n,l=a.history,o=Na.Pop,c=null,u=f();u==null&&(u=0,l.replaceState(Ul({},l.state,{idx:u}),""));function f(){return(l.state||{idx:null}).idx}function d(){o=Na.Pop;let p=f(),x=p==null?null:p-u;u=p,c&&c({action:o,location:m.location,delta:x})}function h(p,x){o=Na.Push;let v=Of(m.location,p,x);u=f()+1;let w=mx(v,u),b=m.createHref(v);try{l.pushState(w,"",b)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;a.location.assign(b)}s&&c&&c({action:o,location:m.location,delta:1})}function y(p,x){o=Na.Replace;let v=Of(m.location,p,x);u=f();let w=mx(v,u),b=m.createHref(v);l.replaceState(w,"",b),s&&c&&c({action:o,location:m.location,delta:0})}function g(p){let x=a.location.origin!=="null"?a.location.origin:a.location.href,v=typeof p=="string"?p:Xc(p);return v=v.replace(/ $/,"%20"),vt(x,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,x)}let m={get action(){return o},get location(){return e(a,l)},listen(p){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(hx,d),c=p,()=>{a.removeEventListener(hx,d),c=null}},createHref(p){return t(a,p)},createURL:g,encodeLocation(p){let x=g(p);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:y,go(p){return l.go(p)}};return m}var xx;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(xx||(xx={}));function eN(e,t,r){return r===void 0&&(r="/"),tN(e,t,r)}function tN(e,t,r,n){let a=typeof t=="string"?Ci(t):t,s=vi(a.pathname||"/",r);if(s==null)return null;let l=mv(e);rN(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let u=hN(s);o=fN(l[c],u)}return o}function mv(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(s,l,o)=>{let c={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:l,route:s};c.relativePath.startsWith("/")&&(vt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Ra([n,c.relativePath]),f=r.concat(c);s.children&&s.children.length>0&&(vt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),mv(s.children,t,f,u)),!(s.path==null&&!s.index)&&t.push({path:u,score:cN(u,s.index),routesMeta:f})};return e.forEach((s,l)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))a(s,l);else for(let c of xv(s.path))a(s,l,c)}),t}function xv(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let l=xv(n.join("/")),o=[];return o.push(...l.map(c=>c===""?s:[s,c].join("/"))),a&&o.push(...l),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function rN(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:uN(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const nN=/^:[\w-]+$/,aN=3,sN=2,iN=1,lN=10,oN=-2,px=e=>e==="*";function cN(e,t){let r=e.split("/"),n=r.length;return r.some(px)&&(n+=oN),t&&(n+=sN),r.filter(a=>!px(a)).reduce((a,s)=>a+(nN.test(s)?aN:s===""?iN:lN),n)}function uN(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function fN(e,t,r){let{routesMeta:n}=e,a={},s="/",l=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,f=s==="/"?t:t.slice(s.length)||"/",d=Lf({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},f),h=c.route;if(!d)return null;Object.assign(a,d.params),l.push({params:a,pathname:Ra([s,d.pathname]),pathnameBase:vN(Ra([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=Ra([s,d.pathnameBase]))}return l}function Lf(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=dN(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],l=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((u,f,d)=>{let{paramName:h,isOptional:y}=f;if(h==="*"){let m=o[d]||"";l=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const g=o[d];return y&&!g?u[h]=void 0:u[h]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:l,pattern:e}}function dN(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Zd(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function hN(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Zd(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function vi(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const mN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xN=e=>mN.test(e);function pN(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Ci(e):e,s;if(r)if(xN(r))s=r;else{if(r.includes("//")){let l=r;r=r.replace(/\/\/+/g,"/"),Zd(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+r))}r.startsWith("/")?s=gx(r.substring(1),"/"):s=gx(r,t)}else s=t;return{pathname:s,search:yN(n),hash:wN(a)}}function gx(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function _u(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function gN(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function eh(e,t){let r=gN(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function th(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Ci(e):(a=Ul({},e),vt(!a.pathname||!a.pathname.includes("?"),_u("?","pathname","search",a)),vt(!a.pathname||!a.pathname.includes("#"),_u("#","pathname","hash",a)),vt(!a.search||!a.search.includes("#"),_u("#","search","hash",a)));let s=e===""||a.pathname==="",l=s?"/":a.pathname,o;if(l==null)o=r;else{let d=t.length-1;if(!n&&l.startsWith("..")){let h=l.split("/");for(;h[0]==="..";)h.shift(),d-=1;a.pathname=h.join("/")}o=d>=0?t[d]:"/"}let c=pN(a,o),u=l&&l!=="/"&&l.endsWith("/"),f=(s||l===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||f)&&(c.pathname+="/"),c}const Ra=e=>e.join("/").replace(/\/\/+/g,"/"),vN=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),yN=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,wN=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function bN(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const pv=["post","put","patch","delete"];new Set(pv);const NN=["get",...pv];new Set(NN);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zl(){return zl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zl.apply(this,arguments)}const T0=T.createContext(null),gv=T.createContext(null),ua=T.createContext(null),C0=T.createContext(null),$n=T.createContext({outlet:null,matches:[],isDataRoute:!1}),vv=T.createContext(null);function _N(e,t){let{relative:r}=t===void 0?{}:t;Fi()||vt(!1);let{basename:n,navigator:a}=T.useContext(ua),{hash:s,pathname:l,search:o}=F0(e,{relative:r}),c=l;return n!=="/"&&(c=l==="/"?n:Ra([n,l])),a.createHref({pathname:c,search:o,hash:s})}function Fi(){return T.useContext(C0)!=null}function Ha(){return Fi()||vt(!1),T.useContext(C0).location}function yv(e){T.useContext(ua).static||T.useLayoutEffect(e)}function Kt(){let{isDataRoute:e}=T.useContext($n);return e?MN():kN()}function kN(){Fi()||vt(!1);let e=T.useContext(T0),{basename:t,future:r,navigator:n}=T.useContext(ua),{matches:a}=T.useContext($n),{pathname:s}=Ha(),l=JSON.stringify(eh(a,r.v7_relativeSplatPath)),o=T.useRef(!1);return yv(()=>{o.current=!0}),T.useCallback(function(u,f){if(f===void 0&&(f={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let d=th(u,JSON.parse(l),s,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Ra([t,d.pathname])),(f.replace?n.replace:n.push)(d,f.state,f)},[t,n,l,s,e])}const EN=T.createContext(null);function SN(e){let t=T.useContext($n).outlet;return t&&T.createElement(EN.Provider,{value:e},t)}function Wn(){let{matches:e}=T.useContext($n),t=e[e.length-1];return t?t.params:{}}function F0(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=T.useContext(ua),{matches:a}=T.useContext($n),{pathname:s}=Ha(),l=JSON.stringify(eh(a,n.v7_relativeSplatPath));return T.useMemo(()=>th(e,JSON.parse(l),s,r==="path"),[e,l,s,r])}function jN(e,t){return TN(e,t)}function TN(e,t,r,n){Fi()||vt(!1);let{navigator:a}=T.useContext(ua),{matches:s}=T.useContext($n),l=s[s.length-1],o=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let u=Ha(),f;if(t){var d;let p=typeof t=="string"?Ci(t):t;c==="/"||(d=p.pathname)!=null&&d.startsWith(c)||vt(!1),f=p}else f=u;let h=f.pathname||"/",y=h;if(c!=="/"){let p=c.replace(/^\//,"").split("/");y="/"+h.replace(/^\//,"").split("/").slice(p.length).join("/")}let g=eN(e,{pathname:y}),m=RN(g&&g.map(p=>Object.assign({},p,{params:Object.assign({},o,p.params),pathname:Ra([c,a.encodeLocation?a.encodeLocation(p.pathname).pathname:p.pathname]),pathnameBase:p.pathnameBase==="/"?c:Ra([c,a.encodeLocation?a.encodeLocation(p.pathnameBase).pathname:p.pathnameBase])})),s,r,n);return t&&m?T.createElement(C0.Provider,{value:{location:zl({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Na.Pop}},m):m}function CN(){let e=LN(),t=bN(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},t),r?T.createElement("pre",{style:a},r):null,null)}const FN=T.createElement(CN,null);class AN extends T.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?T.createElement($n.Provider,{value:this.props.routeContext},T.createElement(vv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function DN(e){let{routeContext:t,match:r,children:n}=e,a=T.useContext(T0);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),T.createElement($n.Provider,{value:t},n)}function RN(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let f=l.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);f>=0||vt(!1),l=l.slice(0,Math.min(l.length,f+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<l.length;f++){let d=l[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=f),d.route.id){let{loaderData:h,errors:y}=r,g=d.route.loader&&h[d.route.id]===void 0&&(!y||y[d.route.id]===void 0);if(d.route.lazy||g){c=!0,u>=0?l=l.slice(0,u+1):l=[l[0]];break}}}return l.reduceRight((f,d,h)=>{let y,g=!1,m=null,p=null;r&&(y=o&&d.route.id?o[d.route.id]:void 0,m=d.route.errorElement||FN,c&&(u<0&&h===0?(BN("route-fallback"),g=!0,p=null):u===h&&(g=!0,p=d.route.hydrateFallbackElement||null)));let x=t.concat(l.slice(0,h+1)),v=()=>{let w;return y?w=m:g?w=p:d.route.Component?w=T.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=f,T.createElement(DN,{match:d,routeContext:{outlet:f,matches:x,isDataRoute:r!=null},children:w})};return r&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?T.createElement(AN,{location:r.location,revalidation:r.revalidation,component:m,error:y,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}var wv=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(wv||{}),bv=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(bv||{});function PN(e){let t=T.useContext(T0);return t||vt(!1),t}function IN(e){let t=T.useContext(gv);return t||vt(!1),t}function ON(e){let t=T.useContext($n);return t||vt(!1),t}function Nv(e){let t=ON(),r=t.matches[t.matches.length-1];return r.route.id||vt(!1),r.route.id}function LN(){var e;let t=T.useContext(vv),r=IN(),n=Nv();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function MN(){let{router:e}=PN(wv.UseNavigateStable),t=Nv(bv.UseNavigateStable),r=T.useRef(!1);return yv(()=>{r.current=!0}),T.useCallback(function(a,s){s===void 0&&(s={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,zl({fromRouteId:t},s)))},[e,t])}const vx={};function BN(e,t,r){vx[e]||(vx[e]=!0)}function UN(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Mf(e){let{to:t,replace:r,state:n,relative:a}=e;Fi()||vt(!1);let{future:s,static:l}=T.useContext(ua),{matches:o}=T.useContext($n),{pathname:c}=Ha(),u=Kt(),f=th(t,eh(o,s.v7_relativeSplatPath),c,a==="path"),d=JSON.stringify(f);return T.useEffect(()=>u(JSON.parse(d),{replace:r,state:n,relative:a}),[u,d,a,r,n]),null}function zN(e){return SN(e.context)}function rt(e){vt(!1)}function $N(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Na.Pop,navigator:s,static:l=!1,future:o}=e;Fi()&&vt(!1);let c=t.replace(/^\/*/,"/"),u=T.useMemo(()=>({basename:c,navigator:s,static:l,future:zl({v7_relativeSplatPath:!1},o)}),[c,o,s,l]);typeof n=="string"&&(n=Ci(n));let{pathname:f="/",search:d="",hash:h="",state:y=null,key:g="default"}=n,m=T.useMemo(()=>{let p=vi(f,c);return p==null?null:{location:{pathname:p,search:d,hash:h,state:y,key:g},navigationType:a}},[c,f,d,h,y,g,a]);return m==null?null:T.createElement(ua.Provider,{value:u},T.createElement(C0.Provider,{children:r,value:m}))}function WN(e){let{children:t,location:r}=e;return jN(Bf(t),r)}new Promise(()=>{});function Bf(e,t){t===void 0&&(t=[]);let r=[];return T.Children.forEach(e,(n,a)=>{if(!T.isValidElement(n))return;let s=[...t,a];if(n.type===T.Fragment){r.push.apply(r,Bf(n.props.children,s));return}n.type!==rt&&vt(!1),!n.props.index||!n.props.children||vt(!1);let l={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=Bf(n.props.children,s)),r.push(l)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gc(){return Gc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gc.apply(this,arguments)}function _v(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,s;for(s=0;s<n.length;s++)a=n[s],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function VN(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function HN(e,t){return e.button===0&&(!t||t==="_self")&&!VN(e)}const XN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],GN=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],KN="6";try{window.__reactRouterVersion=KN}catch{}const qN=T.createContext({isTransitioning:!1}),YN="startTransition",yx=Bw[YN];function JN(e){let{basename:t,children:r,future:n,window:a}=e,s=T.useRef();s.current==null&&(s.current=Jb({window:a,v5Compat:!0}));let l=s.current,[o,c]=T.useState({action:l.action,location:l.location}),{v7_startTransition:u}=n||{},f=T.useCallback(d=>{u&&yx?yx(()=>c(d)):c(d)},[c,u]);return T.useLayoutEffect(()=>l.listen(f),[l,f]),T.useEffect(()=>UN(n),[n]),T.createElement($N,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:l,future:n})}const QN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ZN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,rh=T.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:s,replace:l,state:o,target:c,to:u,preventScrollReset:f,viewTransition:d}=t,h=_v(t,XN),{basename:y}=T.useContext(ua),g,m=!1;if(typeof u=="string"&&ZN.test(u)&&(g=u,QN))try{let w=new URL(window.location.href),b=u.startsWith("//")?new URL(w.protocol+u):new URL(u),_=vi(b.pathname,y);b.origin===w.origin&&_!=null?u=_+b.search+b.hash:m=!0}catch{}let p=_N(u,{relative:a}),x=r_(u,{replace:l,state:o,target:c,preventScrollReset:f,relative:a,viewTransition:d});function v(w){n&&n(w),w.defaultPrevented||x(w)}return T.createElement("a",Gc({},h,{href:g||p,onClick:m||s?n:v,ref:r,target:c}))}),e_=T.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:a=!1,className:s="",end:l=!1,style:o,to:c,viewTransition:u,children:f}=t,d=_v(t,GN),h=F0(c,{relative:d.relative}),y=Ha(),g=T.useContext(gv),{navigator:m,basename:p}=T.useContext(ua),x=g!=null&&n_(h)&&u===!0,v=m.encodeLocation?m.encodeLocation(h).pathname:h.pathname,w=y.pathname,b=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;a||(w=w.toLowerCase(),b=b?b.toLowerCase():null,v=v.toLowerCase()),b&&p&&(b=vi(b,p)||b);const _=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let E=w===v||!l&&w.startsWith(v)&&w.charAt(_)==="/",N=b!=null&&(b===v||!l&&b.startsWith(v)&&b.charAt(v.length)==="/"),R={isActive:E,isPending:N,isTransitioning:x},j=E?n:void 0,L;typeof s=="function"?L=s(R):L=[s,E?"active":null,N?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let V=typeof o=="function"?o(R):o;return T.createElement(rh,Gc({},d,{"aria-current":j,className:L,ref:r,style:V,to:c,viewTransition:u}),typeof f=="function"?f(R):f)});var Uf;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Uf||(Uf={}));var wx;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(wx||(wx={}));function t_(e){let t=T.useContext(T0);return t||vt(!1),t}function r_(e,t){let{target:r,replace:n,state:a,preventScrollReset:s,relative:l,viewTransition:o}=t===void 0?{}:t,c=Kt(),u=Ha(),f=F0(e,{relative:l});return T.useCallback(d=>{if(HN(d,r)){d.preventDefault();let h=n!==void 0?n:Xc(u)===Xc(f);c(e,{replace:h,state:a,preventScrollReset:s,relative:l,viewTransition:o})}},[u,c,f,n,a,r,e,s,l,o])}function n_(e,t){t===void 0&&(t={});let r=T.useContext(qN);r==null&&vt(!1);let{basename:n}=t_(Uf.useViewTransitionState),a=F0(e,{relative:t.relative});if(!r.isTransitioning)return!1;let s=vi(r.currentLocation.pathname,n)||r.currentLocation.pathname,l=vi(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Lf(a.pathname,l)!=null||Lf(a.pathname,s)!=null}function kv(e,t){return function(){return e.apply(t,arguments)}}const{toString:a_}=Object.prototype,{getPrototypeOf:nh}=Object,{iterator:A0,toStringTag:Ev}=Symbol,D0=(e=>t=>{const r=a_.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Tn=e=>(e=e.toLowerCase(),t=>D0(t)===e),R0=e=>t=>typeof t===e,{isArray:Ai}=Array,yi=R0("undefined");function co(e){return e!==null&&!yi(e)&&e.constructor!==null&&!yi(e.constructor)&&Pr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Sv=Tn("ArrayBuffer");function s_(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Sv(e.buffer),t}const i_=R0("string"),Pr=R0("function"),jv=R0("number"),uo=e=>e!==null&&typeof e=="object",l_=e=>e===!0||e===!1,gc=e=>{if(D0(e)!=="object")return!1;const t=nh(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Ev in e)&&!(A0 in e)},o_=e=>{if(!uo(e)||co(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},c_=Tn("Date"),u_=Tn("File"),f_=Tn("Blob"),d_=Tn("FileList"),h_=e=>uo(e)&&Pr(e.pipe),m_=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Pr(e.append)&&((t=D0(e))==="formdata"||t==="object"&&Pr(e.toString)&&e.toString()==="[object FormData]"))},x_=Tn("URLSearchParams"),[p_,g_,v_,y_]=["ReadableStream","Request","Response","Headers"].map(Tn),w_=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function fo(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),Ai(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(co(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),l=s.length;let o;for(n=0;n<l;n++)o=s[n],t.call(null,e[o],o,e)}}function Tv(e,t){if(co(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const as=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Cv=e=>!yi(e)&&e!==as;function zf(){const{caseless:e,skipUndefined:t}=Cv(this)&&this||{},r={},n=(a,s)=>{const l=e&&Tv(r,s)||s;gc(r[l])&&gc(a)?r[l]=zf(r[l],a):gc(a)?r[l]=zf({},a):Ai(a)?r[l]=a.slice():(!t||!yi(a))&&(r[l]=a)};for(let a=0,s=arguments.length;a<s;a++)arguments[a]&&fo(arguments[a],n);return r}const b_=(e,t,r,{allOwnKeys:n}={})=>(fo(t,(a,s)=>{r&&Pr(a)?e[s]=kv(a,r):e[s]=a},{allOwnKeys:n}),e),N_=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),__=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},k_=(e,t,r,n)=>{let a,s,l;const o={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)l=a[s],(!n||n(l,e,t))&&!o[l]&&(t[l]=e[l],o[l]=!0);e=r!==!1&&nh(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},E_=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},S_=e=>{if(!e)return null;if(Ai(e))return e;let t=e.length;if(!jv(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},j_=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&nh(Uint8Array)),T_=(e,t)=>{const n=(e&&e[A0]).call(e);let a;for(;(a=n.next())&&!a.done;){const s=a.value;t.call(e,s[0],s[1])}},C_=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},F_=Tn("HTMLFormElement"),A_=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),bx=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),D_=Tn("RegExp"),Fv=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};fo(r,(a,s)=>{let l;(l=t(a,s,e))!==!1&&(n[s]=l||a)}),Object.defineProperties(e,n)},R_=e=>{Fv(e,(t,r)=>{if(Pr(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Pr(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},P_=(e,t)=>{const r={},n=a=>{a.forEach(s=>{r[s]=!0})};return Ai(e)?n(e):n(String(e).split(t)),r},I_=()=>{},O_=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function L_(e){return!!(e&&Pr(e.append)&&e[Ev]==="FormData"&&e[A0])}const M_=e=>{const t=new Array(10),r=(n,a)=>{if(uo(n)){if(t.indexOf(n)>=0)return;if(co(n))return n;if(!("toJSON"in n)){t[a]=n;const s=Ai(n)?[]:{};return fo(n,(l,o)=>{const c=r(l,a+1);!yi(c)&&(s[o]=c)}),t[a]=void 0,s}}return n};return r(e,0)},B_=Tn("AsyncFunction"),U_=e=>e&&(uo(e)||Pr(e))&&Pr(e.then)&&Pr(e.catch),Av=((e,t)=>e?setImmediate:t?((r,n)=>(as.addEventListener("message",({source:a,data:s})=>{a===as&&s===r&&n.length&&n.shift()()},!1),a=>{n.push(a),as.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Pr(as.postMessage)),z_=typeof queueMicrotask<"u"?queueMicrotask.bind(as):typeof process<"u"&&process.nextTick||Av,$_=e=>e!=null&&Pr(e[A0]),ae={isArray:Ai,isArrayBuffer:Sv,isBuffer:co,isFormData:m_,isArrayBufferView:s_,isString:i_,isNumber:jv,isBoolean:l_,isObject:uo,isPlainObject:gc,isEmptyObject:o_,isReadableStream:p_,isRequest:g_,isResponse:v_,isHeaders:y_,isUndefined:yi,isDate:c_,isFile:u_,isBlob:f_,isRegExp:D_,isFunction:Pr,isStream:h_,isURLSearchParams:x_,isTypedArray:j_,isFileList:d_,forEach:fo,merge:zf,extend:b_,trim:w_,stripBOM:N_,inherits:__,toFlatObject:k_,kindOf:D0,kindOfTest:Tn,endsWith:E_,toArray:S_,forEachEntry:T_,matchAll:C_,isHTMLForm:F_,hasOwnProperty:bx,hasOwnProp:bx,reduceDescriptors:Fv,freezeMethods:R_,toObjectSet:P_,toCamelCase:A_,noop:I_,toFiniteNumber:O_,findKey:Tv,global:as,isContextDefined:Cv,isSpecCompliantForm:L_,toJSONObject:M_,isAsyncFn:B_,isThenable:U_,setImmediate:Av,asap:z_,isIterable:$_};function Me(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}ae.inherits(Me,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ae.toJSONObject(this.config),code:this.code,status:this.status}}});const Dv=Me.prototype,Rv={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Rv[e]={value:e}});Object.defineProperties(Me,Rv);Object.defineProperty(Dv,"isAxiosError",{value:!0});Me.from=(e,t,r,n,a,s)=>{const l=Object.create(Dv);ae.toFlatObject(e,l,function(f){return f!==Error.prototype},u=>u!=="isAxiosError");const o=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return Me.call(l,o,c,r,n,a),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",s&&Object.assign(l,s),l};const W_=null;function $f(e){return ae.isPlainObject(e)||ae.isArray(e)}function Pv(e){return ae.endsWith(e,"[]")?e.slice(0,-2):e}function Nx(e,t,r){return e?e.concat(t).map(function(a,s){return a=Pv(a),!r&&s?"["+a+"]":a}).join(r?".":""):t}function V_(e){return ae.isArray(e)&&!e.some($f)}const H_=ae.toFlatObject(ae,{},null,function(t){return/^is[A-Z]/.test(t)});function P0(e,t,r){if(!ae.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=ae.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,p){return!ae.isUndefined(p[m])});const n=r.metaTokens,a=r.visitor||f,s=r.dots,l=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&ae.isSpecCompliantForm(t);if(!ae.isFunction(a))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(ae.isDate(g))return g.toISOString();if(ae.isBoolean(g))return g.toString();if(!c&&ae.isBlob(g))throw new Me("Blob is not supported. Use a Buffer instead.");return ae.isArrayBuffer(g)||ae.isTypedArray(g)?c&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function f(g,m,p){let x=g;if(g&&!p&&typeof g=="object"){if(ae.endsWith(m,"{}"))m=n?m:m.slice(0,-2),g=JSON.stringify(g);else if(ae.isArray(g)&&V_(g)||(ae.isFileList(g)||ae.endsWith(m,"[]"))&&(x=ae.toArray(g)))return m=Pv(m),x.forEach(function(w,b){!(ae.isUndefined(w)||w===null)&&t.append(l===!0?Nx([m],b,s):l===null?m:m+"[]",u(w))}),!1}return $f(g)?!0:(t.append(Nx(p,m,s),u(g)),!1)}const d=[],h=Object.assign(H_,{defaultVisitor:f,convertValue:u,isVisitable:$f});function y(g,m){if(!ae.isUndefined(g)){if(d.indexOf(g)!==-1)throw Error("Circular reference detected in "+m.join("."));d.push(g),ae.forEach(g,function(x,v){(!(ae.isUndefined(x)||x===null)&&a.call(t,x,ae.isString(v)?v.trim():v,m,h))===!0&&y(x,m?m.concat(v):[v])}),d.pop()}}if(!ae.isObject(e))throw new TypeError("data must be an object");return y(e),t}function _x(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function ah(e,t){this._pairs=[],e&&P0(e,this,t)}const Iv=ah.prototype;Iv.append=function(t,r){this._pairs.push([t,r])};Iv.toString=function(t){const r=t?function(n){return t.call(this,n,_x)}:_x;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function X_(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Ov(e,t,r){if(!t)return e;const n=r&&r.encode||X_;ae.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let s;if(a?s=a(t,r):s=ae.isURLSearchParams(t)?t.toString():new ah(t,r).toString(n),s){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class kx{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ae.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Lv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},G_=typeof URLSearchParams<"u"?URLSearchParams:ah,K_=typeof FormData<"u"?FormData:null,q_=typeof Blob<"u"?Blob:null,Y_={isBrowser:!0,classes:{URLSearchParams:G_,FormData:K_,Blob:q_},protocols:["http","https","file","blob","url","data"]},sh=typeof window<"u"&&typeof document<"u",Wf=typeof navigator=="object"&&navigator||void 0,J_=sh&&(!Wf||["ReactNative","NativeScript","NS"].indexOf(Wf.product)<0),Q_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Z_=sh&&window.location.href||"http://localhost",ek=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:sh,hasStandardBrowserEnv:J_,hasStandardBrowserWebWorkerEnv:Q_,navigator:Wf,origin:Z_},Symbol.toStringTag,{value:"Module"})),cr={...ek,...Y_};function tk(e,t){return P0(e,new cr.classes.URLSearchParams,{visitor:function(r,n,a,s){return cr.isNode&&ae.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function rk(e){return ae.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function nk(e){const t={},r=Object.keys(e);let n;const a=r.length;let s;for(n=0;n<a;n++)s=r[n],t[s]=e[s];return t}function Mv(e){function t(r,n,a,s){let l=r[s++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),c=s>=r.length;return l=!l&&ae.isArray(a)?a.length:l,c?(ae.hasOwnProp(a,l)?a[l]=[a[l],n]:a[l]=n,!o):((!a[l]||!ae.isObject(a[l]))&&(a[l]=[]),t(r,n,a[l],s)&&ae.isArray(a[l])&&(a[l]=nk(a[l])),!o)}if(ae.isFormData(e)&&ae.isFunction(e.entries)){const r={};return ae.forEachEntry(e,(n,a)=>{t(rk(n),a,r,0)}),r}return null}function ak(e,t,r){if(ae.isString(e))try{return(t||JSON.parse)(e),ae.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const ho={transitional:Lv,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,s=ae.isObject(t);if(s&&ae.isHTMLForm(t)&&(t=new FormData(t)),ae.isFormData(t))return a?JSON.stringify(Mv(t)):t;if(ae.isArrayBuffer(t)||ae.isBuffer(t)||ae.isStream(t)||ae.isFile(t)||ae.isBlob(t)||ae.isReadableStream(t))return t;if(ae.isArrayBufferView(t))return t.buffer;if(ae.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return tk(t,this.formSerializer).toString();if((o=ae.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return P0(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||a?(r.setContentType("application/json",!1),ak(t)):t}],transformResponse:[function(t){const r=this.transitional||ho.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(ae.isResponse(t)||ae.isReadableStream(t))return t;if(t&&ae.isString(t)&&(n&&!this.responseType||a)){const l=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(o){if(l)throw o.name==="SyntaxError"?Me.from(o,Me.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:cr.classes.FormData,Blob:cr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ae.forEach(["delete","get","head","post","put","patch"],e=>{ho.headers[e]={}});const sk=ae.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ik=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(l){a=l.indexOf(":"),r=l.substring(0,a).trim().toLowerCase(),n=l.substring(a+1).trim(),!(!r||t[r]&&sk[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},Ex=Symbol("internals");function qi(e){return e&&String(e).trim().toLowerCase()}function vc(e){return e===!1||e==null?e:ae.isArray(e)?e.map(vc):String(e)}function lk(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const ok=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ku(e,t,r,n,a){if(ae.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!ae.isString(t)){if(ae.isString(n))return t.indexOf(n)!==-1;if(ae.isRegExp(n))return n.test(t)}}function ck(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function uk(e,t){const r=ae.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,s,l){return this[n].call(this,t,a,s,l)},configurable:!0})})}let Ir=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function s(o,c,u){const f=qi(c);if(!f)throw new Error("header name must be a non-empty string");const d=ae.findKey(a,f);(!d||a[d]===void 0||u===!0||u===void 0&&a[d]!==!1)&&(a[d||c]=vc(o))}const l=(o,c)=>ae.forEach(o,(u,f)=>s(u,f,c));if(ae.isPlainObject(t)||t instanceof this.constructor)l(t,r);else if(ae.isString(t)&&(t=t.trim())&&!ok(t))l(ik(t),r);else if(ae.isObject(t)&&ae.isIterable(t)){let o={},c,u;for(const f of t){if(!ae.isArray(f))throw TypeError("Object iterator must return a key-value pair");o[u=f[0]]=(c=o[u])?ae.isArray(c)?[...c,f[1]]:[c,f[1]]:f[1]}l(o,r)}else t!=null&&s(r,t,n);return this}get(t,r){if(t=qi(t),t){const n=ae.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return lk(a);if(ae.isFunction(r))return r.call(this,a,n);if(ae.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=qi(t),t){const n=ae.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||ku(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function s(l){if(l=qi(l),l){const o=ae.findKey(n,l);o&&(!r||ku(n,n[o],o,r))&&(delete n[o],a=!0)}}return ae.isArray(t)?t.forEach(s):s(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const s=r[n];(!t||ku(this,this[s],s,t,!0))&&(delete this[s],a=!0)}return a}normalize(t){const r=this,n={};return ae.forEach(this,(a,s)=>{const l=ae.findKey(n,s);if(l){r[l]=vc(a),delete r[s];return}const o=t?ck(s):String(s).trim();o!==s&&delete r[s],r[o]=vc(a),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return ae.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&ae.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[Ex]=this[Ex]={accessors:{}}).accessors,a=this.prototype;function s(l){const o=qi(l);n[o]||(uk(a,l),n[o]=!0)}return ae.isArray(t)?t.forEach(s):s(t),this}};Ir.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ae.reduceDescriptors(Ir.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});ae.freezeMethods(Ir);function Eu(e,t){const r=this||ho,n=t||r,a=Ir.from(n.headers);let s=n.data;return ae.forEach(e,function(o){s=o.call(r,s,a.normalize(),t?t.status:void 0)}),a.normalize(),s}function Bv(e){return!!(e&&e.__CANCEL__)}function Di(e,t,r){Me.call(this,e??"canceled",Me.ERR_CANCELED,t,r),this.name="CanceledError"}ae.inherits(Di,Me,{__CANCEL__:!0});function Uv(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Me("Request failed with status code "+r.status,[Me.ERR_BAD_REQUEST,Me.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function fk(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function dk(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,s=0,l;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),f=n[s];l||(l=u),r[a]=c,n[a]=u;let d=s,h=0;for(;d!==a;)h+=r[d++],d=d%e;if(a=(a+1)%e,a===s&&(s=(s+1)%e),u-l<t)return;const y=f&&u-f;return y?Math.round(h*1e3/y):void 0}}function hk(e,t){let r=0,n=1e3/t,a,s;const l=(u,f=Date.now())=>{r=f,a=null,s&&(clearTimeout(s),s=null),e(...u)};return[(...u)=>{const f=Date.now(),d=f-r;d>=n?l(u,f):(a=u,s||(s=setTimeout(()=>{s=null,l(a)},n-d)))},()=>a&&l(a)]}const Kc=(e,t,r=3)=>{let n=0;const a=dk(50,250);return hk(s=>{const l=s.loaded,o=s.lengthComputable?s.total:void 0,c=l-n,u=a(c),f=l<=o;n=l;const d={loaded:l,total:o,progress:o?l/o:void 0,bytes:c,rate:u||void 0,estimated:u&&o&&f?(o-l)/u:void 0,event:s,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(d)},r)},Sx=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},jx=e=>(...t)=>ae.asap(()=>e(...t)),mk=cr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,cr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(cr.origin),cr.navigator&&/(msie|trident)/i.test(cr.navigator.userAgent)):()=>!0,xk=cr.hasStandardBrowserEnv?{write(e,t,r,n,a,s,l){if(typeof document>"u")return;const o=[`${e}=${encodeURIComponent(t)}`];ae.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),ae.isString(n)&&o.push(`path=${n}`),ae.isString(a)&&o.push(`domain=${a}`),s===!0&&o.push("secure"),ae.isString(l)&&o.push(`SameSite=${l}`),document.cookie=o.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function pk(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function gk(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function zv(e,t,r){let n=!pk(t);return e&&(n||r==!1)?gk(e,t):t}const Tx=e=>e instanceof Ir?{...e}:e;function ws(e,t){t=t||{};const r={};function n(u,f,d,h){return ae.isPlainObject(u)&&ae.isPlainObject(f)?ae.merge.call({caseless:h},u,f):ae.isPlainObject(f)?ae.merge({},f):ae.isArray(f)?f.slice():f}function a(u,f,d,h){if(ae.isUndefined(f)){if(!ae.isUndefined(u))return n(void 0,u,d,h)}else return n(u,f,d,h)}function s(u,f){if(!ae.isUndefined(f))return n(void 0,f)}function l(u,f){if(ae.isUndefined(f)){if(!ae.isUndefined(u))return n(void 0,u)}else return n(void 0,f)}function o(u,f,d){if(d in t)return n(u,f);if(d in e)return n(void 0,u)}const c={url:s,method:s,data:s,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(u,f,d)=>a(Tx(u),Tx(f),d,!0)};return ae.forEach(Object.keys({...e,...t}),function(f){const d=c[f]||a,h=d(e[f],t[f],f);ae.isUndefined(h)&&d!==o||(r[f]=h)}),r}const $v=e=>{const t=ws({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:s,headers:l,auth:o}=t;if(t.headers=l=Ir.from(l),t.url=Ov(zv(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),ae.isFormData(r)){if(cr.hasStandardBrowserEnv||cr.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(ae.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([f,d])=>{u.includes(f.toLowerCase())&&l.set(f,d)})}}if(cr.hasStandardBrowserEnv&&(n&&ae.isFunction(n)&&(n=n(t)),n||n!==!1&&mk(t.url))){const c=a&&s&&xk.read(s);c&&l.set(a,c)}return t},vk=typeof XMLHttpRequest<"u",yk=vk&&function(e){return new Promise(function(r,n){const a=$v(e);let s=a.data;const l=Ir.from(a.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:u}=a,f,d,h,y,g;function m(){y&&y(),g&&g(),a.cancelToken&&a.cancelToken.unsubscribe(f),a.signal&&a.signal.removeEventListener("abort",f)}let p=new XMLHttpRequest;p.open(a.method.toUpperCase(),a.url,!0),p.timeout=a.timeout;function x(){if(!p)return;const w=Ir.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders()),_={data:!o||o==="text"||o==="json"?p.responseText:p.response,status:p.status,statusText:p.statusText,headers:w,config:e,request:p};Uv(function(N){r(N),m()},function(N){n(N),m()},_),p=null}"onloadend"in p?p.onloadend=x:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(x)},p.onabort=function(){p&&(n(new Me("Request aborted",Me.ECONNABORTED,e,p)),p=null)},p.onerror=function(b){const _=b&&b.message?b.message:"Network Error",E=new Me(_,Me.ERR_NETWORK,e,p);E.event=b||null,n(E),p=null},p.ontimeout=function(){let b=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const _=a.transitional||Lv;a.timeoutErrorMessage&&(b=a.timeoutErrorMessage),n(new Me(b,_.clarifyTimeoutError?Me.ETIMEDOUT:Me.ECONNABORTED,e,p)),p=null},s===void 0&&l.setContentType(null),"setRequestHeader"in p&&ae.forEach(l.toJSON(),function(b,_){p.setRequestHeader(_,b)}),ae.isUndefined(a.withCredentials)||(p.withCredentials=!!a.withCredentials),o&&o!=="json"&&(p.responseType=a.responseType),u&&([h,g]=Kc(u,!0),p.addEventListener("progress",h)),c&&p.upload&&([d,y]=Kc(c),p.upload.addEventListener("progress",d),p.upload.addEventListener("loadend",y)),(a.cancelToken||a.signal)&&(f=w=>{p&&(n(!w||w.type?new Di(null,e,p):w),p.abort(),p=null)},a.cancelToken&&a.cancelToken.subscribe(f),a.signal&&(a.signal.aborted?f():a.signal.addEventListener("abort",f)));const v=fk(a.url);if(v&&cr.protocols.indexOf(v)===-1){n(new Me("Unsupported protocol "+v+":",Me.ERR_BAD_REQUEST,e));return}p.send(s||null)})},wk=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const s=function(u){if(!a){a=!0,o();const f=u instanceof Error?u:this.reason;n.abort(f instanceof Me?f:new Di(f instanceof Error?f.message:f))}};let l=t&&setTimeout(()=>{l=null,s(new Me(`timeout ${t} of ms exceeded`,Me.ETIMEDOUT))},t);const o=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),e=null)};e.forEach(u=>u.addEventListener("abort",s));const{signal:c}=n;return c.unsubscribe=()=>ae.asap(o),c}},bk=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},Nk=async function*(e,t){for await(const r of _k(e))yield*bk(r,t)},_k=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},Cx=(e,t,r,n)=>{const a=Nk(e,t);let s=0,l,o=c=>{l||(l=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:f}=await a.next();if(u){o(),c.close();return}let d=f.byteLength;if(r){let h=s+=d;r(h)}c.enqueue(new Uint8Array(f))}catch(u){throw o(u),u}},cancel(c){return o(c),a.return()}},{highWaterMark:2})},Fx=64*1024,{isFunction:Xo}=ae,kk=(({Request:e,Response:t})=>({Request:e,Response:t}))(ae.global),{ReadableStream:Ax,TextEncoder:Dx}=ae.global,Rx=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Ek=e=>{e=ae.merge.call({skipUndefined:!0},kk,e);const{fetch:t,Request:r,Response:n}=e,a=t?Xo(t):typeof fetch=="function",s=Xo(r),l=Xo(n);if(!a)return!1;const o=a&&Xo(Ax),c=a&&(typeof Dx=="function"?(g=>m=>g.encode(m))(new Dx):async g=>new Uint8Array(await new r(g).arrayBuffer())),u=s&&o&&Rx(()=>{let g=!1;const m=new r(cr.origin,{body:new Ax,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!m}),f=l&&o&&Rx(()=>ae.isReadableStream(new n("").body)),d={stream:f&&(g=>g.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!d[g]&&(d[g]=(m,p)=>{let x=m&&m[g];if(x)return x.call(m);throw new Me(`Response type '${g}' is not supported`,Me.ERR_NOT_SUPPORT,p)})});const h=async g=>{if(g==null)return 0;if(ae.isBlob(g))return g.size;if(ae.isSpecCompliantForm(g))return(await new r(cr.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(ae.isArrayBufferView(g)||ae.isArrayBuffer(g))return g.byteLength;if(ae.isURLSearchParams(g)&&(g=g+""),ae.isString(g))return(await c(g)).byteLength},y=async(g,m)=>{const p=ae.toFiniteNumber(g.getContentLength());return p??h(m)};return async g=>{let{url:m,method:p,data:x,signal:v,cancelToken:w,timeout:b,onDownloadProgress:_,onUploadProgress:E,responseType:N,headers:R,withCredentials:j="same-origin",fetchOptions:L}=$v(g),V=t||fetch;N=N?(N+"").toLowerCase():"text";let K=wk([v,w&&w.toAbortSignal()],b),Y=null;const H=K&&K.unsubscribe&&(()=>{K.unsubscribe()});let B;try{if(E&&u&&p!=="get"&&p!=="head"&&(B=await y(R,x))!==0){let U=new r(m,{method:"POST",body:x,duplex:"half"}),S;if(ae.isFormData(x)&&(S=U.headers.get("content-type"))&&R.setContentType(S),U.body){const[z,F]=Sx(B,Kc(jx(E)));x=Cx(U.body,Fx,z,F)}}ae.isString(j)||(j=j?"include":"omit");const J=s&&"credentials"in r.prototype,ue={...L,signal:K,method:p.toUpperCase(),headers:R.normalize().toJSON(),body:x,duplex:"half",credentials:J?j:void 0};Y=s&&new r(m,ue);let le=await(s?V(Y,L):V(m,ue));const G=f&&(N==="stream"||N==="response");if(f&&(_||G&&H)){const U={};["status","statusText","headers"].forEach(M=>{U[M]=le[M]});const S=ae.toFiniteNumber(le.headers.get("content-length")),[z,F]=_&&Sx(S,Kc(jx(_),!0))||[];le=new n(Cx(le.body,Fx,z,()=>{F&&F(),H&&H()}),U)}N=N||"text";let q=await d[ae.findKey(d,N)||"text"](le,g);return!G&&H&&H(),await new Promise((U,S)=>{Uv(U,S,{data:q,headers:Ir.from(le.headers),status:le.status,statusText:le.statusText,config:g,request:Y})})}catch(J){throw H&&H(),J&&J.name==="TypeError"&&/Load failed|fetch/i.test(J.message)?Object.assign(new Me("Network Error",Me.ERR_NETWORK,g,Y),{cause:J.cause||J}):Me.from(J,J&&J.code,g,Y)}}},Sk=new Map,Wv=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:a}=t,s=[n,a,r];let l=s.length,o=l,c,u,f=Sk;for(;o--;)c=s[o],u=f.get(c),u===void 0&&f.set(c,u=o?new Map:Ek(t)),f=u;return u};Wv();const ih={http:W_,xhr:yk,fetch:{get:Wv}};ae.forEach(ih,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Px=e=>`- ${e}`,jk=e=>ae.isFunction(e)||e===null||e===!1;function Tk(e,t){e=ae.isArray(e)?e:[e];const{length:r}=e;let n,a;const s={};for(let l=0;l<r;l++){n=e[l];let o;if(a=n,!jk(n)&&(a=ih[(o=String(n)).toLowerCase()],a===void 0))throw new Me(`Unknown adapter '${o}'`);if(a&&(ae.isFunction(a)||(a=a.get(t))))break;s[o||"#"+l]=a}if(!a){const l=Object.entries(s).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=r?l.length>1?`since :
`+l.map(Px).join(`
`):" "+Px(l[0]):"as no adapter specified";throw new Me("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return a}const Vv={getAdapter:Tk,adapters:ih};function Su(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Di(null,e)}function Ix(e){return Su(e),e.headers=Ir.from(e.headers),e.data=Eu.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Vv.getAdapter(e.adapter||ho.adapter,e)(e).then(function(n){return Su(e),n.data=Eu.call(e,e.transformResponse,n),n.headers=Ir.from(n.headers),n},function(n){return Bv(n)||(Su(e),n&&n.response&&(n.response.data=Eu.call(e,e.transformResponse,n.response),n.response.headers=Ir.from(n.response.headers))),Promise.reject(n)})}const Hv="1.13.2",I0={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{I0[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Ox={};I0.transitional=function(t,r,n){function a(s,l){return"[Axios v"+Hv+"] Transitional option '"+s+"'"+l+(n?". "+n:"")}return(s,l,o)=>{if(t===!1)throw new Me(a(l," has been removed"+(r?" in "+r:"")),Me.ERR_DEPRECATED);return r&&!Ox[l]&&(Ox[l]=!0,console.warn(a(l," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,l,o):!0}};I0.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function Ck(e,t,r){if(typeof e!="object")throw new Me("options must be an object",Me.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const s=n[a],l=t[s];if(l){const o=e[s],c=o===void 0||l(o,s,e);if(c!==!0)throw new Me("option "+s+" must be "+c,Me.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Me("Unknown option "+s,Me.ERR_BAD_OPTION)}}const yc={assertOptions:Ck,validators:I0},Dn=yc.validators;let us=class{constructor(t){this.defaults=t||{},this.interceptors={request:new kx,response:new kx}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const s=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ws(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:s}=r;n!==void 0&&yc.assertOptions(n,{silentJSONParsing:Dn.transitional(Dn.boolean),forcedJSONParsing:Dn.transitional(Dn.boolean),clarifyTimeoutError:Dn.transitional(Dn.boolean)},!1),a!=null&&(ae.isFunction(a)?r.paramsSerializer={serialize:a}:yc.assertOptions(a,{encode:Dn.function,serialize:Dn.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),yc.assertOptions(r,{baseUrl:Dn.spelling("baseURL"),withXsrfToken:Dn.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=s&&ae.merge(s.common,s[r.method]);s&&ae.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),r.headers=Ir.concat(l,s);const o=[];let c=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(r)===!1||(c=c&&m.synchronous,o.unshift(m.fulfilled,m.rejected))});const u=[];this.interceptors.response.forEach(function(m){u.push(m.fulfilled,m.rejected)});let f,d=0,h;if(!c){const g=[Ix.bind(this),void 0];for(g.unshift(...o),g.push(...u),h=g.length,f=Promise.resolve(r);d<h;)f=f.then(g[d++],g[d++]);return f}h=o.length;let y=r;for(;d<h;){const g=o[d++],m=o[d++];try{y=g(y)}catch(p){m.call(this,p);break}}try{f=Ix.call(this,y)}catch(g){return Promise.reject(g)}for(d=0,h=u.length;d<h;)f=f.then(u[d++],u[d++]);return f}getUri(t){t=ws(this.defaults,t);const r=zv(t.baseURL,t.url,t.allowAbsoluteUrls);return Ov(r,t.params,t.paramsSerializer)}};ae.forEach(["delete","get","head","options"],function(t){us.prototype[t]=function(r,n){return this.request(ws(n||{},{method:t,url:r,data:(n||{}).data}))}});ae.forEach(["post","put","patch"],function(t){function r(n){return function(s,l,o){return this.request(ws(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:l}))}}us.prototype[t]=r(),us.prototype[t+"Form"]=r(!0)});let Fk=class Xv{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(a=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](a);n._listeners=null}),this.promise.then=a=>{let s;const l=new Promise(o=>{n.subscribe(o),s=o}).then(a);return l.cancel=function(){n.unsubscribe(s)},l},t(function(s,l,o){n.reason||(n.reason=new Di(s,l,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Xv(function(a){t=a}),cancel:t}}};function Ak(e){return function(r){return e.apply(null,r)}}function Dk(e){return ae.isObject(e)&&e.isAxiosError===!0}const Vf={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Vf).forEach(([e,t])=>{Vf[t]=e});function Gv(e){const t=new us(e),r=kv(us.prototype.request,t);return ae.extend(r,us.prototype,t,{allOwnKeys:!0}),ae.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return Gv(ws(e,a))},r}const Ft=Gv(ho);Ft.Axios=us;Ft.CanceledError=Di;Ft.CancelToken=Fk;Ft.isCancel=Bv;Ft.VERSION=Hv;Ft.toFormData=P0;Ft.AxiosError=Me;Ft.Cancel=Ft.CanceledError;Ft.all=function(t){return Promise.all(t)};Ft.spread=Ak;Ft.isAxiosError=Dk;Ft.mergeConfig=ws;Ft.AxiosHeaders=Ir;Ft.formToJSON=e=>Mv(ae.isHTMLForm(e)?new FormData(e):e);Ft.getAdapter=Vv.getAdapter;Ft.HttpStatusCode=Vf;Ft.default=Ft;const{Axios:IR,AxiosError:OR,CanceledError:LR,isCancel:MR,CancelToken:BR,VERSION:UR,all:zR,Cancel:$R,isAxiosError:WR,spread:VR,toFormData:HR,AxiosHeaders:XR,HttpStatusCode:GR,formToJSON:KR,getAdapter:qR,mergeConfig:YR}=Ft,Rk="http://localhost:3001/api/v1",Ce=Ft.create({baseURL:Rk,headers:{"Content-Type":"application/json"}});Ce.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Ce.interceptors.response.use(e=>e,e=>{var t;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});const Yi={register:e=>Ce.post("/auth/register",e),login:e=>Ce.post("/auth/login",e),logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user")},getCurrentUser:()=>{const e=localStorage.getItem("user");return e?JSON.parse(e):null},getToken:()=>localStorage.getItem("token")},Lr={getAll:()=>Ce.get("/immeubles"),getOne:e=>Ce.get(`/immeubles/${e}`),create:e=>Ce.post("/immeubles",e),update:(e,t)=>Ce.patch(`/immeubles/${e}`,t),delete:e=>Ce.delete(`/immeubles/${e}`)},Xr={getByImmeuble:e=>Ce.get(`/immeubles/${e}/proprietaires`),getOne:(e,t)=>Ce.get(`/immeubles/${e}/proprietaires/${t}`),create:(e,t)=>Ce.post(`/immeubles/${e}/proprietaires`,t),update:(e,t,r)=>Ce.patch(`/immeubles/${e}/proprietaires/${t}`,r),delete:(e,t)=>Ce.delete(`/immeubles/${e}/proprietaires/${t}`)},Oa={getByImmeuble:e=>Ce.get(`/immeubles/${e}/locataires`),getOne:(e,t)=>Ce.get(`/immeubles/${e}/locataires/${t}`),create:(e,t)=>Ce.post(`/immeubles/${e}/locataires`,t),update:(e,t,r)=>Ce.patch(`/immeubles/${e}/locataires/${t}`,r),delete:(e,t)=>Ce.delete(`/immeubles/${e}/locataires/${t}`)},$l={getAll:()=>Ce.get("/decomptes"),getById:e=>Ce.get(`/decomptes/${e}`),create:e=>Ce.post("/decomptes",e),update:(e,t)=>Ce.patch(`/decomptes/${e}`,t),delete:e=>Ce.delete(`/decomptes/${e}`),calculer:e=>Ce.post(`/decomptes/${e}/calculer`),getCategories:()=>Ce.get("/decomptes/categories")},Pk={getAll:()=>Ce.get("/tarifs-eau"),getById:e=>Ce.get(`/tarifs-eau/${e}`),create:e=>Ce.post("/tarifs-eau",e),update:(e,t)=>Ce.patch(`/tarifs-eau/${e}`,t),delete:e=>Ce.delete(`/tarifs-eau/${e}`)},wi={getByImmeuble:e=>Ce.get(`/immeubles/${e}/compteurs-eau`),create:(e,t)=>Ce.post(`/immeubles/${e}/compteurs-eau`,t),update:(e,t,r)=>Ce.patch(`/immeubles/${e}/compteurs-eau/${t}`,r),delete:(e,t)=>Ce.delete(`/immeubles/${e}/compteurs-eau/${t}`)},Za={getByDecompte:e=>Ce.get(`/decomptes/${e}/releves`),create:(e,t)=>Ce.post(`/decomptes/${e}/releves`,t),bulkImport:(e,t)=>Ce.post(`/decomptes/${e}/releves/bulk`,{releves:t}),getTemplate:e=>Ce.get(`/decomptes/${e}/releves/template`),update:(e,t,r)=>Ce.patch(`/decomptes/${e}/releves/${t}`,r),delete:(e,t)=>Ce.delete(`/decomptes/${e}/releves/${t}`)},ss={getAll:e=>Ce.get(`/immeubles/${e}/fournisseurs`),getCategories:e=>Ce.get(`/immeubles/${e}/fournisseurs/categories`),create:(e,t)=>Ce.post(`/immeubles/${e}/fournisseurs`,t),update:(e,t,r)=>Ce.patch(`/immeubles/${e}/fournisseurs/${t}`,r),delete:(e,t)=>Ce.delete(`/immeubles/${e}/fournisseurs/${t}`)},is={getAll:(e,t)=>Ce.get(`/immeubles/${e}/transactions`,{params:t}),getStats:e=>Ce.get(`/immeubles/${e}/transactions/stats`),import:(e,t)=>Ce.post(`/immeubles/${e}/transactions/import`,{transactions:t}),create:(e,t)=>Ce.post(`/immeubles/${e}/transactions`,t),update:(e,t,r)=>Ce.patch(`/immeubles/${e}/transactions/${t}`,r),delete:(e,t)=>Ce.delete(`/immeubles/${e}/transactions/${t}`)},ii={getAll:e=>Ce.get(`/immeubles/${e}/exercices`),getOne:(e,t)=>Ce.get(`/immeubles/${e}/exercices/${t}`),create:(e,t)=>Ce.post(`/immeubles/${e}/exercices`,t),cloturer:(e,t,r={})=>Ce.post(`/immeubles/${e}/exercices/${t}/cloturer`,r),getSoldeProprietaire:(e,t,r)=>Ce.get(`/immeubles/${e}/exercices/${t}/proprietaires/${r}/solde`),getDecompteAnnuel:(e,t,r)=>Ce.get(`/immeubles/${e}/exercices/${t}/proprietaires/${r}/decompte`),createAppel:(e,t,r)=>Ce.post(`/immeubles/${e}/exercices/${t}/appels`,r),enregistrerPaiement:(e,t,r,n)=>Ce.post(`/immeubles/${e}/exercices/appels/${t}/proprietaires/${r}/paiement`,n)},Kv=T.createContext(null),Ik=({children:e})=>{const[t,r]=T.useState(null),[n,a]=T.useState(!0);T.useEffect(()=>{const u=Yi.getToken(),f=Yi.getCurrentUser();u&&f&&r(f),a(!1)},[]);const s=async(u,f)=>{var d,h;try{const y=await Yi.login({email:u,password:f}),{accessToken:g,user:m}=y.data;return localStorage.setItem("token",g),localStorage.setItem("user",JSON.stringify(m)),r(m),{success:!0}}catch(y){return console.error("Login error:",y),{success:!1,error:((h=(d=y.response)==null?void 0:d.data)==null?void 0:h.message)||"Erreur de connexion"}}},c={user:t,loading:n,login:s,register:async u=>{var f;try{return(await Yi.register(u)).data.success?await s(u.email,u.password):{success:!0}}catch(d){console.error("Register error:",d);let h="Erreur lors de l'inscription";if((f=d.response)!=null&&f.data){const y=d.response.data;if(y.errors&&Array.isArray(y.errors))return{success:!1,error:{errors:y.errors}};y.message&&(h=y.message)}return{success:!1,error:h}}},logout:()=>{Yi.logout(),r(null)},isAuthenticated:!!t};return i.jsx(Kv.Provider,{value:c,children:e})},mo=()=>{const e=T.useContext(Kv);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ok={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lk=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),je=(e,t)=>{const r=T.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:l,className:o="",children:c,...u},f)=>T.createElement("svg",{ref:f,...Ok,width:a,height:a,stroke:n,strokeWidth:l?Number(s)*24/Number(a):s,className:["lucide",`lucide-${Lk(e)}`,o].join(" "),...u},[...t.map(([d,h])=>T.createElement(d,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=je("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=je("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=je("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hf=je("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mk=je("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bk=je("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uk=je("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=je("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zk=je("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wc=je("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=je("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $k=je("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jn=je("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lh=je("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wk=je("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ml=je("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oh=je("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vk=je("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qc=je("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lx=je("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hk=je("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xk=je("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ch=je("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zn=je("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qv=je("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O0=je("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L0=je("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=je("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gk=je("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mx=je("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xf=je("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wl=je("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bx=je("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gf=je("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bc=je("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kk=je("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bi=je("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M0=je("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qk=je("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=je("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ni=je("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=je("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uh=je("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yk=je("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=je("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=je("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jk=je("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qk=je("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=je("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=je("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=je("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fh=je("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B0=je("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zk=je("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yv=je("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jv=je("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=je("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eE=je("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=je("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=je("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=je("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rE=je("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function nE(){const[e,t]=T.useState(""),[r,n]=T.useState(""),[a,s]=T.useState(""),[l,o]=T.useState(!1),[c,u]=T.useState(!1),{login:f}=mo(),d=Kt(),h=async y=>{y.preventDefault(),s(""),o(!0);const g=await f(e,r);g.success?d("/dashboard"):s(g.error),o(!1)};return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"max-w-md w-full space-y-8",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:" Copro Manager"}),i.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Connectez-vous  votre compte"})]}),i.jsxs("form",{className:"mt-8 space-y-6",onSubmit:h,children:[a&&i.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:a}),i.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email"}),i.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:e,onChange:y=>t(y.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Email"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("label",{htmlFor:"password",className:"sr-only",children:"Mot de passe"}),i.jsx("input",{id:"password",name:"password",type:c?"text":"password",required:!0,value:r,onChange:y=>n(y.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Mot de passe"}),i.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 z-20",children:c?i.jsx(qv,{className:"h-5 w-5"}):i.jsx(O0,{className:"h-5 w-5"})})]})]}),i.jsx("div",{children:i.jsx("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Connexion...":"Se connecter"})}),i.jsx("div",{className:"text-center",children:i.jsx(rh,{to:"/register",className:"font-medium text-primary-600 hover:text-primary-500",children:"Pas encore de compte ? Inscrivez-vous"})})]})]})})}function aE(){const[e,t]=T.useState({firstName:"",lastName:"",email:"",password:""}),[r,n]=T.useState([]),[a,s]=T.useState(!1),[l,o]=T.useState(!1),{register:c}=mo(),u=Kt(),f=h=>{t({...e,[h.target.name]:h.target.value})},d=async h=>{h.preventDefault(),n([]);const y=[];if(e.password.length<8&&y.push("Le mot de passe doit contenir au moins 8 caractres"),e.firstName.trim()||y.push("Le prnom est requis"),e.lastName.trim()||y.push("Le nom est requis"),e.email.trim()||y.push("L'email est requis"),y.length>0){n(y);return}s(!0);const g=await c(e);g.success?u("/dashboard"):g.error&&(typeof g.error=="string"?n([g.error]):g.error.errors&&Array.isArray(g.error.errors)?n(g.error.errors):n(["Une erreur est survenue lors de l'inscription"])),s(!1)};return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"max-w-md w-full space-y-8",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:" Copro Manager"}),i.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Crez votre compte"})]}),i.jsxs("form",{className:"mt-8 space-y-6",onSubmit:d,children:[r.length>0&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:r.length===1?"Erreur":`${r.length} erreurs`}),i.jsx("div",{className:"mt-2 text-sm text-red-700",children:i.jsx("ul",{className:"list-disc pl-5 space-y-1",children:r.map((h,y)=>i.jsx("li",{children:h},y))})})]})]})}),i.jsxs("div",{className:"rounded-md shadow-sm space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"firstName",className:"sr-only",children:"Prnom"}),i.jsx("input",{id:"firstName",name:"firstName",type:"text",required:!0,value:e.firstName,onChange:f,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Prnom"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"lastName",className:"sr-only",children:"Nom"}),i.jsx("input",{id:"lastName",name:"lastName",type:"text",required:!0,value:e.lastName,onChange:f,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Nom"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email"}),i.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:e.email,onChange:f,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Email"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("label",{htmlFor:"password",className:"sr-only",children:"Mot de passe"}),i.jsx("input",{id:"password",name:"password",type:l?"text":"password",required:!0,value:e.password,onChange:f,className:"appearance-none relative block w-full px-3 py-2 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Mot de passe (min. 8 caractres)"}),i.jsx("button",{type:"button",onClick:()=>o(!l),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:l?i.jsx(qv,{className:"h-5 w-5"}):i.jsx(O0,{className:"h-5 w-5"})})]})]}),i.jsx("div",{children:i.jsx("button",{type:"submit",disabled:a,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Inscription...":"S'inscrire"})}),i.jsx("div",{className:"text-center",children:i.jsx(rh,{to:"/login",className:"font-medium text-primary-600 hover:text-primary-500",children:"Dj un compte ? Connectez-vous"})})]})]})})}const Qv=T.createContext(null),Ux=5*60*1e3,sE=({children:e})=>{const t=T.useRef({immeubles:{data:null,timestamp:0},proprietaires:{},locataires:{},transactions:{},fournisseurs:{},compteurs:{},stats:{data:null,timestamp:0}}),[r,n]=T.useState({}),a=(p,x=null)=>{var b;const v=Date.now();if(x){const _=(b=t.current[p])==null?void 0:b[x];return _&&v-_.timestamp<Ux}const w=t.current[p];return(w==null?void 0:w.data)&&v-w.timestamp<Ux},s=T.useCallback(async(p=!1)=>{if(!p&&a("immeubles"))return t.current.immeubles.data;n(x=>({...x,immeubles:!0}));try{const v=(await Lr.getAll()).data.immeubles||[],w=await Promise.all(v.map(async b=>{let _=0,E=0;if(a("proprietaires",b.id)&&(_=t.current.proprietaires[b.id].data.length),a("locataires",b.id)&&(E=t.current.locataires[b.id].data.length),!_&&!E)try{const[N,R]=await Promise.all([Xr.getByImmeuble(b.id),Oa.getByImmeuble(b.id)]),j=N.data.proprietaires||[],L=R.data.locataires||[];t.current.proprietaires[b.id]={data:j,timestamp:Date.now()},t.current.locataires[b.id]={data:L,timestamp:Date.now()},_=j.length,E=L.length}catch(N){console.error(`Error loading counts for ${b.id}:`,N)}return{...b,proprietairesCount:_,locatairesCount:E}}));return t.current.immeubles={data:w,timestamp:Date.now()},w}catch(x){throw console.error("Error loading immeubles:",x),x}finally{n(x=>({...x,immeubles:!1}))}},[]),l=T.useCallback(async(p=!1)=>{if(!p&&a("stats"))return t.current.stats.data;n(x=>({...x,stats:!0}));try{const x=await s(p),v={immeubles:x.length,proprietaires:x.reduce((w,b)=>w+(b.proprietairesCount||0),0),locataires:x.reduce((w,b)=>w+(b.locatairesCount||0),0),decomptes:0};return t.current.stats={data:v,timestamp:Date.now()},v}catch(x){return console.error("Error loading stats:",x),{immeubles:0,proprietaires:0,locataires:0,decomptes:0}}finally{n(x=>({...x,stats:!1}))}},[s]),o=T.useCallback(async(p,x=!1)=>{if(!x&&a("proprietaires",p))return t.current.proprietaires[p].data;try{const w=(await Xr.getByImmeuble(p)).data.proprietaires||[];return t.current.proprietaires[p]={data:w,timestamp:Date.now()},w}catch(v){return console.error("Error loading proprietaires:",v),[]}},[]),c=T.useCallback(async(p,x=!1)=>{if(!x&&a("locataires",p))return t.current.locataires[p].data;try{const w=(await Oa.getByImmeuble(p)).data.locataires||[];return t.current.locataires[p]={data:w,timestamp:Date.now()},w}catch(v){return console.error("Error loading locataires:",v),[]}},[]),u=T.useCallback(async(p,x=!1)=>{if(!x&&a("transactions",p))return t.current.transactions[p].data;try{const w=(await is.getAll(p,{limit:1e3})).data.transactions||[];return t.current.transactions[p]={data:w,timestamp:Date.now()},w}catch(v){return console.error("Error loading transactions:",v),[]}},[]),f=T.useCallback(async(p,x=!1)=>{if(!x&&a("fournisseurs",p))return t.current.fournisseurs[p].data;try{const w=(await ss.getAll(p)).data.fournisseurs||[];return t.current.fournisseurs[p]={data:w,timestamp:Date.now()},w}catch(v){return console.error("Error loading fournisseurs:",v),[]}},[]),d=T.useCallback(async(p,x=!1)=>{if(!x&&a("compteurs",p))return t.current.compteurs[p].data;try{const w=(await wi.getByImmeuble(p)).data.compteurs||[];return t.current.compteurs[p]={data:w,timestamp:Date.now()},w}catch(v){return console.error("Error loading compteurs:",v),[]}},[]),h=T.useCallback(async(p,x=!1)=>{n(v=>({...v,[`immeuble_${p}`]:!0}));try{const[v,w,b,_,E]=await Promise.all([Lr.getOne(p),o(p,x),c(p,x),d(p,x),f(p,x)]);return{immeuble:v.data.immeuble,proprietaires:w,locataires:b,compteurs:_,fournisseurs:E}}catch(v){throw console.error("Error loading immeuble detail:",v),v}finally{n(v=>({...v,[`immeuble_${p}`]:!1}))}},[o,c,d,f]),y=T.useCallback((p,x=null)=>{p==="all"?t.current={immeubles:{data:null,timestamp:0},proprietaires:{},locataires:{},transactions:{},fournisseurs:{},compteurs:{},stats:{data:null,timestamp:0}}:x?(t.current[p]&&delete t.current[p][x],t.current.stats={data:null,timestamp:0},t.current.immeubles={data:null,timestamp:0}):t.current[p]=p==="immeubles"||p==="stats"?{data:null,timestamp:0}:{}},[]),g=T.useCallback(async(p,x)=>{switch(y(p,x),p){case"proprietaires":return o(x,!0);case"locataires":return c(x,!0);case"transactions":return u(x,!0);case"fournisseurs":return f(x,!0);case"compteurs":return d(x,!0);default:return null}},[y,o,c,u,f,d]),m={getImmeubles:s,getDashboardStats:l,getProprietaires:o,getLocataires:c,getTransactions:u,getFournisseurs:f,getCompteurs:d,getImmeubleDetail:h,invalidateCache:y,refreshAfterUpdate:g,loading:r,getCachedData:(p,x=null)=>{var v,w,b;return x?((w=(v=t.current[p])==null?void 0:v[x])==null?void 0:w.data)||null:((b=t.current[p])==null?void 0:b.data)||null}};return i.jsx(Qv.Provider,{value:m,children:e})},dh=()=>{const e=T.useContext(Qv);if(!e)throw new Error("useData must be used within a DataProvider");return e};function iE(){const{user:e}=mo(),{getDashboardStats:t}=dh(),r=Kt(),[n,a]=T.useState({immeubles:0,proprietaires:0,locataires:0,decomptes:0}),[s,l]=T.useState(!0);T.useEffect(()=>{o()},[]);const o=async(f=!1)=>{try{l(!0);const d=await t(f);a(d)}catch(d){console.error("Error loading stats:",d)}finally{l(!1)}},c=[{title:"Immeubles",value:n.immeubles,icon:fr,color:"text-blue-600",bgColor:"bg-blue-100",path:"/immeubles"},{title:"Propritaires",value:n.proprietaires,icon:Vt,color:"text-purple-600",bgColor:"bg-purple-100",path:"/proprietaires"},{title:"Locataires",value:n.locataires,icon:Vt,color:"text-green-600",bgColor:"bg-green-100",path:"/locataires"}],u=[{title:"Ajouter un immeuble",description:"Crer un nouveau bien en coproprit",icon:Gt,path:"/immeubles"},{title:"Nouveau dcompte",description:"Gnrer un dcompte de charges",icon:bs,path:"/decomptes"},{title:"Voir les rapports",description:"Consulter les statistiques dtailles",icon:B0,path:"/dashboard"},{title:"Grer les locataires",description:"Ajouter ou modifier des locataires",icon:Vt,path:"/locataires"}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsxs("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:["Bienvenue, ",(e==null?void 0:e.prenom)||(e==null?void 0:e.firstName)||"Utilisateur"," ! "]}),i.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Voici un aperu de votre activit"})]}),i.jsx("button",{onClick:()=>o(!0),disabled:s,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",title:"Rafrachir les donnes",children:i.jsx(kr,{className:`h-5 w-5 ${s?"animate-spin":""}`})})]}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:c.map(f=>i.jsxs("button",{onClick:()=>r(f.path),className:"bg-white rounded-xl shadow-sm p-5 sm:p-6 hover:shadow-md transition-all text-left group w-full",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:f.title}),s?i.jsx("div",{className:"mt-2 h-8 w-16 bg-gray-200 animate-pulse rounded"}):i.jsx("p",{className:`mt-2 text-2xl sm:text-3xl font-bold ${f.color}`,children:f.value})]}),i.jsx("div",{className:`p-3 rounded-full ${f.bgColor} group-hover:scale-110 transition-transform`,children:i.jsx(f.icon,{className:`h-6 w-6 ${f.color}`})})]}),i.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 flex items-center text-sm text-gray-500 group-hover:text-primary-600 transition-colors",children:[i.jsx("span",{children:"Voir tout"}),i.jsx(ml,{className:"h-4 w-4 ml-1 group-hover:translate-x-1 transition-transform"})]})]},f.title))}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-5 sm:p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Actions rapides"}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:u.map(f=>i.jsxs("button",{onClick:()=>r(f.path),className:"flex items-center p-4 border border-gray-200 rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-colors text-left group w-full",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("div",{className:"p-3 bg-gray-100 rounded-lg group-hover:bg-primary-100 transition-colors",children:i.jsx(f.icon,{className:"h-5 w-5 text-gray-600 group-hover:text-primary-600 transition-colors"})})}),i.jsxs("div",{className:"ml-4 flex-1 min-w-0",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900",children:f.title}),i.jsx("p",{className:"mt-1 text-sm text-gray-500 truncate",children:f.description})]}),i.jsx(Mk,{className:"h-4 w-4 text-gray-400 group-hover:text-primary-600 group-hover:translate-x-1 transition-all flex-shrink-0 ml-2"})]},f.title))})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-5 sm:p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activit rcente"}),i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(bs,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),i.jsx("p",{className:"text-gray-600",children:"Aucune activit rcente"}),i.jsx("p",{className:"text-sm mt-2 text-gray-400",children:"Les dernires actions apparatront ici"})]})]})]})}function lE({immeuble:e,onClose:t,onSuccess:r}){const[n,a]=T.useState({nom:"",adresse:"",codePostal:"",ville:"",region:"brussels",totalMilliemes:1e3,nombreAppartements:1,systemeRepartition:"milliemes",modeComptageEau:"divisionnaire",tarifEauM3:5.85,fournisseurEau:"VIVAQUA"}),[s,l]=T.useState([]),[o,c]=T.useState(!1);T.useEffect(()=>{e&&a({nom:e.nom||"",adresse:e.adresse||"",codePostal:e.code_postal||"",ville:e.ville||"",region:e.region||"brussels",totalMilliemes:e.total_milliemes||1e3,nombreAppartements:e.nombre_appartements||1,systemeRepartition:e.systeme_repartition||"milliemes",modeComptageEau:e.mode_comptage_eau||"divisionnaire",tarifEauM3:e.tarif_eau_m3||5.85,fournisseurEau:e.fournisseur_eau||"VIVAQUA"})},[e]);const u=h=>{const{name:y,value:g}=h.target;a(m=>({...m,[y]:g}))},f=()=>{const h=[];return n.nom.trim()||h.push("Le nom de l'immeuble est requis"),n.adresse.trim()||h.push("L'adresse est requise"),n.codePostal.trim()||h.push("Le code postal est requis"),n.ville.trim()||h.push("La ville est requise"),(!n.nombreAppartements||n.nombreAppartements<=0)&&h.push("Le nombre d'appartements doit tre suprieur  0"),(!n.totalMilliemes||n.totalMilliemes<=0)&&h.push("Le total des millimes doit tre suprieur  0"),(!n.tarifEauM3||n.tarifEauM3<=0)&&h.push("Le tarif de l'eau doit tre suprieur  0"),l(h),h.length===0},d=async h=>{var y,g;if(h.preventDefault(),!!f()){c(!0),l([]);try{const m={nom:n.nom.trim(),adresse:n.adresse.trim(),codePostal:n.codePostal.trim(),ville:n.ville.trim(),region:n.region,nombreAppartements:parseInt(n.nombreAppartements),totalMilliemes:parseInt(n.totalMilliemes),systemeRepartition:n.systemeRepartition,modeComptageEau:n.modeComptageEau,tarifEauM3:parseFloat(n.tarifEauM3),fournisseurEau:n.fournisseurEau.trim()};e?await Lr.update(e.id,m):await Lr.create(m),r()}catch(m){console.error("Error saving immeuble:",m),(g=(y=m.response)==null?void 0:y.data)!=null&&g.errors?l(Array.isArray(m.response.data.errors)?m.response.data.errors:[m.response.data.message||"Erreur lors de l'enregistrement"]):l(["Erreur lors de l'enregistrement de l'immeuble"])}finally{c(!1)}}};return i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full my-8",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Modifier l'immeuble":"Ajouter un immeuble"}),i.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(br,{className:"h-6 w-6"})})]}),i.jsxs("form",{onSubmit:d,className:"p-6",children:[s.length>0&&i.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx(st,{className:"h-5 w-5 text-red-400 mt-0.5"}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:s.length===1?"Erreur":`${s.length} erreurs`}),i.jsx("div",{className:"mt-2 text-sm text-red-700",children:i.jsx("ul",{className:"list-disc pl-5 space-y-1",children:s.map((h,y)=>i.jsx("li",{children:h},y))})})]})]})}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Informations gnrales"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"nom",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom de l'immeuble *"}),i.jsx("input",{type:"text",id:"nom",name:"nom",required:!0,value:n.nom,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: Rsidence Royale"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"adresse",className:"block text-sm font-medium text-gray-700 mb-1",children:"Adresse *"}),i.jsx("input",{type:"text",id:"adresse",name:"adresse",required:!0,value:n.adresse,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: Avenue Louise 123"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"codePostal",className:"block text-sm font-medium text-gray-700 mb-1",children:"Code postal *"}),i.jsx("input",{type:"text",id:"codePostal",name:"codePostal",required:!0,value:n.codePostal,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: 1050"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"ville",className:"block text-sm font-medium text-gray-700 mb-1",children:"Ville *"}),i.jsx("input",{type:"text",id:"ville",name:"ville",required:!0,value:n.ville,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: Bruxelles"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"region",className:"block text-sm font-medium text-gray-700 mb-1",children:"Rgion *"}),i.jsxs("select",{id:"region",name:"region",required:!0,value:n.region,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[i.jsx("option",{value:"brussels",children:"Bruxelles"}),i.jsx("option",{value:"wallonia",children:"Wallonie"}),i.jsx("option",{value:"flanders",children:"Flandre"})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"systemeRepartition",className:"block text-sm font-medium text-gray-700 mb-1",children:"Systme de rpartition *"}),i.jsxs("select",{id:"systemeRepartition",name:"systemeRepartition",required:!0,value:n.systemeRepartition,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[i.jsx("option",{value:"milliemes",children:"Millimes (sur 1000)"}),i.jsx("option",{value:"parts",children:"Parts"})]}),i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:n.systemeRepartition==="milliemes"?"Systme traditionnel belge/franais (total: 1000)":"Systme par nombre de parts possdes"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"nombreAppartements",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre d'appartements *"}),i.jsx("input",{type:"number",id:"nombreAppartements",name:"nombreAppartements",required:!0,min:"1",value:n.nombreAppartements,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"totalMilliemes",className:"block text-sm font-medium text-gray-700 mb-1",children:n.systemeRepartition==="milliemes"?"Total millimes *":"Total parts *"}),i.jsx("input",{type:"number",id:"totalMilliemes",name:"totalMilliemes",required:!0,min:"1",value:n.totalMilliemes,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:n.systemeRepartition==="milliemes"?"Gnralement 1000 pour les millimes":"Somme totale des parts de tous les propritaires"})]})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Gestion de l'eau"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"modeComptageEau",className:"block text-sm font-medium text-gray-700 mb-1",children:"Mode de comptage *"}),i.jsxs("select",{id:"modeComptageEau",name:"modeComptageEau",required:!0,value:n.modeComptageEau,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[i.jsx("option",{value:"collectif",children:"Collectif"}),i.jsx("option",{value:"divisionnaire",children:"Divisionnaire"}),i.jsx("option",{value:"individuel",children:"Individuel"})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"tarifEauM3",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tarif eau (/m) *"}),i.jsx("input",{type:"number",id:"tarifEauM3",name:"tarifEauM3",required:!0,min:"0",step:"0.01",value:n.tarifEauM3,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"fournisseurEau",className:"block text-sm font-medium text-gray-700 mb-1",children:"Fournisseur d'eau"}),i.jsxs("select",{id:"fournisseurEau",name:"fournisseurEau",value:n.fournisseurEau,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[i.jsx("option",{value:"VIVAQUA",children:"VIVAQUA (Bruxelles)"}),i.jsx("option",{value:"SWDE",children:"SWDE (Wallonie)"}),i.jsx("option",{value:"CILE",children:"CILE (Wallonie)"}),i.jsx("option",{value:"De Watergroep",children:"De Watergroep (Flandre)"}),i.jsx("option",{value:"Farys",children:"Farys (Flandre)"}),i.jsx("option",{value:"PIDPA",children:"PIDPA (Flandre)"}),i.jsx("option",{value:"Water-link",children:"Water-link (Flandre)"})]})]})]})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200",children:[i.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),i.jsx("button",{type:"submit",disabled:o,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Enregistrement..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Hn,{className:"h-4 w-4 mr-2"}),e?"Mettre  jour":"Crer"]})})]})]})]})})}function oE(){const e=Kt(),{getImmeubles:t,invalidateCache:r}=dh(),[n,a]=T.useState([]),[s,l]=T.useState(!0),[o,c]=T.useState(""),[u,f]=T.useState(!1),[d,h]=T.useState(null),[y,g]=T.useState(!1),[m,p]=T.useState(null),[x,v]=T.useState(""),[w,b]=T.useState("grid");T.useEffect(()=>{_()},[]);const _=async(B=!1)=>{try{l(!0),c("");const J=await t(B);a(J)}catch(J){console.error("Error loading immeubles:",J),c("Erreur lors du chargement des immeubles")}finally{l(!1)}},E=()=>{h(null),f(!0)},N=(B,J)=>{J==null||J.stopPropagation(),h(B),f(!0)},R=(B,J)=>{J==null||J.stopPropagation(),p(B),v(""),g(!0)},j=async()=>{if(m&&x===`Effacer ${m.nom}`)try{await Lr.delete(m.id),r("all"),a(n.filter(B=>B.id!==m.id)),g(!1),p(null),v("")}catch(B){console.error("Error deleting immeuble:",B),c("Erreur lors de la suppression")}},L=()=>{f(!1),h(null),r("all"),_(!0)},V=(B,J)=>{J==null||J.stopPropagation(),e("/proprietaires",{state:{selectedImmeuble:B}})},K=(B,J)=>{J==null||J.stopPropagation(),e("/locataires",{state:{selectedImmeuble:B}})},Y=B=>({brussels:"Bruxelles",wallonia:"Wallonie",flanders:"Flandre"})[B]||B,H=B=>B==="milliemes"?"Millimes":"Parts";return s?i.jsx("div",{className:"flex items-center justify-center min-h-96",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement..."})]})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Immeubles"}),i.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Grez vos biens en coproprit"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("button",{onClick:()=>_(!0),className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",title:"Rafrachir",children:i.jsx(kr,{className:"h-5 w-5"})}),n.length>0&&i.jsxs("div",{className:"flex bg-white border border-gray-300 rounded-lg p-1",children:[i.jsx("button",{onClick:()=>b("grid"),className:`p-2 rounded transition-colors ${w==="grid"?"bg-primary-600 text-white":"text-gray-600 hover:bg-gray-100"}`,title:"Vue grille",children:i.jsx(Xf,{className:"h-5 w-5"})}),i.jsx("button",{onClick:()=>b("list"),className:`p-2 rounded transition-colors ${w==="list"?"bg-primary-600 text-white":"text-gray-600 hover:bg-gray-100"}`,title:"Vue liste",children:i.jsx(Gf,{className:"h-5 w-5"})})]}),i.jsxs("button",{onClick:E,className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[i.jsx(Gt,{className:"h-5 w-5 mr-2"}),"Ajouter"]})]})]}),o&&i.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[i.jsx(st,{className:"h-5 w-5 mr-2"}),o]}),n.length===0&&i.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[i.jsx(fr,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun immeuble"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Commencez par ajouter votre premier immeuble"}),i.jsxs("button",{onClick:E,className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[i.jsx(Gt,{className:"h-5 w-5 mr-2"}),"Ajouter un immeuble"]})]}),n.length>0&&w==="grid"&&i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(B=>i.jsx("div",{className:"bg-white rounded-lg shadow hover:shadow-lg transition-all cursor-pointer group",onClick:()=>e(`/immeubles/${B.id}`),children:i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"flex items-start justify-between",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform",children:i.jsx(fr,{className:"h-6 w-6 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:B.nom}),i.jsxs("div",{className:"flex items-center text-sm text-gray-500 mt-1",children:[i.jsx(M0,{className:"h-3.5 w-3.5 mr-1"}),B.ville," - ",Y(B.region)]})]})]})}),i.jsxs("div",{className:"mt-4 flex items-center space-x-4",children:[i.jsxs("button",{onClick:J=>V(B.id,J),className:"flex items-center px-3 py-1.5 bg-purple-50 text-purple-700 rounded-lg hover:bg-purple-100 transition-colors",children:[i.jsx(Vt,{className:"h-4 w-4 mr-1.5"}),i.jsx("span",{className:"font-medium",children:B.proprietairesCount||0})]}),i.jsxs("button",{onClick:J=>K(B.id,J),className:"flex items-center px-3 py-1.5 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors",children:[i.jsx(Wl,{className:"h-4 w-4 mr-1.5"}),i.jsx("span",{className:"font-medium",children:B.locatairesCount||0})]})]}),i.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-500",children:H(B.systeme_repartition)}),i.jsxs("span",{className:"font-medium text-gray-900",children:[B.total_milliemes||1e3," millimes"]})]})}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 flex justify-end space-x-2",children:[i.jsx("button",{onClick:J=>N(B,J),className:"p-2 text-gray-500 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Modifier",children:i.jsx(Yc,{className:"h-4 w-4"})}),i.jsx("button",{onClick:J=>R(B,J),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Supprimer",children:i.jsx(La,{className:"h-4 w-4"})})]})]})},B.id))}),n.length>0&&w==="list"&&i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Immeuble"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Localisation"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Systme"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Propritaires"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Locataires"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(B=>i.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>e(`/immeubles/${B.id}`),children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center",children:i.jsx(fr,{className:"h-5 w-5 text-blue-600"})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:B.nom}),i.jsx("div",{className:"text-sm text-gray-500",children:B.fournisseur_eau||"N/A"})]})]})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm text-gray-900",children:B.ville}),i.jsx("div",{className:"text-sm text-gray-500",children:Y(B.region)})]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm text-gray-900",children:H(B.systeme_repartition)}),i.jsx("div",{className:"text-sm text-gray-500",children:B.total_milliemes})]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("button",{onClick:J=>V(B.id,J),className:"inline-flex items-center px-3 py-1 text-sm font-medium bg-purple-50 text-purple-700 hover:bg-purple-100 rounded-full transition-colors",children:[i.jsx(Vt,{className:"h-4 w-4 mr-1"}),B.proprietairesCount||0]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("button",{onClick:J=>K(B.id,J),className:"inline-flex items-center px-3 py-1 text-sm font-medium bg-green-50 text-green-700 hover:bg-green-100 rounded-full transition-colors",children:[i.jsx(Wl,{className:"h-4 w-4 mr-1"}),B.locatairesCount||0]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx("button",{onClick:()=>e(`/immeubles/${B.id}`),className:"text-primary-600 hover:text-primary-900 font-medium",children:"Grer "}),i.jsx("button",{onClick:J=>N(B,J),className:"text-primary-600 hover:text-primary-900",children:i.jsx(Yc,{className:"h-4 w-4"})}),i.jsx("button",{onClick:J=>R(B,J),className:"text-red-600 hover:text-red-900",children:i.jsx(La,{className:"h-4 w-4"})})]})})]},B.id))})]})})}),u&&i.jsx(lE,{immeuble:d,onClose:()=>{f(!1),h(null)},onSuccess:L}),y&&i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-red-100 flex items-center justify-center",children:i.jsx(st,{className:"h-6 w-6 text-red-600"})}),i.jsx("h3",{className:"ml-3 text-lg font-medium text-gray-900",children:"Confirmer la suppression"})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Cette action est ",i.jsx("strong",{children:"irrversible"}),". L'immeuble ",i.jsx("strong",{className:"text-gray-900",children:m==null?void 0:m.nom})," sera dfinitivement supprim."]}),i.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-3 mb-4",children:i.jsx("p",{className:"text-sm text-red-800 font-semibold",children:" Tous les propritaires et locataires associs seront galement supprims !"})}),i.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-3 mb-4",children:i.jsxs("p",{className:"text-sm text-yellow-700",children:["Pour confirmer, tapez : ",i.jsxs("strong",{children:["Effacer ",m==null?void 0:m.nom]})]})}),i.jsx("input",{type:"text",value:x,onChange:B=>v(B.target.value),placeholder:`Effacer ${m==null?void 0:m.nom}`,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500",autoFocus:!0})]}),i.jsxs("div",{className:"flex space-x-3",children:[i.jsx("button",{onClick:()=>{g(!1),p(null),v("")},className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Annuler"}),i.jsx("button",{onClick:j,disabled:x!==`Effacer ${m==null?void 0:m.nom}`,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Supprimer dfinitivement"})]})]})})]})}function Ya({children:e}){const{isAuthenticated:t,loading:r}=mo();return r?i.jsx("div",{className:"min-h-screen flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement..."})]})}):t?e:i.jsx(Mf,{to:"/login",replace:!0})}function cE(){var s,l;const{user:e,logout:t}=mo(),r=Kt(),n=()=>{t(),r("/login")},a=[{name:"Tableau de bord",to:"/dashboard",icon:Wl},{name:"Immeubles",to:"/immeubles",icon:fr},{name:"Propritaires",to:"/proprietaires",icon:Vt},{name:"Locataires",to:"/locataires",icon:Vk},{name:"Dcomptes",to:"/decomptes",icon:bs},{name:"Paramtres",to:"/settings",icon:Jk}];return i.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[i.jsx("div",{className:"hidden md:flex md:w-64 md:flex-col md:fixed md:inset-y-0",children:i.jsxs("div",{className:"flex flex-col flex-grow bg-white border-r border-gray-200 pt-5 pb-4 overflow-y-auto",children:[i.jsx("div",{className:"flex items-center flex-shrink-0 px-4 mb-6",children:i.jsx("h1",{className:"text-xl font-bold text-gray-900",children:" Copro Manager"})}),i.jsx("div",{className:"px-4 mb-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsxs("div",{className:"h-10 w-10 rounded-full bg-primary-600 flex items-center justify-center text-white font-semibold",children:[(s=e==null?void 0:e.firstName)==null?void 0:s[0],(l=e==null?void 0:e.lastName)==null?void 0:l[0]]})}),i.jsxs("div",{className:"ml-3",children:[i.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[e==null?void 0:e.firstName," ",e==null?void 0:e.lastName]}),i.jsx("p",{className:"text-xs text-gray-500",children:e==null?void 0:e.email})]})]})}),i.jsx("nav",{className:"flex-1 px-4 space-y-1",children:a.map(o=>i.jsxs(e_,{to:o.to,className:({isActive:c})=>`flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ${c?"bg-primary-600 text-white":"text-gray-700 hover:bg-gray-100"}`,children:[i.jsx(o.icon,{className:"mr-3 h-5 w-5"}),o.name]},o.name))}),i.jsx("div",{className:"px-4 pt-4 border-t border-gray-200",children:i.jsxs("button",{onClick:n,className:"flex items-center w-full px-4 py-3 text-sm font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[i.jsx(Kk,{className:"mr-3 h-5 w-5"}),"Dconnexion"]})})]})}),i.jsxs("div",{className:"md:pl-64 flex flex-col flex-1",children:[i.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:i.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex justify-between h-16 items-center",children:[i.jsx("h1",{className:"text-xl font-bold text-gray-900 md:hidden",children:" Copro Manager"}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("span",{className:"text-sm text-gray-700 hidden md:inline",children:[e==null?void 0:e.firstName," ",e==null?void 0:e.lastName]}),i.jsx("button",{onClick:n,className:"md:hidden px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md",children:"Dconnexion"})]})]})})}),i.jsx("main",{className:"flex-1",children:i.jsx("div",{className:"py-6",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsx(zN,{})})})})]})]})}function hh({proprietaire:e,immeubles:t,onClose:r,onSuccess:n}){const[a,s]=T.useState({immeubleId:"",typeProprietaire:"personne_physique",nom:"",prenom:"",email:"",telephone:"",adresse:"",numeroTva:"",partsCoproprietaire:"",milliemes:"",numeroCompteBancaire:""}),[l,o]=T.useState([]),[c,u]=T.useState(!1),[f,d]=T.useState(null);T.useEffect(()=>{if(e){s({immeubleId:e.immeuble_id||"",typeProprietaire:e.type_proprietaire||"personne_physique",nom:e.nom||"",prenom:e.prenom||"",email:e.email||"",telephone:e.telephone||"",adresse:e.adresse||"",numeroTva:e.numero_tva||"",partsCoproprietaire:e.parts_coproprietaire||"",milliemes:e.milliemes||"",numeroCompteBancaire:e.numero_compte_bancaire||""});const p=t.find(x=>x.id===e.immeuble_id);d(p)}else t.length>0&&(s(p=>({...p,immeubleId:t[0].id})),d(t[0]))},[e,t]);const h=p=>{const{name:x,value:v}=p.target;if(s(w=>({...w,[x]:v})),x==="immeubleId"){const w=t.find(b=>b.id===v);d(w),s(b=>({...b,partsCoproprietaire:"",milliemes:""}))}},y=()=>{const p=[];return a.immeubleId||p.push("L'immeuble est requis"),a.nom.trim()||p.push("Le nom est requis"),a.prenom.trim()||p.push("Le prnom est requis"),a.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)&&p.push("L'email n'est pas valide"),f&&((f.systeme_repartition||"milliemes")==="milliemes"?(!a.milliemes||parseFloat(a.milliemes)<=0)&&p.push("Les millimes sont requis et doivent tre suprieurs  0"):(!a.partsCoproprietaire||parseInt(a.partsCoproprietaire)<=0)&&p.push("Le nombre de parts est requis et doit tre suprieur  0")),a.numeroTva&&a.typeProprietaire==="personne_morale"&&(/^BE\s?0?\d{3}\.?\d{3}\.?\d{3}$/i.test(a.numeroTva)||p.push("Le numro de TVA belge doit tre au format BE 0XXX.XXX.XXX")),o(p),p.length===0},g=async p=>{var x,v;if(p.preventDefault(),!!y()){u(!0),o([]);try{const w={typeProprietaire:a.typeProprietaire,nom:a.nom.trim(),prenom:a.prenom.trim(),email:a.email.trim()||null,telephone:a.telephone.trim()||null,adresse:a.adresse.trim()||null,numeroTva:a.numeroTva.trim()||null,partsCoproprietaire:a.partsCoproprietaire?parseInt(a.partsCoproprietaire):null,milliemes:a.milliemes?parseFloat(a.milliemes):null,numeroCompteBancaire:a.numeroCompteBancaire.trim()||null};e?await Xr.update(a.immeubleId,e.id,w):await Xr.create(a.immeubleId,w),n()}catch(w){console.error("Error saving proprietaire:",w),(v=(x=w.response)==null?void 0:x.data)!=null&&v.errors?o(Array.isArray(w.response.data.errors)?w.response.data.errors:[w.response.data.message||"Erreur lors de l'enregistrement"]):o(["Erreur lors de l'enregistrement du propritaire"])}finally{u(!1)}}};if(t.length===0)return i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Aucun immeuble"}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:i.jsx(br,{className:"h-6 w-6"})})]}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Vous devez d'abord crer un immeuble avant d'ajouter des propritaires."}),i.jsx("button",{onClick:r,className:"w-full px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Fermer"})]})});const m=(f==null?void 0:f.systeme_repartition)||"milliemes";return i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full my-8",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Modifier le propritaire":"Ajouter un propritaire"}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(br,{className:"h-6 w-6"})})]}),i.jsxs("form",{onSubmit:g,className:"p-6",children:[l.length>0&&i.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx(st,{className:"h-5 w-5 text-red-400 mt-0.5"}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:l.length===1?"Erreur":`${l.length} erreurs`}),i.jsx("div",{className:"mt-2 text-sm text-red-700",children:i.jsx("ul",{className:"list-disc pl-5 space-y-1",children:l.map((p,x)=>i.jsx("li",{children:p},x))})})]})]})}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Informations gnrales"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"immeubleId",className:"block text-sm font-medium text-gray-700 mb-1",children:"Immeuble *"}),i.jsx("select",{id:"immeubleId",name:"immeubleId",required:!0,value:a.immeubleId,onChange:h,disabled:!!e,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-gray-100",children:t.map(p=>i.jsx("option",{value:p.id,children:p.nom},p.id))}),e&&i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"L'immeuble ne peut pas tre modifi aprs cration"}),f&&i.jsxs("p",{className:"mt-1 text-xs text-primary-600",children:["Systme: ",m==="milliemes"?"Millimes":"Parts"]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"typeProprietaire",className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de propritaire *"}),i.jsxs("select",{id:"typeProprietaire",name:"typeProprietaire",required:!0,value:a.typeProprietaire,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[i.jsx("option",{value:"personne_physique",children:"Personne physique"}),i.jsx("option",{value:"personne_morale",children:"Personne morale (Socit)"})]})]})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:a.typeProprietaire==="personne_morale"?"Informations socit":"Informations personnelles"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"prenom",className:"block text-sm font-medium text-gray-700 mb-1",children:[a.typeProprietaire==="personne_morale"?"Reprsentant (prnom)":"Prnom"," *"]}),i.jsx("input",{type:"text",id:"prenom",name:"prenom",required:!0,value:a.prenom,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:(a.typeProprietaire==="personne_morale","Jean")})]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"nom",className:"block text-sm font-medium text-gray-700 mb-1",children:[a.typeProprietaire==="personne_morale"?"Nom socit":"Nom"," *"]}),i.jsx("input",{type:"text",id:"nom",name:"nom",required:!0,value:a.nom,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:a.typeProprietaire==="personne_morale"?"Immo Solutions SA":"Dupont"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",id:"email",name:"email",value:a.email,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"contact@example.com"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"telephone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tlphone"}),i.jsx("input",{type:"tel",id:"telephone",name:"telephone",value:a.telephone,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"0472 123 456"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"adresse",className:"block text-sm font-medium text-gray-700 mb-1",children:"Adresse complte"}),i.jsx("textarea",{id:"adresse",name:"adresse",rows:"2",value:a.adresse,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Rue de la Loi 123, 1000 Bruxelles"})]}),a.typeProprietaire==="personne_morale"&&i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"numeroTva",className:"block text-sm font-medium text-gray-700 mb-1",children:"Numro de TVA (optionnel)"}),i.jsx("input",{type:"text",id:"numeroTva",name:"numeroTva",value:a.numeroTva,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"BE 0123.456.789"}),i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Format belge : BE 0XXX.XXX.XXX"})]})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Informations de coproprit"}),i.jsx("div",{className:"grid grid-cols-1 gap-4",children:m==="milliemes"?i.jsxs("div",{children:[i.jsx("label",{htmlFor:"milliemes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Quote-part (millimes) *"}),i.jsx("input",{type:"number",id:"milliemes",name:"milliemes",min:"0",step:"0.01",required:!0,value:a.milliemes,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: 250.50"}),i.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Quote-part dans les charges communes (sur ",(f==null?void 0:f.total_milliemes)||1e3," millimes)"]})]}):i.jsxs("div",{children:[i.jsx("label",{htmlFor:"partsCoproprietaire",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de parts *"}),i.jsx("input",{type:"number",id:"partsCoproprietaire",name:"partsCoproprietaire",min:"0",step:"1",required:!0,value:a.partsCoproprietaire,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: 100"}),i.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Nombre de parts possdes (sur ",(f==null?void 0:f.total_milliemes)||1e3," parts au total)"]})]})})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Informations bancaires (optionnel)"}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"numeroCompteBancaire",className:"block text-sm font-medium text-gray-700 mb-1",children:"Numro de compte bancaire (IBAN)"}),i.jsx("input",{type:"text",id:"numeroCompteBancaire",name:"numeroCompteBancaire",value:a.numeroCompteBancaire,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"BE68 5390 0754 7034"})]})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200",children:[i.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),i.jsx("button",{type:"submit",disabled:c,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Enregistrement..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Hn,{className:"h-4 w-4 mr-2"}),e?"Mettre  jour":"Crer"]})})]})]})]})})}function uE(){const e=Ha(),[t,r]=T.useState([]),[n,a]=T.useState([]),[s,l]=T.useState("all"),[o,c]=T.useState(!0),[u,f]=T.useState(""),[d,h]=T.useState(!1),[y,g]=T.useState(null),[m,p]=T.useState(!1),[x,v]=T.useState(null),[w,b]=T.useState("");T.useEffect(()=>{var Y;_(),(Y=e.state)!=null&&Y.selectedImmeuble&&l(e.state.selectedImmeuble)},[e.state]);const _=async()=>{try{c(!0),f("");const H=(await Lr.getAll()).data.immeubles||[];a(H);const B=[];for(const J of H)try{const le=((await Xr.getByImmeuble(J.id)).data.proprietaires||[]).map(G=>({...G,immeuble_nom:J.nom,immeuble_systeme:J.systeme_repartition||"milliemes"}));B.push(...le)}catch(ue){console.error(`Error loading proprietaires for immeuble ${J.id}:`,ue)}r(B)}catch(Y){console.error("Error loading data:",Y),f("Erreur lors du chargement des donnes")}finally{c(!1)}},E=()=>{g(null),h(!0)},N=Y=>{g(Y),h(!0)},R=Y=>{v(Y),b(""),p(!0)},j=async()=>{if(!x)return;const Y=`Effacer ${x.prenom} ${x.nom}`;if(w===Y)try{await Xr.delete(x.immeuble_id,x.id),r(t.filter(H=>H.id!==x.id)),p(!1),v(null),b("")}catch(H){console.error("Error deleting proprietaire:",H),f("Erreur lors de la suppression"),b("")}},L=()=>{h(!1),g(null),_()},V=Y=>Y==="personne_physique"?"Personne physique":"Personne morale",K=s==="all"?t:t.filter(Y=>Y.immeuble_id===s);return o?i.jsx("div",{className:"flex items-center justify-center min-h-96",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement..."})]})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Propritaires"}),i.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Grez les propritaires de vos immeubles"})]}),i.jsxs("button",{onClick:E,className:"flex items-center justify-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[i.jsx(Gt,{className:"h-5 w-5 mr-2"}),"Ajouter un propritaire"]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[i.jsx("label",{htmlFor:"immeuble-filter",className:"block text-sm font-medium text-gray-700 mb-2",children:"Filtrer par immeuble"}),i.jsxs("select",{id:"immeuble-filter",value:s,onChange:Y=>l(Y.target.value),className:"w-full sm:w-64 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[i.jsx("option",{value:"all",children:"Tous les immeubles"}),n.map(Y=>{const H=t.filter(B=>B.immeuble_id===Y.id).length;return i.jsxs("option",{value:Y.id,children:[Y.nom," (",H,")"]},Y.id)})]})]}),u&&i.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[i.jsx(st,{className:"h-5 w-5 mr-2"}),u]}),K.length===0&&!o&&i.jsx("div",{className:"bg-white rounded-lg shadow-sm border-2 border-dashed border-gray-300 p-12",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Vt,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun propritaire"}),i.jsx("p",{className:"text-gray-600 mb-6",children:s==="all"?"Commencez par ajouter votre premier propritaire":"Aucun propritaire pour cet immeuble"}),i.jsxs("button",{onClick:E,className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[i.jsx(Gt,{className:"h-5 w-5 mr-2"}),"Ajouter un propritaire"]})]})}),K.length>0&&i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:K.map(Y=>i.jsx("div",{className:"bg-white rounded-lg shadow hover:shadow-md transition-shadow border border-gray-200",children:i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"flex items-start justify-between mb-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:Y.type_proprietaire==="personne_morale"?i.jsx(Uk,{className:"h-6 w-6 text-purple-600"}):i.jsx(Vt,{className:"h-6 w-6 text-purple-600"})}),i.jsxs("div",{className:"ml-3",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[Y.prenom," ",Y.nom]}),i.jsx("span",{className:"text-xs text-gray-500",children:V(Y.type_proprietaire)})]})]})}),i.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-3",children:[i.jsx(fr,{className:"h-4 w-4 mr-2 text-gray-400"}),Y.immeuble_nom]}),i.jsxs("div",{className:"space-y-2 mb-4 pb-4 border-b border-gray-200",children:[Y.email&&i.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[i.jsx(bi,{className:"h-4 w-4 mr-2 text-gray-400"}),i.jsx("span",{className:"truncate",children:Y.email})]}),Y.telephone&&i.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[i.jsx(Ni,{className:"h-4 w-4 mr-2 text-gray-400"}),Y.telephone]}),Y.adresse&&i.jsxs("div",{className:"flex items-start text-sm text-gray-600",children:[i.jsx(M0,{className:"h-4 w-4 mr-2 mt-0.5 text-gray-400 flex-shrink-0"}),i.jsx("span",{className:"line-clamp-2",children:Y.adresse})]})]}),i.jsx("div",{className:"grid grid-cols-2 gap-4 mb-4",children:Y.immeuble_systeme==="milliemes"?i.jsxs("div",{className:"col-span-2",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Quote-part (millimes)"}),i.jsx("p",{className:"text-sm font-semibold text-gray-900",children:Y.milliemes||0})]}):i.jsxs("div",{className:"col-span-2",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Parts"}),i.jsx("p",{className:"text-sm font-semibold text-gray-900",children:Y.parts_coproprietaire||0})]})}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:()=>N(Y),className:"flex-1 flex items-center justify-center px-3 py-2 text-sm font-medium text-primary-600 bg-primary-50 hover:bg-primary-100 rounded-lg transition-colors",children:[i.jsx(Yc,{className:"h-4 w-4 mr-1"}),"Modifier"]}),i.jsx("button",{onClick:()=>R(Y),className:"flex items-center justify-center px-3 py-2 text-sm font-medium text-red-600 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:i.jsx(La,{className:"h-4 w-4"})})]})]})},Y.id))}),d&&i.jsx(hh,{proprietaire:y,immeubles:n,onClose:()=>{h(!1),g(null)},onSuccess:L}),m&&i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-red-100 flex items-center justify-center",children:i.jsx(st,{className:"h-6 w-6 text-red-600"})}),i.jsx("h3",{className:"ml-3 text-lg font-medium text-gray-900",children:"Confirmer la suppression"})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Cette action est ",i.jsx("strong",{children:"irrversible"}),". Le propritaire ",i.jsxs("strong",{className:"text-gray-900",children:[x==null?void 0:x.prenom," ",x==null?void 0:x.nom]})," sera dfinitivement supprim."]}),i.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-3 mb-4",children:i.jsx("p",{className:"text-sm text-red-800 font-semibold",children:" Attention : Tous les locataires associs seront galement supprims !"})}),i.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-3 mb-4",children:i.jsxs("p",{className:"text-sm text-yellow-700",children:["Pour confirmer, tapez : ",i.jsxs("strong",{children:["Effacer ",x==null?void 0:x.prenom," ",x==null?void 0:x.nom]})]})}),i.jsx("input",{type:"text",value:w,onChange:Y=>b(Y.target.value),placeholder:`Effacer ${x==null?void 0:x.prenom} ${x==null?void 0:x.nom}`,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500",autoFocus:!0})]}),i.jsxs("div",{className:"flex space-x-3",children:[i.jsx("button",{onClick:()=>{p(!1),v(null),b("")},className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Annuler"}),i.jsx("button",{onClick:j,disabled:w!==`Effacer ${x==null?void 0:x.prenom} ${x==null?void 0:x.nom}`,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Supprimer dfinitivement"})]})]})})]})}function mh({locataire:e,immeubles:t,onClose:r,onSuccess:n}){const[a,s]=T.useState({immeubleId:"",proprietaireId:"",nom:"",prenom:"",email:"",telephone:"",appartement:"",dateDebutBail:"",dateFinBail:"",loyerMensuel:"",chargesMensuelles:"",quotePartMilliemes:""}),[l,o]=T.useState([]),[c,u]=T.useState(!1),[f,d]=T.useState([]),[h,y]=T.useState(!1);T.useEffect(()=>{e?(s({immeubleId:e.immeuble_id||"",proprietaireId:e.proprietaire_id||"",nom:e.nom||"",prenom:e.prenom||"",email:e.email||"",telephone:e.telephone||"",appartement:e.appartement||"",dateDebutBail:e.date_debut_bail?e.date_debut_bail.split("T")[0]:"",dateFinBail:e.date_fin_bail?e.date_fin_bail.split("T")[0]:"",loyerMensuel:e.loyer_mensuel||"",chargesMensuelles:e.charges_mensuelles||"",quotePartMilliemes:e.quote_part_milliemes||""}),e.immeuble_id&&g(e.immeuble_id)):t.length>0&&(s(v=>({...v,immeubleId:t[0].id})),g(t[0].id))},[e,t]);const g=async v=>{try{y(!0);const b=(await Xr.getByImmeuble(v)).data.proprietaires||[];d(b),b.length>0&&!a.proprietaireId&&s(_=>({..._,proprietaireId:b[0].id}))}catch(w){console.error("Error loading proprietaires:",w)}finally{y(!1)}},m=v=>{const{name:w,value:b}=v.target;s(_=>({..._,[w]:b})),w==="immeubleId"&&(g(b),s(_=>({..._,proprietaireId:""})))},p=()=>{const v=[];if(a.immeubleId||v.push("L'immeuble est requis"),a.proprietaireId||v.push("Le propritaire est requis"),a.nom.trim()||v.push("Le nom est requis"),a.prenom.trim()||v.push("Le prnom est requis"),a.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)&&v.push("L'email n'est pas valide"),a.dateDebutBail||v.push("La date d'entre est requise"),a.dateFinBail&&a.dateDebutBail){const w=new Date(a.dateDebutBail);new Date(a.dateFinBail)<=w&&v.push("La date de sortie doit tre aprs la date d'entre")}return a.loyerMensuel&&parseFloat(a.loyerMensuel)<0&&v.push("Le loyer ne peut pas tre ngatif"),a.chargesMensuelles&&parseFloat(a.chargesMensuelles)<0&&v.push("Les charges ne peuvent pas tre ngatives"),a.quotePartMilliemes&&parseFloat(a.quotePartMilliemes)<0&&v.push("La quote-part ne peut pas tre ngative"),o(v),v.length===0},x=async v=>{var w,b;if(v.preventDefault(),!!p()){u(!0),o([]);try{const _={proprietaireId:a.proprietaireId,nom:a.nom.trim(),prenom:a.prenom.trim(),email:a.email.trim()||null,telephone:a.telephone.trim()||null,appartement:a.appartement.trim()||null,dateDebutBail:a.dateDebutBail,dateFinBail:a.dateFinBail||null,loyerMensuel:a.loyerMensuel?parseFloat(a.loyerMensuel):null,chargesMensuelles:a.chargesMensuelles?parseFloat(a.chargesMensuelles):null,quotePartMilliemes:a.quotePartMilliemes?parseFloat(a.quotePartMilliemes):null};e?await Oa.update(a.immeubleId,e.id,_):await Oa.create(a.immeubleId,_),n()}catch(_){console.error("Error saving locataire:",_),(b=(w=_.response)==null?void 0:w.data)!=null&&b.errors?o(Array.isArray(_.response.data.errors)?_.response.data.errors:[_.response.data.message||"Erreur lors de l'enregistrement"]):o([_.message||"Erreur lors de l'enregistrement du locataire"])}finally{u(!1)}}};return t.length===0?i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Aucun immeuble"}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:i.jsx(br,{className:"h-6 w-6"})})]}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Vous devez d'abord crer un immeuble avant d'ajouter des locataires."}),i.jsx("button",{onClick:r,className:"w-full px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Fermer"})]})}):i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full my-8",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Modifier le locataire":"Ajouter un locataire"}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(br,{className:"h-6 w-6"})})]}),i.jsxs("form",{onSubmit:x,className:"p-6",children:[l.length>0&&i.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx(st,{className:"h-5 w-5 text-red-400 mt-0.5"}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:l.length===1?"Erreur":`${l.length} erreurs`}),i.jsx("div",{className:"mt-2 text-sm text-red-700",children:i.jsx("ul",{className:"list-disc pl-5 space-y-1",children:l.map((v,w)=>i.jsx("li",{children:v},w))})})]})]})}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Immeuble et propritaire"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"immeubleId",className:"block text-sm font-medium text-gray-700 mb-1",children:"Immeuble *"}),i.jsx("select",{id:"immeubleId",name:"immeubleId",required:!0,value:a.immeubleId,onChange:m,disabled:!!e,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-gray-100",children:t.map(v=>i.jsx("option",{value:v.id,children:v.nom},v.id))}),e&&i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"L'immeuble ne peut pas tre modifi aprs cration"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"proprietaireId",className:"block text-sm font-medium text-gray-700 mb-1",children:"Propritaire *"}),i.jsx("select",{id:"proprietaireId",name:"proprietaireId",required:!0,value:a.proprietaireId,onChange:m,disabled:h||f.length===0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-gray-100",children:h?i.jsx("option",{children:"Chargement..."}):f.length===0?i.jsx("option",{children:"Aucun propritaire disponible"}):f.map(v=>i.jsxs("option",{value:v.id,children:[v.prenom," ",v.nom]},v.id))}),f.length===0&&!h&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:"Crez d'abord un propritaire pour cet immeuble"})]})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Informations personnelles"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"prenom",className:"block text-sm font-medium text-gray-700 mb-1",children:"Prnom *"}),i.jsx("input",{type:"text",id:"prenom",name:"prenom",required:!0,value:a.prenom,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: Jean"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"nom",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom *"}),i.jsx("input",{type:"text",id:"nom",name:"nom",required:!0,value:a.nom,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: Dupont"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",id:"email",name:"email",value:a.email,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"jean.dupont@example.com"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"telephone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tlphone"}),i.jsx("input",{type:"tel",id:"telephone",name:"telephone",value:a.telephone,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"0472 123 456"})]})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Informations de location"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"appartement",className:"block text-sm font-medium text-gray-700 mb-1",children:"Appartement / Lot"}),i.jsx("input",{type:"text",id:"appartement",name:"appartement",value:a.appartement,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: A12, 3me tage"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"quotePartMilliemes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Quote-part (millimes)"}),i.jsx("input",{type:"number",id:"quotePartMilliemes",name:"quotePartMilliemes",min:"0",step:"0.01",value:a.quotePartMilliemes,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: 50"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"dateDebutBail",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date d'entre *"}),i.jsx("input",{type:"date",id:"dateDebutBail",name:"dateDebutBail",required:!0,value:a.dateDebutBail,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"dateFinBail",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de sortie (optionnelle)"}),i.jsx("input",{type:"date",id:"dateFinBail",name:"dateFinBail",value:a.dateFinBail,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Informations financires"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"loyerMensuel",className:"block text-sm font-medium text-gray-700 mb-1",children:"Loyer mensuel ()"}),i.jsx("input",{type:"number",id:"loyerMensuel",name:"loyerMensuel",min:"0",step:"0.01",value:a.loyerMensuel,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: 850.00"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"chargesMensuelles",className:"block text-sm font-medium text-gray-700 mb-1",children:"Charges mensuelles ()"}),i.jsx("input",{type:"number",id:"chargesMensuelles",name:"chargesMensuelles",min:"0",step:"0.01",value:a.chargesMensuelles,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: 150.00"})]})]})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200",children:[i.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),i.jsx("button",{type:"submit",disabled:c||f.length===0,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Enregistrement..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Hn,{className:"h-4 w-4 mr-2"}),e?"Mettre  jour":"Crer"]})})]})]})]})})}function fE(){const e=Ha(),[t,r]=T.useState([]),[n,a]=T.useState([]),[s,l]=T.useState("all"),[o,c]=T.useState(!0),[u,f]=T.useState(""),[d,h]=T.useState(!1),[y,g]=T.useState(null),[m,p]=T.useState(!1),[x,v]=T.useState(null),[w,b]=T.useState("");T.useEffect(()=>{var H;_(),(H=e.state)!=null&&H.selectedImmeuble&&l(e.state.selectedImmeuble)},[e.state]);const _=async()=>{try{c(!0),f("");const H=await Lr.getAll();a(H.data.immeubles||[]);const B=[];for(const J of H.data.immeubles||[])try{const le=((await Oa.getByImmeuble(J.id)).data.locataires||[]).map(G=>({...G,immeuble_nom:J.nom}));B.push(...le)}catch(ue){console.error(`Error loading locataires for immeuble ${J.id}:`,ue)}r(B)}catch(H){console.error("Error loading data:",H),f("Erreur lors du chargement des donnes")}finally{c(!1)}},E=()=>{g(null),h(!0)},N=H=>{g(H),h(!0)},R=H=>{v(H),b(""),p(!0)},j=async()=>{if(!x)return;const H=`Effacer ${x.prenom} ${x.nom}`;if(w===H)try{await Oa.delete(x.immeuble_id,x.id),r(t.filter(B=>B.id!==x.id)),p(!1),v(null),b("")}catch(B){console.error("Error deleting locataire:",B),f("Erreur lors de la suppression"),b("")}},L=()=>{h(!1),g(null),_()},V=H=>H.date_fin_bail?new Date(H.date_fin_bail)>new Date:!0,K=H=>H?new Date(H).toLocaleDateString("fr-FR"):"N/A",Y=s==="all"?t:t.filter(H=>H.immeuble_id===s);return o?i.jsx("div",{className:"flex items-center justify-center min-h-96",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement..."})]})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Locataires"}),i.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Grez vos locataires et leurs baux"})]}),i.jsxs("button",{onClick:E,className:"flex items-center justify-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[i.jsx(Gt,{className:"h-5 w-5 mr-2"}),"Ajouter un locataire"]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[i.jsx("label",{htmlFor:"immeuble-filter",className:"block text-sm font-medium text-gray-700 mb-2",children:"Filtrer par immeuble"}),i.jsxs("select",{id:"immeuble-filter",value:s,onChange:H=>l(H.target.value),className:"w-full sm:w-64 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[i.jsx("option",{value:"all",children:"Tous les immeubles"}),n.map(H=>{const B=t.filter(J=>J.immeuble_id===H.id).length;return i.jsxs("option",{value:H.id,children:[H.nom," (",B,")"]},H.id)})]})]}),u&&i.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[i.jsx(st,{className:"h-5 w-5 mr-2"}),u]}),Y.length===0&&!o&&i.jsx("div",{className:"bg-white rounded-lg shadow-sm border-2 border-dashed border-gray-300 p-12",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Vt,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun locataire"}),i.jsx("p",{className:"text-gray-600 mb-6",children:s==="all"?"Commencez par ajouter votre premier locataire":"Aucun locataire pour cet immeuble"}),i.jsxs("button",{onClick:E,className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[i.jsx(Gt,{className:"h-5 w-5 mr-2"}),"Ajouter un locataire"]})]})}),Y.length>0&&i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Locataire"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Immeuble"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priode"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Loyer"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Y.map(H=>{var B,J;return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center",children:i.jsxs("span",{className:"text-primary-600 font-semibold",children:[(B=H.prenom)==null?void 0:B[0],(J=H.nom)==null?void 0:J[0]]})}),i.jsxs("div",{className:"ml-4",children:[i.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[H.prenom," ",H.nom]}),i.jsxs("div",{className:"text-sm text-gray-500",children:["Appt ",H.appartement||"N/A"]})]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[i.jsx(fr,{className:"h-4 w-4 mr-2 text-gray-400"}),H.immeuble_nom]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm text-gray-900 space-y-1",children:[H.email&&i.jsxs("div",{className:"flex items-center",children:[i.jsx(bi,{className:"h-3 w-3 mr-2 text-gray-400"}),H.email]}),H.telephone&&i.jsxs("div",{className:"flex items-center",children:[i.jsx(Ni,{className:"h-3 w-3 mr-2 text-gray-400"}),H.telephone]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm text-gray-900 space-y-1",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(fn,{className:"h-3 w-3 mr-2 text-gray-400"}),K(H.date_debut_bail)]}),H.date_fin_bail&&i.jsxs("div",{className:"flex items-center text-gray-500",children:[i.jsx(fn,{className:"h-3 w-3 mr-2 text-gray-400"}),K(H.date_fin_bail)]})]})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm text-gray-900",children:H.loyer_mensuel?`${H.loyer_mensuel}`:"N/A"}),H.charges_mensuelles>0&&i.jsxs("div",{className:"text-xs text-gray-500",children:["+ ",H.charges_mensuelles," charges"]})]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V(H)?i.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"Actif"}):i.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:"Inactif"})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:i.jsxs("div",{className:"flex justify-end space-x-2",children:[i.jsx("button",{onClick:()=>N(H),className:"text-primary-600 hover:text-primary-900",children:i.jsx(Yc,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>R(H),className:"text-red-600 hover:text-red-900",children:i.jsx(La,{className:"h-4 w-4"})})]})})]},H.id)})})]})})}),d&&i.jsx(mh,{locataire:y,immeubles:n,onClose:()=>{h(!1),g(null)},onSuccess:L}),m&&i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-red-100 flex items-center justify-center",children:i.jsx(st,{className:"h-6 w-6 text-red-600"})}),i.jsx("h3",{className:"ml-3 text-lg font-medium text-gray-900",children:"Confirmer la suppression"})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Cette action est ",i.jsx("strong",{children:"irrversible"}),". Le locataire ",i.jsxs("strong",{className:"text-gray-900",children:[x==null?void 0:x.prenom," ",x==null?void 0:x.nom]})," sera dfinitivement supprim."]}),i.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-3 mb-4",children:i.jsxs("p",{className:"text-sm text-yellow-700",children:["Pour confirmer, tapez : ",i.jsxs("strong",{children:["Effacer ",x==null?void 0:x.prenom," ",x==null?void 0:x.nom]})]})}),i.jsx("input",{type:"text",value:w,onChange:H=>b(H.target.value),placeholder:`Effacer ${x==null?void 0:x.prenom} ${x==null?void 0:x.nom}`,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500",autoFocus:!0})]}),i.jsxs("div",{className:"flex space-x-3",children:[i.jsx("button",{onClick:()=>{p(!1),v(null),b("")},className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Annuler"}),i.jsx("button",{onClick:j,disabled:w!==`Effacer ${x==null?void 0:x.prenom} ${x==null?void 0:x.nom}`,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Supprimer dfinitivement"})]})]})})]})}function dE({immeubles:e,onClose:t,onSuccess:r}){const[n,a]=T.useState({immeubleId:"",annee:new Date().getFullYear(),periodeDebut:`${new Date().getFullYear()}-01-01`,periodeFin:`${new Date().getFullYear()}-12-31`,typeComptage:"divisionnaire",tarifEauId:""}),[s,l]=T.useState([]),[o,c]=T.useState([]),[u,f]=T.useState(!1),[d,h]=T.useState(!0);T.useEffect(()=>{y(),e.length>0&&a(x=>({...x,immeubleId:e[0].id,typeComptage:e[0].mode_comptage_eau||"divisionnaire"}))},[e]);const y=async()=>{try{h(!0);const x=await Pk.getAll();l(x.data.tarifs||[]),x.data.tarifs.length>0&&a(v=>({...v,tarifEauId:x.data.tarifs[0].id}))}catch(x){console.error("Error loading tarifs:",x)}finally{h(!1)}},g=x=>{const{name:v,value:w}=x.target;if(a(b=>({...b,[v]:w})),v==="immeubleId"){const b=e.find(_=>_.id===w);b&&a(_=>({..._,typeComptage:b.mode_comptage_eau||"divisionnaire"}))}v==="annee"&&a(b=>({...b,periodeDebut:`${w}-01-01`,periodeFin:`${w}-12-31`}))},m=()=>{const x=[];if(n.immeubleId||x.push("L'immeuble est requis"),n.annee||x.push("L'anne est requise"),n.periodeDebut||x.push("La date de dbut est requise"),n.periodeFin||x.push("La date de fin est requise"),n.periodeFin&&n.periodeDebut){const v=new Date(n.periodeDebut);new Date(n.periodeFin)<=v&&x.push("La date de fin doit tre aprs la date de dbut")}return n.tarifEauId||x.push("Le tarif d'eau est requis"),c(x),x.length===0},p=async x=>{var v,w,b,_;if(x.preventDefault(),!!m()){f(!0),c([]);try{await $l.create(n),r()}catch(E){console.error("Error creating decompte:",E),(w=(v=E.response)==null?void 0:v.data)!=null&&w.errors?c(Array.isArray(E.response.data.errors)?E.response.data.errors:[E.response.data.message||"Erreur lors de la cration"]):c([((_=(b=E.response)==null?void 0:b.data)==null?void 0:_.message)||"Erreur lors de la cration du dcompte"])}finally{f(!1)}}};return e.length===0?i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Aucun immeuble"}),i.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:i.jsx(br,{className:"h-6 w-6"})})]}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Vous devez d'abord crer un immeuble avant d'ajouter des dcomptes."}),i.jsx("button",{onClick:t,className:"w-full px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Fermer"})]})}):i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full my-8",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Nouveau dcompte"}),i.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(br,{className:"h-6 w-6"})})]}),i.jsxs("form",{onSubmit:p,className:"p-6",children:[o.length>0&&i.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx(st,{className:"h-5 w-5 text-red-400 mt-0.5"}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:o.length===1?"Erreur":`${o.length} erreurs`}),i.jsx("div",{className:"mt-2 text-sm text-red-700",children:i.jsx("ul",{className:"list-disc pl-5 space-y-1",children:o.map((x,v)=>i.jsx("li",{children:x},v))})})]})]})}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Informations gnrales"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"immeubleId",className:"block text-sm font-medium text-gray-700 mb-1",children:"Immeuble *"}),i.jsx("select",{id:"immeubleId",name:"immeubleId",required:!0,value:n.immeubleId,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:e.map(x=>i.jsx("option",{value:x.id,children:x.nom},x.id))})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"annee",className:"block text-sm font-medium text-gray-700 mb-1",children:"Anne *"}),i.jsx("input",{type:"number",id:"annee",name:"annee",required:!0,min:"2020",max:"2099",value:n.annee,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Priode du dcompte"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"periodeDebut",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de dbut *"}),i.jsx("input",{type:"date",id:"periodeDebut",name:"periodeDebut",required:!0,value:n.periodeDebut,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"periodeFin",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de fin *"}),i.jsx("input",{type:"date",id:"periodeFin",name:"periodeFin",required:!0,value:n.periodeFin,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Configuration eau"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"typeComptage",className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de comptage *"}),i.jsxs("select",{id:"typeComptage",name:"typeComptage",required:!0,value:n.typeComptage,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[i.jsx("option",{value:"collectif",children:"Collectif (1 compteur)"}),i.jsx("option",{value:"divisionnaire",children:"Divisionnaire (compteurs individuels)"}),i.jsx("option",{value:"individuel",children:"Individuel (facturation directe)"})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"tarifEauId",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tarif d'eau *"}),i.jsx("select",{id:"tarifEauId",name:"tarifEauId",required:!0,value:n.tarifEauId,onChange:g,disabled:d,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-gray-100",children:d?i.jsx("option",{children:"Chargement..."}):s.length===0?i.jsx("option",{children:"Aucun tarif disponible"}):s.map(x=>i.jsx("option",{value:x.id,children:x.nom},x.id))}),s.length===0&&!d&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:"Aucun tarif configur. Veuillez d'abord crer un tarif."})]})]})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200",children:[i.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),i.jsx("button",{type:"submit",disabled:u||s.length===0,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Cration..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Hn,{className:"h-4 w-4 mr-2"}),"Crer le dcompte"]})})]})]})]})})}function hE(){const e=Kt(),[t,r]=T.useState([]),[n,a]=T.useState([]),[s,l]=T.useState(!0),[o,c]=T.useState(""),[u,f]=T.useState(!1),[d,h]=T.useState("all"),[y,g]=T.useState("all");T.useEffect(()=>{m()},[]);const m=async()=>{try{l(!0),c("");const[j,L]=await Promise.all([$l.getAll(),Lr.getAll()]);r(j.data.decomptes||[]),a(L.data.immeubles||[])}catch(j){console.error("Error loading data:",j),c("Erreur lors du chargement des donnes")}finally{l(!1)}},p=[...new Set(t.map(j=>j.annee))].sort((j,L)=>L-j),x=new Date().getFullYear(),v=p.includes(x)?p:[x,...p].sort((j,L)=>L-j),w=t.filter(j=>!(d!=="all"&&j.annee!==parseInt(d)||y!=="all"&&j.immeuble_id!==y)),b=w.reduce((j,L)=>(j[L.annee]||(j[L.annee]=[]),j[L.annee].push(L),j),{}),_=()=>{f(!0)},E=()=>{f(!1),m()},N=j=>{const L={brouillon:{label:"Brouillon",color:"bg-gray-100 text-gray-800",icon:Lx},calcule:{label:"Calcul",color:"bg-blue-100 text-blue-800",icon:wc},valide:{label:"Valid",color:"bg-green-100 text-green-800",icon:jn},cloture:{label:"Cltur",color:"bg-purple-100 text-purple-800",icon:bc}},V=L[j]||L.brouillon,K=V.icon;return i.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${V.color}`,children:[i.jsx(K,{className:"h-3 w-3 mr-1"}),V.label]})},R=j=>{const L=v.indexOf(parseInt(d));j==="prev"&&L<v.length-1?h(v[L+1].toString()):j==="next"&&L>0&&h(v[L-1].toString())};return s?i.jsx("div",{className:"flex items-center justify-center min-h-96",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement..."})]})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dcomptes de charges"}),i.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Grez vos dcomptes annuels et rpartitions"})]}),i.jsxs("button",{onClick:_,className:"flex items-center justify-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[i.jsx(Gt,{className:"h-5 w-5 mr-2"}),"Nouveau dcompte"]})]}),o&&i.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[i.jsx(st,{className:"h-5 w-5 mr-2"}),o]}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Gk,{className:"h-5 w-5 text-gray-400"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filtres :"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>R("prev"),disabled:d==="all"||v.indexOf(parseInt(d))===v.length-1,className:"p-1 rounded hover:bg-gray-100 disabled:opacity-30 disabled:cursor-not-allowed",children:i.jsx(Wk,{className:"h-5 w-5"})}),i.jsxs("select",{value:d,onChange:j=>h(j.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[i.jsx("option",{value:"all",children:"Toutes les annes"}),v.map(j=>i.jsx("option",{value:j,children:j},j))]}),i.jsx("button",{onClick:()=>R("next"),disabled:d==="all"||v.indexOf(parseInt(d))===0,className:"p-1 rounded hover:bg-gray-100 disabled:opacity-30 disabled:cursor-not-allowed",children:i.jsx(ml,{className:"h-5 w-5"})})]}),i.jsxs("select",{value:y,onChange:j=>g(j.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[i.jsx("option",{value:"all",children:"Tous les immeubles"}),n.map(j=>i.jsx("option",{value:j.id,children:j.nom},j.id))]}),i.jsx("div",{className:"flex gap-2 ml-auto",children:[x-1,x,x+1].map(j=>i.jsx("button",{onClick:()=>h(j.toString()),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${d===j.toString()?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:j},j))})]})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Total dcomptes"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w.length})]}),i.jsx(bs,{className:"h-8 w-8 text-gray-300"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Brouillons"}),i.jsx("p",{className:"text-2xl font-bold text-gray-600",children:w.filter(j=>j.statut==="brouillon").length})]}),i.jsx(Lx,{className:"h-8 w-8 text-gray-300"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Calculs"}),i.jsx("p",{className:"text-2xl font-bold text-blue-600",children:w.filter(j=>j.statut==="calcule").length})]}),i.jsx(wc,{className:"h-8 w-8 text-blue-200"})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Valids/Clturs"}),i.jsx("p",{className:"text-2xl font-bold text-green-600",children:w.filter(j=>["valide","cloture"].includes(j.statut)).length})]}),i.jsx(jn,{className:"h-8 w-8 text-green-200"})]})})]}),w.length===0&&!s&&i.jsx("div",{className:"bg-white rounded-lg shadow-sm border-2 border-dashed border-gray-300 p-12",children:i.jsxs("div",{className:"text-center",children:[i.jsx(wc,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t.length===0?"Aucun dcompte":"Aucun dcompte pour ce filtre"}),i.jsx("p",{className:"text-gray-600 mb-6",children:t.length===0?"Crez votre premier dcompte annuel":"Modifiez vos filtres ou crez un nouveau dcompte"}),i.jsxs("button",{onClick:_,className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[i.jsx(Gt,{className:"h-5 w-5 mr-2"}),"Nouveau dcompte"]})]})}),Object.keys(b).sort((j,L)=>L-j).map(j=>i.jsxs("div",{className:"space-y-4",children:[d==="all"&&i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-primary-100 text-primary-700 rounded-full",children:[i.jsx(fn,{className:"h-4 w-4"}),i.jsx("span",{className:"font-semibold",children:j})]}),i.jsx("div",{className:"flex-1 h-px bg-gray-200"}),i.jsxs("span",{className:"text-sm text-gray-500",children:[b[j].length," dcompte",b[j].length>1?"s":""]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Anne"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Immeuble"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priode"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tarif"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b[j].map(L=>i.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>e(`/decomptes/${L.id}`),children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(fn,{className:"h-5 w-5 text-primary-600 mr-2"}),i.jsx("span",{className:"text-lg font-semibold text-gray-900",children:L.annee})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[i.jsx(fr,{className:"h-4 w-4 mr-2 text-gray-400"}),L.immeuble_nom]})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[new Date(L.periode_debut).toLocaleDateString("fr-FR")," "," ",new Date(L.periode_fin).toLocaleDateString("fr-FR")]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:"text-sm text-gray-900 capitalize",children:L.type_comptage})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N(L.statut)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:L.tarif_nom||"Non dfini"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:i.jsx("button",{onClick:V=>{V.stopPropagation(),e(`/decomptes/${L.id}`)},className:"text-primary-600 hover:text-primary-900",children:"Grer "})})]},L.id))})]})})})]},j)),u&&i.jsx(dE,{immeubles:n,onClose:()=>f(!1),onSuccess:E})]})}function mE({decompteId:e,compteurs:t,onClose:r,onSuccess:n}){const[a,s]=T.useState([]),[l,o]=T.useState(new Date().toISOString().split("T")[0]),[c,u]=T.useState([]),[f,d]=T.useState(!1);T.useEffect(()=>{const m=t.map(p=>({compteurId:p.id,numeroCompteur:p.numero_compteur,locataireNom:p.locataire_nom?`${p.locataire_prenom} ${p.locataire_nom}`:"Non assign",indexPrecedent:"",indexActuel:"",nombreHabitants:p.nombre_habitants||0}));s(m)},[t]);const h=(m,p,x)=>{s(v=>v.map(w=>w.compteurId===m?{...w,[p]:x}:w))},y=()=>{const m=[];return l||m.push("La date du relev est requise"),a.forEach(p=>{if(p.indexPrecedent!==""&&p.indexActuel!==""){const x=parseFloat(p.indexPrecedent),v=parseFloat(p.indexActuel);isNaN(x)||isNaN(v)?m.push(`${p.numeroCompteur}: Les index doivent tre des nombres`):v<x&&m.push(`${p.numeroCompteur}: L'index actuel doit tre suprieur ou gal  l'index prcdent`)}}),u(m),m.length===0},g=async m=>{var p,x;if(m.preventDefault(),!!y()){d(!0),u([]);try{const v=a.filter(b=>b.indexPrecedent!==""&&b.indexActuel!=="");if(v.length===0){u(["Veuillez saisir au moins un relev"]),d(!1);return}const w=v.map(b=>Za.create(e,{compteurId:b.compteurId,dateReleve:l,indexPrecedent:parseFloat(b.indexPrecedent),indexActuel:parseFloat(b.indexActuel)}));await Promise.all(w),n()}catch(v){console.error("Error creating releves:",v),u([((x=(p=v.response)==null?void 0:p.data)==null?void 0:x.message)||"Erreur lors de la sauvegarde des relevs"])}finally{d(!1)}}};return i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full my-8",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(fn,{className:"h-6 w-6 text-primary-600 mr-3"}),i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Saisir les relevs de compteurs"})]}),i.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(br,{className:"h-6 w-6"})})]}),i.jsxs("form",{onSubmit:g,className:"p-6",children:[c.length>0&&i.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx(st,{className:"h-5 w-5 text-red-400 mt-0.5"}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:c.length===1?"Erreur":`${c.length} erreurs`}),i.jsx("div",{className:"mt-2 text-sm text-red-700",children:i.jsx("ul",{className:"list-disc pl-5 space-y-1",children:c.map((m,p)=>i.jsx("li",{children:m},p))})})]})]})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{htmlFor:"dateReleve",className:"block text-sm font-medium text-gray-700 mb-2",children:"Date du relev *"}),i.jsx("input",{type:"date",id:"dateReleve",value:l,onChange:m=>o(m.target.value),className:"w-full md:w-64 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Compteur"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Locataire"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Index prcdent (m)"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Index actuel (m)"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Consommation"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Habitants"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(m=>{const p=m.indexActuel&&m.indexPrecedent?(parseFloat(m.indexActuel)-parseFloat(m.indexPrecedent)).toFixed(2):"-";return i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:m.numeroCompteur}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:m.locataireNom}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("input",{type:"number",step:"0.001",min:"0",value:m.indexPrecedent,onChange:x=>h(m.compteurId,"indexPrecedent",x.target.value),className:"w-28 px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"0.000"})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("input",{type:"number",step:"0.001",min:"0",value:m.indexActuel,onChange:x=>h(m.compteurId,"indexActuel",x.target.value),className:"w-28 px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"0.000"})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-semibold text-primary-600",children:p}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:m.nombreHabitants})]},m.compteurId)})})]})}),t.length===0&&i.jsx("div",{className:"text-center py-8 text-gray-500",children:"Aucun compteur configur pour cet immeuble"}),i.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200",children:[i.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),i.jsx("button",{type:"submit",disabled:f||t.length===0,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:f?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sauvegarde..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Hn,{className:"h-4 w-4 mr-2"}),"Enregistrer les relevs"]})})]})]})]})})}function xE(){const{id:e}=Wn(),t=Kt(),[r,n]=T.useState(null),[a,s]=T.useState([]),[l,o]=T.useState([]),[c,u]=T.useState([]),[f,d]=T.useState(!0),[h,y]=T.useState(!1),[g,m]=T.useState(""),[p,x]=T.useState(!1);T.useEffect(()=>{v()},[e]);const v=async()=>{try{d(!0),m("");const b=await $l.getById(e);n(b.data.decompte),u(b.data.repartitions||[]);const _=await wi.getByImmeuble(b.data.decompte.immeuble_id);s(_.data.compteurs||[]);const E=await Za.getByDecompte(e);o(E.data.releves||[])}catch(b){console.error("Error loading data:",b),m("Erreur lors du chargement")}finally{d(!1)}},w=async()=>{var b,_;try{y(!0),m(""),await $l.calculer(e),await v()}catch(E){console.error("Error calculating:",E),m(((_=(b=E.response)==null?void 0:b.data)==null?void 0:_.message)||"Erreur lors du calcul")}finally{y(!1)}};return f?i.jsx("div",{className:"flex items-center justify-center min-h-96",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement..."})]})}):r?i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("button",{onClick:()=>t("/decomptes"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:i.jsx(Vn,{className:"h-5 w-5"})}),i.jsxs("div",{children:[i.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Dcompte ",r.annee]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.immeuble_nom})]})]}),i.jsx("button",{onClick:w,disabled:h||l.length===0||r.statut==="cloture",className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:h?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Calcul en cours..."]}):i.jsxs(i.Fragment,{children:[i.jsx(wc,{className:"h-5 w-5 mr-2"}),"Calculer les rpartitions"]})})]}),g&&i.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[i.jsx(st,{className:"h-5 w-5 mr-2"}),g]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(fr,{className:"h-8 w-8 text-blue-600"}),i.jsxs("div",{className:"ml-4",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Priode"}),i.jsx("p",{className:"text-lg font-semibold text-gray-900",children:new Date(r.periode_debut).toLocaleDateString("fr-FR")})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(zn,{className:"h-8 w-8 text-cyan-600"}),i.jsxs("div",{className:"ml-4",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Compteurs"}),i.jsx("p",{className:"text-lg font-semibold text-gray-900",children:a.length})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(Vt,{className:"h-8 w-8 text-purple-600"}),i.jsxs("div",{className:"ml-4",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Habitants"}),i.jsx("p",{className:"text-lg font-semibold text-gray-900",children:r.total_habitants||0})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(jn,{className:"h-8 w-8 text-green-600"}),i.jsxs("div",{className:"ml-4",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Statut"}),i.jsx("p",{className:"text-lg font-semibold text-gray-900 capitalize",children:r.statut})]})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsx("div",{className:"border-b border-gray-200",children:i.jsxs("nav",{className:"flex -mb-px",children:[i.jsx("button",{className:"px-6 py-4 text-sm font-medium text-primary-600 border-b-2 border-primary-600",children:"Relevs compteurs"}),i.jsxs("button",{className:"px-6 py-4 text-sm font-medium text-gray-500 hover:text-gray-700",disabled:c.length===0,children:["Rpartitions (",c.length,")"]})]})}),i.jsx("div",{className:"p-6",children:a.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(zn,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun compteur configur"}),i.jsx("p",{className:"text-gray-600",children:"Configurez d'abord les compteurs d'eau pour cet immeuble"})]}):l.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(fn,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun relev enregistr"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Commencez par saisir les index des compteurs"}),i.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[i.jsx(Gt,{className:"h-5 w-5 mr-2"}),"Saisir les relevs"]})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Locataire"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Compteur"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Index prcdent"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Index actuel"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Consommation"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Habitants"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(b=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[b.locataire_prenom," ",b.locataire_nom]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:b.numero_compteur}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[b.index_precedent," m"]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[b.index_actuel," m"]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("span",{className:"text-sm font-semibold text-primary-600",children:[b.consommation," m"]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:b.nombre_habitants})]},b.id))})]})})}),c.length>0&&i.jsxs("div",{className:"border-t border-gray-200 p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Rpartitions calcules"}),i.jsx("div",{className:"space-y-4",children:c.map(b=>i.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-medium text-gray-900",children:[b.locataire_prenom," ",b.locataire_nom]}),i.jsxs("div",{className:"mt-2 text-sm text-gray-600 space-y-1",children:[i.jsxs("p",{children:["Consommation: ",b.m3_consommes," m"]}),b.m3_gratuits>0&&i.jsxs("p",{className:"text-green-600",children:["M gratuits: -",b.m3_gratuits," m"]}),i.jsxs("p",{children:["Habitants: ",b.habitants]})]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[b.montant_total_ttc.toFixed(2)," "]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1 space-y-1",children:[i.jsxs("div",{children:["Eau: ",b.montant_eau.toFixed(2)," "]}),b.montant_assainissement>0&&i.jsxs("div",{children:["Assainissement: ",b.montant_assainissement.toFixed(2)," "]}),i.jsxs("div",{children:["Redevance: ",b.montant_redevance_fixe.toFixed(2)," "]}),i.jsxs("div",{children:["TVA: ",b.montant_tva.toFixed(2)," "]})]})]})]})},b.id))})]})]}),p&&i.jsx(mE,{decompteId:e,compteurs:a,onClose:()=>x(!1),onSuccess:()=>{x(!1),v()}})]}):i.jsxs("div",{className:"text-center py-12",children:[i.jsx(st,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Dcompte introuvable"}),i.jsx("button",{onClick:()=>t("/decomptes"),className:"mt-4 text-primary-600 hover:text-primary-700",children:"Retour  la liste"})]})}const pE="modulepreload",gE=function(e){return"/"+e},zx={},vE=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=gE(c),c in zx)return;zx[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":pE,u||(d.as="script"),d.crossOrigin="",d.href=c,o&&d.setAttribute("nonce",o),document.head.appendChild(d),u)return new Promise((h,y)=>{d.addEventListener("load",h),d.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return a.then(l=>{for(const o of l||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})};function Zv({compteur:e,locataires:t,proprietaires:r,immeubleId:n,onClose:a,onSuccess:s}){const[l,o]=T.useState({numeroCompteur:"",assignationType:"none",locataireId:"",proprietaireId:"",typeCompteur:"individuel",emplacement:"",actif:!0}),[c,u]=T.useState([]),[f,d]=T.useState(!1);T.useEffect(()=>{e&&o({numeroCompteur:e.numero_compteur||"",assignationType:e.locataire_id?"locataire":e.proprietaire_id?"proprietaire":"none",locataireId:e.locataire_id||"",proprietaireId:e.proprietaire_id||"",typeCompteur:e.type_compteur||"individuel",emplacement:e.emplacement||"",actif:e.actif===!0})},[e]);const h=p=>{const{name:x,value:v,type:w,checked:b}=p.target;o(_=>({..._,[x]:w==="checkbox"?b:v}))},y=p=>{const x=p.target.value;o(v=>({...v,assignationType:x,locataireId:"",proprietaireId:""}))},g=()=>{const p=[];return l.numeroCompteur.trim()||p.push("Le numro de compteur est requis"),l.typeCompteur||p.push("Le type de compteur est requis"),u(p),p.length===0},m=async p=>{var x,v,w,b;if(p.preventDefault(),!!g()){d(!0),u([]);try{const _={numeroCompteur:l.numeroCompteur.trim(),locataireId:l.assignationType==="locataire"?l.locataireId:null,proprietaireId:l.assignationType==="proprietaire"?l.proprietaireId:null,typeCompteur:l.typeCompteur,emplacement:l.emplacement.trim()||null,actif:l.actif};e?await wi.update(n,e.id,_):await wi.create(n,_),s()}catch(_){console.error("Error saving compteur:",_),(v=(x=_.response)==null?void 0:x.data)!=null&&v.errors?u(Array.isArray(_.response.data.errors)?_.response.data.errors:[_.response.data.message||"Erreur lors de la sauvegarde"]):u([((b=(w=_.response)==null?void 0:w.data)==null?void 0:b.message)||"Erreur lors de la sauvegarde du compteur"])}finally{d(!1)}}};return i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full my-8",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(zn,{className:"h-6 w-6 text-cyan-600 mr-3"}),i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Modifier le compteur":"Nouveau compteur"})]}),i.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(br,{className:"h-6 w-6"})})]}),i.jsxs("form",{onSubmit:m,className:"p-6",children:[c.length>0&&i.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex",children:[i.jsx(st,{className:"h-5 w-5 text-red-400 mt-0.5"}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-red-800",children:c.length===1?"Erreur":`${c.length} erreurs`}),i.jsx("div",{className:"mt-2 text-sm text-red-700",children:i.jsx("ul",{className:"list-disc pl-5 space-y-1",children:c.map((p,x)=>i.jsx("li",{children:p},x))})})]})]})}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"numeroCompteur",className:"block text-sm font-medium text-gray-700 mb-1",children:"Numro de compteur *"}),i.jsx("input",{type:"text",id:"numeroCompteur",name:"numeroCompteur",required:!0,value:l.numeroCompteur,onChange:h,placeholder:"Ex: C-001",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"typeCompteur",className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de compteur *"}),i.jsxs("select",{id:"typeCompteur",name:"typeCompteur",required:!0,value:l.typeCompteur,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[i.jsx("option",{value:"individuel",children:"Individuel"}),i.jsx("option",{value:"collectif",children:"Collectif"}),i.jsx("option",{value:"divisionnaire",children:"Divisionnaire"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"assignationType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Assign "}),i.jsxs("select",{id:"assignationType",name:"assignationType",value:l.assignationType,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[i.jsx("option",{value:"none",children:"Non assign"}),i.jsx("option",{value:"locataire",children:"Locataire"}),i.jsx("option",{value:"proprietaire",children:"Propritaire occupant"})]})]}),l.assignationType==="locataire"&&i.jsxs("div",{children:[i.jsx("label",{htmlFor:"locataireId",className:"block text-sm font-medium text-gray-700 mb-1",children:"Locataire *"}),i.jsxs("select",{id:"locataireId",name:"locataireId",required:!0,value:l.locataireId,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[i.jsx("option",{value:"",children:"Slectionnez un locataire"}),t.map(p=>i.jsxs("option",{value:p.id,children:[p.prenom," ",p.nom,p.proprietaire_nom&&` (Prop: ${p.proprietaire_prenom} ${p.proprietaire_nom})`]},p.id))]}),t.length===0&&i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Aucun locataire disponible. Crez d'abord un locataire."})]}),l.assignationType==="proprietaire"&&i.jsxs("div",{children:[i.jsx("label",{htmlFor:"proprietaireId",className:"block text-sm font-medium text-gray-700 mb-1",children:"Propritaire occupant *"}),i.jsxs("select",{id:"proprietaireId",name:"proprietaireId",required:!0,value:l.proprietaireId,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[i.jsx("option",{value:"",children:"Slectionnez un propritaire"}),r.map(p=>i.jsxs("option",{value:p.id,children:[p.prenom," ",p.nom]},p.id))]}),r.length===0&&i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Aucun propritaire disponible."})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"emplacement",className:"block text-sm font-medium text-gray-700 mb-1",children:"Emplacement"}),i.jsx("input",{type:"text",id:"emplacement",name:"emplacement",value:l.emplacement,onChange:h,placeholder:"Ex: Cave A, Appartement 101",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"actif",name:"actif",checked:l.actif,onChange:h,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"actif",className:"ml-2 block text-sm text-gray-700",children:"Compteur actif"})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200",children:[i.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),i.jsx("button",{type:"submit",disabled:f,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:f?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Sauvegarde..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Hn,{className:"h-4 w-4 mr-2"}),e?"Mettre  jour":"Crer le compteur"]})})]})]})]})})}function yE({title:e,message:t,confirmText:r,onConfirm:n,onCancel:a}){const[s,l]=T.useState(""),[o,c]=T.useState(!1),u=async()=>{c(!0);try{await n()}catch(d){console.error("Error during deletion:",d)}finally{c(!1)}},f=s===r;return i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:i.jsx(xo,{className:"h-6 w-6 text-red-600"})}),i.jsx("h3",{className:"ml-4 text-lg font-medium text-gray-900",children:e})]}),i.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(br,{className:"h-6 w-6"})})]}),i.jsxs("div",{className:"p-6",children:[i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:t}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:i.jsxs("p",{className:"text-sm text-yellow-800",children:[" Cette action est irrversible. Pour confirmer, tapez"," ",i.jsx("span",{className:"font-mono font-semibold",children:r})]})}),i.jsx("input",{type:"text",value:s,onChange:d=>l(d.target.value),placeholder:`Tapez "${r}" pour confirmer`,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500",autoFocus:!0})]}),i.jsxs("div",{className:"flex justify-end space-x-3 px-6 py-4 bg-gray-50 rounded-b-lg",children:[i.jsx("button",{onClick:a,disabled:o,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Annuler"}),i.jsx("button",{onClick:u,disabled:!f||o,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white inline-block mr-2"}),"Suppression..."]}):"Supprimer dfinitivement"})]})]})})}function wE({compteurs:e,locataires:t,proprietaires:r,immeubleId:n,onUpdate:a}){const[s,l]=T.useState(null),[o,c]=T.useState(null),[u,f]=T.useState(!1),[d,h]=T.useState(""),y=x=>{l(x),f(!0)},g=async()=>{var x,v;try{h(""),await wi.delete(n,o.id),c(null),a()}catch(w){console.error("Error deleting compteur:",w),h(((v=(x=w.response)==null?void 0:x.data)==null?void 0:v.message)||"Erreur lors de la suppression")}},m=()=>{f(!1),l(null),a()},p=x=>x.locataire_id?i.jsxs("div",{className:"flex items-center",children:[i.jsx(Wl,{className:"h-4 w-4 text-green-600 mr-2"}),i.jsxs("div",{children:[i.jsxs("div",{className:"text-sm text-gray-900",children:[x.locataire_prenom," ",x.locataire_nom]}),i.jsx("div",{className:"text-xs text-gray-500",children:"Locataire"})]})]}):x.proprietaire_id?i.jsxs("div",{className:"flex items-center",children:[i.jsx(Jv,{className:"h-4 w-4 text-purple-600 mr-2"}),i.jsxs("div",{children:[i.jsxs("div",{className:"text-sm text-gray-900",children:[x.proprietaire_prenom," ",x.proprietaire_nom]}),i.jsx("div",{className:"text-xs text-gray-500",children:"Propritaire occupant"})]})]}):i.jsx("span",{className:"text-sm text-gray-400",children:"Non assign"});return e.length===0?i.jsx("div",{className:"bg-white rounded-lg border-2 border-dashed border-gray-300 p-12",children:i.jsxs("div",{className:"text-center",children:[i.jsx(zn,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun compteur"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Commencez par ajouter les compteurs d'eau de l'immeuble"})]})}):i.jsxs(i.Fragment,{children:[d&&i.jsxs("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[i.jsx(st,{className:"h-5 w-5 mr-2"}),d]}),i.jsx("div",{className:"scroll-table",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Numro"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Occupant"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Emplacement"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(x=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(zn,{className:"h-5 w-5 text-cyan-600 mr-2"}),i.jsx("span",{className:"text-sm font-medium text-gray-900",children:x.numero_compteur})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p(x)}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x.emplacement||"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:"text-sm text-gray-900 capitalize",children:x.type_compteur})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x.actif?i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[i.jsx(jn,{className:"h-3 w-3 mr-1"}),"Actif"]}):i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[i.jsx(tE,{className:"h-3 w-3 mr-1"}),"Inactif"]})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[i.jsx("button",{onClick:()=>y(x),className:"text-primary-600 hover:text-primary-900 mr-4",children:i.jsx(po,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>c(x),className:"text-red-600 hover:text-red-900",children:i.jsx(La,{className:"h-4 w-4"})})]})]},x.id))})]})}),u&&i.jsx(Zv,{compteur:s,locataires:t,proprietaires:r,immeubleId:n,onClose:()=>{f(!1),l(null)},onSuccess:m}),o&&i.jsx(yE,{title:"Supprimer le compteur",message:`tes-vous sr de vouloir supprimer le compteur ${o.numero_compteur} ?`,confirmText:o.numero_compteur,onConfirm:g,onCancel:()=>c(null)})]})}const bE=T.lazy(()=>vE(()=>import("./ComptabiliteImmeuble-Di_1MCaV.js"),[]));function NE(){const{id:e}=Wn(),t=Kt(),{getImmeubleDetail:r,refreshAfterUpdate:n}=dh(),[a,s]=T.useState(null),[l,o]=T.useState([]),[c,u]=T.useState([]),[f,d]=T.useState([]),[h,y]=T.useState([]),[g,m]=T.useState(!0),[p,x]=T.useState(""),[v,w]=T.useState("proprietaires"),[b,_]=T.useState("grid"),[E,N]=T.useState("grid"),[R,j]=T.useState(!1),[L,V]=T.useState(!1),[K,Y]=T.useState(!1),[H,B]=T.useState(!1);T.useEffect(()=>{J()},[e]),T.useEffect(()=>{const X=setTimeout(()=>B(!0),100);return()=>clearTimeout(X)},[]);const J=async(X=!1)=>{try{m(!0),x("");const Q=await r(e,X);s(Q.immeuble),o(Q.proprietaires),u(Q.locataires),d(Q.compteurs),y(Q.fournisseurs)}catch(Q){console.error("Error loading data:",Q),x("Erreur lors du chargement")}finally{m(!1)}},ue=X=>{const Q=(a==null?void 0:a.nombre_total_parts)||(a==null?void 0:a.total_milliemes)||1e3;return Q===0||!X?"0.00":(X/Q*100).toFixed(2)},le=X=>X.proprietaire_id?l.find(Q=>Q.id===X.proprietaire_id):null,G=()=>(a==null?void 0:a.nombre_appartements)||(a==null?void 0:a.nombre_lots)||null,q=()=>{const X=G();return X?l.length>=X:!1},U=X=>t(`/immeubles/${e}/proprietaires/${X}`),S=X=>t(`/immeubles/${e}/locataires/${X}`),z=async()=>{j(!1),await n("proprietaires",e),J(!0)},F=async()=>{V(!1),await n("locataires",e),J(!0)},M=async()=>{Y(!1),await n("compteurs",e),J(!0)};if(g)return i.jsx("div",{className:"flex items-center justify-center min-h-96",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement..."})]})});if(!a)return i.jsxs("div",{className:"text-center py-12",children:[i.jsx(st,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Immeuble introuvable"}),i.jsx("button",{onClick:()=>t("/immeubles"),className:"mt-4 text-primary-600 hover:text-primary-700",children:"Retour  la liste"})]});const W=G(),ie=q();return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("button",{onClick:()=>t("/immeubles"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors mt-1",children:i.jsx(Vn,{className:"h-5 w-5"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:a.nom}),i.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mt-1",children:[i.jsx(M0,{className:"h-4 w-4"}),i.jsx("span",{children:a.adresse})]}),i.jsxs("div",{className:"flex flex-wrap gap-3 mt-3 text-sm",children:[i.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full bg-blue-100 text-blue-800",children:[i.jsx(fr,{className:"h-3.5 w-3.5 mr-1.5"}),a.nombre_total_parts||a.total_milliemes||1e3," millimes"]}),W&&i.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full bg-purple-100 text-purple-800",children:[i.jsx(Vt,{className:"h-3.5 w-3.5 mr-1.5"}),l.length,"/",W," lots"]}),a.mode_comptage_eau&&i.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full bg-cyan-100 text-cyan-800",children:[i.jsx(zn,{className:"h-3.5 w-3.5 mr-1.5"}),a.mode_comptage_eau]})]})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>J(!0),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Rafrachir",children:i.jsx(kr,{className:"h-5 w-5 text-gray-500"})}),i.jsx("button",{onClick:()=>t(`/immeubles/${e}/edit`),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Modifier",children:i.jsx(po,{className:"h-5 w-5 text-gray-500"})})]})]})}),p&&i.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[i.jsx(st,{className:"h-5 w-5 mr-2"}),p]}),i.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3",children:[i.jsx("button",{onClick:()=>w("proprietaires"),className:`bg-white rounded-xl shadow-sm border-2 p-4 hover:shadow-md transition-all text-left group ${v==="proprietaires"?"border-purple-500":"border-transparent"}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase",children:"Propritaires"}),i.jsx("p",{className:"text-2xl font-bold text-purple-600 mt-1",children:l.length})]}),i.jsx("div",{className:"p-2 bg-purple-100 rounded-lg group-hover:scale-110 transition-transform",children:i.jsx(Vt,{className:"h-5 w-5 text-purple-600"})})]})}),i.jsx("button",{onClick:()=>w("locataires"),className:`bg-white rounded-xl shadow-sm border-2 p-4 hover:shadow-md transition-all text-left group ${v==="locataires"?"border-green-500":"border-transparent"}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase",children:"Locataires"}),i.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:c.length})]}),i.jsx("div",{className:"p-2 bg-green-100 rounded-lg group-hover:scale-110 transition-transform",children:i.jsx(qc,{className:"h-5 w-5 text-green-600"})})]})}),i.jsx("button",{onClick:()=>w("compteurs"),className:`bg-white rounded-xl shadow-sm border-2 p-4 hover:shadow-md transition-all text-left group ${v==="compteurs"?"border-cyan-500":"border-transparent"}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase",children:"Compteurs"}),i.jsx("p",{className:"text-2xl font-bold text-cyan-600 mt-1",children:f.length})]}),i.jsx("div",{className:"p-2 bg-cyan-100 rounded-lg group-hover:scale-110 transition-transform",children:i.jsx(zn,{className:"h-5 w-5 text-cyan-600"})})]})}),i.jsx("button",{onClick:()=>t(`/immeubles/${e}/fournisseurs`),className:"bg-white rounded-xl shadow-sm border-2 border-transparent p-4 hover:shadow-md transition-all text-left group",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase",children:"Fournisseurs"}),i.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:h.length})]}),i.jsx("div",{className:"p-2 bg-orange-100 rounded-lg group-hover:scale-110 transition-transform",children:i.jsx(Jc,{className:"h-5 w-5 text-orange-600"})})]})}),i.jsx("button",{onClick:()=>t(`/immeubles/${e}/exercices`),className:"bg-white rounded-xl shadow-sm border-2 border-transparent p-4 hover:shadow-md transition-all text-left group",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase",children:"Exercices"}),i.jsx("p",{className:"text-2xl font-bold text-indigo-600 mt-1",children:""})]}),i.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg group-hover:scale-110 transition-transform",children:i.jsx(fn,{className:"h-5 w-5 text-indigo-600"})})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[v==="proprietaires"&&i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Propritaires"}),i.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[l.length," propritaire",l.length!==1?"s":""," enregistr",l.length!==1?"s":""]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[i.jsx("button",{onClick:()=>_("grid"),className:`p-2 rounded transition-colors ${b==="grid"?"bg-primary-600 text-white":"text-gray-600 hover:bg-gray-200"}`,children:i.jsx(Xf,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>_("list"),className:`p-2 rounded transition-colors ${b==="list"?"bg-primary-600 text-white":"text-gray-600 hover:bg-gray-200"}`,children:i.jsx(Gf,{className:"h-4 w-4"})})]}),i.jsxs("button",{onClick:()=>j(!0),disabled:ie,className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:[i.jsx(Gt,{className:"h-5 w-5 mr-2"}),"Ajouter"]})]})]}),ie&&i.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center",children:[i.jsx(xo,{className:"h-5 w-5 text-yellow-600 mr-2"}),i.jsxs("span",{className:"text-sm text-yellow-800",children:["Maximum de ",W," lots atteint"]})]}),l.length===0?i.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg",children:[i.jsx(Vt,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Aucun propritaire"})]}):b==="grid"?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(X=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md hover:border-primary-300 transition-all cursor-pointer",onClick:()=>U(X.id),children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-medium text-gray-900",children:[X.prenom," ",X.nom]}),X.numero_appartement&&i.jsxs("p",{className:"text-sm text-gray-600",children:["Apt. ",X.numero_appartement]}),i.jsx("p",{className:"text-sm text-gray-600",children:X.email})]}),i.jsx(ml,{className:"h-4 w-4 text-gray-400"})]}),i.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 flex items-center justify-between",children:[i.jsx("span",{className:"text-sm text-gray-500",children:"Parts"}),i.jsxs("span",{className:"font-medium text-primary-600",children:[X.nombre_parts||X.milliemes||0," (",ue(X.nombre_parts||X.milliemes),"%)"]})]})]},X.id))}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nom"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Appartement"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Parts"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(X=>i.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>U(X.id),children:[i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[X.prenom," ",X.nom]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:X.numero_appartement||"-"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:X.email}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-primary-600 font-medium",children:[X.nombre_parts||X.milliemes||0," (",ue(X.nombre_parts||X.milliemes),"%)"]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:i.jsx(ml,{className:"h-4 w-4 text-gray-400 inline"})})]},X.id))})]})})]}),v==="locataires"&&i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Locataires"}),i.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[c.length," locataire",c.length!==1?"s":""]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[i.jsx("button",{onClick:()=>N("grid"),className:`p-2 rounded transition-colors ${E==="grid"?"bg-primary-600 text-white":"text-gray-600 hover:bg-gray-200"}`,children:i.jsx(Xf,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>N("list"),className:`p-2 rounded transition-colors ${E==="list"?"bg-primary-600 text-white":"text-gray-600 hover:bg-gray-200"}`,children:i.jsx(Gf,{className:"h-4 w-4"})})]}),i.jsxs("button",{onClick:()=>V(!0),className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[i.jsx(Gt,{className:"h-5 w-5 mr-2"}),"Ajouter"]})]})]}),c.length===0?i.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg",children:[i.jsx(Vt,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Aucun locataire"})]}):E==="grid"?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(X=>{const Q=le(X);return i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md hover:border-primary-300 transition-all cursor-pointer",onClick:()=>S(X.id),children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-medium text-gray-900",children:[X.prenom," ",X.nom]}),i.jsx("p",{className:"text-sm text-gray-600",children:X.email}),i.jsx("p",{className:"text-sm text-gray-600",children:X.telephone})]}),i.jsx(ml,{className:"h-4 w-4 text-gray-400"})]}),X.nombre_habitants>0&&i.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[X.nombre_habitants," habitant",X.nombre_habitants>1?"s":""]}),Q&&i.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:i.jsxs("button",{onClick:Z=>{Z.stopPropagation(),U(Q.id)},className:"text-xs text-purple-600 hover:text-purple-800 flex items-center",children:[i.jsx(qc,{className:"h-3 w-3 mr-1"}),"Prop: ",Q.prenom," ",Q.nom]})})]},X.id)})}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nom"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tlphone"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Habitants"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Propritaire"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(X=>{const Q=le(X);return i.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>S(X.id),children:[i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[X.prenom," ",X.nom]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:X.email}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:X.telephone}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:X.nombre_habitants||0}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Q?i.jsxs("button",{onClick:Z=>{Z.stopPropagation(),U(Q.id)},className:"text-sm text-purple-600 hover:text-purple-800",children:[Q.prenom," ",Q.nom]}):i.jsx("span",{className:"text-sm text-gray-400",children:"-"})})]},X.id)})})]})})]}),v==="compteurs"&&i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Compteurs d'eau"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Grez les compteurs individuels de l'immeuble"})]}),i.jsxs("button",{onClick:()=>Y(!0),className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[i.jsx(Gt,{className:"h-5 w-5 mr-2"}),"Ajouter un compteur"]})]}),i.jsx(wE,{compteurs:f,locataires:c,proprietaires:l,immeubleId:a.id,onUpdate:()=>J(!0)})]})]}),H&&i.jsx(T.Suspense,{fallback:i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"animate-pulse",children:[i.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4 mb-4"}),i.jsx("div",{className:"h-32 bg-gray-100 rounded"})]})}),children:i.jsx(bE,{immeubleId:e,proprietaires:l})}),R&&i.jsx(hh,{immeubleId:e,onClose:()=>j(!1),onSuccess:z}),L&&i.jsx(mh,{immeubleId:e,proprietaires:l,onClose:()=>V(!1),onSuccess:F}),K&&i.jsx(Zv,{locataires:c,proprietaires:l,immeubleId:e,onClose:()=>Y(!1),onSuccess:M})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Qc={};Qc.version="0.18.5";var ey=1252,_E=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],xh={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ph=function(e){_E.indexOf(e)!=-1&&(ey=xh[0]=e)};function kE(){ph(1252)}var wn=function(e){ph(e)};function gh(){wn(1200),kE()}function $x(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function EE(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function ty(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var rl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?EE(e.slice(2)):t==254&&r==255?ty(e.slice(2)):t==65279?e.slice(1):e},Go=function(t){return String.fromCharCode(t)},Wx=function(t){return String.fromCharCode(t)},Vl,_a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Hl(e){for(var t="",r=0,n=0,a=0,s=0,l=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),l=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=_a.charAt(s)+_a.charAt(l)+_a.charAt(o)+_a.charAt(c);return t}function Kr(e){var t="",r=0,n=0,a=0,s=0,l=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=_a.indexOf(e.charAt(u++)),l=_a.indexOf(e.charAt(u++)),r=s<<2|l>>4,t+=String.fromCharCode(r),o=_a.indexOf(e.charAt(u++)),n=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=_a.indexOf(e.charAt(u++)),a=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var $e=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),fa=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ma(e){return $e?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Vx(e){return $e?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var $r=function(t){return $e?fa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function U0(e){if(typeof ArrayBuffer>"u")return $r(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Xa(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function SE(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function vh(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return vh(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Wt=$e?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:fa(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function jE(e){for(var t=[],r=0,n=e.length+250,a=Ma(e.length+255),s=0;s<e.length;++s){var l=e.charCodeAt(s);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|o>>6&15|(l&3)<<4,a[r++]=128|o&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Ma(65535),n=65530)}return t.push(a.slice(0,r)),Wt(t)}var _r=/\u0000/g,nl=/[\u0001-\u0006]/g;function li(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function bn(e,t){var r=""+e;return r.length>=t?r:Nt("0",t-r.length)+r}function yh(e,t){var r=""+e;return r.length>=t?r:Nt(" ",t-r.length)+r}function Zc(e,t){var r=""+e;return r.length>=t?r:r+Nt(" ",t-r.length)}function TE(e,t){var r=""+Math.round(e);return r.length>=t?r:Nt("0",t-r.length)+r}function CE(e,t){var r=""+e;return r.length>=t?r:Nt("0",t-r.length)+r}var Hx=Math.pow(2,32);function Ls(e,t){if(e>Hx||e<-Hx)return TE(e,t);var r=Math.round(e);return CE(r,t)}function e0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Xx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Tu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function FE(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Re={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Gx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},AE={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function t0(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,l=1,o=0,c=1,u=0,f=0,d=Math.floor(a);u<t&&(d=Math.floor(a),o=d*l+s,f=d*u+c,!(a-d<5e-8));)a=1/(a-d),s=l,l=o,c=u,u=f;if(f>t&&(u>t?(f=c,o=s):(f=u,o=l)),!r)return[0,n*o,f];var h=Math.floor(n*o/f);return[h,n*o-h*f,f]}function ls(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,l=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),l=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=LE(c,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var ry=new Date(1899,11,31,0,0,0),DE=ry.getTime(),RE=new Date(1900,2,1,0,0,0);function ny(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=RE&&(r+=24*60*60*1e3),(r-(DE+(e.getTimezoneOffset()-ry.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function wh(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function PE(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function IE(e){var t=e<0?12:11,r=wh(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function OE(e){var t=wh(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Xl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=IE(e):t===10?r=e.toFixed(10).substr(0,12):r=OE(e),wh(PE(r.toUpperCase()))}function Ns(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Xl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return dn(14,ny(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function LE(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function ME(e,t,r,n){var a="",s=0,l=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Tu[r.m-1][1];case 5:return Tu[r.m-1][0];default:return Tu[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return Xx[r.q][0];default:return Xx[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?bn(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),t==="s"?s===0?"0":""+s/l:(a=bn(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var f=u>0?bn(c,u):"";return f}function ka(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var ay=/%/g;function BE(e,t,r){var n=t.replace(ay,""),a=t.length-n.length;return ta(e,n,r*Math.pow(10,2*a))+Nt("%",a)}function UE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ta(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function sy(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+sy(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var iy=/# (\?+)( ?)\/( ?)(\d+)/;function zE(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),l=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(l===0?Nt(" ",e[1].length+1+e[4].length):yh(l,e[1].length)+e[2]+"/"+e[3]+bn(o,e[4].length))}function $E(e,t,r){return r+(t===0?"":""+t)+Nt(" ",e[1].length+2+e[4].length)}var ly=/^#*0*\.([0#]+)/,oy=/\).*[0#]/,cy=/\(###\) ###\\?-####/;function yr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Kx(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function qx(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function WE(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function VE(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Qr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(oy)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Qr("n",n,r):"("+Qr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return UE(e,t,r);if(t.indexOf("%")!==-1)return BE(e,t,r);if(t.indexOf("E")!==-1)return sy(t,r);if(t.charCodeAt(0)===36)return"$"+Qr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,l,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ls(c,t.length);if(t.match(/^[#?]+$/))return a=Ls(r,0),a==="0"&&(a=""),a.length>t.length?a:yr(t.substr(0,t.length-a.length))+a;if(s=t.match(iy))return zE(s,c,u);if(t.match(/^#+0+$/))return u+Ls(c,t.length-t.indexOf("0"));if(s=t.match(ly))return a=Kx(r,s[1].length).replace(/^([^\.]+)$/,"$1."+yr(s[1])).replace(/\.$/,"."+yr(s[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+Nt("0",yr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+Kx(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+ka(Ls(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Qr(e,t,-r):ka(""+(Math.floor(r)+WE(r,s[1].length)))+"."+bn(qx(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Qr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=li(Qr(e,t.replace(/[\\-]/g,""),r)),l=0,li(li(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return l<a.length?a.charAt(l++):g==="0"?"0":""}));if(t.match(cy))return a=Qr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=t0(c,Math.pow(10,l)-1,!1),a=""+u,f=ta("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=Zc(o[2],l),f.length<s[4].length&&(f=yr(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=t0(c,Math.pow(10,l)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?yh(o[1],l)+s[2]+"/"+s[3]+Zc(o[2],l):Nt(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Ls(r,0),t.length<=a.length?a:yr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var d=t.indexOf(".")-l,h=t.length-a.length-d;return yr(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return l=qx(r,s[1].length),r<0?"-"+Qr(e,t,-r):ka(VE(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?bn(0,3-g.length):"")+g})+"."+bn(l,s[1].length);switch(t){case"###,##0.00":return Qr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=ka(Ls(c,0));return y!=="0"?u+y:"";case"###,###.00":return Qr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Qr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function HE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ta(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function XE(e,t,r){var n=t.replace(ay,""),a=t.length-n.length;return ta(e,n,r*Math.pow(10,2*a))+Nt("%",a)}function uy(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+uy(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Pn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(oy)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Pn("n",n,r):"("+Pn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return HE(e,t,r);if(t.indexOf("%")!==-1)return XE(e,t,r);if(t.indexOf("E")!==-1)return uy(t,r);if(t.charCodeAt(0)===36)return"$"+Pn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,l,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+bn(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:yr(t.substr(0,t.length-a.length))+a;if(s=t.match(iy))return $E(s,c,u);if(t.match(/^#+0+$/))return u+bn(c,t.length-t.indexOf("0"));if(s=t.match(ly))return a=(""+r).replace(/^([^\.]+)$/,"$1."+yr(s[1])).replace(/\.$/,"."+yr(s[1])),a=a.replace(/\.(\d*)$/,function(g,m){return"."+m+Nt("0",yr(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+ka(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Pn(e,t,-r):ka(""+r)+"."+Nt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Pn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=li(Pn(e,t.replace(/[\\-]/g,""),r)),l=0,li(li(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return l<a.length?a.charAt(l++):g==="0"?"0":""}));if(t.match(cy))return a=Pn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),o=t0(c,Math.pow(10,l)-1,!1),a=""+u,f=ta("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=Zc(o[2],l),f.length<s[4].length&&(f=yr(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),o=t0(c,Math.pow(10,l)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?yh(o[1],l)+s[2]+"/"+s[3]+Zc(o[2],l):Nt(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:yr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var d=t.indexOf(".")-l,h=t.length-a.length-d;return yr(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Pn(e,t,-r):ka(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?bn(0,3-g.length):"")+g})+"."+bn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=ka(""+c);return y!=="0"?u+y:"";default:if(t.match(/\.[0#?]*$/))return Pn(e,t.slice(0,t.lastIndexOf(".")),r)+yr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ta(e,t,r){return(r|0)===r?Pn(e,t,r):Qr(e,t,r)}function GE(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var fy=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ri(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":e0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(fy))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function KE(e,t,r,n){for(var a=[],s="",l=0,o="",c="t",u,f,d,h="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!e0(e,l))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(d=e.charCodeAt(++l))!==34&&l<e.length;)s+=String.fromCharCode(d);a[a.length]={t:"t",v:s},++l;break;case"\\":var y=e.charAt(++l),g=y==="("||y===")"?y:"t";a[a.length]={t:g,v:y},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(u==null&&(u=ls(t,r,e.charAt(l+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},c=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=ls(t,r),u==null))return"";for(s=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:s},c=o;break;case"A":case"a":case"":var m={t:o,v:o};if(u==null&&(u=ls(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",h="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",l+=5,h="h"):e.substr(l,5).toUpperCase()==="/"?(u!=null&&(m.v=u.H>=12?"":""),m.t="T",l+=5,h="h"):(m.t="t",++l),u==null&&m.t==="T")return"";a[a.length]=m,c=o;break;case"[":for(s=o;e.charAt(l++)!=="]"&&l<e.length;)s+=e.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(fy)){if(u==null&&(u=ls(t,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ri(e)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++l<e.length&&(o=e.charAt(l))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++l)===o;)s+=o;a[a.length]={t:o,v:s},c=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)s+=e.charAt(l);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++l;break}var p=0,x=0,v;for(l=a.length-1,c="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=h,c="h",p<1&&(p=1);break;case"s":(v=a[l].v.match(/\.0+$/))&&(x=Math.max(x,v[0].length-1)),p<3&&(p=3);case"d":case"y":case"M":case"e":c=a[l].t;break;case"m":c==="s"&&(a[l].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&a[l].v.match(/[Hh]/)&&(p=1),p<2&&a[l].v.match(/[Mm]/)&&(p=2),p<3&&a[l].v.match(/[Ss]/)&&(p=3)}switch(p){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var w="",b;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=ME(a[l].t.charCodeAt(0),a[l].v,u,x),a[l].t="t";break;case"n":case"?":for(b=l+1;a[b]!=null&&((o=a[b].t)==="?"||o==="D"||(o===" "||o==="t")&&a[b+1]!=null&&(a[b+1].t==="?"||a[b+1].t==="t"&&a[b+1].v==="/")||a[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[b].v==="/"||a[b].v===" "&&a[b+1]!=null&&a[b+1].t=="?"));)a[l].v+=a[b].v,a[b]={v:"",t:";"},++b;w+=a[l].v,l=b-1;break;case"G":a[l].t="t",a[l].v=Ns(t,r);break}var _="",E,N;if(w.length>0){w.charCodeAt(0)==40?(E=t<0&&w.charCodeAt(0)===45?-t:t,N=ta("n",w,E)):(E=t<0&&n>1?-t:t,N=ta("n",w,E),E<0&&a[0]&&a[0].t=="t"&&(N=N.substr(1),a[0].v="-"+a[0].v)),b=N.length-1;var R=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){R=l;break}var j=a.length;if(R===a.length&&N.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(b>=a[l].v.length-1?(b-=a[l].v.length,a[l].v=N.substr(b+1,a[l].v.length)):b<0?a[l].v="":(a[l].v=N.substr(0,b+1),b=-1),a[l].t="t",j=l);b>=0&&j<a.length&&(a[j].v=N.substr(0,b+1)+a[j].v)}else if(R!==a.length&&N.indexOf("E")===-1){for(b=N.indexOf(".")-1,l=R;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(f=a[l].v.indexOf(".")>-1&&l===R?a[l].v.indexOf(".")-1:a[l].v.length-1,_=a[l].v.substr(f+1);f>=0;--f)b>=0&&(a[l].v.charAt(f)==="0"||a[l].v.charAt(f)==="#")&&(_=N.charAt(b--)+_);a[l].v=_,a[l].t="t",j=l}for(b>=0&&j<a.length&&(a[j].v=N.substr(0,b+1)+a[j].v),b=N.indexOf(".")+1,l=R;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==R)){for(f=a[l].v.indexOf(".")>-1&&l===R?a[l].v.indexOf(".")+1:0,_=a[l].v.substr(0,f);f<a[l].v.length;++f)b<N.length&&(_+=N.charAt(b++));a[l].v=_,a[l].t="t",j=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(E=n>1&&t<0&&l>0&&a[l-1].v==="-"?-t:t,a[l].v=ta(a[l].t,a[l].v,E),a[l].t="t");var L="";for(l=0;l!==a.length;++l)a[l]!=null&&(L+=a[l].v);return L}var Yx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Jx(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function qE(e,t){var r=GE(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(Yx),o=r[1].match(Yx);return Jx(t,l)?[n,r[0]]:Jx(t,o)?[n,r[1]]:[n,r[l!=null&&o!=null?2:1]]}return[n,s]}function dn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Re)[e],n==null&&(n=r.table&&r.table[Gx[e]]||Re[Gx[e]]),n==null&&(n=AE[e]||"General");break}if(e0(n,0))return Ns(t,r);t instanceof Date&&(t=ny(t,r.date1904));var a=qE(n,t);if(e0(a[1]))return Ns(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return KE(a[1],t,r,a[0])}function ra(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Re[r]==null){t<0&&(t=r);continue}if(Re[r]==e){t=r;break}}t<0&&(t=391)}return Re[t]=e,t}function z0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ra(e[t],t)}function Pi(){Re=FE()}var YE={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function JE(e){var t=typeof e=="number"?Re[e]:e;return t=t.replace(dy,"(\\d+)"),new RegExp("^"+t+"$")}function QE(e,t,r){var n=-1,a=-1,s=-1,l=-1,o=-1,c=-1;(t.match(dy)||[]).forEach(function(d,h){var y=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=y;break;case"d":s=y;break;case"h":l=y;break;case"s":c=y;break;case"m":l>=0?o=y:a=y;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return l==-1&&o==-1&&c==-1?u:n==-1&&a==-1&&s==-1?f:u+"T"+f}var ZE=function(){var e={};e.version="1.2.0";function t(){for(var N=0,R=new Array(256),j=0;j!=256;++j)N=j,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,R[j]=N;return typeof Int32Array<"u"?new Int32Array(R):R}var r=t();function n(N){var R=0,j=0,L=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(L=0;L!=256;++L)V[L]=N[L];for(L=0;L!=256;++L)for(j=N[L],R=256+L;R<4096;R+=256)j=V[R]=j>>>8^N[j&255];var K=[];for(L=1;L!=16;++L)K[L-1]=typeof Int32Array<"u"?V.subarray(L*256,L*256+256):V.slice(L*256,L*256+256);return K}var a=n(r),s=a[0],l=a[1],o=a[2],c=a[3],u=a[4],f=a[5],d=a[6],h=a[7],y=a[8],g=a[9],m=a[10],p=a[11],x=a[12],v=a[13],w=a[14];function b(N,R){for(var j=R^-1,L=0,V=N.length;L<V;)j=j>>>8^r[(j^N.charCodeAt(L++))&255];return~j}function _(N,R){for(var j=R^-1,L=N.length-15,V=0;V<L;)j=w[N[V++]^j&255]^v[N[V++]^j>>8&255]^x[N[V++]^j>>16&255]^p[N[V++]^j>>>24]^m[N[V++]]^g[N[V++]]^y[N[V++]]^h[N[V++]]^d[N[V++]]^f[N[V++]]^u[N[V++]]^c[N[V++]]^o[N[V++]]^l[N[V++]]^s[N[V++]]^r[N[V++]];for(L+=15;V<L;)j=j>>>8^r[(j^N[V++])&255];return~j}function E(N,R){for(var j=R^-1,L=0,V=N.length,K=0,Y=0;L<V;)K=N.charCodeAt(L++),K<128?j=j>>>8^r[(j^K)&255]:K<2048?(j=j>>>8^r[(j^(192|K>>6&31))&255],j=j>>>8^r[(j^(128|K&63))&255]):K>=55296&&K<57344?(K=(K&1023)+64,Y=N.charCodeAt(L++)&1023,j=j>>>8^r[(j^(240|K>>8&7))&255],j=j>>>8^r[(j^(128|K>>2&63))&255],j=j>>>8^r[(j^(128|Y>>6&15|(K&3)<<4))&255],j=j>>>8^r[(j^(128|Y&63))&255]):(j=j>>>8^r[(j^(224|K>>12&15))&255],j=j>>>8^r[(j^(128|K>>6&63))&255],j=j>>>8^r[(j^(128|K&63))&255]);return~j}return e.table=r,e.bstr=b,e.buf=_,e.str=E,e}(),De=function(){var t={};t.version="1.2.1";function r(k,D){for(var C=k.split("/"),A=D.split("/"),P=0,O=0,te=Math.min(C.length,A.length);P<te;++P){if(O=C[P].length-A[P].length)return O;if(C[P]!=A[P])return C[P]<A[P]?-1:1}return C.length-A.length}function n(k){if(k.charAt(k.length-1)=="/")return k.slice(0,-1).indexOf("/")===-1?k:n(k.slice(0,-1));var D=k.lastIndexOf("/");return D===-1?k:k.slice(0,D+1)}function a(k){if(k.charAt(k.length-1)=="/")return a(k.slice(0,-1));var D=k.lastIndexOf("/");return D===-1?k:k.slice(D+1)}function s(k,D){typeof D=="string"&&(D=new Date(D));var C=D.getHours();C=C<<6|D.getMinutes(),C=C<<5|D.getSeconds()>>>1,k.write_shift(2,C);var A=D.getFullYear()-1980;A=A<<4|D.getMonth()+1,A=A<<5|D.getDate(),k.write_shift(2,A)}function l(k){var D=k.read_shift(2)&65535,C=k.read_shift(2)&65535,A=new Date,P=C&31;C>>>=5;var O=C&15;C>>>=4,A.setMilliseconds(0),A.setFullYear(C+1980),A.setMonth(O-1),A.setDate(P);var te=D&31;D>>>=5;var ce=D&63;return D>>>=6,A.setHours(D),A.setMinutes(ce),A.setSeconds(te<<1),A}function o(k){Jt(k,0);for(var D={},C=0;k.l<=k.length-4;){var A=k.read_shift(2),P=k.read_shift(2),O=k.l+P,te={};switch(A){case 21589:C=k.read_shift(1),C&1&&(te.mtime=k.read_shift(4)),P>5&&(C&2&&(te.atime=k.read_shift(4)),C&4&&(te.ctime=k.read_shift(4))),te.mtime&&(te.mt=new Date(te.mtime*1e3));break}k.l=O,D[A]=te}return D}var c;function u(){return c||(c={})}function f(k,D){if(k[0]==80&&k[1]==75)return nm(k,D);if((k[0]|32)==109&&(k[1]|32)==105)return pw(k,D);if(k.length<512)throw new Error("CFB file size "+k.length+" < 512");var C=3,A=512,P=0,O=0,te=0,ce=0,ee=0,re=[],ne=k.slice(0,512);Jt(ne,0);var he=d(ne);switch(C=he[0],C){case 3:A=512;break;case 4:A=4096;break;case 0:if(he[1]==0)return nm(k,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+C)}A!==512&&(ne=k.slice(0,A),Jt(ne,28));var we=k.slice(0,A);h(ne,C);var _e=ne.read_shift(4,"i");if(C===3&&_e!==0)throw new Error("# Directory Sectors: Expected 0 saw "+_e);ne.l+=4,te=ne.read_shift(4,"i"),ne.l+=4,ne.chk("00100000","Mini Stream Cutoff Size: "),ce=ne.read_shift(4,"i"),P=ne.read_shift(4,"i"),ee=ne.read_shift(4,"i"),O=ne.read_shift(4,"i");for(var xe=-1,Ne=0;Ne<109&&(xe=ne.read_shift(4,"i"),!(xe<0));++Ne)re[Ne]=xe;var Le=y(k,A);p(ee,O,Le,A,re);var dt=v(Le,te,re,A);dt[te].name="!Directory",P>0&&ce!==Y&&(dt[ce].name="!MiniFAT"),dt[re[0]].name="!FAT",dt.fat_addrs=re,dt.ssz=A;var ht={},tr=[],Mi=[],Bi=[];w(te,dt,Le,tr,P,ht,Mi,ce),g(Mi,Bi,tr),tr.shift();var Ui={FileIndex:Mi,FullPaths:Bi};return D&&D.raw&&(Ui.raw={header:we,sectors:Le}),Ui}function d(k){if(k[k.l]==80&&k[k.l+1]==75)return[0,0];k.chk(H,"Header Signature: "),k.l+=16;var D=k.read_shift(2,"u");return[k.read_shift(2,"u"),D]}function h(k,D){var C=9;switch(k.l+=2,C=k.read_shift(2)){case 9:if(D!=3)throw new Error("Sector Shift: Expected 9 saw "+C);break;case 12:if(D!=4)throw new Error("Sector Shift: Expected 12 saw "+C);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+C)}k.chk("0600","Mini Sector Shift: "),k.chk("000000000000","Reserved: ")}function y(k,D){for(var C=Math.ceil(k.length/D)-1,A=[],P=1;P<C;++P)A[P-1]=k.slice(P*D,(P+1)*D);return A[C-1]=k.slice(C*D),A}function g(k,D,C){for(var A=0,P=0,O=0,te=0,ce=0,ee=C.length,re=[],ne=[];A<ee;++A)re[A]=ne[A]=A,D[A]=C[A];for(;ce<ne.length;++ce)A=ne[ce],P=k[A].L,O=k[A].R,te=k[A].C,re[A]===A&&(P!==-1&&re[P]!==P&&(re[A]=re[P]),O!==-1&&re[O]!==O&&(re[A]=re[O])),te!==-1&&(re[te]=A),P!==-1&&A!=re[A]&&(re[P]=re[A],ne.lastIndexOf(P)<ce&&ne.push(P)),O!==-1&&A!=re[A]&&(re[O]=re[A],ne.lastIndexOf(O)<ce&&ne.push(O));for(A=1;A<ee;++A)re[A]===A&&(O!==-1&&re[O]!==O?re[A]=re[O]:P!==-1&&re[P]!==P&&(re[A]=re[P]));for(A=1;A<ee;++A)if(k[A].type!==0){if(ce=A,ce!=re[ce])do ce=re[ce],D[A]=D[ce]+"/"+D[A];while(ce!==0&&re[ce]!==-1&&ce!=re[ce]);re[A]=-1}for(D[0]+="/",A=1;A<ee;++A)k[A].type!==2&&(D[A]+="/")}function m(k,D,C){for(var A=k.start,P=k.size,O=[],te=A;C&&P>0&&te>=0;)O.push(D.slice(te*K,te*K+K)),P-=K,te=es(C,te*4);return O.length===0?oe(0):Wt(O).slice(0,k.size)}function p(k,D,C,A,P){var O=Y;if(k===Y){if(D!==0)throw new Error("DIFAT chain shorter than expected")}else if(k!==-1){var te=C[k],ce=(A>>>2)-1;if(!te)return;for(var ee=0;ee<ce&&(O=es(te,ee*4))!==Y;++ee)P.push(O);p(es(te,A-4),D-1,C,A,P)}}function x(k,D,C,A,P){var O=[],te=[];P||(P=[]);var ce=A-1,ee=0,re=0;for(ee=D;ee>=0;){P[ee]=!0,O[O.length]=ee,te.push(k[ee]);var ne=C[Math.floor(ee*4/A)];if(re=ee*4&ce,A<4+re)throw new Error("FAT boundary crossed: "+ee+" 4 "+A);if(!k[ne])break;ee=es(k[ne],re)}return{nodes:O,data:cp([te])}}function v(k,D,C,A){var P=k.length,O=[],te=[],ce=[],ee=[],re=A-1,ne=0,he=0,we=0,_e=0;for(ne=0;ne<P;++ne)if(ce=[],we=ne+D,we>=P&&(we-=P),!te[we]){ee=[];var xe=[];for(he=we;he>=0;){xe[he]=!0,te[he]=!0,ce[ce.length]=he,ee.push(k[he]);var Ne=C[Math.floor(he*4/A)];if(_e=he*4&re,A<4+_e)throw new Error("FAT boundary crossed: "+he+" 4 "+A);if(!k[Ne]||(he=es(k[Ne],_e),xe[he]))break}O[we]={nodes:ce,data:cp([ee])}}return O}function w(k,D,C,A,P,O,te,ce){for(var ee=0,re=A.length?2:0,ne=D[k].data,he=0,we=0,_e;he<ne.length;he+=128){var xe=ne.slice(he,he+128);Jt(xe,64),we=xe.read_shift(2),_e=jh(xe,0,we-re),A.push(_e);var Ne={name:_e,type:xe.read_shift(1),color:xe.read_shift(1),L:xe.read_shift(4,"i"),R:xe.read_shift(4,"i"),C:xe.read_shift(4,"i"),clsid:xe.read_shift(16),state:xe.read_shift(4,"i"),start:0,size:0},Le=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);Le!==0&&(Ne.ct=b(xe,xe.l-8));var dt=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);dt!==0&&(Ne.mt=b(xe,xe.l-8)),Ne.start=xe.read_shift(4,"i"),Ne.size=xe.read_shift(4,"i"),Ne.size<0&&Ne.start<0&&(Ne.size=Ne.type=0,Ne.start=Y,Ne.name=""),Ne.type===5?(ee=Ne.start,P>0&&ee!==Y&&(D[ee].name="!StreamData")):Ne.size>=4096?(Ne.storage="fat",D[Ne.start]===void 0&&(D[Ne.start]=x(C,Ne.start,D.fat_addrs,D.ssz)),D[Ne.start].name=Ne.name,Ne.content=D[Ne.start].data.slice(0,Ne.size)):(Ne.storage="minifat",Ne.size<0?Ne.size=0:ee!==Y&&Ne.start!==Y&&D[ee]&&(Ne.content=m(Ne,D[ee].data,(D[ce]||{}).data))),Ne.content&&Jt(Ne.content,0),O[_e]=Ne,te.push(Ne)}}function b(k,D){return new Date((zr(k,D+4)/1e7*Math.pow(2,32)+zr(k,D)/1e7-11644473600)*1e3)}function _(k,D){return u(),f(c.readFileSync(k),D)}function E(k,D){var C=D&&D.type;switch(C||$e&&Buffer.isBuffer(k)&&(C="buffer"),C||"base64"){case"file":return _(k,D);case"base64":return f($r(Kr(k)),D);case"binary":return f($r(k),D)}return f(k,D)}function N(k,D){var C=D||{},A=C.root||"Root Entry";if(k.FullPaths||(k.FullPaths=[]),k.FileIndex||(k.FileIndex=[]),k.FullPaths.length!==k.FileIndex.length)throw new Error("inconsistent CFB structure");k.FullPaths.length===0&&(k.FullPaths[0]=A+"/",k.FileIndex[0]={name:A,type:5}),C.CLSID&&(k.FileIndex[0].clsid=C.CLSID),R(k)}function R(k){var D="Sh33tJ5";if(!De.find(k,"/"+D)){var C=oe(4);C[0]=55,C[1]=C[3]=50,C[2]=54,k.FileIndex.push({name:D,type:2,content:C,size:4,L:69,R:69,C:69}),k.FullPaths.push(k.FullPaths[0]+D),j(k)}}function j(k,D){N(k);for(var C=!1,A=!1,P=k.FullPaths.length-1;P>=0;--P){var O=k.FileIndex[P];switch(O.type){case 0:A?C=!0:(k.FileIndex.pop(),k.FullPaths.pop());break;case 1:case 2:case 5:A=!0,isNaN(O.R*O.L*O.C)&&(C=!0),O.R>-1&&O.L>-1&&O.R==O.L&&(C=!0);break;default:C=!0;break}}if(!(!C&&!D)){var te=new Date(1987,1,19),ce=0,ee=Object.create?Object.create(null):{},re=[];for(P=0;P<k.FullPaths.length;++P)ee[k.FullPaths[P]]=!0,k.FileIndex[P].type!==0&&re.push([k.FullPaths[P],k.FileIndex[P]]);for(P=0;P<re.length;++P){var ne=n(re[P][0]);A=ee[ne],A||(re.push([ne,{name:a(ne).replace("/",""),type:1,clsid:J,ct:te,mt:te,content:null}]),ee[ne]=!0)}for(re.sort(function(_e,xe){return r(_e[0],xe[0])}),k.FullPaths=[],k.FileIndex=[],P=0;P<re.length;++P)k.FullPaths[P]=re[P][0],k.FileIndex[P]=re[P][1];for(P=0;P<re.length;++P){var he=k.FileIndex[P],we=k.FullPaths[P];if(he.name=a(we).replace("/",""),he.L=he.R=he.C=-(he.color=1),he.size=he.content?he.content.length:0,he.start=0,he.clsid=he.clsid||J,P===0)he.C=re.length>1?1:-1,he.size=0,he.type=5;else if(we.slice(-1)=="/"){for(ce=P+1;ce<re.length&&n(k.FullPaths[ce])!=we;++ce);for(he.C=ce>=re.length?-1:ce,ce=P+1;ce<re.length&&n(k.FullPaths[ce])!=n(we);++ce);he.R=ce>=re.length?-1:ce,he.type=1}else n(k.FullPaths[P+1]||"")==n(we)&&(he.R=P+1),he.type=2}}}function L(k,D){var C=D||{};if(C.fileType=="mad")return gw(k,C);switch(j(k),C.fileType){case"zip":return uw(k,C)}var A=function(_e){for(var xe=0,Ne=0,Le=0;Le<_e.FileIndex.length;++Le){var dt=_e.FileIndex[Le];if(dt.content){var ht=dt.content.length;ht>0&&(ht<4096?xe+=ht+63>>6:Ne+=ht+511>>9)}}for(var tr=_e.FullPaths.length+3>>2,Mi=xe+7>>3,Bi=xe+127>>7,Ui=Mi+Ne+tr+Bi,qa=Ui+127>>7,Y0=qa<=109?0:Math.ceil((qa-109)/127);Ui+qa+Y0+127>>7>qa;)Y0=++qa<=109?0:Math.ceil((qa-109)/127);var Kn=[1,Y0,qa,Bi,tr,Ne,xe,0];return _e.FileIndex[0].size=xe<<6,Kn[7]=(_e.FileIndex[0].start=Kn[0]+Kn[1]+Kn[2]+Kn[3]+Kn[4]+Kn[5])+(Kn[6]+7>>3),Kn}(k),P=oe(A[7]<<9),O=0,te=0;{for(O=0;O<8;++O)P.write_shift(1,B[O]);for(O=0;O<8;++O)P.write_shift(2,0);for(P.write_shift(2,62),P.write_shift(2,3),P.write_shift(2,65534),P.write_shift(2,9),P.write_shift(2,6),O=0;O<3;++O)P.write_shift(2,0);for(P.write_shift(4,0),P.write_shift(4,A[2]),P.write_shift(4,A[0]+A[1]+A[2]+A[3]-1),P.write_shift(4,0),P.write_shift(4,4096),P.write_shift(4,A[3]?A[0]+A[1]+A[2]-1:Y),P.write_shift(4,A[3]),P.write_shift(-4,A[1]?A[0]-1:Y),P.write_shift(4,A[1]),O=0;O<109;++O)P.write_shift(-4,O<A[2]?A[1]+O:-1)}if(A[1])for(te=0;te<A[1];++te){for(;O<236+te*127;++O)P.write_shift(-4,O<A[2]?A[1]+O:-1);P.write_shift(-4,te===A[1]-1?Y:te+1)}var ce=function(_e){for(te+=_e;O<te-1;++O)P.write_shift(-4,O+1);_e&&(++O,P.write_shift(-4,Y))};for(te=O=0,te+=A[1];O<te;++O)P.write_shift(-4,ue.DIFSECT);for(te+=A[2];O<te;++O)P.write_shift(-4,ue.FATSECT);ce(A[3]),ce(A[4]);for(var ee=0,re=0,ne=k.FileIndex[0];ee<k.FileIndex.length;++ee)ne=k.FileIndex[ee],ne.content&&(re=ne.content.length,!(re<4096)&&(ne.start=te,ce(re+511>>9)));for(ce(A[6]+7>>3);P.l&511;)P.write_shift(-4,ue.ENDOFCHAIN);for(te=O=0,ee=0;ee<k.FileIndex.length;++ee)ne=k.FileIndex[ee],ne.content&&(re=ne.content.length,!(!re||re>=4096)&&(ne.start=te,ce(re+63>>6)));for(;P.l&511;)P.write_shift(-4,ue.ENDOFCHAIN);for(O=0;O<A[4]<<2;++O){var he=k.FullPaths[O];if(!he||he.length===0){for(ee=0;ee<17;++ee)P.write_shift(4,0);for(ee=0;ee<3;++ee)P.write_shift(4,-1);for(ee=0;ee<12;++ee)P.write_shift(4,0);continue}ne=k.FileIndex[O],O===0&&(ne.start=ne.size?ne.start-1:Y);var we=O===0&&C.root||ne.name;if(re=2*(we.length+1),P.write_shift(64,we,"utf16le"),P.write_shift(2,re),P.write_shift(1,ne.type),P.write_shift(1,ne.color),P.write_shift(-4,ne.L),P.write_shift(-4,ne.R),P.write_shift(-4,ne.C),ne.clsid)P.write_shift(16,ne.clsid,"hex");else for(ee=0;ee<4;++ee)P.write_shift(4,0);P.write_shift(4,ne.state||0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,ne.start),P.write_shift(4,ne.size),P.write_shift(4,0)}for(O=1;O<k.FileIndex.length;++O)if(ne=k.FileIndex[O],ne.size>=4096)if(P.l=ne.start+1<<9,$e&&Buffer.isBuffer(ne.content))ne.content.copy(P,P.l,0,ne.size),P.l+=ne.size+511&-512;else{for(ee=0;ee<ne.size;++ee)P.write_shift(1,ne.content[ee]);for(;ee&511;++ee)P.write_shift(1,0)}for(O=1;O<k.FileIndex.length;++O)if(ne=k.FileIndex[O],ne.size>0&&ne.size<4096)if($e&&Buffer.isBuffer(ne.content))ne.content.copy(P,P.l,0,ne.size),P.l+=ne.size+63&-64;else{for(ee=0;ee<ne.size;++ee)P.write_shift(1,ne.content[ee]);for(;ee&63;++ee)P.write_shift(1,0)}if($e)P.l=P.length;else for(;P.l<P.length;)P.write_shift(1,0);return P}function V(k,D){var C=k.FullPaths.map(function(ee){return ee.toUpperCase()}),A=C.map(function(ee){var re=ee.split("/");return re[re.length-(ee.slice(-1)=="/"?2:1)]}),P=!1;D.charCodeAt(0)===47?(P=!0,D=C[0].slice(0,-1)+D):P=D.indexOf("/")!==-1;var O=D.toUpperCase(),te=P===!0?C.indexOf(O):A.indexOf(O);if(te!==-1)return k.FileIndex[te];var ce=!O.match(nl);for(O=O.replace(_r,""),ce&&(O=O.replace(nl,"!")),te=0;te<C.length;++te)if((ce?C[te].replace(nl,"!"):C[te]).replace(_r,"")==O||(ce?A[te].replace(nl,"!"):A[te]).replace(_r,"")==O)return k.FileIndex[te];return null}var K=64,Y=-2,H="d0cf11e0a1b11ae1",B=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:H,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function le(k,D,C){u();var A=L(k,C);c.writeFileSync(D,A)}function G(k){for(var D=new Array(k.length),C=0;C<k.length;++C)D[C]=String.fromCharCode(k[C]);return D.join("")}function q(k,D){var C=L(k,D);switch(D&&D.type||"buffer"){case"file":return u(),c.writeFileSync(D.filename,C),C;case"binary":return typeof C=="string"?C:G(C);case"base64":return Hl(typeof C=="string"?C:G(C));case"buffer":if($e)return Buffer.isBuffer(C)?C:fa(C);case"array":return typeof C=="string"?$r(C):C}return C}var U;function S(k){try{var D=k.InflateRaw,C=new D;if(C._processChunk(new Uint8Array([3,0]),C._finishFlushFlag),C.bytesRead)U=k;else throw new Error("zlib does not expose bytesRead")}catch(A){console.error("cannot use native zlib: "+(A.message||A))}}function z(k,D){if(!U)return Fn(k,D);var C=U.InflateRaw,A=new C,P=A._processChunk(k.slice(k.l),A._finishFlushFlag);return k.l+=A.bytesRead,P}function F(k){return U?U.deflateRawSync(k):Fe(k)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function X(k){var D=(k<<1|k<<11)&139536|(k<<5|k<<15)&558144;return(D>>16|D>>8|D)&255}for(var Q=typeof Uint8Array<"u",Z=Q?new Uint8Array(256):[],ye=0;ye<256;++ye)Z[ye]=X(ye);function I(k,D){var C=Z[k&255];return D<=8?C>>>8-D:(C=C<<8|Z[k>>8&255],D<=16?C>>>16-D:(C=C<<8|Z[k>>16&255],C>>>24-D))}function ve(k,D){var C=D&7,A=D>>>3;return(k[A]|(C<=6?0:k[A+1]<<8))>>>C&3}function Ae(k,D){var C=D&7,A=D>>>3;return(k[A]|(C<=5?0:k[A+1]<<8))>>>C&7}function Ie(k,D){var C=D&7,A=D>>>3;return(k[A]|(C<=4?0:k[A+1]<<8))>>>C&15}function be(k,D){var C=D&7,A=D>>>3;return(k[A]|(C<=3?0:k[A+1]<<8))>>>C&31}function de(k,D){var C=D&7,A=D>>>3;return(k[A]|(C<=1?0:k[A+1]<<8))>>>C&127}function se(k,D,C){var A=D&7,P=D>>>3,O=(1<<C)-1,te=k[P]>>>A;return C<8-A||(te|=k[P+1]<<8-A,C<16-A)||(te|=k[P+2]<<16-A,C<24-A)||(te|=k[P+3]<<24-A),te&O}function Se(k,D,C){var A=D&7,P=D>>>3;return A<=5?k[P]|=(C&7)<<A:(k[P]|=C<<A&255,k[P+1]=(C&7)>>8-A),D+3}function Ee(k,D,C){var A=D&7,P=D>>>3;return C=(C&1)<<A,k[P]|=C,D+1}function Te(k,D,C){var A=D&7,P=D>>>3;return C<<=A,k[P]|=C&255,C>>>=8,k[P+1]=C,D+8}function Ue(k,D,C){var A=D&7,P=D>>>3;return C<<=A,k[P]|=C&255,C>>>=8,k[P+1]=C&255,k[P+2]=C>>>8,D+16}function Ye(k,D){var C=k.length,A=2*C>D?2*C:D+5,P=0;if(C>=D)return k;if($e){var O=Vx(A);if(k.copy)k.copy(O);else for(;P<k.length;++P)O[P]=k[P];return O}else if(Q){var te=new Uint8Array(A);if(te.set)te.set(k);else for(;P<C;++P)te[P]=k[P];return te}return k.length=A,k}function nt(k){for(var D=new Array(k),C=0;C<k;++C)D[C]=0;return D}function Et(k,D,C){var A=1,P=0,O=0,te=0,ce=0,ee=k.length,re=Q?new Uint16Array(32):nt(32);for(O=0;O<32;++O)re[O]=0;for(O=ee;O<C;++O)k[O]=0;ee=k.length;var ne=Q?new Uint16Array(ee):nt(ee);for(O=0;O<ee;++O)re[P=k[O]]++,A<P&&(A=P),ne[O]=0;for(re[0]=0,O=1;O<=A;++O)re[O+16]=ce=ce+re[O-1]<<1;for(O=0;O<ee;++O)ce=k[O],ce!=0&&(ne[O]=re[ce+16]++);var he=0;for(O=0;O<ee;++O)if(he=k[O],he!=0)for(ce=I(ne[O],A)>>A-he,te=(1<<A+4-he)-1;te>=0;--te)D[ce|te<<he]=he&15|O<<4;return A}var jr=Q?new Uint16Array(512):nt(512),mn=Q?new Uint16Array(32):nt(32);if(!Q){for(var St=0;St<512;++St)jr[St]=0;for(St=0;St<32;++St)mn[St]=0}(function(){for(var k=[],D=0;D<32;D++)k.push(5);Et(k,mn,32);var C=[];for(D=0;D<=143;D++)C.push(8);for(;D<=255;D++)C.push(9);for(;D<=279;D++)C.push(7);for(;D<=287;D++)C.push(8);Et(C,jr,288)})();var pr=function(){for(var D=Q?new Uint8Array(32768):[],C=0,A=0;C<ie.length-1;++C)for(;A<ie[C+1];++A)D[A]=C;for(;A<32768;++A)D[A]=29;var P=Q?new Uint8Array(259):[];for(C=0,A=0;C<W.length-1;++C)for(;A<W[C+1];++A)P[A]=C;function O(ce,ee){for(var re=0;re<ce.length;){var ne=Math.min(65535,ce.length-re),he=re+ne==ce.length;for(ee.write_shift(1,+he),ee.write_shift(2,ne),ee.write_shift(2,~ne&65535);ne-- >0;)ee[ee.l++]=ce[re++]}return ee.l}function te(ce,ee){for(var re=0,ne=0,he=Q?new Uint16Array(32768):[];ne<ce.length;){var we=Math.min(65535,ce.length-ne);if(we<10){for(re=Se(ee,re,+(ne+we==ce.length)),re&7&&(re+=8-(re&7)),ee.l=re/8|0,ee.write_shift(2,we),ee.write_shift(2,~we&65535);we-- >0;)ee[ee.l++]=ce[ne++];re=ee.l*8;continue}re=Se(ee,re,+(ne+we==ce.length)+2);for(var _e=0;we-- >0;){var xe=ce[ne];_e=(_e<<5^xe)&32767;var Ne=-1,Le=0;if((Ne=he[_e])&&(Ne|=ne&-32768,Ne>ne&&(Ne-=32768),Ne<ne))for(;ce[Ne+Le]==ce[ne+Le]&&Le<250;)++Le;if(Le>2){xe=P[Le],xe<=22?re=Te(ee,re,Z[xe+1]>>1)-1:(Te(ee,re,3),re+=5,Te(ee,re,Z[xe-23]>>5),re+=3);var dt=xe<8?0:xe-4>>2;dt>0&&(Ue(ee,re,Le-W[xe]),re+=dt),xe=D[ne-Ne],re=Te(ee,re,Z[xe]>>3),re-=3;var ht=xe<4?0:xe-2>>1;ht>0&&(Ue(ee,re,ne-Ne-ie[xe]),re+=ht);for(var tr=0;tr<Le;++tr)he[_e]=ne&32767,_e=(_e<<5^ce[ne])&32767,++ne;we-=Le-1}else xe<=143?xe=xe+48:re=Ee(ee,re,1),re=Te(ee,re,Z[xe]),he[_e]=ne&32767,++ne}re=Te(ee,re,0)-1}return ee.l=(re+7)/8|0,ee.l}return function(ee,re){return ee.length<8?O(ee,re):te(ee,re)}}();function Fe(k){var D=oe(50+Math.floor(k.length*1.1)),C=pr(k,D);return D.slice(0,C)}var He=Q?new Uint16Array(32768):nt(32768),gr=Q?new Uint16Array(32768):nt(32768),wt=Q?new Uint16Array(128):nt(128),Cn=1,Li=1;function So(k,D){var C=be(k,D)+257;D+=5;var A=be(k,D)+1;D+=5;var P=Ie(k,D)+4;D+=4;for(var O=0,te=Q?new Uint8Array(19):nt(19),ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,re=Q?new Uint8Array(8):nt(8),ne=Q?new Uint8Array(8):nt(8),he=te.length,we=0;we<P;++we)te[M[we]]=O=Ae(k,D),ee<O&&(ee=O),re[O]++,D+=3;var _e=0;for(re[0]=0,we=1;we<=ee;++we)ne[we]=_e=_e+re[we-1]<<1;for(we=0;we<he;++we)(_e=te[we])!=0&&(ce[we]=ne[_e]++);var xe=0;for(we=0;we<he;++we)if(xe=te[we],xe!=0){_e=Z[ce[we]]>>8-xe;for(var Ne=(1<<7-xe)-1;Ne>=0;--Ne)wt[_e|Ne<<xe]=xe&7|we<<3}var Le=[];for(ee=1;Le.length<C+A;)switch(_e=wt[de(k,D)],D+=_e&7,_e>>>=3){case 16:for(O=3+ve(k,D),D+=2,_e=Le[Le.length-1];O-- >0;)Le.push(_e);break;case 17:for(O=3+Ae(k,D),D+=3;O-- >0;)Le.push(0);break;case 18:for(O=11+de(k,D),D+=7;O-- >0;)Le.push(0);break;default:Le.push(_e),ee<_e&&(ee=_e);break}var dt=Le.slice(0,C),ht=Le.slice(C);for(we=C;we<286;++we)dt[we]=0;for(we=A;we<30;++we)ht[we]=0;return Cn=Et(dt,He,286),Li=Et(ht,gr,30),D}function jo(k,D){if(k[0]==3&&!(k[1]&3))return[Ma(D),2];for(var C=0,A=0,P=Vx(D||1<<18),O=0,te=P.length>>>0,ce=0,ee=0;!(A&1);){if(A=Ae(k,C),C+=3,A>>>1)A>>1==1?(ce=9,ee=5):(C=So(k,C),ce=Cn,ee=Li);else{C&7&&(C+=8-(C&7));var re=k[C>>>3]|k[(C>>>3)+1]<<8;if(C+=32,re>0)for(!D&&te<O+re&&(P=Ye(P,O+re),te=P.length);re-- >0;)P[O++]=k[C>>>3],C+=8;continue}for(;;){!D&&te<O+32767&&(P=Ye(P,O+32767),te=P.length);var ne=se(k,C,ce),he=A>>>1==1?jr[ne]:He[ne];if(C+=he&15,he>>>=4,!(he>>>8&255))P[O++]=he;else{if(he==256)break;he-=257;var we=he<8?0:he-4>>2;we>5&&(we=0);var _e=O+W[he];we>0&&(_e+=se(k,C,we),C+=we),ne=se(k,C,ee),he=A>>>1==1?mn[ne]:gr[ne],C+=he&15,he>>>=4;var xe=he<4?0:he-2>>1,Ne=ie[he];for(xe>0&&(Ne+=se(k,C,xe),C+=xe),!D&&te<_e&&(P=Ye(P,_e+100),te=P.length);O<_e;)P[O]=P[O-Ne],++O}}}return D?[P,C+7>>>3]:[P.slice(0,O),C+7>>>3]}function Fn(k,D){var C=k.slice(k.l||0),A=jo(C,D);return k.l+=A[1],A[0]}function rm(k,D){if(k)typeof console<"u"&&console.error(D);else throw new Error(D)}function nm(k,D){var C=k;Jt(C,0);var A=[],P=[],O={FileIndex:A,FullPaths:P};N(O,{root:D.root});for(var te=C.length-4;(C[te]!=80||C[te+1]!=75||C[te+2]!=5||C[te+3]!=6)&&te>=0;)--te;C.l=te+4,C.l+=4;var ce=C.read_shift(2);C.l+=6;var ee=C.read_shift(4);for(C.l=ee,te=0;te<ce;++te){C.l+=20;var re=C.read_shift(4),ne=C.read_shift(4),he=C.read_shift(2),we=C.read_shift(2),_e=C.read_shift(2);C.l+=8;var xe=C.read_shift(4),Ne=o(C.slice(C.l+he,C.l+he+we));C.l+=he+we+_e;var Le=C.l;C.l=xe+4,cw(C,re,ne,O,Ne),C.l=Le}return O}function cw(k,D,C,A,P){k.l+=2;var O=k.read_shift(2),te=k.read_shift(2),ce=l(k);if(O&8257)throw new Error("Unsupported ZIP encryption");for(var ee=k.read_shift(4),re=k.read_shift(4),ne=k.read_shift(4),he=k.read_shift(2),we=k.read_shift(2),_e="",xe=0;xe<he;++xe)_e+=String.fromCharCode(k[k.l++]);if(we){var Ne=o(k.slice(k.l,k.l+we));(Ne[21589]||{}).mt&&(ce=Ne[21589].mt),((P||{})[21589]||{}).mt&&(ce=P[21589].mt)}k.l+=we;var Le=k.slice(k.l,k.l+re);switch(te){case 8:Le=z(k,ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+te)}var dt=!1;O&8&&(ee=k.read_shift(4),ee==134695760&&(ee=k.read_shift(4),dt=!0),re=k.read_shift(4),ne=k.read_shift(4)),re!=D&&rm(dt,"Bad compressed size: "+D+" != "+re),ne!=C&&rm(dt,"Bad uncompressed size: "+C+" != "+ne),q0(A,_e,Le,{unsafe:!0,mt:ce})}function uw(k,D){var C=D||{},A=[],P=[],O=oe(1),te=C.compression?8:0,ce=0,ee=0,re=0,ne=0,he=0,we=k.FullPaths[0],_e=we,xe=k.FileIndex[0],Ne=[],Le=0;for(ee=1;ee<k.FullPaths.length;++ee)if(_e=k.FullPaths[ee].slice(we.length),xe=k.FileIndex[ee],!(!xe.size||!xe.content||_e=="Sh33tJ5")){var dt=ne,ht=oe(_e.length);for(re=0;re<_e.length;++re)ht.write_shift(1,_e.charCodeAt(re)&127);ht=ht.slice(0,ht.l),Ne[he]=ZE.buf(xe.content,0);var tr=xe.content;te==8&&(tr=F(tr)),O=oe(30),O.write_shift(4,67324752),O.write_shift(2,20),O.write_shift(2,ce),O.write_shift(2,te),xe.mt?s(O,xe.mt):O.write_shift(4,0),O.write_shift(-4,Ne[he]),O.write_shift(4,tr.length),O.write_shift(4,xe.content.length),O.write_shift(2,ht.length),O.write_shift(2,0),ne+=O.length,A.push(O),ne+=ht.length,A.push(ht),ne+=tr.length,A.push(tr),O=oe(46),O.write_shift(4,33639248),O.write_shift(2,0),O.write_shift(2,20),O.write_shift(2,ce),O.write_shift(2,te),O.write_shift(4,0),O.write_shift(-4,Ne[he]),O.write_shift(4,tr.length),O.write_shift(4,xe.content.length),O.write_shift(2,ht.length),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(4,0),O.write_shift(4,dt),Le+=O.l,P.push(O),Le+=ht.length,P.push(ht),++he}return O=oe(22),O.write_shift(4,101010256),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,he),O.write_shift(2,he),O.write_shift(4,Le),O.write_shift(4,ne),O.write_shift(2,0),Wt([Wt(A),Wt(P),O])}var To={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function fw(k,D){if(k.ctype)return k.ctype;var C=k.name||"",A=C.match(/\.([^\.]+)$/);return A&&To[A[1]]||D&&(A=(C=D).match(/[\.\\]([^\.\\])+$/),A&&To[A[1]])?To[A[1]]:"application/octet-stream"}function dw(k){for(var D=Hl(k),C=[],A=0;A<D.length;A+=76)C.push(D.slice(A,A+76));return C.join(`\r
`)+`\r
`}function hw(k){var D=k.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var ne=re.charCodeAt(0).toString(16).toUpperCase();return"="+(ne.length==1?"0"+ne:ne)});D=D.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),D.charAt(0)==`
`&&(D="=0D"+D.slice(1)),D=D.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var C=[],A=D.split(`\r
`),P=0;P<A.length;++P){var O=A[P];if(O.length==0){C.push("");continue}for(var te=0;te<O.length;){var ce=76,ee=O.slice(te,te+ce);ee.charAt(ce-1)=="="?ce--:ee.charAt(ce-2)=="="?ce-=2:ee.charAt(ce-3)=="="&&(ce-=3),ee=O.slice(te,te+ce),te+=ce,te<O.length&&(ee+="="),C.push(ee)}}return C.join(`\r
`)}function mw(k){for(var D=[],C=0;C<k.length;++C){for(var A=k[C];C<=k.length&&A.charAt(A.length-1)=="=";)A=A.slice(0,A.length-1)+k[++C];D.push(A)}for(var P=0;P<D.length;++P)D[P]=D[P].replace(/[=][0-9A-Fa-f]{2}/g,function(O){return String.fromCharCode(parseInt(O.slice(1),16))});return $r(D.join(`\r
`))}function xw(k,D,C){for(var A="",P="",O="",te,ce=0;ce<10;++ce){var ee=D[ce];if(!ee||ee.match(/^\s*$/))break;var re=ee.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":A=re[2].trim();break;case"content-type":O=re[2].trim();break;case"content-transfer-encoding":P=re[2].trim();break}}switch(++ce,P.toLowerCase()){case"base64":te=$r(Kr(D.slice(ce).join("")));break;case"quoted-printable":te=mw(D.slice(ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+P)}var ne=q0(k,A.slice(C.length),te,{unsafe:!0});O&&(ne.ctype=O)}function pw(k,D){if(G(k.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var C=D&&D.root||"",A=($e&&Buffer.isBuffer(k)?k.toString("binary"):G(k)).split(`\r
`),P=0,O="";for(P=0;P<A.length;++P)if(O=A[P],!!/^Content-Location:/i.test(O)&&(O=O.slice(O.indexOf("file")),C||(C=O.slice(0,O.lastIndexOf("/")+1)),O.slice(0,C.length)!=C))for(;C.length>0&&(C=C.slice(0,C.length-1),C=C.slice(0,C.lastIndexOf("/")+1),O.slice(0,C.length)!=C););var te=(A[1]||"").match(/boundary="(.*?)"/);if(!te)throw new Error("MAD cannot find boundary");var ce="--"+(te[1]||""),ee=[],re=[],ne={FileIndex:ee,FullPaths:re};N(ne);var he,we=0;for(P=0;P<A.length;++P){var _e=A[P];_e!==ce&&_e!==ce+"--"||(we++&&xw(ne,A.slice(he,P),C),he=P)}return ne}function gw(k,D){var C=D||{},A=C.boundary||"SheetJS";A="------="+A;for(var P=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+A.slice(2)+'"',"","",""],O=k.FullPaths[0],te=O,ce=k.FileIndex[0],ee=1;ee<k.FullPaths.length;++ee)if(te=k.FullPaths[ee].slice(O.length),ce=k.FileIndex[ee],!(!ce.size||!ce.content||te=="Sh33tJ5")){te=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Le){return"_x"+Le.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Le){return"_u"+Le.charCodeAt(0).toString(16)+"_"});for(var re=ce.content,ne=$e&&Buffer.isBuffer(re)?re.toString("binary"):G(re),he=0,we=Math.min(1024,ne.length),_e=0,xe=0;xe<=we;++xe)(_e=ne.charCodeAt(xe))>=32&&_e<128&&++he;var Ne=he>=we*4/5;P.push(A),P.push("Content-Location: "+(C.root||"file:///C:/SheetJS/")+te),P.push("Content-Transfer-Encoding: "+(Ne?"quoted-printable":"base64")),P.push("Content-Type: "+fw(ce,te)),P.push(""),P.push(Ne?hw(ne):dw(ne))}return P.push(A+`--\r
`),P.join(`\r
`)}function vw(k){var D={};return N(D,k),D}function q0(k,D,C,A){var P=A&&A.unsafe;P||N(k);var O=!P&&De.find(k,D);if(!O){var te=k.FullPaths[0];D.slice(0,te.length)==te?te=D:(te.slice(-1)!="/"&&(te+="/"),te=(te+D).replace("//","/")),O={name:a(D),type:2},k.FileIndex.push(O),k.FullPaths.push(te),P||De.utils.cfb_gc(k)}return O.content=C,O.size=C?C.length:0,A&&(A.CLSID&&(O.clsid=A.CLSID),A.mt&&(O.mt=A.mt),A.ct&&(O.ct=A.ct)),O}function yw(k,D){N(k);var C=De.find(k,D);if(C){for(var A=0;A<k.FileIndex.length;++A)if(k.FileIndex[A]==C)return k.FileIndex.splice(A,1),k.FullPaths.splice(A,1),!0}return!1}function ww(k,D,C){N(k);var A=De.find(k,D);if(A){for(var P=0;P<k.FileIndex.length;++P)if(k.FileIndex[P]==A)return k.FileIndex[P].name=a(C),k.FullPaths[P]=C,!0}return!1}function bw(k){j(k,!0)}return t.find=V,t.read=E,t.parse=f,t.write=q,t.writeFile=le,t.utils={cfb_new:vw,cfb_add:q0,cfb_del:yw,cfb_mov:ww,cfb_gc:bw,ReadShift:xl,CheckField:Py,prep_blob:Jt,bconcat:Wt,use_zlib:S,_deflateRaw:Fe,_inflateRaw:Fn,consts:ue},t}();function eS(e){return typeof e=="string"?U0(e):Array.isArray(e)?SE(e):e}function go(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=U0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Mn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([eS(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Xa(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function tS(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function kt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Qx(e,t){for(var r=[],n=kt(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function $0(e){for(var t=[],r=kt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function W0(e){for(var t=[],r=kt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function rS(e){for(var t=[],r=kt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var r0=new Date(1899,11,30,0,0,0);function Ut(e,t){var r=e.getTime(),n=r0.getTime()+(e.getTimezoneOffset()-r0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var hy=new Date,nS=r0.getTime()+(hy.getTimezoneOffset()-r0.getTimezoneOffset())*6e4,Zx=hy.getTimezoneOffset();function V0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+nS),t.getTimezoneOffset()!==Zx&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Zx)*6e4),t}function aS(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var ep=new Date("2017-02-19T19:06:09.000Z"),my=isNaN(ep.getFullYear())?new Date("2/19/17"):ep,sS=my.getFullYear()==2017;function ct(e,t){var r=new Date(e);if(sS)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(my.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function _s(e,t){if($e&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Mn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Mn(ty(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Mn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Mn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function ut(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ut(e[r]));return t}function Nt(e,t){for(var r="";r.length<t;)r+=e;return r}function kn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var iS=["january","february","march","april","may","june","july","august","september","october","november","december"];function _i(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&iS.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var lS=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),l=[s[0]],o=1;o<s.length;++o)l.push(a),l.push(s[o]);return l}}();function xy(e){return e?e.content&&e.type?_s(e.content,!0):e.data?rl(e.data):e.asNodeBuffer&&$e?rl(e.asNodeBuffer().toString("binary")):e.asBinary?rl(e.asBinary()):e._data&&e._data.getContent?rl(_s(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function py(e){if(!e)return null;if(e.data)return $x(e.data);if(e.asNodeBuffer&&$e)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?$x(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function oS(e){return e&&e.name.slice(-4)===".bin"?py(e):xy(e)}function tn(e,t){for(var r=e.FullPaths||kt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function bh(e,t){var r=tn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Rt(e,t,r){if(!r)return oS(bh(e,t));if(!t)return null;try{return Rt(e,t)}catch{return null}}function Wr(e,t,r){if(!r)return xy(bh(e,t));if(!t)return null;try{return Wr(e,t)}catch{return null}}function cS(e,t,r){return py(bh(e,t))}function tp(e){for(var t=e.FullPaths||kt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ze(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return $e?n=fa(r):n=jE(r),De.utils.cfb_add(e,t,n)}De.utils.cfb_add(e,t,r)}else e.file(t,r)}function Nh(){return De.utils.cfb_new()}function gy(e,t){switch(t.type){case"base64":return De.read(e,{type:"base64"});case"binary":return De.read(e,{type:"binary"});case"buffer":case"array":return De.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function al(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var At=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,uS=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,rp=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,fS=/<[^>]*>/g,xr=At.match(rp)?rp:fS,dS=/<\w*:/,hS=/<(\/?)\w+:/;function Oe(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var l=e.match(uS),o=0,c="",u=0,f="",d="",h=1;if(l)for(u=0;u!=l.length;++u){for(d=l[u],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(f=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(h=(a=d.charCodeAt(s+1))==34||a==39?1:0,c=d.slice(s+1+h,d.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,n[f.toLowerCase()]=c;else{var y=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[y]&&f.slice(o-3,o)=="ext")continue;n[y]=c,n[y.toLowerCase()]=c}}return n}function Xn(e){return e.replace(hS,"<$1")}var vy={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},_h=$0(vy),Ge=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,c){return vy[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var l=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,l)+r(a.slice(l+3))}}(),kh=/[&<>'"]/g,mS=/[\u0000-\u0008\u000b-\u001f]/g;function Ze(e){var t=e+"";return t.replace(kh,function(r){return _h[r]}).replace(mS,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function np(e){return Ze(e).replace(/ /g,"_x0020_")}var yy=/[\u0000-\u001f]/g;function Eh(e){var t=e+"";return t.replace(kh,function(r){return _h[r]}).replace(/\n/g,"<br/>").replace(yy,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function xS(e){var t=e+"";return t.replace(kh,function(r){return _h[r]}).replace(yy,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var ap=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function pS(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function lt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Cu(e){for(var t="",r=0,n=0,a=0,s=0,l=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,t+=String.fromCharCode(l);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}l=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function sp(e){var t=Ma(2*e.length),r,n,a=1,s=0,l=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[s++]=l&255,t[s++]=l>>>8,l=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function ip(e){return fa(e,"binary").toString("utf8")}var Ko="foo bar baz",tt=$e&&(ip(Ko)==Cu(Ko)&&ip||sp(Ko)==Cu(Ko)&&sp)||Cu,Mn=$e?function(e){return fa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Gl=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),wy=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),gS=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),vS=/<\/?(?:vt:)?variant>/g,yS=/<(?:vt:)([^>]*)>([\s\S]*)</;function lp(e,t){var r=Oe(e),n=e.match(gS(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var l=s.replace(vS,"").match(yS);l&&a.push({v:tt(l[2]),t:l[1]})}),a}var by=/(^\s|\s$|\n)/;function Qt(e,t){return"<"+e+(t.match(by)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Kl(e){return kt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function pe(e,t,r){return"<"+e+(r!=null?Kl(r):"")+(t!=null?(t.match(by)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Kf(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function wS(e,t){switch(typeof e){case"string":var r=pe("vt:lpwstr",Ze(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return pe((e|0)==e?"vt:i4":"vt:r8",Ze(String(e)));case"boolean":return pe("vt:bool",e?"true":"false")}if(e instanceof Date)return pe("vt:filetime",Kf(e));throw new Error("Unable to serialize "+e)}function Sh(e){if($e&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return tt(Xa(vh(e)));throw new Error("Bad input format: expected Buffer or string")}var ql=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Lt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Fs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ur={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function bS(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function NS(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,l=n?-t:t;isFinite(l)?l==0?a=s=0:(a=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var op=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},cp=$e?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:fa(t)})):op(e)}:op,up=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Zn(e,a)));return n.join("").replace(_r,"")},jh=$e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(_r,""):up(e,t,r)}:up,fp=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Ny=$e?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):fp(e,t,r)}:fp,dp=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Us(e,a)));return n.join("")},vo=$e?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):dp(t,r,n)}:dp,_y=function(e,t){var r=zr(e,t);return r>0?vo(e,t+4,t+4+r-1):""},ky=_y,Ey=function(e,t){var r=zr(e,t);return r>0?vo(e,t+4,t+4+r-1):""},Sy=Ey,jy=function(e,t){var r=2*zr(e,t);return r>0?vo(e,t+4,t+4+r-1):""},Ty=jy,Cy=function(t,r){var n=zr(t,r);return n>0?jh(t,r+4,r+4+n):""},Fy=Cy,Ay=function(e,t){var r=zr(e,t);return r>0?vo(e,t+4,t+4+r):""},Dy=Ay,Ry=function(e,t){return bS(e,t)},n0=Ry,Th=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};$e&&(ky=function(t,r){if(!Buffer.isBuffer(t))return _y(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Sy=function(t,r){if(!Buffer.isBuffer(t))return Ey(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Ty=function(t,r){if(!Buffer.isBuffer(t))return jy(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Fy=function(t,r){if(!Buffer.isBuffer(t))return Cy(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Dy=function(t,r){if(!Buffer.isBuffer(t))return Ay(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},n0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Ry(t,r)},Th=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Us=function(e,t){return e[t]},Zn=function(e,t){return e[t+1]*256+e[t]},_S=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},zr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},es=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},kS=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function xl(e,t){var r="",n,a,s=[],l,o,c,u;switch(t){case"dbcs":if(u=this.l,$e&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Zn(this,u)),u+=2;e*=2;break;case"utf8":r=vo(this,this.l,this.l+e);break;case"utf16le":e*=2,r=jh(this,this.l,this.l+e);break;case"wstr":return xl.call(this,e,"dbcs");case"lpstr-ansi":r=ky(this,this.l),e=4+zr(this,this.l);break;case"lpstr-cp":r=Sy(this,this.l),e=4+zr(this,this.l);break;case"lpwstr":r=Ty(this,this.l),e=4+2*zr(this,this.l);break;case"lpp4":e=4+zr(this,this.l),r=Fy(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+zr(this,this.l),r=Dy(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Us(this,this.l+e++))!==0;)s.push(Go(l));r=s.join("");break;case"_wstr":for(e=0,r="";(l=Zn(this,this.l+e))!==0;)s.push(Go(l)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return l=Us(this,u),this.l=u+1,o=xl.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Go(Zn(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return l=Us(this,u),this.l=u+1,o=xl.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Go(Us(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=Us(this,this.l),this.l++,n;case 2:return n=(t==="i"?_S:Zn)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?es:kS)(this,this.l),this.l+=4,n):(a=zr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=n0(this,this.l):a=n0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=Ny(this,this.l,e);break}}return this.l+=e,r}var ES=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},SS=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},jS=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function TS(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)jS(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var l=t.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,ES(this,t,this.l);break;case 8:if(n=8,r==="f"){NS(this,t,this.l);break}case 16:break;case-4:n=4,SS(this,t,this.l);break}return this.l+=n,this}function Py(e,t){var r=Ny(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Jt(e,t){e.l=t,e.read_shift=xl,e.chk=Py,e.write_shift=TS}function mr(e,t){e.l+=t}function oe(e){var t=Ma(e);return Jt(t,0),t}function da(e,t,r){if(e){var n,a,s;Jt(e,e.l||0);for(var l=e.length,o=0,c=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=to[o]||to[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;c=e.l+s;var f=u.f&&u.f(e,s,r);if(e.l=c,t(f,u,o))return}}}function Or(){var e=[],t=$e?256:2048,r=function(u){var f=oe(u);return Jt(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},l=function(){return a(),Wt(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:l,_bufs:e}}function fe(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=to[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=e.next(s);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&Th(r)&&e.push(r)}}function pl(e,t,r){var n=ut(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function hp(e,t,r){var n=ut(e);return n.s=pl(n.s,t.s,r),n.e=pl(n.e,t.s,r),n}function gl(e,t){if(e.cRel&&e.c<0)for(e=ut(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ut(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Pe(e);return!e.cRel&&e.cRel!=null&&(r=AS(r)),!e.rRel&&e.rRel!=null&&(r=CS(r)),r}function Fu(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+xt(e.s.c)+":"+(e.e.cRel?"":"$")+xt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ct(e.s.r)+":"+(e.e.rRel?"":"$")+Ct(e.e.r):gl(e.s,t.biff)+":"+gl(e.e,t.biff)}function Ch(e){return parseInt(FS(e),10)-1}function Ct(e){return""+(e+1)}function CS(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function FS(e){return e.replace(/\$(\d+)$/,"$1")}function Fh(e){for(var t=DS(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function xt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function AS(e){return e.replace(/^([A-Z])/,"$$$1")}function DS(e){return e.replace(/^\$([A-Z])/,"$1")}function RS(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function pt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Pe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Mr(e){var t=e.indexOf(":");return t==-1?{s:pt(e),e:pt(e)}:{s:pt(e.slice(0,t)),e:pt(e.slice(t+1))}}function Be(e,t){return typeof t>"u"||typeof t=="number"?Be(e.s,e.e):(typeof e!="string"&&(e=Pe(e)),typeof t!="string"&&(t=Pe(t)),e==t?e:e+":"+t)}function Ke(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function mp(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=dn(e.z,r?Ut(t):t)}catch{}try{return e.w=dn((e.XF||{}).numFmtId||(r?14:0),r?Ut(t):t)}catch{return""+t}}function oa(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ha[e.v]||e.v:t==null?mp(e,e.v):mp(e,t))}function Ga(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Iy(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),l=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var c=typeof n.origin=="string"?pt(n.origin):n.origin;l=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Ke(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),l==-1&&(u.e.r=l=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var y={v:t[d][h]},g=l+d,m=o+h;if(u.s.r>g&&(u.s.r=g),u.s.c>m&&(u.s.c=m),u.e.r<g&&(u.e.r=g),u.e.c<m&&(u.e.c=m),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))y=t[d][h];else if(Array.isArray(y.v)&&(y.f=t[d][h][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||Re[14],n.cellDates?(y.t="d",y.w=dn(y.z,Ut(y.v))):(y.t="n",y.v=Ut(y.v),y.w=dn(y.z,y.v))):y.t="s";if(a)s[g]||(s[g]=[]),s[g][m]&&s[g][m].z&&(y.z=s[g][m].z),s[g][m]=y;else{var p=Pe({c:m,r:g});s[p]&&s[p].z&&(y.z=s[p].z),s[p]=y}}}return u.s.c<1e7&&(s["!ref"]=Be(u)),s}function Ii(e,t){return Iy(null,e,t)}function PS(e){return e.read_shift(4,"i")}function En(e,t){return t||(t=oe(4)),t.write_shift(4,e),t}function dr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ht(e,t){var r=!1;return t==null&&(r=!0,t=oe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function IS(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function OS(e,t){return t||(t=oe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Ah(e,t){var r=e.l,n=e.read_shift(1),a=dr(e),s=[],l={t:a,h:a};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)s.push(IS(e));l.r=s}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function LS(e,t){var r=!1;return t==null&&(r=!0,t=oe(15+4*e.t.length)),t.write_shift(1,0),Ht(e.t,t),r?t.slice(0,t.l):t}var MS=Ah;function BS(e,t){var r=!1;return t==null&&(r=!0,t=oe(23+4*e.t.length)),t.write_shift(1,1),Ht(e.t,t),t.write_shift(4,1),OS({},t),r?t.slice(0,t.l):t}function hn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function As(e,t){return t==null&&(t=oe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ds(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Rs(e,t){return t==null&&(t=oe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var US=dr,Oy=Ht;function Dh(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function a0(e,t){var r=!1;return t==null&&(r=!0,t=oe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var zS=dr,qf=Dh,Rh=a0;function Ph(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?n0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):es(t,0)>>2;return r?a/100:a}function Ly(e,t){t==null&&(t=oe(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function My(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function $S(e,t){return t||(t=oe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ps=My,Oi=$S;function ur(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ks(e,t){return(t||oe(8)).write_shift(8,e,"f")}function WS(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=fs[a];u&&(t.rgb=Jl(u));break;case 2:t.rgb=Jl([l,o,c]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function s0(e,t){if(t||(t=oe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function VS(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function HS(e,t){t||(t=oe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function By(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function XS(e){return By(e,1)}function GS(e){return By(e,2)}var Ih=2,Tr=3,qo=11,xp=12,i0=19,Yo=64,KS=65,qS=71,YS=4108,JS=4126,zt=80,Uy=81,QS=[zt,Uy],Yf={1:{n:"CodePage",t:Ih},2:{n:"Category",t:zt},3:{n:"PresentationFormat",t:zt},4:{n:"ByteCount",t:Tr},5:{n:"LineCount",t:Tr},6:{n:"ParagraphCount",t:Tr},7:{n:"SlideCount",t:Tr},8:{n:"NoteCount",t:Tr},9:{n:"HiddenCount",t:Tr},10:{n:"MultimediaClipCount",t:Tr},11:{n:"ScaleCrop",t:qo},12:{n:"HeadingPairs",t:YS},13:{n:"TitlesOfParts",t:JS},14:{n:"Manager",t:zt},15:{n:"Company",t:zt},16:{n:"LinksUpToDate",t:qo},17:{n:"CharacterCount",t:Tr},19:{n:"SharedDoc",t:qo},22:{n:"HyperlinksChanged",t:qo},23:{n:"AppVersion",t:Tr,p:"version"},24:{n:"DigSig",t:KS},26:{n:"ContentType",t:zt},27:{n:"ContentStatus",t:zt},28:{n:"Language",t:zt},29:{n:"Version",t:zt},255:{},2147483648:{n:"Locale",t:i0},2147483651:{n:"Behavior",t:i0},1919054434:{}},Jf={1:{n:"CodePage",t:Ih},2:{n:"Title",t:zt},3:{n:"Subject",t:zt},4:{n:"Author",t:zt},5:{n:"Keywords",t:zt},6:{n:"Comments",t:zt},7:{n:"Template",t:zt},8:{n:"LastAuthor",t:zt},9:{n:"RevNumber",t:zt},10:{n:"EditTime",t:Yo},11:{n:"LastPrinted",t:Yo},12:{n:"CreatedDate",t:Yo},13:{n:"ModifiedDate",t:Yo},14:{n:"PageCount",t:Tr},15:{n:"WordCount",t:Tr},16:{n:"CharCount",t:Tr},17:{n:"Thumbnail",t:qS},18:{n:"Application",t:zt},19:{n:"DocSecurity",t:Tr},255:{},2147483648:{n:"Locale",t:i0},2147483651:{n:"Behavior",t:i0},1919054434:{}},pp={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ZS=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function e3(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var t3=e3([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),fs=ut(t3),ha={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},zy={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Qf={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Jo={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Oh(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function r3(e){var t=Oh();if(!e||!e.match)return t;var r={};if((e.match(xr)||[]).forEach(function(n){var a=Oe(n);switch(a[0].replace(dS,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Qf[a.ContentType]]!==void 0&&t[Qf[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Lt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function $y(e,t){var r=rS(Qf),n=[],a;n[n.length]=At,n[n.length]=pe("Types",null,{xmlns:Lt.CT,"xmlns:xsd":Lt.xsd,"xmlns:xsi":Lt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return pe("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=pe("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Jo[c][t.bookType]||Jo[c].xlsx}))},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=pe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Jo[c][t.bookType]||Jo[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=pe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var We={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Yl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function vl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(xr)||[]).forEach(function(a){var s=Oe(a);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:al(s.Target,t);r[o]=l,n[s.Id]=l}}),r["!id"]=n,r}function oi(e){var t=[At,pe("Relationships",null,{xmlns:Lt.RELS})];return kt(e["!id"]).forEach(function(r){t[t.length]=pe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Qe(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[We.HLINK,We.XPATH,We.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var n3="application/vnd.oasis.opendocument.spreadsheet";function a3(e,t){for(var r=Sh(e),n,a;n=ql.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Oe(n[0],!1),a.path=="/"&&a.type!==n3)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function s3(e){var t=[At];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function gp(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function i3(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function l3(e){var t=[At];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(gp(e[r][0],e[r][1])),t.push(i3("",e[r][0]));return t.push(gp("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Wy(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Qc.version+"</meta:generator></office:meta></office:document-meta>"}var on=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],o3=function(){for(var e=new Array(on.length),t=0;t<on.length;++t){var r=on[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Vy(e){var t={};e=tt(e);for(var r=0;r<on.length;++r){var n=on[r],a=e.match(o3[r]);a!=null&&a.length>0&&(t[n[1]]=Ge(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=ct(t[n[1]]))}return t}function Au(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Ze(t),n[n.length]=r?pe(e,t,r):Qt(e,t))}function Hy(e,t){var r=t||{},n=[At,pe("cp:coreProperties",null,{"xmlns:cp":Lt.CORE_PROPS,"xmlns:dc":Lt.dc,"xmlns:dcterms":Lt.dcterms,"xmlns:dcmitype":Lt.dcmitype,"xmlns:xsi":Lt.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Au("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Kf(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Au("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Kf(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=on.length;++s){var l=on[s],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Au(l[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ds=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Xy=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Gy(e,t,r,n){var a=[];if(typeof e=="string")a=lp(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(f){return{v:f}}));var l=typeof t=="string"?lp(t,n).map(function(f){return f.v}):t,o=0,c=0;if(l.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=l.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=l.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=l.slice(o,o+c);break}o+=c}}function c3(e,t,r){var n={};return t||(t={}),e=tt(e),ds.forEach(function(a){var s=(e.match(Gl(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=Ge(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Gy(n.HeadingPairs,n.TitlesOfParts,t,r),t}function Ky(e){var t=[],r=pe;return e||(e={}),e.Application="SheetJS",t[t.length]=At,t[t.length]=pe("Properties",null,{xmlns:Lt.EXT_PROPS,"xmlns:vt":Lt.vt}),ds.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Ze(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ze(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var u3=/<[^>]+>[^<]*/g;function f3(e,t){var r={},n="",a=e.match(u3);if(a)for(var s=0;s!=a.length;++s){var l=a[s],o=Oe(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ge(o.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var c=l.split(">"),u=c[0].slice(4),f=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Ge(f);break;case"bool":r[n]=lt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=ct(f);break;case"cy":case"error":r[n]=Ge(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,u,c)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function qy(e){var t=[At,pe("Properties",null,{xmlns:Lt.CUST_PROPS,"xmlns:vt":Lt.vt})];if(!e)return t.join("");var r=1;return kt(e).forEach(function(a){++r,t[t.length]=pe("property",wS(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ze(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Zf={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Du;function d3(e,t,r){Du||(Du=$0(Zf)),t=Du[t]||t,e[t]=r}function h3(e,t){var r=[];return kt(Zf).map(function(n){for(var a=0;a<on.length;++a)if(on[a][1]==n)return on[a];for(a=0;a<ds.length;++a)if(ds[a][1]==n)return ds[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Qt(Zf[n[1]]||n[1],a))}}),pe("DocumentProperties",r.join(""),{xmlns:Ur.o})}function m3(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&kt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var l=0;l<on.length;++l)if(s==on[l][1])return;for(l=0;l<ds.length;++l)if(s==ds[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var o=e[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(pe(np(s),o,{"dt:dt":c}))}}),t&&kt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var l=t[s],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),a.push(pe(np(s),l,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Ur.o+'">'+a.join("")+"</"+n+">"}function Lh(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function x3(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var l=oe(8);return l.write_shift(4,n),l.write_shift(4,a),l}function Yy(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Jy(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Qy(e,t,r){return t===31?Jy(e):Yy(e,t,r)}function ed(e,t,r){return Qy(e,t,r===!1?0:4)}function p3(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Qy(e,t,0)}function g3(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(_r,""),e.l-a&2&&(e.l+=2)}return r}function v3(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(_r,"");return r}function y3(e){var t=e.l,r=l0(e,Uy);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=l0(e,Tr);return[r,n]}function w3(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(y3(e));return r}function vp(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),l=e.read_shift(4);n[s]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(_r,"").replace(nl,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Zy(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function b3(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function l0(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==xp&&n!==t&&QS.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===xp?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Yy(e,n,4).replace(_r,"");case 31:return Jy(e);case 64:return Lh(e);case 65:return Zy(e);case 71:return b3(e);case 80:return ed(e,n,!s.raw).replace(_r,"");case 81:return p3(e,n).replace(_r,"");case 4108:return w3(e);case 4126:case 4127:return n==4127?g3(e):v3(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function yp(e,t){var r=oe(4),n=oe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=oe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=x3(t);break;case 31:case 80:for(n=oe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Wt([r,n])}function wp(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],l=0,o=0,c=-1,u={};for(l=0;l!=a;++l){var f=e.read_shift(4),d=e.read_shift(4);s[l]=[f,d+r]}s.sort(function(v,w){return v[1]-w[1]});var h={};for(l=0;l!=a;++l){if(e.l!==s[l][1]){var y=!0;if(l>0&&t)switch(t[s[l-1][0]].t){case 2:e.l+2===s[l][1]&&(e.l+=2,y=!1);break;case 80:e.l<=s[l][1]&&(e.l=s[l][1],y=!1);break;case 4108:e.l<=s[l][1]&&(e.l=s[l][1],y=!1);break}if((!t||l==0)&&e.l<=s[l][1]&&(y=!1,e.l=s[l][1]),y)throw new Error("Read Error: Expected address "+s[l][1]+" at "+e.l+" :"+l)}if(t){var g=t[s[l][0]];if(h[g.n]=l0(e,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:wn(o=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(s[l][0]===1){if(o=h.CodePage=l0(e,Ih),wn(o),c!==-1){var m=e.l;e.l=s[c][1],u=vp(e,o),e.l=m}}else if(s[l][0]===0){if(o===0){c=l,e.l=s[l+1][1];continue}u=vp(e,o)}else{var p=u[s[l][0]],x;switch(e[e.l]){case 65:e.l+=4,x=Zy(e);break;case 30:e.l+=4,x=ed(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=ed(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=jt(e,4);break;case 64:e.l+=4,x=ct(Lh(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[p]=x}}return e.l=r+n,h}var e2=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function N3(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function bp(e,t,r){var n=oe(8),a=[],s=[],l=8,o=0,c=oe(8),u=oe(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),a.push(u),l+=8+c.length,!t){u=oe(8),u.write_shift(4,0),a.unshift(u);var f=[oe(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(c=oe(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=Wt(f),s.unshift(c),l+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(e2.indexOf(e[o][0])>-1||Xy.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],y=0;if(t){y=+t[e[o][0]];var g=r[y];if(g.p=="version"&&typeof h=="string"){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}c=yp(g.t,h)}else{var p=N3(h);p==-1&&(p=31,h=String(h)),c=yp(p,h)}s.push(c),u=oe(8),u.write_shift(4,t?y:2+o),a.push(u),l+=8+c.length}var x=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,x),x+=s[o].length;return n.write_shift(4,l),n.write_shift(4,s.length),Wt([n].concat(a).concat(s))}function Np(e,t,r){var n=e.content;if(!n)return{};Jt(n,0);var a,s,l,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==De.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(l=n.read_shift(16),c=n.read_shift(4));var d=wp(n,t),h={SystemIdentifier:u};for(var y in d)h[y]=d[y];if(h.FMTID=s,a===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var g;try{g=wp(n,null)}catch{}for(y in g)h[y]=g[y];return h.FMTID=[s,l],h}function _p(e,t,r,n,a,s){var l=oe(a?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,De.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,a?68:48);var c=bp(e,r,n);if(o.push(c),a){var u=bp(a,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+c.length),o.push(u)}return Wt(o)}function xa(e,t){return e.read_shift(t),null}function _3(e,t){t||(t=oe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function k3(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function jt(e,t){return e.read_shift(t)===1}function wr(e,t){return t||(t=oe(2)),t.write_shift(2,+!!e),t}function Pt(e){return e.read_shift(2,"u")}function rn(e,t){return t||(t=oe(2)),t.write_shift(2,e),t}function t2(e,t){return k3(e,t,Pt)}function E3(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function r2(e,t,r){return r||(r=oe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function yo(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?e.read_shift(n,a):"";return l}function S3(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),l=0,o,c={};a&&(l=e.read_shift(2)),n&&(o=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return a&&(e.l+=4*l),n&&(e.l+=o),c.t=f,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function j3(e){var t=e.t||"",r=oe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=oe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Wt(a)}function Es(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function wo(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Es(e,n,r)}function Is(e,t,r){if(r.biff>5)return wo(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function n2(e,t,r){return r||(r=oe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function T3(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function C3(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(_r,"");return n&&(e.l+=24),a}function F3(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(s>>1,"utf16le").replace(_r,"");return r+l}function A3(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return C3(e);case"0303000000000000c000000000000046":return F3(e);default:throw new Error("Unsupported Moniker "+r)}}function Qo(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(_r,""):"";return r}function kp(e,t){t||(t=oe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function D3(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,l,o,c,u="",f,d;a&16&&(s=Qo(e,r-e.l)),a&128&&(l=Qo(e,r-e.l)),(a&257)===257&&(o=Qo(e,r-e.l)),(a&257)===1&&(c=A3(e,r-e.l)),a&8&&(u=Qo(e,r-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(d=Lh(e)),e.l=r;var h=l||o||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var y={Target:h};return f&&(y.guid=f),d&&(y.time=d),s&&(y.Tooltip=s),y}function R3(e){var t=oe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(s==28)n=n.slice(1),kp(n,t);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&kp(a>-1?n.slice(a+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function a2(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function s2(e,t){var r=a2(e);return r[3]=0,r}function Gn(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Ss(e,t,r,n){return n||(n=oe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function P3(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function I3(e,t,r){return t===0?"":Is(e,t,r)}function O3(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[a,s,l]}function i2(e){var t=e.read_shift(2),r=Ph(e);return[t,r]}function L3(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=yo(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function H0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function l2(e,t){return t||(t=oe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function o2(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var M3=o2;function c2(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function B3(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function U3(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ar(e){e.l+=2,e.l+=e.read_shift(2)}var z3={0:ar,4:ar,5:ar,6:ar,7:U3,8:ar,9:ar,10:ar,11:ar,12:ar,13:B3,14:ar,15:ar,16:ar,17:ar,18:ar,19:ar,20:ar,21:c2};function $3(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(z3[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Zo(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Mh(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=oe(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function W3(e,t){return t===0||e.read_shift(2),1200}function V3(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Is(e,0,r);return e.read_shift(t+n-e.l),a}function H3(e,t){var r=!t||t.biff==8,n=oe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function X3(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function G3(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=yo(e,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:s,name:l}}function K3(e,t){var r=!t||t.biff>=8?2:1,n=oe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function q3(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],l=0;l!=a&&e.l<r;++l)s.push(S3(e));return s.Count=n,s.Unique=a,s}function Y3(e,t){var r=oe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=j3(e[a]);var s=Wt([r].concat(n));return s.parts=[r.length].concat(n.map(function(l){return l.length})),s}function J3(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Q3(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Z3(e){var t=P3(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function ej(e){return e.read_shift(2),e.read_shift(4)}function Ep(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function tj(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:l,FirstTab:o,Selected:c,TabRatio:u}}function rj(){var e=oe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function nj(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function aj(e){var t=oe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function sj(){}function ij(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=yo(e,0,r),n}function lj(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=oe(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function oj(e){var t=Gn(e);return t.isst=e.read_shift(4),t}function cj(e,t,r,n){var a=oe(10);return Ss(e,t,n,a),a.write_shift(4,r),a}function uj(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Gn(e);r.biff==2&&e.l++;var s=wo(e,n-e.l,r);return a.val=s,a}function fj(e,t,r,n,a){var s=!a||a.biff==8,l=oe(8+ +s+(1+s)*r.length);return Ss(e,t,n,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function dj(e,t,r){var n=e.read_shift(2),a=Is(e,0,r);return[n,a]}function hj(e,t,r,n){var a=r&&r.biff==5;n||(n=oe(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var mj=Is;function Sp(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:l,c}}}function xj(e,t){var r=t.biff==8||!t.biff?4:2,n=oe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function pj(e){var t=e.read_shift(2),r=e.read_shift(2),n=i2(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function gj(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(i2(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(s.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:s}}function vj(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(s.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:s}}function yj(e,t,r,n){var a={},s=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=ZS[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function wj(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=yj(e,t,n.fStyle,r),n}function jp(e,t,r,n){var a=r&&r.biff==5;n||(n=oe(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function bj(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Nj(e){var t=oe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Tp(e,t,r){var n=Gn(e);(r.biff==2||t==9)&&++e.l;var a=E3(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function _j(e,t,r,n,a,s){var l=oe(8);return Ss(e,t,n,l),r2(r,s,l),l}function kj(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Gn(e),a=ur(e);return n.val=a,n}function Ej(e,t,r,n){var a=oe(14);return Ss(e,t,n,a),ks(r,a),a}var Cp=I3;function Sj(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=Es(e,s),o=[];n>e.l;)o.push(wo(e));return[s,a,l,o]}function Fp(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=L3(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var jj=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ap(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Es(e,l,r);a&32&&(u=jj[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:$C(e,f,r,o);return{chKey:s,Name:u,itab:c,rgce:d}}function u2(e,t,r){if(r.biff<8)return Tj(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(O3(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Tj(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=yo(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Cj(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=Es(e,n,r),l=Es(e,a,r);return[s,l]}function Fj(e,t,r){var n=o2(e);e.l++;var a=e.read_shift(1);return t-=8,[WC(e,t,r),a,n]}function Dp(e,t,r){var n=M3(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,UC(e,t,r)]}function Aj(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Dj(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=Is(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,l,s]}}function Rj(e,t,r){return Dj(e,t,r)}function Pj(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(H0(e));return r}function Ij(e){var t=oe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)l2(e[r],t);return t}function Oj(e,t,r){if(r&&r.biff<8)return Mj(e,t,r);var n=c2(e),a=$3(e,t-22,n[1]);return{cmo:n,ft:a}}var Lj={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function Mj(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((Lj[n]||mr)(e,t,r)),{cmo:[a,n,s],ft:l}}function Bj(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:l=T3(e,6,r);var o=e.read_shift(2);e.read_shift(2),Pt(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],d=Es(e,e.lens[u+1]-e.lens[u]-1);if(a+=d,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function Uj(e,t){var r=H0(e);e.l+=16;var n=D3(e,t-24);return[r,n]}function zj(e){var t=oe(24),r=pt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Wt([t,R3(e[1])])}function $j(e,t){e.read_shift(2);var r=H0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(_r,""),[r,n]}function Wj(e){var t=e[1].Tooltip,r=oe(10+2*(t.length+1));r.write_shift(2,2048);var n=pt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function Vj(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=pp[r]||r,r=e.read_shift(2),t[1]=pp[r]||r,t}function Hj(e){return e||(e=oe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Xj(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(s2(e));return r}function Gj(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(s2(e));return r}function Kj(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function f2(e,t,r){if(!r.cellStyles)return mr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:s,w:l,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function qj(e,t){var r=oe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Yj(e,t){var r={};return t<32||(e.l+=16,r.header=ur(e),r.footer=ur(e),e.l+=2),r}function Jj(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function Qj(e){for(var t=oe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Zj=Gn,eT=t2,tT=wo;function rT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function nT(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Gn(e);++e.l;var a=Is(e,t-7,r);return n.t="str",n.val=a,n}function aT(e){var t=Gn(e);++e.l;var r=ur(e);return t.t="n",t.val=r,t}function sT(e,t,r){var n=oe(15);return ko(n,e,t),n.write_shift(8,r,"f"),n}function iT(e){var t=Gn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function lT(e,t,r){var n=oe(9);return ko(n,e,t),n.write_shift(2,r),n}function oT(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function cT(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function uT(e,t,r){var n=e.l+t,a=Gn(e),s=e.read_shift(2),l=Es(e,s,r);return e.l=n,a.t="str",a.val=l,a}var fT=[2,3,48,49,131,139,140,245],td=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=$0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],f=Ma(1);switch(c.type){case"base64":f=$r(Kr(o));break;case"binary":f=$r(o);break;case"buffer":case"array":f=o;break}Jt(f,0);var d=f.read_shift(1),h=!!(d&136),y=!1,g=!1;switch(d){case 2:break;case 3:break;case 48:y=!0,h=!0;break;case 49:y=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var m=0,p=521;d==2&&(m=f.read_shift(2)),f.l+=3,d!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),d!=2&&(p=f.read_shift(2));var x=f.read_shift(2),v=c.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(v=e[f[f.l]]),f.l+=1,f.l+=2),g&&(f.l+=36);for(var w=[],b={},_=Math.min(f.length,d==2?521:p-10-(y?264:0)),E=g?32:11;f.l<_&&f[f.l]!=13;)switch(b={},b.name=Vl.utils.decode(v,f.slice(f.l,f.l+E)).replace(/[\u0000\r\n].*$/g,""),f.l+=E,b.type=String.fromCharCode(f.read_shift(1)),d!=2&&!g&&(b.offset=f.read_shift(4)),b.len=f.read_shift(1),d==2&&(b.offset=f.read_shift(2)),b.dec=f.read_shift(1),b.name.length&&w.push(b),d!=2&&(f.l+=g?13:14),b.type){case"B":(!y||b.len!=8)&&c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(f[f.l]!==13&&(f.l=p-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=p;var N=0,R=0;for(u[0]=[],R=0;R!=w.length;++R)u[0][R]=w[R].name;for(;m-- >0;){if(f[f.l]===42){f.l+=x;continue}for(++f.l,u[++N]=[],R=0,R=0;R!=w.length;++R){var j=f.slice(f.l,f.l+w[R].len);f.l+=w[R].len,Jt(j,0);var L=Vl.utils.decode(v,j);switch(w[R].type){case"C":L.trim().length&&(u[N][R]=L.replace(/\s+$/,""));break;case"D":L.length===8?u[N][R]=new Date(+L.slice(0,4),+L.slice(4,6)-1,+L.slice(6,8)):u[N][R]=L;break;case"F":u[N][R]=parseFloat(L.trim());break;case"+":case"I":u[N][R]=g?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(L.trim().toUpperCase()){case"Y":case"T":u[N][R]=!0;break;case"N":case"F":u[N][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+L+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[N][R]="##MEMO##"+(g?parseInt(L.trim(),10):j.read_shift(4));break;case"N":L=L.replace(/\u0000/g,"").trim(),L&&L!="."&&(u[N][R]=+L||0);break;case"@":u[N][R]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":u[N][R]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":u[N][R]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[N][R]=-j.read_shift(-8,"f");break;case"B":if(y&&w[R].len==8){u[N][R]=j.read_shift(8,"f");break}case"G":case"P":j.l+=w[R].len;break;case"0":if(w[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[R].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Ii(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function a(o,c){try{return Ga(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,c){var u=c||{};if(+u.codepage>=0&&wn(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Or(),d=f0(o,{header:1,raw:!0,cellDates:!0}),h=d[0],y=d.slice(1),g=o["!cols"]||[],m=0,p=0,x=0,v=1;for(m=0;m<h.length;++m){if(((g[m]||{}).DBF||{}).name){h[m]=g[m].DBF.name,++x;continue}if(h[m]!=null){if(++x,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(p=0;p<1024;++p)if(h.indexOf(h[m]+"_"+p)==-1){h[m]+="_"+p;break}}}}var w=Ke(o["!ref"]),b=[],_=[],E=[];for(m=0;m<=w.e.c-w.s.c;++m){var N="",R="",j=0,L=[];for(p=0;p<y.length;++p)y[p][m]!=null&&L.push(y[p][m]);if(L.length==0||h[m]==null){b[m]="?";continue}for(p=0;p<L.length;++p){switch(typeof L[p]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=L[p]instanceof Date?"D":"C";break;default:R="C"}j=Math.max(j,String(L[p]).length),N=N&&N!=R?"C":R}j>250&&(j=250),R=((g[m]||{}).DBF||{}).type,R=="C"&&g[m].DBF.len>j&&(j=g[m].DBF.len),N=="B"&&R=="N"&&(N="N",E[m]=g[m].DBF.dec,j=g[m].DBF.len),_[m]=N=="C"||R=="N"?j:s[N]||0,v+=_[m],b[m]=N}var V=f.next(32);for(V.write_shift(4,318902576),V.write_shift(4,y.length),V.write_shift(2,296+32*x),V.write_shift(2,v),m=0;m<4;++m)V.write_shift(4,0);for(V.write_shift(4,0|(+t[ey]||3)<<8),m=0,p=0;m<h.length;++m)if(h[m]!=null){var K=f.next(32),Y=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);K.write_shift(1,Y,"sbcs"),K.write_shift(1,b[m]=="?"?"C":b[m],"sbcs"),K.write_shift(4,p),K.write_shift(1,_[m]||s[b[m]]||0),K.write_shift(1,E[m]||0),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(1,0),K.write_shift(4,0),K.write_shift(4,0),p+=_[m]||s[b[m]]||0}var H=f.next(264);for(H.write_shift(4,13),m=0;m<65;++m)H.write_shift(4,0);for(m=0;m<y.length;++m){var B=f.next(v);for(B.write_shift(1,0),p=0;p<h.length;++p)if(h[p]!=null)switch(b[p]){case"L":B.write_shift(1,y[m][p]==null?63:y[m][p]?84:70);break;case"B":B.write_shift(8,y[m][p]||0,"f");break;case"N":var J="0";for(typeof y[m][p]=="number"&&(J=y[m][p].toFixed(E[p]||0)),x=0;x<_[p]-J.length;++x)B.write_shift(1,32);B.write_shift(1,J,"sbcs");break;case"D":y[m][p]?(B.write_shift(4,("0000"+y[m][p].getFullYear()).slice(-4),"sbcs"),B.write_shift(2,("00"+(y[m][p].getMonth()+1)).slice(-2),"sbcs"),B.write_shift(2,("00"+y[m][p].getDate()).slice(-2),"sbcs")):B.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(y[m][p]!=null?y[m][p]:"").slice(0,_[p]);for(B.write_shift(1,ue,"sbcs"),x=0;x<_[p]-ue.length;++x)B.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}}(),d2=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+kt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,y){var g=e[y];return typeof g=="number"?Wx(g):g},n=function(h,y,g){var m=y.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?h:Wx(m)};e["|"]=254;function a(h,y){switch(y.type){case"base64":return s(Kr(h),y);case"binary":return s(h,y);case"buffer":return s($e&&Buffer.isBuffer(h)?h.toString("binary"):Xa(h),y);case"array":return s(_s(h),y)}throw new Error("Unrecognized type "+y.type)}function s(h,y){var g=h.split(/[\n\r]+/),m=-1,p=-1,x=0,v=0,w=[],b=[],_=null,E={},N=[],R=[],j=[],L=0,V;for(+y.codepage>=0&&wn(+y.codepage);x!==g.length;++x){L=0;var K=g[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Y=K.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),H=Y[0],B;if(K.length>0)switch(H){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&b.push(K.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,ue=!1,le=!1,G=!1,q=-1,U=-1;for(v=1;v<Y.length;++v)switch(Y[v].charAt(0)){case"A":break;case"X":p=parseInt(Y[v].slice(1))-1,ue=!0;break;case"Y":for(m=parseInt(Y[v].slice(1))-1,ue||(p=0),V=w.length;V<=m;++V)w[V]=[];break;case"K":B=Y[v].slice(1),B.charAt(0)==='"'?B=B.slice(1,B.length-1):B==="TRUE"?B=!0:B==="FALSE"?B=!1:isNaN(kn(B))?isNaN(_i(B).getDate())||(B=ct(B)):(B=kn(B),_!==null&&Ri(_)&&(B=V0(B))),J=!0;break;case"E":G=!0;var S=ci(Y[v].slice(1),{r:m,c:p});w[m][p]=[w[m][p],S];break;case"S":le=!0,w[m][p]=[w[m][p],"S5S"];break;case"G":break;case"R":q=parseInt(Y[v].slice(1))-1;break;case"C":U=parseInt(Y[v].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+K)}if(J&&(w[m][p]&&w[m][p].length==2?w[m][p][0]=B:w[m][p]=B,_=null),le){if(G)throw new Error("SYLK shared formula cannot have own formula");var z=q>-1&&w[q][U];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");w[m][p][1]=F2(z[1],{r:m-q,c:p-U})}break;case"F":var F=0;for(v=1;v<Y.length;++v)switch(Y[v].charAt(0)){case"X":p=parseInt(Y[v].slice(1))-1,++F;break;case"Y":for(m=parseInt(Y[v].slice(1))-1,V=w.length;V<=m;++V)w[V]=[];break;case"M":L=parseInt(Y[v].slice(1))/20;break;case"F":break;case"G":break;case"P":_=b[parseInt(Y[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=Y[v].slice(1).split(" "),V=parseInt(j[0],10);V<=parseInt(j[1],10);++V)L=parseInt(j[2],10),R[V-1]=L===0?{hidden:!0}:{wch:L},Ba(R[V-1]);break;case"C":p=parseInt(Y[v].slice(1))-1,R[p]||(R[p]={});break;case"R":m=parseInt(Y[v].slice(1))-1,N[m]||(N[m]={}),L>0?(N[m].hpt=L,N[m].hpx=Ei(L)):L===0&&(N[m].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+K)}F<1&&(_=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+K)}}return N.length>0&&(E["!rows"]=N),R.length>0&&(E["!cols"]=R),y&&y.sheetRows&&(w=w.slice(0,y.sheetRows)),[w,E]}function l(h,y){var g=a(h,y),m=g[0],p=g[1],x=Ii(m,y);return kt(p).forEach(function(v){x[v]=p[v]}),x}function o(h,y){return Ga(l(h,y),y)}function c(h,y,g,m){var p="C;Y"+(g+1)+";X"+(m+1)+";K";switch(h.t){case"n":p+=h.v||0,h.f&&!h.F&&(p+=";E"+Vh(h.f,{r:g,c:m}));break;case"b":p+=h.v?"TRUE":"FALSE";break;case"e":p+=h.w||h.v;break;case"d":p+='"'+(h.w||h.v)+'"';break;case"s":p+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return p}function u(h,y){y.forEach(function(g,m){var p="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?p+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Ql(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Zl(g.wpx)),typeof g.wch=="number"&&(p+=Math.round(g.wch))),p.charAt(p.length-1)!=" "&&h.push(p)})}function f(h,y){y.forEach(function(g,m){var p="F;";g.hidden?p+="M0;":g.hpt?p+="M"+20*g.hpt+";":g.hpx&&(p+="M"+20*eo(g.hpx)+";"),p.length>2&&h.push(p+"R"+(m+1))})}function d(h,y){var g=["ID;PWXL;N;E"],m=[],p=Ke(h["!ref"]),x,v=Array.isArray(h),w=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&u(g,h["!cols"]),h["!rows"]&&f(g,h["!rows"]),g.push("B;Y"+(p.e.r-p.s.r+1)+";X"+(p.e.c-p.s.c+1)+";D"+[p.s.c,p.s.r,p.e.c,p.e.r].join(" "));for(var b=p.s.r;b<=p.e.r;++b)for(var _=p.s.c;_<=p.e.c;++_){var E=Pe({r:b,c:_});x=v?(h[b]||[])[_]:h[E],!(!x||x.v==null&&(!x.f||x.F))&&m.push(c(x,h,b,_))}return g.join(w)+w+m.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:l,from_sheet:d}}(),h2=function(){function e(s,l){switch(l.type){case"base64":return t(Kr(s),l);case"binary":return t(s,l);case"buffer":return t($e&&Buffer.isBuffer(s)?s.toString("binary"):Xa(s),l);case"array":return t(_s(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){for(var o=s.split(`
`),c=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++c]=[],u=0;continue}if(!(c<0)){var h=o[f].trim().split(","),y=h[0],g=h[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+y){case-1:if(m==="BOT"){d[++c]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[c][u]=!0:m==="FALSE"?d[c][u]=!1:isNaN(kn(g))?isNaN(_i(g).getDate())?d[c][u]=g:d[c][u]=ct(g):d[c][u]=kn(g),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[c][u++]=m!==""?m:null;break}if(m==="EOD")break}}return l&&l.sheetRows&&(d=d.slice(0,l.sheetRows)),d}function r(s,l){return Ii(e(s,l),l)}function n(s,l){return Ga(r(s,l),l)}var a=function(){var s=function(c,u,f,d,h){c.push(u),c.push(f+","+d),c.push('"'+h.replace(/"/g,'""')+'"')},l=function(c,u,f,d){c.push(u+","+f),c.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var u=[],f=Ke(c["!ref"]),d,h=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var y=f.s.r;y<=f.e.r;++y){l(u,-1,0,"BOT");for(var g=f.s.c;g<=f.e.c;++g){var m=Pe({r:y,c:g});if(d=h?(c[y]||[])[g]:c[m],!d){l(u,1,0,"");continue}switch(d.t){case"n":var p=d.w;!p&&d.v!=null&&(p=d.v),p==null?d.f&&!d.F?l(u,1,0,"="+d.f):l(u,1,0,""):l(u,0,p,"V");break;case"b":l(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":l(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=dn(d.z||Re[14],Ut(ct(d.v)))),l(u,0,d.w,"V");break;default:l(u,1,0,"")}}}l(u,-1,0,"EOD");var x=`\r
`,v=u.join(x);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),m2=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var y=d.split(`
`),g=-1,m=-1,p=0,x=[];p!==y.length;++p){var v=y[p].trim().split(":");if(v[0]==="cell"){var w=pt(v[1]);if(x.length<=w.r)for(g=x.length;g<=w.r;++g)x[g]||(x[g]=[]);switch(g=w.r,m=w.c,v[2]){case"t":x[g][m]=e(v[3]);break;case"v":x[g][m]=+v[3];break;case"vtf":var b=v[v.length-1];case"vtc":switch(v[3]){case"nl":x[g][m]=!!+v[4];break;default:x[g][m]=+v[4];break}v[2]=="vtf"&&(x[g][m]=[x[g][m],b])}}}return h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}function n(d,h){return Ii(r(d,h),h)}function a(d,h){return Ga(n(d,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var h=[],y=[],g,m="",p=Mr(d["!ref"]),x=Array.isArray(d),v=p.s.r;v<=p.e.r;++v)for(var w=p.s.c;w<=p.e.c;++w)if(m=Pe({r:v,c:w}),g=x?(d[v]||[])[w]:d[m],!(!g||g.v==null||g.t==="z")){switch(y=["cell",m,"t"],g.t){case"s":case"str":y.push(t(g.v));break;case"n":g.f?(y[2]="vtf",y[3]="n",y[4]=g.v,y[5]=t(g.f)):(y[2]="v",y[3]=g.v);break;case"b":y[2]="vt"+(g.f?"f":"c"),y[3]="nl",y[4]=g.v?"1":"0",y[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var b=Ut(ct(g.v));y[2]="vtc",y[3]="nd",y[4]=""+b,y[5]=g.w||dn(g.z||Re[14],b);break;case"e":continue}h.push(y.join(":"))}return h.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[s,l,o,l,u(d),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),ki=function(){function e(f,d,h,y,g){g.raw?d[h][y]=f:f===""||(f==="TRUE"?d[h][y]=!0:f==="FALSE"?d[h][y]=!1:isNaN(kn(f))?isNaN(_i(f).getDate())?d[h][y]=f:d[h][y]=ct(f):d[h][y]=kn(f))}function t(f,d){var h=d||{},y=[];if(!f||f.length===0)return y;for(var g=f.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var p=10,x=0,v=0;v<=m;++v)x=g[v].indexOf(" "),x==-1?x=g[v].length:x++,p=Math.max(p,x);for(v=0;v<=m;++v){y[v]=[];var w=0;for(e(g[v].slice(0,p).trim(),y,v,w,h),w=1;w<=(g[v].length-p)/10+1;++w)e(g[v].slice(p+(w-1)*10,p+w*10).trim(),y,v,w,h)}return h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},h=!1,y=0,g=0;y<f.length;++y)(g=f.charCodeAt(y))==34?h=!h:!h&&g in r&&(d[g]=(d[g]||0)+1);g=[];for(y in d)Object.prototype.hasOwnProperty.call(d,y)&&g.push([d[y],y]);if(!g.length){d=n;for(y in d)Object.prototype.hasOwnProperty.call(d,y)&&g.push([d[y],y])}return g.sort(function(m,p){return m[0]-p[0]||n[m[1]]-n[p[1]]}),r[g.pop()[1]]||44}function s(f,d){var h=d||{},y="",g=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(y=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(y=f.charAt(4),f=f.slice(6)):y=a(f.slice(0,1024)):h&&h.FS?y=h.FS:y=a(f.slice(0,1024));var p=0,x=0,v=0,w=0,b=0,_=y.charCodeAt(0),E=!1,N=0,R=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var j=h.dateNF!=null?JE(h.dateNF):null;function L(){var V=f.slice(w,b),K={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)K.t="z";else if(h.raw)K.t="s",K.v=V;else if(V.trim().length===0)K.t="s",K.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(K.t="s",K.v=V.slice(2,-1).replace(/""/g,'"')):S5(V)?(K.t="n",K.f=V.slice(1)):(K.t="s",K.v=V);else if(V=="TRUE")K.t="b",K.v=!0;else if(V=="FALSE")K.t="b",K.v=!1;else if(!isNaN(v=kn(V)))K.t="n",h.cellText!==!1&&(K.w=V),K.v=v;else if(!isNaN(_i(V).getDate())||j&&V.match(j)){K.z=h.dateNF||Re[14];var Y=0;j&&V.match(j)&&(V=QE(V,h.dateNF,V.match(j)||[]),Y=1),h.cellDates?(K.t="d",K.v=ct(V,Y)):(K.t="n",K.v=Ut(ct(V,Y))),h.cellText!==!1&&(K.w=dn(K.z,K.v instanceof Date?Ut(K.v):K.v)),h.cellNF||delete K.z}else K.t="s",K.v=V;if(K.t=="z"||(h.dense?(g[p]||(g[p]=[]),g[p][x]=K):g[Pe({c:x,r:p})]=K),w=b+1,R=f.charCodeAt(w),m.e.c<x&&(m.e.c=x),m.e.r<p&&(m.e.r=p),N==_)++x;else if(x=0,++p,h.sheetRows&&h.sheetRows<=p)return!0}e:for(;b<f.length;++b)switch(N=f.charCodeAt(b)){case 34:R===34&&(E=!E);break;case _:case 10:case 13:if(!E&&L())break e;break}return b-w>0&&L(),g["!ref"]=Be(m),g}function l(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,d):Ii(t(f,d),d)}function o(f,d){var h="",y=d.type=="string"?[0,0,0,0]:Qh(f,d);switch(d.type){case"base64":h=Kr(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):d.codepage&&typeof Vl<"u"||(h=$e&&Buffer.isBuffer(f)?f.toString("binary"):Xa(f));break;case"array":h=_s(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return y[0]==239&&y[1]==187&&y[2]==191?h=tt(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=tt(h):d.type=="binary"&&typeof Vl<"u",h.slice(0,19)=="socialcalc:version:"?m2.to_sheet(d.type=="string"?h:tt(h),d):l(h,d)}function c(f,d){return Ga(o(f,d),d)}function u(f){for(var d=[],h=Ke(f["!ref"]),y,g=Array.isArray(f),m=h.s.r;m<=h.e.r;++m){for(var p=[],x=h.s.c;x<=h.e.c;++x){var v=Pe({r:m,c:x});if(y=g?(f[m]||[])[x]:f[v],!y||y.v==null){p.push("          ");continue}for(var w=(y.w||(oa(y),y.w)||"").slice(0,10);w.length<10;)w+=" ";p.push(w+(x===0?" ":""))}d.push(p.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function dT(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=d2.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return ki.to_workbook(e,t)}}var hs=function(){function e(S,z,F){if(S){Jt(S,S.l||0);for(var M=F.Enum||q;S.l<S.length;){var W=S.read_shift(2),ie=M[W]||M[65535],X=S.read_shift(2),Q=S.l+X,Z=ie.f&&ie.f(S,X,F);if(S.l=Q,z(Z,ie,W))return}}}function t(S,z){switch(z.type){case"base64":return r($r(Kr(S)),z);case"binary":return r($r(S),z);case"buffer":case"array":return r(S,z)}throw"Unsupported type "+z.type}function r(S,z){if(!S)return S;var F=z||{},M=F.dense?[]:{},W="Sheet1",ie="",X=0,Q={},Z=[],ye=[],I={s:{r:0,c:0},e:{r:0,c:0}},ve=F.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)F.Enum=q,e(S,function(de,se,Se){switch(Se){case 0:F.vers=de,de>=4096&&(F.qpro=!0);break;case 6:I=de;break;case 204:de&&(ie=de);break;case 222:ie=de;break;case 15:case 51:F.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:Se==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=F.dateNF||Re[14],F.cellDates&&(de[1].t="d",de[1].v=V0(de[1].v))),F.qpro&&de[3]>X&&(M["!ref"]=Be(I),Q[W]=M,Z.push(W),M=F.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},X=de[3],W=ie||"Sheet"+(X+1),ie="");var Ee=F.dense?(M[de[0].r]||[])[de[0].c]:M[Pe(de[0])];if(Ee){Ee.t=de[1].t,Ee.v=de[1].v,de[1].z!=null&&(Ee.z=de[1].z),de[1].f!=null&&(Ee.f=de[1].f);break}F.dense?(M[de[0].r]||(M[de[0].r]=[]),M[de[0].r][de[0].c]=de[1]):M[Pe(de[0])]=de[1];break}},F);else if(S[2]==26||S[2]==14)F.Enum=U,S[2]==14&&(F.qpro=!0,S.l=0),e(S,function(de,se,Se){switch(Se){case 204:W=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>X&&(M["!ref"]=Be(I),Q[W]=M,Z.push(W),M=F.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},X=de[3],W="Sheet"+(X+1)),ve>0&&de[0].r>=ve)break;F.dense?(M[de[0].r]||(M[de[0].r]=[]),M[de[0].r][de[0].c]=de[1]):M[Pe(de[0])]=de[1],I.e.c<de[0].c&&(I.e.c=de[0].c),I.e.r<de[0].r&&(I.e.r=de[0].r);break;case 27:de[14e3]&&(ye[de[14e3][0]]=de[14e3][1]);break;case 1537:ye[de[0]]=de[1],de[0]==X&&(W=de[1]);break}},F);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(M["!ref"]=Be(I),Q[ie||W]=M,Z.push(ie||W),!ye.length)return{SheetNames:Z,Sheets:Q};for(var Ae={},Ie=[],be=0;be<ye.length;++be)Q[Z[be]]?(Ie.push(ye[be]||Z[be]),Ae[ye[be]]=Q[ye[be]]||Q[Z[be]]):(Ie.push(ye[be]),Ae[ye[be]]={"!ref":"A1"});return{SheetNames:Ie,Sheets:Ae}}function n(S,z){var F=z||{};if(+F.codepage>=0&&wn(+F.codepage),F.type=="string")throw new Error("Cannot write WK1 to JS string");var M=Or(),W=Ke(S["!ref"]),ie=Array.isArray(S),X=[];ge(M,0,s(1030)),ge(M,6,c(W));for(var Q=Math.min(W.e.r,8191),Z=W.s.r;Z<=Q;++Z)for(var ye=Ct(Z),I=W.s.c;I<=W.e.c;++I){Z===W.s.r&&(X[I]=xt(I));var ve=X[I]+ye,Ae=ie?(S[Z]||[])[I]:S[ve];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?ge(M,13,y(Z,I,Ae.v)):ge(M,14,m(Z,I,Ae.v));else{var Ie=oa(Ae);ge(M,15,d(Z,I,Ie.slice(0,239)))}}return ge(M,1),M.end()}function a(S,z){var F=z||{};if(+F.codepage>=0&&wn(+F.codepage),F.type=="string")throw new Error("Cannot write WK3 to JS string");var M=Or();ge(M,0,l(S));for(var W=0,ie=0;W<S.SheetNames.length;++W)(S.Sheets[S.SheetNames[W]]||{})["!ref"]&&ge(M,27,G(S.SheetNames[W],ie++));var X=0;for(W=0;W<S.SheetNames.length;++W){var Q=S.Sheets[S.SheetNames[W]];if(!(!Q||!Q["!ref"])){for(var Z=Ke(Q["!ref"]),ye=Array.isArray(Q),I=[],ve=Math.min(Z.e.r,8191),Ae=Z.s.r;Ae<=ve;++Ae)for(var Ie=Ct(Ae),be=Z.s.c;be<=Z.e.c;++be){Ae===Z.s.r&&(I[be]=xt(be));var de=I[be]+Ie,se=ye?(Q[Ae]||[])[be]:Q[de];if(!(!se||se.t=="z"))if(se.t=="n")ge(M,23,L(Ae,be,X,se.v));else{var Se=oa(se);ge(M,22,N(Ae,be,X,Se.slice(0,239)))}}++X}}return ge(M,1),M.end()}function s(S){var z=oe(2);return z.write_shift(2,S),z}function l(S){var z=oe(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var F=0,M=0,W=0,ie=0;ie<S.SheetNames.length;++ie){var X=S.SheetNames[ie],Q=S.Sheets[X];if(!(!Q||!Q["!ref"])){++W;var Z=Mr(Q["!ref"]);F<Z.e.r&&(F=Z.e.r),M<Z.e.c&&(M=Z.e.c)}}return F>8191&&(F=8191),z.write_shift(2,F),z.write_shift(1,W),z.write_shift(1,M),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function o(S,z,F){var M={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&F.qpro?(M.s.c=S.read_shift(1),S.l++,M.s.r=S.read_shift(2),M.e.c=S.read_shift(1),S.l++,M.e.r=S.read_shift(2),M):(M.s.c=S.read_shift(2),M.s.r=S.read_shift(2),z==12&&F.qpro&&(S.l+=2),M.e.c=S.read_shift(2),M.e.r=S.read_shift(2),z==12&&F.qpro&&(S.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function c(S){var z=oe(8);return z.write_shift(2,S.s.c),z.write_shift(2,S.s.r),z.write_shift(2,S.e.c),z.write_shift(2,S.e.r),z}function u(S,z,F){var M=[{c:0,r:0},{t:"n",v:0},0,0];return F.qpro&&F.vers!=20768?(M[0].c=S.read_shift(1),M[3]=S.read_shift(1),M[0].r=S.read_shift(2),S.l+=2):(M[2]=S.read_shift(1),M[0].c=S.read_shift(2),M[0].r=S.read_shift(2)),M}function f(S,z,F){var M=S.l+z,W=u(S,z,F);if(W[1].t="s",F.vers==20768){S.l++;var ie=S.read_shift(1);return W[1].v=S.read_shift(ie,"utf8"),W}return F.qpro&&S.l++,W[1].v=S.read_shift(M-S.l,"cstr"),W}function d(S,z,F){var M=oe(7+F.length);M.write_shift(1,255),M.write_shift(2,z),M.write_shift(2,S),M.write_shift(1,39);for(var W=0;W<M.length;++W){var ie=F.charCodeAt(W);M.write_shift(1,ie>=128?95:ie)}return M.write_shift(1,0),M}function h(S,z,F){var M=u(S,z,F);return M[1].v=S.read_shift(2,"i"),M}function y(S,z,F){var M=oe(7);return M.write_shift(1,255),M.write_shift(2,z),M.write_shift(2,S),M.write_shift(2,F,"i"),M}function g(S,z,F){var M=u(S,z,F);return M[1].v=S.read_shift(8,"f"),M}function m(S,z,F){var M=oe(13);return M.write_shift(1,255),M.write_shift(2,z),M.write_shift(2,S),M.write_shift(8,F,"f"),M}function p(S,z,F){var M=S.l+z,W=u(S,z,F);if(W[1].v=S.read_shift(8,"f"),F.qpro)S.l=M;else{var ie=S.read_shift(2);b(S.slice(S.l,S.l+ie),W),S.l+=ie}return W}function x(S,z,F){var M=z&32768;return z&=-32769,z=(M?S:0)+(z>=8192?z-16384:z),(M?"":"$")+(F?xt(z):Ct(z))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(S,z){Jt(S,0);for(var F=[],M=0,W="",ie="",X="",Q="";S.l<S.length;){var Z=S[S.l++];switch(Z){case 0:F.push(S.read_shift(8,"f"));break;case 1:ie=x(z[0].c,S.read_shift(2),!0),W=x(z[0].r,S.read_shift(2),!1),F.push(ie+W);break;case 2:{var ye=x(z[0].c,S.read_shift(2),!0),I=x(z[0].r,S.read_shift(2),!1);ie=x(z[0].c,S.read_shift(2),!0),W=x(z[0].r,S.read_shift(2),!1),F.push(ye+I+":"+ie+W)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:F.push("("+F.pop()+")");break;case 5:F.push(S.read_shift(2));break;case 6:{for(var ve="";Z=S[S.l++];)ve+=String.fromCharCode(Z);F.push('"'+ve.replace(/"/g,'""')+'"')}break;case 8:F.push("-"+F.pop());break;case 23:F.push("+"+F.pop());break;case 22:F.push("NOT("+F.pop()+")");break;case 20:case 21:Q=F.pop(),X=F.pop(),F.push(["AND","OR"][Z-20]+"("+X+","+Q+")");break;default:if(Z<32&&w[Z])Q=F.pop(),X=F.pop(),F.push(X+w[Z]+Q);else if(v[Z]){if(M=v[Z][1],M==69&&(M=S[S.l++]),M>F.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+F.join("|")+"|");return}var Ae=F.slice(-M);F.length-=M,F.push(v[Z][0]+"("+Ae.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}F.length==1?z[1].f=""+F[0]:console.error("WK1 bad formula parse |"+F.join("|")+"|")}function _(S){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=S.read_shift(2),z[3]=S[S.l++],z[0].c=S[S.l++],z}function E(S,z){var F=_(S);return F[1].t="s",F[1].v=S.read_shift(z-4,"cstr"),F}function N(S,z,F,M){var W=oe(6+M.length);W.write_shift(2,S),W.write_shift(1,F),W.write_shift(1,z),W.write_shift(1,39);for(var ie=0;ie<M.length;++ie){var X=M.charCodeAt(ie);W.write_shift(1,X>=128?95:X)}return W.write_shift(1,0),W}function R(S,z){var F=_(S);F[1].v=S.read_shift(2);var M=F[1].v>>1;if(F[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return F[1].v=M,F}function j(S,z){var F=_(S),M=S.read_shift(4),W=S.read_shift(4),ie=S.read_shift(2);if(ie==65535)return M===0&&W===3221225472?(F[1].t="e",F[1].v=15):M===0&&W===3489660928?(F[1].t="e",F[1].v=42):F[1].v=0,F;var X=ie&32768;return ie=(ie&32767)-16446,F[1].v=(1-X*2)*(W*Math.pow(2,ie+32)+M*Math.pow(2,ie)),F}function L(S,z,F,M){var W=oe(14);if(W.write_shift(2,S),W.write_shift(1,F),W.write_shift(1,z),M==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var ie=0,X=0,Q=0,Z=0;return M<0&&(ie=1,M=-M),X=Math.log2(M)|0,M/=Math.pow(2,X-31),Z=M>>>0,Z&2147483648||(M/=2,++X,Z=M>>>0),M-=Z,Z|=2147483648,Z>>>=0,M*=Math.pow(2,32),Q=M>>>0,W.write_shift(4,Q),W.write_shift(4,Z),X+=16383+(ie?32768:0),W.write_shift(2,X),W}function V(S,z){var F=j(S);return S.l+=z-14,F}function K(S,z){var F=_(S),M=S.read_shift(4);return F[1].v=M>>6,F}function Y(S,z){var F=_(S),M=S.read_shift(8,"f");return F[1].v=M,F}function H(S,z){var F=Y(S);return S.l+=z-10,F}function B(S,z){return S[S.l+z-1]==0?S.read_shift(z,"cstr"):""}function J(S,z){var F=S[S.l++];F>z-1&&(F=z-1);for(var M="";M.length<F;)M+=String.fromCharCode(S[S.l++]);return M}function ue(S,z,F){if(!(!F.qpro||z<21)){var M=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var W=S.read_shift(z-21,"cstr");return[M,W]}}function le(S,z){for(var F={},M=S.l+z;S.l<M;){var W=S.read_shift(2);if(W==14e3){for(F[W]=[0,""],F[W][0]=S.read_shift(2);S[S.l];)F[W][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return F}function G(S,z){var F=oe(5+S.length);F.write_shift(2,14e3),F.write_shift(2,z);for(var M=0;M<S.length;++M){var W=S.charCodeAt(M);F[F.l++]=W>127?95:W}return F[F.l++]=0,F}var q={0:{n:"BOF",f:Pt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f},16:{n:"FORMULA",f:p},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:B},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},U={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:K},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:H},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:B},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function hT(e){var t={},r=e.match(xr),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Oe(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=xh[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var mT=function(){var e=Gl("t"),t=Gl("rPr");function r(s){var l=s.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:Ge(l[1])},c=s.match(t);return c&&(o.s=hT(c[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),xT=function(){var t=/(\r\n|\n)/g;function r(a,s,l){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),l.push("</b>")),a.i&&(s.push("<i>"),l.push("</i>")),a.strike&&(s.push("<s>"),l.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),l.push("</"+c+">")),l.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),pT=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,gT=/<(?:\w+:)?r>/,vT=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Bh(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ge(tt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=tt(e),r&&(n.h=Eh(n.t))):e.match(gT)&&(n.r=tt(e),n.t=Ge(tt((e.replace(vT,"").match(pT)||[]).join("").replace(xr,""))),r&&(n.h=xT(mT(n.r)))),n):{t:""}}var yT=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,wT=/<(?:\w+:)?(?:si|sstItem)>/g,bT=/<\/(?:\w+:)?(?:si|sstItem)>/;function NT(e,t){var r=[],n="";if(!e)return r;var a=e.match(yT);if(a){n=a[2].replace(wT,"").split(bT);for(var s=0;s!=n.length;++s){var l=Bh(n[s].trim(),t);l!=null&&(r[r.length]=l)}a=Oe(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var _T=/^\s|\s$|[\t\n\r]/;function x2(e,t){if(!t.bookSST)return"";var r=[At];r[r.length]=pe("sst",null,{xmlns:Fs[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(_T)&&(s+=' xml:space="preserve"'),s+=">"+Ze(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function kT(e){return[e.read_shift(4),e.read_shift(4)]}function ET(e,t){var r=[],n=!1;return da(e,function(s,l,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function ST(e,t){return t||(t=oe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var jT=LS;function TT(e){var t=Or();fe(t,159,ST(e));for(var r=0;r<e.length;++r)fe(t,19,jT(e[r]));return fe(t,160),t.end()}function p2(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function na(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function CT(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=na(e,4),t.U=na(e,4),t.W=na(e,4),t}function FT(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function AT(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(FT(e));return t}function DT(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function RT(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=na(e,4),t.U=na(e,4),t.W=na(e,4),t}function PT(e){var t=RT(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function g2(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function v2(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function IT(e){var t=na(e);switch(t.Minor){case 2:return[t.Minor,OT(e)];case 3:return[t.Minor,LT()];case 4:return[t.Minor,MT(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function OT(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=g2(e,r),a=v2(e,e.length-e.l);return{t:"Std",h:n,v:a}}function LT(){throw new Error("File is password-protected: ECMA-376 Extensible")}function MT(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(xr,function(s){var l=Oe(s);switch(Xn(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=l[o]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function BT(e,t){var r={},n=r.EncryptionVersionInfo=na(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=g2(e,a),t-=a,r.EncryptionVerifier=v2(e,t),r}function UT(e){var t={},r=t.EncryptionVersionInfo=na(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Uh(e){var t=0,r,n=p2(e),a=n.length+1,s,l,o,c,u;for(r=Ma(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)l=r[s],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^l;return t^52811}var y2=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,o){return n(l^o)},s=function(l){for(var o=t[l.length-1],c=104,u=l.length-1;u>=0;--u)for(var f=l[u],d=0;d!=7;++d)f&64&&(o^=r[c]),f*=2,--c;return o};return function(l){for(var o=p2(l),c=s(o),u=o.length,f=Ma(16),d=0;d!=16;++d)f[d]=0;var h,y,g;for((u&1)===1&&(h=c>>8,f[u]=a(e[0],h),--u,h=c&255,y=o[o.length-1],f[u]=a(y,h));u>0;)--u,h=c>>8,f[u]=a(o[u],h),--u,h=c&255,f[u]=a(o[u],h);for(u=15,g=15-o.length;g>0;)h=c>>8,f[u]=a(e[g],h),--u,--g,h=c&255,f[u]=a(o[u],h),--u,--g;return f}}(),zT=function(e,t,r,n,a){a||(a=t),n||(n=y2(e));var s,l;for(s=0;s!=t.length;++s)l=t[s],l^=n[r],l=(l>>5|l<<3)&255,a[s]=l,++r;return[a,r,n]},$T=function(e){var t=0,r=y2(e);return function(n){var a=zT("",n,t,r);return t=a[1],a[0]}};function WT(e,t,r,n){var a={key:Pt(e),verificationBytes:Pt(e)};return r.password&&(a.verifier=Uh(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=$T(r.password)),a}function VT(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=UT(e):n.Data=BT(e,t),n}function HT(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?VT(e,t-2,n):WT(e,r.biff>=8?t:t-2,r,n),n}var w2=function(){function e(a,s){switch(s.type){case"base64":return t(Kr(a),s);case"binary":return t(a,s);case"buffer":return t($e&&Buffer.isBuffer(a)?a.toString("binary"):Xa(a),s);case"array":return t(_s(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var l=s||{},o=l.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,y=0,g,m=-1;g=h.exec(f);){switch(g[0]){case"\\cell":var p=f.slice(y,h.lastIndex-g[0].length);if(p[0]==" "&&(p=p.slice(1)),++m,p.length){var x={v:p,t:"s"};Array.isArray(o)?o[d][m]=x:o[Pe({r:d,c:m})]=x}break}y=h.lastIndex}m>u.e.c&&(u.e.c=m)}),o["!ref"]=Be(u),o}function r(a,s){return Ga(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],l=Ke(a["!ref"]),o,c=Array.isArray(a),u=l.s.r;u<=l.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=l.s.c;f<=l.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=l.s.c;f<=l.e.c;++f){var d=Pe({r:u,c:f});o=c?(a[u]||[])[f]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(oa(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function XT(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Jl(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function GT(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),l=a-s;if(l===0)return[0,0,t];var o=0,c=0,u=a+s;switch(c=l/(u>1?2-u:u),a){case t:o=((r-n)/l+6)%6;break;case r:o=(n-t)/l+2;break;case n:o=(t-r)/l+4;break}return[o/6,c,u/2]}function KT(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,l=[s,s,s],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=a*o,l[0]+=a,l[1]+=c;break;case 1:c=a*(2-o),l[0]+=c,l[1]+=a;break;case 2:c=a*(o-2),l[1]+=a,l[2]+=c;break;case 3:c=a*(4-o),l[1]+=c,l[2]+=a;break;case 4:c=a*(o-4),l[2]+=a,l[0]+=c;break;case 5:c=a*(6-o),l[2]+=c,l[0]+=a;break}for(var u=0;u!=3;++u)l[u]=Math.round(l[u]*255);return l}function o0(e,t){if(t===0)return e;var r=GT(XT(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Jl(KT(r))}var b2=6,qT=15,YT=1,or=b2;function Ql(e){return Math.floor((e+Math.round(128/or)/256)*or)}function Zl(e){return Math.floor((e-5)/or*100+.5)/100}function c0(e){return Math.round((e*or+5)/or*256)/256}function Ru(e){return c0(Zl(Ql(e)))}function zh(e){var t=Math.abs(e-Ru(e)),r=or;if(t>.005)for(or=YT;or<qT;++or)Math.abs(e-Ru(e))<=t&&(t=Math.abs(e-Ru(e)),r=or);or=r}function Ba(e){e.width?(e.wpx=Ql(e.width),e.wch=Zl(e.wpx),e.MDW=or):e.wpx?(e.wch=Zl(e.wpx),e.width=c0(e.wch),e.MDW=or):typeof e.wch=="number"&&(e.width=c0(e.wch),e.wpx=Ql(e.width),e.MDW=or),e.customWidth&&delete e.customWidth}var JT=96,N2=JT;function eo(e){return e*96/N2}function Ei(e){return e*N2/96}var QT={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function ZT(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(xr)||[]).forEach(function(l){var o=Oe(l);switch(Xn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=lt(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=lt(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function e6(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(xr)||[]).forEach(function(l){var o=Oe(l);switch(Xn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function t6(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(xr)||[]).forEach(function(l){var o=Oe(l);switch(Xn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=tt(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?lt(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?lt(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?lt(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?lt(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?lt(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?lt(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?lt(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=xh[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=lt(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=fs[a.color.index];a.color.index==81&&(c=fs[1]),c||(c=fs[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=o0(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function r6(e,t,r){t.NumberFmt=[];for(var n=kt(Re),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Re[n[a]];var s=e[0].match(xr);if(s)for(a=0;a<s.length;++a){var l=Oe(s[a]);switch(Xn(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ge(tt(l.formatCode)),c=parseInt(l.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}ra(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function n6(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=pe("numFmt",null,{numFmtId:n,formatCode:Ze(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=pe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var ec=["numFmtId","fillId","fontId","borderId","xfId"],tc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function a6(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(xr)||[]).forEach(function(s){var l=Oe(s),o=0;switch(Xn(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],o=0;o<ec.length;++o)n[ec[o]]&&(n[ec[o]]=parseInt(n[ec[o]],10));for(o=0;o<tc.length;++o)n[tc[o]]&&(n[tc[o]]=lt(n[tc[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};l.vertical&&(c.vertical=l.vertical),l.horizontal&&(c.horizontal=l.horizontal),l.textRotation!=null&&(c.textRotation=l.textRotation),l.indent&&(c.indent=l.indent),l.wrapText&&(c.wrapText=lt(l.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function s6(e){var t=[];return t[t.length]=pe("cellXfs",null),e.forEach(function(r){t[t.length]=pe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=pe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var i6=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&r6(d,f,u),(d=o.match(a))&&t6(d,f,c,u),(d=o.match(n))&&e6(d,f,c,u),(d=o.match(s))&&ZT(d,f,c,u),(d=o.match(r))&&a6(d,f,u),f}}();function _2(e,t){var r=[At,pe("styleSheet",null,{xmlns:Fs[0],"xmlns:vt":Lt.vt})],n;return e.SSF&&(n=n6(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=s6(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function l6(e,t){var r=e.read_shift(2),n=dr(e);return[r,n]}function o6(e,t,r){r||(r=oe(6+4*t.length)),r.write_shift(2,e),Ht(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function c6(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=VS(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=WS(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=dr(e),n}function u6(e,t){t||(t=oe(25+4*32)),t.write_shift(2,e.sz*20),HS(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),s0(e.color,t);var n=0;return n=2,t.write_shift(1,n),Ht(e.name,t),t.length>t.l?t.slice(0,t.l):t}var f6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Pu,d6=mr;function Rp(e,t){t||(t=oe(4*3+8*7+16*1)),Pu||(Pu=$0(f6));var r=Pu[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(s0({auto:1},t),s0({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function h6(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function k2(e,t,r){r||(r=oe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ji(e,t){return t||(t=oe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var m6=mr;function x6(e,t){return t||(t=oe(51)),t.write_shift(1,0),Ji(null,t),Ji(null,t),Ji(null,t),Ji(null,t),Ji(null,t),t.length>t.l?t.slice(0,t.l):t}function p6(e,t){return t||(t=oe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),a0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function g6(e,t,r){var n=oe(2052);return n.write_shift(4,e),a0(t,n),a0(r,n),n.length>n.l?n.slice(0,n.l):n}function v6(e,t,r){var n={};n.NumberFmt=[];for(var a in Re)n.NumberFmt[a]=Re[a];n.CellXf=[],n.Fonts=[];var s=[],l=!1;return da(e,function(c,u,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],ra(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=o0(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(f),l=!0;break;case 38:s.pop(),l=!1;break;default:if(u.T>0)s.push(f);else if(u.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function y6(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(fe(e,615,En(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&fe(e,44,o6(a,t[a]))}),fe(e,616))}}function w6(e){var t=1;fe(e,611,En(t)),fe(e,43,u6({sz:12,color:{theme:1},name:"Calibri",family:2})),fe(e,612)}function b6(e){var t=2;fe(e,603,En(t)),fe(e,45,Rp({patternType:"none"})),fe(e,45,Rp({patternType:"gray125"})),fe(e,604)}function N6(e){var t=1;fe(e,613,En(t)),fe(e,46,x6()),fe(e,614)}function _6(e){var t=1;fe(e,626,En(t)),fe(e,47,k2({numFmtId:0},65535)),fe(e,627)}function k6(e,t){fe(e,617,En(t.length)),t.forEach(function(r){fe(e,47,k2(r,0))}),fe(e,618)}function E6(e){var t=1;fe(e,619,En(t)),fe(e,48,p6({xfId:0,name:"Normal"})),fe(e,620)}function S6(e){var t=0;fe(e,505,En(t)),fe(e,506)}function j6(e){var t=0;fe(e,508,g6(t,"TableStyleMedium9","PivotStyleMedium4")),fe(e,509)}function T6(e,t){var r=Or();return fe(r,278),y6(r,e.SSF),w6(r),b6(r),N6(r),_6(r),k6(r,t.cellXfs),E6(r),S6(r),j6(r),fe(r,279),r.end()}var C6=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function F6(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(xr)||[]).forEach(function(a){var s=Oe(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[C6.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function A6(){}function D6(){}var R6=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,P6=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,I6=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function O6(e,t,r){t.themeElements={};var n;[["clrScheme",R6,F6],["fontScheme",P6,A6],["fmtScheme",I6,D6]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var L6=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function E2(e,t){(!e||e.length===0)&&(e=$h());var r,n={};if(!(r=e.match(L6)))throw new Error("themeElements not found in theme");return O6(r[0],n,t),n.raw=e,n}function $h(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[At];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function M6(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var l;try{l=gy(s,{type:"array"})}catch{return}var o=Wr(l,"theme/theme/theme1.xml",!0);if(o)return E2(o,r)}}function B6(e){return e.read_shift(4)}function U6(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=z6(e,4);break;case 2:t.xclrValue=a2(e);break;case 3:t.xclrValue=B6(e);break;case 4:e.l+=4;break}return e.l+=8,t}function z6(e,t){return mr(e,t)}function $6(e,t){return mr(e,t)}function W6(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=U6(e);break;case 6:n[1]=$6(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function V6(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(W6(e,r-e.l));return{ixfe:n,ext:s}}function H6(e,t){t.forEach(function(r){switch(r[0]){}})}function X6(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:dr(e)}}function G6(e){var t=oe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ht(e.name,t),t.slice(0,t.l)}function K6(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function q6(e){var t=oe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Y6(e,t){var r=oe(8+2*t.length);return r.write_shift(4,e),Ht(t,r),r.slice(0,r.l)}function J6(e){return e.l+=4,e.read_shift(4)!=0}function Q6(e,t){var r=oe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Z6(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],l=!1,o=2;return da(e,function(c,u,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(f),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!u.T){if(!l||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function e5(){var e=Or();return fe(e,332),fe(e,334,En(1)),fe(e,335,G6({name:"XLDAPR",version:12e4,flags:3496657072})),fe(e,336),fe(e,339,Y6(1,"XLDAPR")),fe(e,52),fe(e,35,En(514)),fe(e,4096,En(0)),fe(e,4097,rn(1)),fe(e,36),fe(e,53),fe(e,340),fe(e,337,Q6(1)),fe(e,51,q6([[1,0]])),fe(e,338),fe(e,333),e.end()}function t5(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,l;return e.replace(xr,function(o){var c=Oe(o);switch(Xn(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(l=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function S2(){var e=[At];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function r5(e){var t=[];if(!e)return t;var r=1;return(e.match(xr)||[]).forEach(function(n){var a=Oe(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function n5(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Pe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function a5(e,t,r){var n=[];return da(e,function(s,l,o){switch(o){case 63:n.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function s5(e,t,r,n){if(!e)return e;var a=n||{},s=!1;da(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function i5(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Zs=1024;function j2(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[pe("xml",null,{"xmlns:v":Ur.v,"xmlns:o":Ur.o,"xmlns:x":Ur.x,"xmlns:mv":Ur.mv}).replace(/\/>/,">"),pe("o:shapelayout",pe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),pe("v:shapetype",[pe("v:stroke",null,{joinstyle:"miter"}),pe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Zs<e*1e3;)Zs+=1e3;return t.forEach(function(s){var l=pt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?pe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=pe("v:fill",c,o),f={on:"t",obscured:"t"};++Zs,a=a.concat(["<v:shape"+Kl({id:"_x0000_s"+Zs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,pe("v:shadow",null,f),pe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Qt("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Qt("x:AutoFill","False"),Qt("x:Row",String(l.r)),Qt("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Pp(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(l){var o=pt(l.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[l.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[l.ref]=s;var c=Ke(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Be(c);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var f={a:l.author,t:l.t,r:l.r,T:r};l.h&&(f.h=l.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}s.c.push(f)})}function l5(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Oe(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=pt(c.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&Bh(d[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function T2(e){var t=[At,pe("comments",null,{xmlns:Fs[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=Ze(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(Ze(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(Qt("t",Ze(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)l+=`Reply:
    `+s[o]+`
`;t.push(Qt("t",Ze(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function o5(e,t){var r=[],n=!1,a={},s=0;return e.replace(xr,function(o,c){var u=Oe(o);switch(Xn(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":a.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function c5(e,t,r){var n=[At,pe("ThreadedComments",null,{xmlns:Lt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,l.ID=c.id,l.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(pe("threadedComment",Qt("text",l.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function u5(e,t){var r=[],n=!1;return e.replace(xr,function(s){var l=Oe(s);switch(Xn(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function f5(e){var t=[At,pe("personList",null,{xmlns:Lt.TCMNT,"xmlns:x":Fs[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(pe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function d5(e){var t={};t.iauthor=e.read_shift(4);var r=Ps(e);return t.rfx=r.s,t.ref=Pe(r.s),e.l+=16,t}function h5(e,t){return t==null&&(t=oe(36)),t.write_shift(4,e[1].iauthor),Oi(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var m5=dr;function x5(e){return Ht(e.slice(0,54))}function p5(e,t){var r=[],n=[],a={},s=!1;return da(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function g5(e){var t=Or(),r=[];return fe(t,628),fe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),fe(t,632,x5(a.a)))})}),fe(t,631),fe(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:pt(n[0]),e:pt(n[0])};fe(t,635,h5([s,a])),a.t&&a.t.length>0&&fe(t,637,BS(a)),fe(t,636),delete a.iauthor})}),fe(t,634),fe(t,629),t.end()}var v5="application/vnd.ms-office.vbaProject";function y5(e){var t=De.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");De.utils.cfb_add(t,a,e.FileIndex[n].content)}}),De.write(t)}function w5(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&De.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var C2=["xlsb","xlsm","xlam","biff8","xla"];function b5(){return{"!type":"dialog"}}function N5(){return{"!type":"dialog"}}function _5(){return{"!type":"macro"}}function k5(){return{"!type":"macro"}}var ci=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,l){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=l.length>0?parseInt(l,10)|0:0;return o?f+=t.c:--f,c?u+=t.r:--u,a+(o?"":"$")+xt(f)+(c?"":"$")+Ct(u)}return function(a,s){return t=s,a.replace(e,r)}}(),Wh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Vh=function(){return function(t,r){return t.replace(Wh,function(n,a,s,l,o,c){var u=Fh(l)-(s?0:r.c),f=Ch(c)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",h=u==0?"":s?u+1:"["+u+"]";return a+"R"+d+"C"+h})}}();function F2(e,t){return e.replace(Wh,function(r,n,a,s,l,o){return n+(a=="$"?a+s:xt(Fh(s)+t.c))+(l=="$"?l+o:Ct(Ch(o)+t.r))})}function E5(e,t,r){var n=Mr(t),a=n.s,s=pt(r),l={r:s.r-a.r,c:s.c-a.c};return F2(e,l)}function S5(e){return e.length!=1}function Ip(e){return e.replace(/_xlfn\./g,"")}function Dt(e){e.l+=1}function Ua(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function A2(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return D2(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),l=Ua(e),o=Ua(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function D2(e){var t=Ua(e),r=Ua(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function j5(e,t,r){if(r.biff<8)return D2(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=Ua(e),l=Ua(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function R2(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return T5(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Ua(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function T5(e){var t=Ua(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function C5(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function F5(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return A5(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),l=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:l,rRel:o}}function A5(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function D5(e,t,r){var n=(e[e.l++]&96)>>5,a=A2(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function R5(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var l=A2(e,s,r);return[n,a,l]}function P5(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function I5(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function O5(e,t,r){var n=(e[e.l++]&96)>>5,a=j5(e,t-1,r);return[n,a]}function L5(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Op(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function M5(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function B5(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function U5(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function z5(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function $5(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function P2(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function W5(e){return e.read_shift(2),P2(e)}function V5(e){return e.read_shift(2),P2(e)}function H5(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=R2(e,0,r);return[n,a]}function X5(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=F5(e,0,r);return[n,a]}function G5(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=R2(e,0,r);return[n,a,s]}function K5(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[JC[a],L2[a],n]}function q5(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Y5(e);return[a,(s[0]===0?L2:YC)[s[1]]]}function Y5(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function J5(e,t,r){e.l+=r&&r.biff==2?3:4}function Q5(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Z5(e){return e.l++,ha[e.read_shift(1)]}function eC(e){return e.l++,e.read_shift(2)}function tC(e){return e.l++,e.read_shift(1)!==0}function rC(e){return e.l++,ur(e)}function nC(e,t,r){return e.l++,yo(e,t-1,r)}function aC(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=jt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ha[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ur(e);break;case 2:r[1]=Is(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function sC(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Ps:H0)(e));return a}function iC(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var o=0;o!=a;++o)l[s][o]=aC(e,r.biff);return l}function lC(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function oC(e,t,r){if(r.biff==5)return cC(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function cC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function uC(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function fC(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function dC(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function hC(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var mC=mr,xC=mr,pC=mr;function bo(e,t,r){return e.l+=2,[C5(e)]}function Hh(e){return e.l+=6,[]}var gC=bo,vC=Hh,yC=Hh,wC=bo;function I2(e){return e.l+=2,[Pt(e),e.read_shift(2)&1]}var bC=bo,NC=I2,_C=Hh,kC=bo,EC=bo,SC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function jC(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),l=SC[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:a,C:s}}function TC(e){return e.l+=2,[e.read_shift(4)]}function CC(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function FC(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function AC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function DC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function RC(e){return e.l+=4,[0,0]}var Lp={1:{n:"PtgExp",f:Q5},2:{n:"PtgTbl",f:pC},3:{n:"PtgAdd",f:Dt},4:{n:"PtgSub",f:Dt},5:{n:"PtgMul",f:Dt},6:{n:"PtgDiv",f:Dt},7:{n:"PtgPower",f:Dt},8:{n:"PtgConcat",f:Dt},9:{n:"PtgLt",f:Dt},10:{n:"PtgLe",f:Dt},11:{n:"PtgEq",f:Dt},12:{n:"PtgGe",f:Dt},13:{n:"PtgGt",f:Dt},14:{n:"PtgNe",f:Dt},15:{n:"PtgIsect",f:Dt},16:{n:"PtgUnion",f:Dt},17:{n:"PtgRange",f:Dt},18:{n:"PtgUplus",f:Dt},19:{n:"PtgUminus",f:Dt},20:{n:"PtgPercent",f:Dt},21:{n:"PtgParen",f:Dt},22:{n:"PtgMissArg",f:Dt},23:{n:"PtgStr",f:nC},26:{n:"PtgSheet",f:CC},27:{n:"PtgEndSheet",f:FC},28:{n:"PtgErr",f:Z5},29:{n:"PtgBool",f:tC},30:{n:"PtgInt",f:eC},31:{n:"PtgNum",f:rC},32:{n:"PtgArray",f:L5},33:{n:"PtgFunc",f:K5},34:{n:"PtgFuncVar",f:q5},35:{n:"PtgName",f:lC},36:{n:"PtgRef",f:H5},37:{n:"PtgArea",f:D5},38:{n:"PtgMemArea",f:uC},39:{n:"PtgMemErr",f:mC},40:{n:"PtgMemNoMem",f:xC},41:{n:"PtgMemFunc",f:fC},42:{n:"PtgRefErr",f:dC},43:{n:"PtgAreaErr",f:P5},44:{n:"PtgRefN",f:X5},45:{n:"PtgAreaN",f:O5},46:{n:"PtgMemAreaN",f:AC},47:{n:"PtgMemNoMemN",f:DC},57:{n:"PtgNameX",f:oC},58:{n:"PtgRef3d",f:G5},59:{n:"PtgArea3d",f:R5},60:{n:"PtgRefErr3d",f:hC},61:{n:"PtgAreaErr3d",f:I5},255:{}},PC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},IC={1:{n:"PtgElfLel",f:I2},2:{n:"PtgElfRw",f:kC},3:{n:"PtgElfCol",f:gC},6:{n:"PtgElfRwV",f:EC},7:{n:"PtgElfColV",f:wC},10:{n:"PtgElfRadical",f:bC},11:{n:"PtgElfRadicalS",f:_C},13:{n:"PtgElfColS",f:vC},15:{n:"PtgElfColSV",f:yC},16:{n:"PtgElfRadicalLel",f:NC},25:{n:"PtgList",f:jC},29:{n:"PtgSxName",f:TC},255:{}},OC={0:{n:"PtgAttrNoop",f:RC},1:{n:"PtgAttrSemi",f:$5},2:{n:"PtgAttrIf",f:U5},4:{n:"PtgAttrChoose",f:M5},8:{n:"PtgAttrGoto",f:B5},16:{n:"PtgAttrSum",f:J5},32:{n:"PtgAttrBaxcel",f:Op},33:{n:"PtgAttrBaxcel",f:Op},64:{n:"PtgAttrSpace",f:W5},65:{n:"PtgAttrSpaceSemi",f:V5},128:{n:"PtgAttrIfError",f:z5},255:{}};function No(e,t,r,n){if(n.biff<8)return mr(e,t);for(var a=e.l+t,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=iC(e,0,n),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=sC(e,r[l][1],n),s.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=a-e.l,t!==0&&s.push(mr(e,t)),s}function _o(e,t,r){for(var n=e.l+t,a,s,l=[];n!=e.l;)t=n-e.l,s=e[e.l],a=Lp[s]||Lp[PC[s]],(s===24||s===25)&&(a=(s===24?IC:OC)[e[e.l+1]]),!a||!a.f?mr(e,t):l.push([a.n,a.f(e,t,r)]);return l}function LC(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var MC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function BC(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function O2(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Mp(e,t,r){var n=O2(e,t,r);return n=="#REF"?n:BC(n,r)}function ir(e,t,r,n,a){var s=a&&a.biff||8,l={s:{c:0,r:0}},o=[],c,u,f,d=0,h=0,y,g="";if(!e[0]||!e[0][0])return"";for(var m=-1,p="",x=0,v=e[0].length;x<v;++x){var w=e[0][x];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:p=Nt(" ",e[0][m][1][1]);break;case 1:p=Nt("\r",e[0][m][1][1]);break;default:if(p="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+p,m=-1}o.push(u+MC[w[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=pl(w[1][1],l,a),o.push(gl(f,s));break;case"PtgRefN":f=r?pl(w[1][1],r,a):w[1][1],o.push(gl(f,s));break;case"PtgRef3d":d=w[1][1],f=pl(w[1][2],l,a),g=Mp(n,d,a),o.push(g+"!"+gl(f,s));break;case"PtgFunc":case"PtgFuncVar":var b=w[1][0],_=w[1][1];b||(b=0),b&=127;var E=b==0?[]:o.slice(-b);o.length-=b,_==="User"&&(_=E.shift()),o.push(_+"("+E.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":y=hp(w[1][1],r?{s:r}:l,a),o.push(Fu(y,a));break;case"PtgArea":y=hp(w[1][1],l,a),o.push(Fu(y,a));break;case"PtgArea3d":d=w[1][1],y=w[1][2],g=Mp(n,d,a),o.push(g+"!"+Fu(y,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var N=(n.names||[])[h-1]||(n[0]||[])[h],R=N?N.Name:"SH33TJSNAME"+String(h);R&&R.slice(0,6)=="_xlfn."&&!a.xlfn&&(R=R.slice(6)),o.push(R);break;case"PtgNameX":var j=w[1][1];h=w[1][2];var L;if(a.biff<=5)j<0&&(j=-j),n[j]&&(L=n[j][h]);else{var V="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][h]&&n[j][h].itab>0&&(V=n.SheetNames[n[j][h].itab-1]+"!"):V=n.SheetNames[h-1]+"!"),n[j]&&n[j][h])V+=n[j][h].Name;else if(n[0]&&n[0][h])V+=n[0][h].Name;else{var K=(O2(n,j,a)||"").split(";;");K[h-1]?V=K[h-1]:V+="SH33TJSERRX"}o.push(V);break}L||(L={Name:"SH33TJSERRY"}),o.push(L.Name);break;case"PtgParen":var Y="(",H=")";if(m>=0){switch(p="",e[0][m][1][0]){case 2:Y=Nt(" ",e[0][m][1][1])+Y;break;case 3:Y=Nt("\r",e[0][m][1][1])+Y;break;case 4:H=Nt(" ",e[0][m][1][1])+H;break;case 5:H=Nt("\r",e[0][m][1][1])+H;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(Y+o.pop()+H);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:w[1][1],r:w[1][0]};var B={c:r.c,r:r.r};if(n.sharedf[Pe(f)]){var J=n.sharedf[Pe(f)];o.push(ir(J,l,B,n,a))}else{var ue=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(ir(u[1],l,B,n,a)),ue=!0;break}ue||o.push(w[1])}break;case"PtgArray":o.push("{"+LC(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&le.indexOf(e[0][x][0])==-1){w=e[0][m];var G=!0;switch(w[1][0]){case 4:G=!1;case 0:p=Nt(" ",w[1][1]);break;case 5:G=!1;case 1:p=Nt("\r",w[1][1]);break;default:if(p="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((G?p:"")+o.pop()+(G?"":p)),m=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function UC(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,l=e.read_shift(a);if(l==65535)return[[],mr(e,t-2)];var o=_o(e,l,r);return t!==l+a&&(s=No(e,t-l-a,o,r)),e.l=n,[o,s]}function zC(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,l=e.read_shift(a);if(l==65535)return[[],mr(e,t-2)];var o=_o(e,l,r);return t!==l+a&&(s=No(e,t-l-a,o,r)),e.l=n,[o,s]}function $C(e,t,r,n){var a=e.l+t,s=_o(e,n,r),l;return a!==e.l&&(l=No(e,a-e.l,s,r)),[s,l]}function WC(e,t,r){var n=e.l+t,a,s=e.read_shift(2),l=_o(e,s,r);return s==65535?[[],mr(e,t-2)]:(t!==s+2&&(a=No(e,n-s-2,l,r)),[l,a])}function VC(e){var t;if(Zn(e,e.l+6)!==65535)return[ur(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function HC(e){if(e==null){var t=oe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ks(e);return ks(0)}function Iu(e,t,r){var n=e.l+t,a=Gn(e);r.biff==2&&++e.l;var s=VC(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=zC(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:l>>3&1,tt:s[1]}}function XC(e,t,r,n,a){var s=Ss(t,r,a),l=HC(e.v),o=oe(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=oe(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var d=Wt([s,l,o,u]);return d}function X0(e,t,r){var n=e.read_shift(4),a=_o(e,n,r),s=e.read_shift(4),l=s>0?No(e,s,a,r):null;return[a,l]}var GC=X0,G0=X0,KC=X0,qC=X0,YC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},L2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},JC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Bp(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function QC(e){var t="of:="+e.replace(Wh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Ou(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function ZC(e){return e.replace(/\./,"!")}var yl={},ui={},wl=typeof Map<"u";function Xh(e,t,r){var n=0,a=e.length;if(r){if(wl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=wl?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(wl?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function K0(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(or=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Zl(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=c0(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function ms(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ka(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){ra(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function M2(e,t,r,n,a,s){try{n.cellNF&&(e.z=Re[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ct(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Re[t]==null&&ra(YE[t]||"General",t),e.t==="e")e.w=e.w||ha[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Xl(e.v);else if(e.t==="d"){var l=Ut(e.v);(l|0)===l?e.w=l.toString(10):e.w=Xl(l)}else{if(e.v===void 0)return"";e.w=Ns(e.v,ui)}else e.t==="d"?e.w=dn(t,Ut(e.v),ui):e.w=dn(t,e.v,ui)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=o0(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=o0(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function eF(e,t,r){if(e&&e["!ref"]){var n=Ke(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function tF(e,t){var r=Ke(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Be(r))}var rF=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,nF=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,aF=/<(?:\w:)?hyperlink [^>]*>/mg,sF=/"(\w*:\w*)"/,iF=/<(?:\w:)?col\b[^>]*[\/]?>/g,lF=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,oF=/<(?:\w:)?pageMargins[^>]*\/>/g,B2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,cF=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,uF=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function fF(e,t,r,n,a,s,l){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",d=e.match(nF);d?(u=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):u=f=e;var h=u.match(B2);h?Gh(h[0],o,a,r):(h=u.match(cF))&&hF(h[0],h[1]||"",o,a,r);var y=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var g=u.slice(y,y+50).match(sF);g&&tF(o,g[1])}var m=u.match(uF);m&&m[1]&&SF(m[1],a);var p=[];if(t.cellStyles){var x=u.match(iF);x&&bF(p,x)}d&&CF(d[1],o,t,c,s,l);var v=f.match(lF);v&&(o["!autofilter"]=_F(v[0]));var w=[],b=f.match(rF);if(b)for(y=0;y!=b.length;++y)w[y]=Ke(b[y].slice(b[y].indexOf('"')+1));var _=f.match(aF);_&&vF(o,_,n);var E=f.match(oF);if(E&&(o["!margins"]=yF(Oe(E[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Be(c)),t.sheetRows>0&&o["!ref"]){var N=Ke(o["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>c.e.r&&(N.e.r=c.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>c.e.c&&(N.e.c=c.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Be(N))}return p.length>0&&(o["!cols"]=p),w.length>0&&(o["!merges"]=w),o}function dF(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Be(e[r])+'"/>';return t+"</mergeCells>"}function Gh(e,t,r,n){var a=Oe(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ge(tt(a.codeName)))}function hF(e,t,r,n,a){Gh(e.slice(0,e.indexOf(">")),r,n,a)}function mF(e,t,r,n,a){var s=!1,l={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,l.codeName=Mn(Ze(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+pe("outlinePr",null,u)}!s&&!o||(a[a.length]=pe("sheetPr",o,l))}var xF=["objects","scenarios","selectLockedCells","selectUnlockedCells"],pF=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function gF(e){var t={sheet:1};return xF.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),pF.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Uh(e.password).toString(16).toUpperCase()),pe("sheetProtection",null,t)}function vF(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Oe(tt(t[a]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+Ge(s.location))):(s.Target="#"+Ge(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Ke(s.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var f=Pe({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function yF(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function wF(e){return ms(e),pe("pageMargins",null,e)}function bF(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Oe(t[n],!0);a.hidden&&(a.hidden=lt(a.hidden));var s=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,zh(a.width)),Ba(a);s<=l;)e[s++]=ut(a)}}function NF(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=pe("col",null,K0(a,n)));return r[r.length]="</cols>",r.join("")}function _F(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function kF(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Be(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=Mr(a);l.s.r==l.e.r&&(l.e.r=Mr(t["!ref"]).e.r,a=Be(l));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),pe("autoFilter",null,{ref:a})}var EF=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function SF(e,t){t.Views||(t.Views=[{}]),(e.match(EF)||[]).forEach(function(r,n){var a=Oe(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),lt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function jF(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),pe("sheetViews",pe("sheetView",null,a),{})}function TF(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=ha[e.v];break;case"d":n&&n.cellDates?a=ct(e.v,-1).toISOString():(e=ut(e),e.t="n",a=""+(e.v=Ut(ct(e.v)))),typeof e.z>"u"&&(e.z=Re[14]);break;default:a=e.v;break}var o=Qt("v",Ze(a)),c={r:t},u=Ka(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Qt("v",""+Xh(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=l),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=pe("f",Ze(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),pe("c",o,c)}var CF=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Gl("v"),l=Gl("f");return function(c,u,f,d,h,y){for(var g=0,m="",p=[],x=[],v=0,w=0,b=0,_="",E,N,R=0,j=0,L,V,K=0,Y=0,H=Array.isArray(y.CellXf),B,J=[],ue=[],le=Array.isArray(u),G=[],q={},U=!1,S=!!f.sheetStubs,z=c.split(t),F=0,M=z.length;F!=M;++F){m=z[F].trim();var W=m.length;if(W!==0){var ie=0;e:for(g=0;g<W;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(f&&f.cellStyles){if(N=Oe(m.slice(ie,g),!0),R=N.r!=null?parseInt(N.r,10):R+1,j=-1,f.sheetRows&&f.sheetRows<R)continue;q={},U=!1,N.ht&&(U=!0,q.hpt=parseFloat(N.ht),q.hpx=Ei(q.hpt)),N.hidden=="1"&&(U=!0,q.hidden=!0),N.outlineLevel!=null&&(U=!0,q.level=+N.outlineLevel),U&&(G[R-1]=q)}break;case"<":ie=g;break}if(ie>=g)break;if(N=Oe(m.slice(ie,g),!0),R=N.r!=null?parseInt(N.r,10):R+1,j=-1,!(f.sheetRows&&f.sheetRows<R)){d.s.r>R-1&&(d.s.r=R-1),d.e.r<R-1&&(d.e.r=R-1),f&&f.cellStyles&&(q={},U=!1,N.ht&&(U=!0,q.hpt=parseFloat(N.ht),q.hpx=Ei(q.hpt)),N.hidden=="1"&&(U=!0,q.hidden=!0),N.outlineLevel!=null&&(U=!0,q.level=+N.outlineLevel),U&&(G[R-1]=q)),p=m.slice(g).split(e);for(var X=0;X!=p.length&&p[X].trim().charAt(0)=="<";++X);for(p=p.slice(X),g=0;g!=p.length;++g)if(m=p[g].trim(),m.length!==0){if(x=m.match(r),v=g,w=0,b=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,x!=null&&x.length===2){for(v=0,_=x[1],w=0;w!=_.length&&!((b=_.charCodeAt(w)-64)<1||b>26);++w)v=26*v+b;--v,j=v}else++j;for(w=0;w!=m.length&&m.charCodeAt(w)!==62;++w);if(++w,N=Oe(m.slice(0,w),!0),N.r||(N.r=Pe({r:R-1,c:j})),_=m.slice(w),E={t:""},(x=_.match(s))!=null&&x[1]!==""&&(E.v=Ge(x[1])),f.cellFormula){if((x=_.match(l))!=null&&x[1]!==""){if(E.f=Ge(tt(x[1])).replace(/\r\n/g,`
`),f.xlfn||(E.f=Ip(E.f)),x[0].indexOf('t="array"')>-1)E.F=(_.match(a)||[])[1],E.F.indexOf(":")>-1&&J.push([Ke(E.F),E.F]);else if(x[0].indexOf('t="shared"')>-1){V=Oe(x[0]);var Q=Ge(tt(x[1]));f.xlfn||(Q=Ip(Q)),ue[parseInt(V.si,10)]=[V,Q,N.r]}}else(x=_.match(/<f[^>]*\/>/))&&(V=Oe(x[0]),ue[V.si]&&(E.f=E5(ue[V.si][1],ue[V.si][2],N.r)));var Z=pt(N.r);for(w=0;w<J.length;++w)Z.r>=J[w][0].s.r&&Z.r<=J[w][0].e.r&&Z.c>=J[w][0].s.c&&Z.c<=J[w][0].e.c&&(E.F=J[w][1])}if(N.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(S)E.t="z";else continue;else E.t=N.t||"n";switch(d.s.c>j&&(d.s.c=j),d.e.c<j&&(d.e.c=j),E.t){case"n":if(E.v==""||E.v==null){if(!S)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!S)continue;E.t="z"}else L=yl[parseInt(E.v,10)],E.v=L.t,E.r=L.r,f.cellHTML&&(E.h=L.h);break;case"str":E.t="s",E.v=E.v!=null?tt(E.v):"",f.cellHTML&&(E.h=Eh(E.v));break;case"inlineStr":x=_.match(n),E.t="s",x!=null&&(L=Bh(x[1]))?(E.v=L.t,f.cellHTML&&(E.h=L.h)):E.v="";break;case"b":E.v=lt(E.v);break;case"d":f.cellDates?E.v=ct(E.v,1):(E.v=Ut(ct(E.v,1)),E.t="n");break;case"e":(!f||f.cellText!==!1)&&(E.w=E.v),E.v=zy[E.v];break}if(K=Y=0,B=null,H&&N.s!==void 0&&(B=y.CellXf[N.s],B!=null&&(B.numFmtId!=null&&(K=B.numFmtId),f.cellStyles&&B.fillId!=null&&(Y=B.fillId))),M2(E,K,Y,f,h,y),f.cellDates&&H&&E.t=="n"&&Ri(Re[K])&&(E.t="d",E.v=V0(E.v)),N.cm&&f.xlmeta){var ye=(f.xlmeta.Cell||[])[+N.cm-1];ye&&ye.type=="XLDAPR"&&(E.D=!0)}if(le){var I=pt(N.r);u[I.r]||(u[I.r]=[]),u[I.r][I.c]=E}else u[N.r]=E}}}}G.length>0&&(u["!rows"]=G)}}();function FF(e,t,r,n){var a=[],s=[],l=Ke(e["!ref"]),o="",c,u="",f=[],d=0,h=0,y=e["!rows"],g=Array.isArray(e),m={r:u},p,x=-1;for(h=l.s.c;h<=l.e.c;++h)f[h]=xt(h);for(d=l.s.r;d<=l.e.r;++d){for(s=[],u=Ct(d),h=l.s.c;h<=l.e.c;++h){c=f[h]+u;var v=g?(e[d]||[])[h]:e[c];v!==void 0&&(o=TF(v,c,e,t))!=null&&s.push(o)}(s.length>0||y&&y[d])&&(m={r:u},y&&y[d]&&(p=y[d],p.hidden&&(m.hidden=1),x=-1,p.hpx?x=eo(p.hpx):p.hpt&&(x=p.hpt),x>-1&&(m.ht=x,m.customHeight=1),p.level&&(m.outlineLevel=p.level)),a[a.length]=pe("row",s.join(""),m))}if(y)for(;d<y.length;++d)y&&y[d]&&(m={r:d+1},p=y[d],p.hidden&&(m.hidden=1),x=-1,p.hpx?x=eo(p.hpx):p.hpt&&(x=p.hpt),x>-1&&(m.ht=x,m.customHeight=1),p.level&&(m.outlineLevel=p.level),a[a.length]=pe("row","",m));return a.join("")}function U2(e,t,r,n){var a=[At,pe("worksheet",null,{xmlns:Fs[0],"xmlns:r":Lt.r})],s=r.SheetNames[e],l=0,o="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",f=Ke(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Be(f)}n||(n={}),c["!comments"]=[];var d=[];mF(c,r,e,t,a),a[a.length]=pe("dimension",null,{ref:u}),a[a.length]=jF(c,t,e,r),t.sheetFormat&&(a[a.length]=pe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=NF(c,c["!cols"])),a[l=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=FF(c,t),o.length>0&&(a[a.length]=o)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),c["!protect"]&&(a[a.length]=gF(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=kF(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=dF(c["!merges"]));var h=-1,y,g=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(y={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=Qe(n,-1,Ze(m[1].Target).replace(/#.*$/,""),We.HLINK),y["r:id"]="rId"+g),(h=m[1].Target.indexOf("#"))>-1&&(y.location=Ze(m[1].Target.slice(h+1))),m[1].Tooltip&&(y.tooltip=Ze(m[1].Tooltip)),a[a.length]=pe("hyperlink",null,y))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=wF(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Qt("ignoredErrors",pe("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(g=Qe(n,-1,"../drawings/drawing"+(e+1)+".xml",We.DRAW),a[a.length]=pe("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=d),c["!comments"].length>0&&(g=Qe(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",We.VML),a[a.length]=pe("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function AF(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function DF(e,t,r){var n=oe(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=eo(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,h=-1,y=f<<10;y<f+1<<10;++y){u.c=y;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Pe(u)];g&&(d<0&&(d=y),h=y)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,h))}var m=n.l;return n.l=c,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function RF(e,t,r,n){var a=DF(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&fe(e,0,a)}var PF=Ps,IF=Oi;function OF(){}function LF(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=US(e),r}function MF(e,t,r){r==null&&(r=oe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return s0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Oy(e,r),r.slice(0,r.l)}function BF(e){var t=hn(e);return[t]}function UF(e,t,r){return r==null&&(r=oe(8)),As(t,r)}function zF(e){var t=Ds(e);return[t]}function $F(e,t,r){return r==null&&(r=oe(4)),Rs(t,r)}function WF(e){var t=hn(e),r=e.read_shift(1);return[t,r,"b"]}function VF(e,t,r){return r==null&&(r=oe(9)),As(t,r),r.write_shift(1,e.v?1:0),r}function HF(e){var t=Ds(e),r=e.read_shift(1);return[t,r,"b"]}function XF(e,t,r){return r==null&&(r=oe(5)),Rs(t,r),r.write_shift(1,e.v?1:0),r}function GF(e){var t=hn(e),r=e.read_shift(1);return[t,r,"e"]}function KF(e,t,r){return r==null&&(r=oe(9)),As(t,r),r.write_shift(1,e.v),r}function qF(e){var t=Ds(e),r=e.read_shift(1);return[t,r,"e"]}function YF(e,t,r){return r==null&&(r=oe(8)),Rs(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function JF(e){var t=hn(e),r=e.read_shift(4);return[t,r,"s"]}function QF(e,t,r){return r==null&&(r=oe(12)),As(t,r),r.write_shift(4,t.v),r}function ZF(e){var t=Ds(e),r=e.read_shift(4);return[t,r,"s"]}function eA(e,t,r){return r==null&&(r=oe(8)),Rs(t,r),r.write_shift(4,t.v),r}function tA(e){var t=hn(e),r=ur(e);return[t,r,"n"]}function rA(e,t,r){return r==null&&(r=oe(16)),As(t,r),ks(e.v,r),r}function z2(e){var t=Ds(e),r=ur(e);return[t,r,"n"]}function nA(e,t,r){return r==null&&(r=oe(12)),Rs(t,r),ks(e.v,r),r}function aA(e){var t=hn(e),r=Ph(e);return[t,r,"n"]}function sA(e,t,r){return r==null&&(r=oe(12)),As(t,r),Ly(e.v,r),r}function iA(e){var t=Ds(e),r=Ph(e);return[t,r,"n"]}function lA(e,t,r){return r==null&&(r=oe(8)),Rs(t,r),Ly(e.v,r),r}function oA(e){var t=hn(e),r=Ah(e);return[t,r,"is"]}function cA(e){var t=hn(e),r=dr(e);return[t,r,"str"]}function uA(e,t,r){return r==null&&(r=oe(12+4*e.v.length)),As(t,r),Ht(e.v,r),r.length>r.l?r.slice(0,r.l):r}function fA(e){var t=Ds(e),r=dr(e);return[t,r,"str"]}function dA(e,t,r){return r==null&&(r=oe(8+4*e.v.length)),Rs(t,r),Ht(e.v,r),r.length>r.l?r.slice(0,r.l):r}function hA(e,t,r){var n=e.l+t,a=hn(e);a.r=r["!row"];var s=e.read_shift(1),l=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=G0(e,n-e.l,r);l[3]=ir(o,null,a,r.supbooks,r)}else e.l=n;return l}function mA(e,t,r){var n=e.l+t,a=hn(e);a.r=r["!row"];var s=e.read_shift(1),l=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=G0(e,n-e.l,r);l[3]=ir(o,null,a,r.supbooks,r)}else e.l=n;return l}function xA(e,t,r){var n=e.l+t,a=hn(e);a.r=r["!row"];var s=ur(e),l=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=G0(e,n-e.l,r);l[3]=ir(o,null,a,r.supbooks,r)}else e.l=n;return l}function pA(e,t,r){var n=e.l+t,a=hn(e);a.r=r["!row"];var s=dr(e),l=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=G0(e,n-e.l,r);l[3]=ir(o,null,a,r.supbooks,r)}else e.l=n;return l}var gA=Ps,vA=Oi;function yA(e,t){return t==null&&(t=oe(4)),t.write_shift(4,e),t}function wA(e,t){var r=e.l+t,n=Ps(e),a=Dh(e),s=dr(e),l=dr(e),o=dr(e);e.l=r;var c={rfx:n,relId:a,loc:s,display:o};return l&&(c.Tooltip=l),c}function bA(e,t){var r=oe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Oi({s:pt(e[0]),e:pt(e[0])},r),Rh("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Ht(a||"",r),Ht(e[1].Tooltip||"",r),Ht("",r),r.slice(0,r.l)}function NA(){}function _A(e,t,r){var n=e.l+t,a=My(e),s=e.read_shift(1),l=[a];if(l[2]=s,r.cellFormula){var o=GC(e,n-e.l,r);l[1]=o}else e.l=n;return l}function kA(e,t,r){var n=e.l+t,a=Ps(e),s=[a];if(r.cellFormula){var l=qC(e,n-e.l,r);s[1]=l,e.l=n}else e.l=n;return s}function EA(e,t,r){r==null&&(r=oe(18));var n=K0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var $2=["left","right","top","bottom","header","footer"];function SA(e){var t={};return $2.forEach(function(r){t[r]=ur(e)}),t}function jA(e,t){return t==null&&(t=oe(6*8)),ms(e),$2.forEach(function(r){ks(e[r],t)}),t}function TA(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function CA(e,t,r){r==null&&(r=oe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function FA(e){var t=oe(24);return t.write_shift(4,4),t.write_shift(4,1),Oi(e,t),t}function AA(e,t){return t==null&&(t=oe(16*4+2)),t.write_shift(2,e.password?Uh(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function DA(){}function RA(){}function PA(e,t,r,n,a,s,l){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,y,g,m,p,x,v,w,b,_,E=[];o.biff=12,o["!row"]=0;var N=0,R=!1,j=[],L={},V=o.supbooks||a.supbooks||[[]];if(V.sharedf=L,V.arrayf=j,V.SheetNames=a.SheetNames||a.Sheets.map(function(le){return le.name}),!o.supbooks&&(o.supbooks=V,a.Names))for(var K=0;K<a.Names.length;++K)V[0][K+1]=a.Names[K];var Y=[],H=[],B=!1;to[16]={n:"BrtShortReal",f:z2};var J;if(da(e,function(G,q,U){if(!h)switch(U){case 148:u=G;break;case 0:y=G,o.sheetRows&&o.sheetRows<=y.r&&(h=!0),b=Ct(p=y.r),o["!row"]=y.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=Ei(G.hpt)),H[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:G[2]},G[2]){case"n":g.v=G[1];break;case"s":w=yl[G[1]],g.v=w.t,g.r=w.r;break;case"b":g.v=!!G[1];break;case"e":g.v=G[1],o.cellText!==!1&&(g.w=ha[g.v]);break;case"str":g.t="s",g.v=G[1];break;case"is":g.t="s",g.v=G[1].t;break}if((m=l.CellXf[G[0].iStyleRef])&&M2(g,m.numFmtId,null,o,s,l),x=G[0].c==-1?x+1:G[0].c,o.dense?(c[p]||(c[p]=[]),c[p][x]=g):c[xt(x)+b]=g,o.cellFormula){for(R=!1,N=0;N<j.length;++N){var S=j[N];y.r>=S[0].s.r&&y.r<=S[0].e.r&&x>=S[0].s.c&&x<=S[0].e.c&&(g.F=Be(S[0]),R=!0)}!R&&G.length>3&&(g.f=G[3])}if(f.s.r>y.r&&(f.s.r=y.r),f.s.c>x&&(f.s.c=x),f.e.r<y.r&&(f.e.r=y.r),f.e.c<x&&(f.e.c=x),o.cellDates&&m&&g.t=="n"&&Ri(Re[m.numFmtId])){var z=ls(g.v);z&&(g.t="d",g.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}J&&(J.type=="XLDAPR"&&(g.D=!0),J=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;g={t:"z",v:void 0},x=G[0].c==-1?x+1:G[0].c,o.dense?(c[p]||(c[p]=[]),c[p][x]=g):c[xt(x)+b]=g,f.s.r>y.r&&(f.s.r=y.r),f.s.c>x&&(f.s.c=x),f.e.r<y.r&&(f.e.r=y.r),f.e.c<x&&(f.e.c=x),J&&(J.type=="XLDAPR"&&(g.D=!0),J=void 0);break;case 176:E.push(G);break;case 49:J=((o.xlmeta||{}).Cell||[])[G-1];break;case 494:var F=n["!id"][G.relId];for(F?(G.Target=F.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=F):G.relId==""&&(G.Target="#"+G.loc),p=G.rfx.s.r;p<=G.rfx.e.r;++p)for(x=G.rfx.s.c;x<=G.rfx.e.c;++x)o.dense?(c[p]||(c[p]=[]),c[p][x]||(c[p][x]={t:"z",v:void 0}),c[p][x].l=G):(v=Pe({c:x,r:p}),c[v]||(c[v]={t:"z",v:void 0}),c[v].l=G);break;case 426:if(!o.cellFormula)break;j.push(G),_=o.dense?c[p][x]:c[xt(x)+b],_.f=ir(G[1],f,{r:y.r,c:x},V,o),_.F=Be(G[0]);break;case 427:if(!o.cellFormula)break;L[Pe(G[0].s)]=G[1],_=o.dense?c[p][x]:c[xt(x)+b],_.f=ir(G[1],f,{r:y.r,c:x},V,o);break;case 60:if(!o.cellStyles)break;for(;G.e>=G.s;)Y[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},B||(B=!0,zh(G.w/256)),Ba(Y[G.e+1]);break;case 161:c["!autofilter"]={ref:Be(G)};break;case 476:c["!margins"]=G;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),G.name&&(a.Sheets[r].CodeName=G.name),(G.above||G.left)&&(c["!outline"]={above:G.above,left:G.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),G.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!q.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Be(u||f)),o.sheetRows&&c["!ref"]){var ue=Ke(c["!ref"]);o.sheetRows<=+ue.e.r&&(ue.e.r=o.sheetRows-1,ue.e.r>f.e.r&&(ue.e.r=f.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>f.e.c&&(ue.e.c=f.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Be(ue))}return E.length>0&&(c["!merges"]=E),Y.length>0&&(c["!cols"]=Y),H.length>0&&(c["!rows"]=H),c}function IA(e,t,r,n,a,s,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=ut(t),t.z=t.z||Re[14],t.v=Ut(ct(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=Ka(a.cellXfs,t,a),t.l&&s["!links"].push([Pe(c),t.l]),t.c&&s["!comments"].push([Pe(c),t.c]),t.t){case"s":case"str":return a.bookSST?(o=Xh(a.Strings,t.v,a.revStrings),c.t="s",c.v=o,l?fe(e,18,eA(t,c)):fe(e,7,QF(t,c))):(c.t="str",l?fe(e,17,dA(t,c)):fe(e,6,uA(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?fe(e,13,lA(t,c)):fe(e,2,sA(t,c)):l?fe(e,16,nA(t,c)):fe(e,5,rA(t,c)),!0;case"b":return c.t="b",l?fe(e,15,XF(t,c)):fe(e,4,VF(t,c)),!0;case"e":return c.t="e",l?fe(e,14,YF(t,c)):fe(e,3,KF(t,c)),!0}return l?fe(e,12,$F(t,c)):fe(e,1,UF(t,c)),!0}function OA(e,t,r,n){var a=Ke(t["!ref"]||"A1"),s,l="",o=[];fe(e,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var f=a.s.r;f<=u;++f){l=Ct(f),RF(e,t,a,f);var d=!1;if(f<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){f===a.s.r&&(o[h]=xt(h)),s=o[h]+l;var y=c?(t[f]||[])[h]:t[s];if(!y){d=!1;continue}d=IA(e,y,f,h,n,t,d)}}fe(e,146)}function LA(e,t){!t||!t["!merges"]||(fe(e,177,yA(t["!merges"].length)),t["!merges"].forEach(function(r){fe(e,176,vA(r))}),fe(e,178))}function MA(e,t){!t||!t["!cols"]||(fe(e,390),t["!cols"].forEach(function(r,n){r&&fe(e,60,EA(n,r))}),fe(e,391))}function BA(e,t){!t||!t["!ref"]||(fe(e,648),fe(e,649,FA(Ke(t["!ref"]))),fe(e,650))}function UA(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Qe(r,-1,n[1].Target.replace(/#.*$/,""),We.HLINK);fe(e,494,bA(n,a))}}),delete t["!links"]}function zA(e,t,r,n){if(t["!comments"].length>0){var a=Qe(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",We.VML);fe(e,551,Rh("rId"+a)),t["!legacy"]=a}}function $A(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:Be(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=Mr(s);o.s.r==o.e.r&&(o.e.r=Mr(t["!ref"]).e.r,s=Be(o));for(var c=0;c<l.length;++c){var u=l[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),fe(e,161,Oi(Ke(s))),fe(e,162)}}function WA(e,t,r){fe(e,133),fe(e,137,CA(t,r)),fe(e,138),fe(e,134)}function VA(e,t){t["!protect"]&&fe(e,535,AA(t["!protect"]))}function HA(e,t,r,n){var a=Or(),s=r.SheetNames[e],l=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Ke(l["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],fe(a,129),(r.vbaraw||l["!outline"])&&fe(a,147,MF(o,l["!outline"])),fe(a,148,IF(c)),WA(a,l,r.Workbook),MA(a,l),OA(a,l,e,t),VA(a,l),$A(a,l,r,e),LA(a,l),UA(a,l,n),l["!margins"]&&fe(a,476,jA(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&BA(a,l),zA(a,l,e,n),fe(a,130),a.end()}function XA(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var a=Ge((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function GA(e,t,r,n,a,s){var l=s||{"!type":"chart"};if(!e)return s;var o=0,c=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=XA(d);f.s.r=f.s.c=0,f.e.c=o,u=xt(o),h[0].forEach(function(y,g){l[u+Ct(g)]={t:"n",v:y,z:h[1]},c=g}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(l["!ref"]=Be(f)),l}function KA(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(B2);return o&&Gh(o[0],s,a,r),(l=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function qA(e,t){e.l+=10;var r=dr(e);return{name:r}}function YA(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return da(e,function(c,u,f){switch(f){case 550:s["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Kh=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],JA=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],QA=[],ZA=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Up(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=lt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function zp(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=lt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function W2(e){zp(e.WBProps,Kh),zp(e.CalcPr,ZA),Up(e.WBView,JA),Up(e.Sheets,QA),ui.date1904=lt(e.WBProps.date1904)}function e8(e){return!e.Workbook||!e.Workbook.WBProps?"false":lt(e.Workbook.WBProps.date1904)?"true":"false"}var t8="][*?/\\".split("");function V2(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return t8.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function r8(e,t,r){e.forEach(function(n,a){V2(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[a]&&t[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function n8(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];r8(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)eF(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var a8=/<\w+:workbook/;function s8(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},l=0;if(e.replace(xr,function(c,u){var f=Oe(c);switch(Xn(f[0])){case"<?xml":break;case"<workbook":c.match(a8)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Kh.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=lt(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=tt(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Ge(tt(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=tt(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),lt(f.hidden||"0")&&(s.Hidden=!0),l=u+c.length;break;case"</definedName>":s.Ref=Ge(tt(e.slice(l,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),Fs.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return W2(r),r}function H2(e){var t=[At];t[t.length]=pe("workbook",null,{xmlns:Fs[0],"xmlns:r":Lt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Kh.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=pe("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var l={name:Ze(e.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=pe("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=pe("definedName",Ze(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function i8(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=qf(e),r.name=dr(e),r}function l8(e,t){return t||(t=oe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Rh(e.strRelID,t),Ht(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function o8(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?dr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function c8(e,t){t||(t=oe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Oy(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function u8(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function f8(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=zS(e),l=KC(e,0,r),o=Dh(e);e.l=n;var c={Name:s,Ptg:l};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function d8(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],to[16]={n:"BrtFRTArchID$",f:u8},da(e,function(c,u,f){switch(f){case 156:l.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=ir(c.Ptg,null,null,l,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([f,c]):l[0]=[f,c],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(c),l.XTI=l.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),W2(r),r.Names=s,r.supbooks=l,r}function h8(e,t){fe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};fe(e,156,l8(a))}fe(e,144)}function m8(e,t){t||(t=oe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ht("SheetJS",t),Ht(Qc.version,t),Ht(Qc.version,t),Ht("7262",t),t.length>t.l?t.slice(0,t.l):t}function x8(e,t){t||(t=oe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function p8(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(fe(e,135),fe(e,158,x8(a)),fe(e,136))}}function g8(e,t){var r=Or();return fe(r,131),fe(r,128,m8()),fe(r,153,c8(e.Workbook&&e.Workbook.WBProps||null)),p8(r,e),h8(r,e),fe(r,132),r.end()}function v8(e,t,r){return t.slice(-4)===".bin"?d8(e,r):s8(e,r)}function y8(e,t,r,n,a,s,l,o){return t.slice(-4)===".bin"?PA(e,n,r,a,s,l,o):fF(e,n,r,a,s,l,o)}function w8(e,t,r,n,a,s,l,o){return t.slice(-4)===".bin"?YA(e,n,r,a,s):KA(e,n,r,a,s)}function b8(e,t,r,n,a,s,l,o){return t.slice(-4)===".bin"?_5():k5()}function N8(e,t,r,n,a,s,l,o){return t.slice(-4)===".bin"?b5():N5()}function _8(e,t,r,n){return t.slice(-4)===".bin"?v6(e,r,n):i6(e,r,n)}function k8(e,t,r){return E2(e,r)}function E8(e,t,r){return t.slice(-4)===".bin"?ET(e,r):NT(e,r)}function S8(e,t,r){return t.slice(-4)===".bin"?p5(e,r):l5(e,r)}function j8(e,t,r){return t.slice(-4)===".bin"?a5(e):r5(e)}function T8(e,t,r,n){return r.slice(-4)===".bin"?s5(e,t,r,n):void 0}function C8(e,t,r){return t.slice(-4)===".bin"?Z6(e,t,r):t5(e,t,r)}function F8(e,t,r){return(t.slice(-4)===".bin"?g8:H2)(e)}function A8(e,t,r,n,a){return(t.slice(-4)===".bin"?HA:U2)(e,r,n,a)}function D8(e,t,r){return(t.slice(-4)===".bin"?T6:_2)(e,r)}function R8(e,t,r){return(t.slice(-4)===".bin"?TT:x2)(e,r)}function P8(e,t,r){return(t.slice(-4)===".bin"?g5:T2)(e)}function I8(e){return(e.slice(-4)===".bin"?e5:S2)()}var X2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,G2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function pn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(X2),s,l,o,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(G2),(l=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),n[o]=s[2].slice(1,s[2].length-1));return n}function O8(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(X2),a,s,l,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(G2),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(s+1),r[l]=a[2].slice(1,a[2].length-1));return r}var bl;function L8(e,t){var r=bl[e]||Ge(e);return r==="General"?Ns(t):dn(r,t)}function M8(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=lt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=ct(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ge(t)]=a}function B8(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ha[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Xl(e.v):e.w=Ns(e.v):e.w=L8(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=bl[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ri(n)){var a=ls(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function U8(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=QT[n.Pattern]||n.Pattern)}e[t.ID]=t}function z8(e,t,r,n,a,s,l,o,c,u){var f="General",d=n.StyleID,h={};u=u||{};var y=[],g=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&l&&(d=l.StyleID);s[d]!==void 0&&(s[d].nf&&(f=s[d].nf),s[d].Interior&&y.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=lt(e);break;case"String":n.t="s",n.r=ap(Ge(e)),n.v=e.indexOf("<")>-1?Ge(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(ct(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ge(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=zy[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=ap(t||e));break}if(B8(n,f,u),u.cellFormula!==!1)if(n.Formula){var m=Ge(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=ci(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ci("RC:RC",a):n.ArrayRange&&(n.F=ci(n.ArrayRange,a),c.push([Ke(n.F),n.F]))}else for(g=0;g<c.length;++g)a.r>=c[g][0].s.r&&a.r<=c[g][0].e.r&&a.c>=c[g][0].s.c&&a.c<=c[g][0].e.c&&(n.F=c[g][1]);u.cellStyles&&(y.forEach(function(p){!h.patternType&&p.patternType&&(h.patternType=p.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function $8(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Lu(e,t){var r=t||{};Pi();var n=rl(Sh(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=tt(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=ut(r);return l.type="string",ki.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(se){a.indexOf("<"+se)>=0&&(s=!0)}),s)return jD(n,r);bl={"General Number":"General","General Date":Re[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Re[15],"Short Date":Re[14],"Long Time":Re[19],"Medium Time":Re[18],"Short Time":Re[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Re[2],Standard:Re[4],Percent:Re[10],Scientific:Re[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,f={},d=[],h=r.dense?[]:{},y="",g={},m={},p=pn('<Data ss:Type="String">'),x=0,v=0,w=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},E={},N="",R=0,j=[],L={},V={},K=0,Y=[],H=[],B={},J=[],ue,le=!1,G=[],q=[],U={},S=0,z=0,F={Sheets:[],WBProps:{date1904:!1}},M={};ql.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var W="";o=ql.exec(n);)switch(o[3]=(W=o[3]).toLowerCase()){case"data":if(W=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?z8(n.slice(x,o.index),N,p,c[c.length-1][0]=="comment"?B:g,{c:v,r:w},_,J[v],m,G,r):(N="",p=pn(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(H.length>0&&(g.c=H),(!r.sheetRows||r.sheetRows>w)&&g.v!==void 0&&(r.dense?(h[w]||(h[w]=[]),h[w][v]=g):h[xt(v)+Ct(w)]=g),g.HRef&&(g.l={Target:Ge(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(S=v+(parseInt(g.MergeAcross,10)|0),z=w+(parseInt(g.MergeDown,10)|0),j.push({s:{c:v,r:w},e:{c:S,r:z}})),!r.sheetStubs)g.MergeAcross?v=S+1:++v;else if(g.MergeAcross||g.MergeDown){for(var ie=v;ie<=S;++ie)for(var X=w;X<=z;++X)(ie>v||X>w)&&(r.dense?(h[X]||(h[X]=[]),h[X][ie]={t:"z"}):h[xt(ie)+Ct(X)]={t:"z"});v=S+1}else++v;else g=O8(o[0]),g.Index&&(v=+g.Index-1),v<b.s.c&&(b.s.c=v),v>b.e.c&&(b.e.c=v),o[0].slice(-2)==="/>"&&++v,H=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<b.s.r&&(b.s.r=w),w>b.e.r&&(b.e.r=w),o[0].slice(-2)==="/>"&&(m=pn(o[0]),m.Index&&(w=+m.Index-1)),v=0,++w):(m=pn(o[0]),m.Index&&(w=+m.Index-1),U={},(m.AutoFitHeight=="0"||m.Height)&&(U.hpx=parseInt(m.Height,10),U.hpt=eo(U.hpx),q[w]=U),m.Hidden=="1"&&(U.hidden=!0,q[w]=U));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));d.push(y),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(h["!ref"]=Be(b),r.sheetRows&&r.sheetRows<=b.e.r&&(h["!fullref"]=h["!ref"],b.e.r=r.sheetRows-1,h["!ref"]=Be(b))),j.length&&(h["!merges"]=j),J.length>0&&(h["!cols"]=J),q.length>0&&(h["!rows"]=q),f[y]=h}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=v=0,c.push([o[3],!1]),u=pn(o[0]),y=Ge(u.Name),h=r.dense?[]:{},j=[],G=[],q=[],M={name:y,Hidden:0},F.Sheets.push(M);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),J=[],le=!1}break;case"style":o[1]==="/"?U8(_,E,r):E=pn(o[0]);break;case"numberformat":E.nf=Ge(pn(o[0]).Format||"General"),bl[E.nf]&&(E.nf=bl[E.nf]);for(var Q=0;Q!=392&&Re[Q]!=E.nf;++Q);if(Q==392){for(Q=57;Q!=392;++Q)if(Re[Q]==null){ra(E.nf,Q);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ue=pn(o[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!le&&ue.wpx>10){le=!0,or=b2;for(var Z=0;Z<J.length;++Z)J[Z]&&Ba(J[Z])}le&&Ba(ue),J[ue.Index-1||J.length]=ue;for(var ye=0;ye<+ue.Span;++ye)J[J.length]=ut(ue);break;case"namedrange":if(o[1]==="/")break;F.Names||(F.Names=[]);var I=Oe(o[0]),ve={Name:I.Name,Ref:ci(I.RefersTo.slice(1),{r:0,c:0})};F.Sheets.length>0&&(ve.Sheet=F.Sheets.length-1),F.Names.push(ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?N+=n.slice(R,o.index):R=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=pn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?d3(L,W,n.slice(K,o.index)):K=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));$8(B),H.push(B)}else c.push([o[3],!1]),u=pn(o[0]),B={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ae=pn(o[0]);h["!autofilter"]={ref:ci(Ae.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Xp(n,r);var Ie=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ie=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ie=!1}break;case"excelworkbook":switch(o[3]){case"date1904":F.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ie=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ie=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(K,o.index)){case"SheetHidden":M.Hidden=1;break;case"SheetVeryHidden":M.Hidden=2;break}else K=o.index+o[0].length;break;case"header":h["!margins"]||ms(h["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(h["!margins"].header=+Oe(o[0]).Margin);break;case"footer":h["!margins"]||ms(h["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(h["!margins"].footer=+Oe(o[0]).Margin);break;case"pagemargins":var be=Oe(o[0]);h["!margins"]||ms(h["!margins"]={},"xlml"),isNaN(+be.Top)||(h["!margins"].top=+be.Top),isNaN(+be.Left)||(h["!margins"].left=+be.Left),isNaN(+be.Right)||(h["!margins"].right=+be.Right),isNaN(+be.Bottom)||(h["!margins"].bottom=+be.Bottom);break;case"displayrighttoleft":F.Views||(F.Views=[]),F.Views[0]||(F.Views[0]={}),F.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ie=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ie=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ie=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ie=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ie=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ie=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ie=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ie=!1}break;case"smarttags":break;default:Ie=!1;break}if(Ie||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?M8(V,W,Y,n.slice(K,o.index)):(Y=o,K=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var de={};return!r.bookSheets&&!r.bookProps&&(de.Sheets=f),de.SheetNames=d,de.Workbook=F,de.SSF=ut(Re),de.Props=L,de.Custprops=V,de}function rd(e,t){switch(Yh(t=t||{}),t.type||"base64"){case"base64":return Lu(Kr(e),t);case"binary":case"buffer":case"file":return Lu(e,t);case"array":return Lu(Xa(e),t)}}function W8(e,t){var r=[];return e.Props&&r.push(h3(e.Props,t)),e.Custprops&&r.push(m3(e.Props,e.Custprops)),r.join("")}function V8(){return""}function H8(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(pe("NumberFormat",null,{"ss:Format":Ze(Re[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(pe("Style",s.join(""),l))}),pe("Styles",r.join(""))}function K2(e){return pe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Vh(e.Ref,{r:0,c:0})})}function X8(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(K2(a)))}return pe("Names",r.join(""))}function G8(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],l=0;l<a.length;++l){var o=a[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(K2(o)))}return s.join("")}function K8(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(pe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(pe("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(pe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(pe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Qt("ProtectContents","True")),e["!protect"].objects&&a.push(Qt("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Qt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Qt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Qt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":pe("WorksheetOptions",a.join(""),{xmlns:Ur.x})}function q8(e){return e.map(function(t){var r=pS(t.t||""),n=pe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return pe("Comment",n,{"ss:Author":t.a})}).join("")}function Y8(e,t,r,n,a,s,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ze(Vh(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var c=pt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==l.r?"":"["+(c.r-l.r)+"]")+"C"+(c.c==l.c?"":"["+(c.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ze(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ze(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=l.c||u[f].s.r!=l.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var d="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=ha[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Re[14]);break;case"s":d="String",h=xS(e.v||"");break}var y=Ka(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+y),o["ss:Index"]=l.c+1;var g=e.v!=null?h:"",m=e.t=="z"?"":'<Data ss:Type="'+d+'">'+g+"</Data>";return(e.c||[]).length>0&&(m+=q8(e.c)),pe("Cell",m,o)}function J8(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ei(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Q8(e,t,r,n){if(!e["!ref"])return"";var a=Ke(e["!ref"]),s=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(p,x){Ba(p);var v=!!p.width,w=K0(x,p),b={"ss:Index":x+1};v&&(b["ss:Width"]=Ql(w.width)),p.hidden&&(b["ss:Hidden"]="1"),o.push(pe("Column",null,b))});for(var c=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var f=[J8(u,(e["!rows"]||[])[u])],d=a.s.c;d<=a.e.c;++d){var h=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>d)&&!(s[l].s.r>u)&&!(s[l].e.c<d)&&!(s[l].e.r<u)){(s[l].s.c!=d||s[l].s.r!=u)&&(h=!0);break}if(!h){var y={r:u,c:d},g=Pe(y),m=c?(e[u]||[])[d]:e[g];f.push(Y8(m,g,e,t,r,n,y))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function Z8(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],l=s?G8(s,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?Q8(s,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(K8(s,t,e,r)),n.join("")}function eD(e,t){t||(t={}),e.SSF||(e.SSF=ut(Re)),e.SSF&&(Pi(),z0(e.SSF),t.revssf=W0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ka(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(W8(e,t)),r.push(V8()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(pe("Worksheet",Z8(n,t,e),{"ss:Name":Ze(e.SheetNames[n])}));return r[2]=H8(e,t),r[3]=X8(e),At+pe("Workbook",r.join(""),{xmlns:Ur.ss,"xmlns:o":Ur.o,"xmlns:x":Ur.x,"xmlns:ss":Ur.ss,"xmlns:dt":Ur.dt,"xmlns:html":Ur.html})}function tD(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=XS(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=GS(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var rD=[60,1084,2066,2165,2175];function nD(e,t,r,n,a){var s=n,l=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}l.push(o),r.l+=s;for(var c=Zn(r,r.l),u=nd[c],f=0;u!=null&&rD.indexOf(c)>-1;)s=Zn(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=r.slice(f,r.l+4+s),l.push(o),r.l+=4+s,u=nd[c=Zn(r,r.l)];var d=Wt(l);Jt(d,0);var h=0;d.lens=[];for(var y=0;y<l.length;++y)d.lens.push(h),h+=l[y].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function Rn(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Re[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ha[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Xl(e.v):e.w=Ns(e.v):e.w=dn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Ri(Re[n]||String(n))){var a=ls(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function rc(e,t,r){return{v:e,ixfe:t,t:r}}function aD(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},l={},o=null,c=[],u="",f={},d,h="",y,g,m,p,x={},v=[],w,b,_=[],E=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},j=function(Fe){return Fe<8?fs[Fe]:Fe<64&&E[Fe-8]||fs[Fe]},L=function(Fe,He,gr){var wt=He.XF.data;if(!(!wt||!wt.patternType||!gr||!gr.cellStyles)){He.s={},He.s.patternType=wt.patternType;var Cn;(Cn=Jl(j(wt.icvFore)))&&(He.s.fgColor={rgb:Cn}),(Cn=Jl(j(wt.icvBack)))&&(He.s.bgColor={rgb:Cn})}},V=function(Fe,He,gr){if(!(U>1)&&!(gr.sheetRows&&Fe.r>=gr.sheetRows)){if(gr.cellStyles&&He.XF&&He.XF.data&&L(Fe,He,gr),delete He.ixfe,delete He.XF,d=Fe,h=Pe(Fe),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Fe.r<l.s.r&&(l.s.r=Fe.r),Fe.c<l.s.c&&(l.s.c=Fe.c),Fe.r+1>l.e.r&&(l.e.r=Fe.r+1),Fe.c+1>l.e.c&&(l.e.c=Fe.c+1),gr.cellFormula&&He.f){for(var wt=0;wt<v.length;++wt)if(!(v[wt][0].s.c>Fe.c||v[wt][0].s.r>Fe.r)&&!(v[wt][0].e.c<Fe.c||v[wt][0].e.r<Fe.r)){He.F=Be(v[wt][0]),(v[wt][0].s.c!=Fe.c||v[wt][0].s.r!=Fe.r)&&delete He.f,He.f&&(He.f=""+ir(v[wt][1],l,Fe,G,K));break}}gr.dense?(a[Fe.r]||(a[Fe.r]=[]),a[Fe.r][Fe.c]=He):a[h]=He}},K={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(K.password=t.password);var Y,H=[],B=[],J=[],ue=[],le=!1,G=[];G.SheetNames=K.snames,G.sharedf=K.sharedf,G.arrayf=K.arrayf,G.names=[],G.XTI=[];var q=0,U=0,S=0,z=[],F=[],M;K.codepage=1200,wn(1200);for(var W=!1;e.l<e.length-1;){var ie=e.l,X=e.read_shift(2);if(X===0&&q===10)break;var Q=e.l===e.length?0:e.read_shift(2),Z=nd[X];if(Z&&Z.f){if(t.bookSheets&&q===133&&X!==133)break;if(q=X,Z.r===2||Z.r==12){var ye=e.read_shift(2);if(Q-=2,!K.enc&&ye!==X&&((ye&255)<<8|ye>>8)!==X)throw new Error("rt mismatch: "+ye+"!="+X);Z.r==12&&(e.l+=10,Q-=10)}var I={};if(X===10?I=Z.f(e,Q,K):I=nD(X,Z,e,Q,K),U==0&&[9,521,1033,2057].indexOf(q)===-1)continue;switch(X){case 34:r.opts.Date1904=N.WBProps.date1904=I;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(K.enc||(e.l=0),K.enc=I,!t.password)throw new Error("File is password-protected");if(I.valid==null)throw new Error("Encryption scheme unsupported");if(!I.valid)throw new Error("Password is incorrect");break;case 92:K.lastuser=I;break;case 66:var ve=Number(I);switch(ve){case 21010:ve=1200;break;case 32768:ve=1e4;break;case 32769:ve=1252;break}wn(K.codepage=ve),W=!0;break;case 317:K.rrtabid=I;break;case 25:K.winlocked=I;break;case 439:r.opts.RefreshAll=I;break;case 12:r.opts.CalcCount=I;break;case 16:r.opts.CalcDelta=I;break;case 17:r.opts.CalcIter=I;break;case 13:r.opts.CalcMode=I;break;case 14:r.opts.CalcPrecision=I;break;case 95:r.opts.CalcSaveRecalc=I;break;case 15:K.CalcRefMode=I;break;case 2211:r.opts.FullCalc=I;break;case 129:I.fDialog&&(a["!type"]="dialog"),I.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),I.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:_.push(I);break;case 430:G.push([I]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(I);break;case 24:case 536:M={Name:I.Name,Ref:ir(I.rgce,l,null,G,K)},I.itab>0&&(M.Sheet=I.itab-1),G.names.push(M),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(I),I.Name=="_xlnm._FilterDatabase"&&I.itab>0&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&I.rgce[0][0][0]=="PtgArea3d"&&(F[I.itab-1]={ref:Be(I.rgce[0][0][1][2])});break;case 22:K.ExternCount=I;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(I),G.XTI=G.XTI.concat(I);break;case 2196:if(K.biff<8)break;M!=null&&(M.Comment=I[1]);break;case 18:a["!protect"]=I;break;case 19:I!==0&&K.WTF&&console.error("Password verifier: "+I);break;case 133:s[I.pos]=I,K.snames.push(I.name);break;case 10:{if(--U)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=Be(l),t.sheetRows&&t.sheetRows<=l.e.r){var Ae=l.e.r;l.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Be(l),l.e.r=Ae}l.e.r++,l.e.c++}H.length>0&&(a["!merges"]=H),B.length>0&&(a["!objects"]=B),J.length>0&&(a["!cols"]=J),ue.length>0&&(a["!rows"]=ue),N.Sheets.push(R)}u===""?f=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(K.biff===8&&(K.biff={9:2,521:3,1033:4}[X]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),K.biffguess=I.BIFFVer==0,I.BIFFVer==0&&I.dt==4096&&(K.biff=5,W=!0,wn(K.codepage=28591)),K.biff==8&&I.BIFFVer==0&&I.dt==16&&(K.biff=2),U++)break;if(a=t.dense?[]:{},K.biff<8&&!W&&(W=!0,wn(K.codepage=t.codepage||1252)),K.biff<5||I.BIFFVer==0&&I.dt==4096){u===""&&(u="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Ie={pos:e.l-Q,name:u};s[Ie.pos]=Ie,K.snames.push(u)}else u=(s[ie]||{name:""}).name;I.dt==32&&(a["!type"]="chart"),I.dt==64&&(a["!type"]="macro"),H=[],B=[],K.arrayf=v=[],J=[],ue=[],le=!1,R={Hidden:(s[ie]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[I.r]||[])[I.c]:a[Pe({c:I.c,r:I.r})])&&++I.c,w={ixfe:I.ixfe,XF:_[I.ixfe]||{},v:I.val,t:"n"},S>0&&(w.z=z[w.ixfe>>8&63]),Rn(w,t,r.opts.Date1904),V({c:I.c,r:I.r},w,t);break;case 5:case 517:w={ixfe:I.ixfe,XF:_[I.ixfe],v:I.val,t:I.t},S>0&&(w.z=z[w.ixfe>>8&63]),Rn(w,t,r.opts.Date1904),V({c:I.c,r:I.r},w,t);break;case 638:w={ixfe:I.ixfe,XF:_[I.ixfe],v:I.rknum,t:"n"},S>0&&(w.z=z[w.ixfe>>8&63]),Rn(w,t,r.opts.Date1904),V({c:I.c,r:I.r},w,t);break;case 189:for(var be=I.c;be<=I.C;++be){var de=I.rkrec[be-I.c][0];w={ixfe:de,XF:_[de],v:I.rkrec[be-I.c][1],t:"n"},S>0&&(w.z=z[w.ixfe>>8&63]),Rn(w,t,r.opts.Date1904),V({c:be,r:I.r},w,t)}break;case 6:case 518:case 1030:{if(I.val=="String"){o=I;break}if(w=rc(I.val,I.cell.ixfe,I.tt),w.XF=_[w.ixfe],t.cellFormula){var se=I.formula;if(se&&se[0]&&se[0][0]&&se[0][0][0]=="PtgExp"){var Se=se[0][0][1][0],Ee=se[0][0][1][1],Te=Pe({r:Se,c:Ee});x[Te]?w.f=""+ir(I.formula,l,I.cell,G,K):w.F=((t.dense?(a[Se]||[])[Ee]:a[Te])||{}).F}else w.f=""+ir(I.formula,l,I.cell,G,K)}S>0&&(w.z=z[w.ixfe>>8&63]),Rn(w,t,r.opts.Date1904),V(I.cell,w,t),o=I}break;case 7:case 519:if(o)o.val=I,w=rc(I,o.cell.ixfe,"s"),w.XF=_[w.ixfe],t.cellFormula&&(w.f=""+ir(o.formula,l,o.cell,G,K)),S>0&&(w.z=z[w.ixfe>>8&63]),Rn(w,t,r.opts.Date1904),V(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(I);var Ue=Pe(I[0].s);if(y=t.dense?(a[I[0].s.r]||[])[I[0].s.c]:a[Ue],t.cellFormula&&y){if(!o||!Ue||!y)break;y.f=""+ir(I[1],l,I[0],G,K),y.F=Be(I[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;x[Pe(o.cell)]=I[0],y=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Pe(o.cell)],(y||{}).f=""+ir(I[0],l,d,G,K)}}break;case 253:w=rc(c[I.isst].t,I.ixfe,"s"),c[I.isst].h&&(w.h=c[I.isst].h),w.XF=_[w.ixfe],S>0&&(w.z=z[w.ixfe>>8&63]),Rn(w,t,r.opts.Date1904),V({c:I.c,r:I.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:I.ixfe,XF:_[I.ixfe],t:"z"},S>0&&(w.z=z[w.ixfe>>8&63]),Rn(w,t,r.opts.Date1904),V({c:I.c,r:I.r},w,t));break;case 190:if(t.sheetStubs)for(var Ye=I.c;Ye<=I.C;++Ye){var nt=I.ixfe[Ye-I.c];w={ixfe:nt,XF:_[nt],t:"z"},S>0&&(w.z=z[w.ixfe>>8&63]),Rn(w,t,r.opts.Date1904),V({c:Ye,r:I.r},w,t)}break;case 214:case 516:case 4:w=rc(I.val,I.ixfe,"s"),w.XF=_[w.ixfe],S>0&&(w.z=z[w.ixfe>>8&63]),Rn(w,t,r.opts.Date1904),V({c:I.c,r:I.r},w,t);break;case 0:case 512:U===1&&(l=I);break;case 252:c=I;break;case 1054:if(K.biff==4){z[S++]=I[1];for(var Et=0;Et<S+163&&Re[Et]!=I[1];++Et);Et>=163&&ra(I[1],S+163)}else ra(I[1],I[0]);break;case 30:{z[S++]=I;for(var jr=0;jr<S+163&&Re[jr]!=I;++jr);jr>=163&&ra(I,S+163)}break;case 229:H=H.concat(I);break;case 93:B[I.cmo[0]]=K.lastobj=I;break;case 438:K.lastobj.TxO=I;break;case 127:K.lastobj.ImData=I;break;case 440:for(p=I[0].s.r;p<=I[0].e.r;++p)for(m=I[0].s.c;m<=I[0].e.c;++m)y=t.dense?(a[p]||[])[m]:a[Pe({c:m,r:p})],y&&(y.l=I[1]);break;case 2048:for(p=I[0].s.r;p<=I[0].e.r;++p)for(m=I[0].s.c;m<=I[0].e.c;++m)y=t.dense?(a[p]||[])[m]:a[Pe({c:m,r:p})],y&&y.l&&(y.l.Tooltip=I[1]);break;case 28:{if(K.biff<=5&&K.biff>=2)break;y=t.dense?(a[I[0].r]||[])[I[0].c]:a[Pe(I[0])];var mn=B[I[2]];y||(t.dense?(a[I[0].r]||(a[I[0].r]=[]),y=a[I[0].r][I[0].c]={t:"z"}):y=a[Pe(I[0])]={t:"z"},l.e.r=Math.max(l.e.r,I[0].r),l.s.r=Math.min(l.s.r,I[0].r),l.e.c=Math.max(l.e.c,I[0].c),l.s.c=Math.min(l.s.c,I[0].c)),y.c||(y.c=[]),g={a:I[1],t:mn.TxO.t},y.c.push(g)}break;case 2173:H6(_[I.ixfe],I.ext);break;case 125:{if(!K.cellStyles)break;for(;I.e>=I.s;)J[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(I.flags&1)},le||(le=!0,zh(I.w/256)),Ba(J[I.e+1])}break;case 520:{var St={};I.level!=null&&(ue[I.r]=St,St.level=I.level),I.hidden&&(ue[I.r]=St,St.hidden=!0),I.hpt&&(ue[I.r]=St,St.hpt=I.hpt,St.hpx=Ei(I.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ms(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[X]]=I;break;case 161:a["!margins"]||ms(a["!margins"]={}),a["!margins"].header=I.header,a["!margins"].footer=I.footer;break;case 574:I.RTL&&(N.Views[0].RTL=!0);break;case 146:E=I;break;case 2198:Y=I;break;case 140:b=I;break;case 442:u?R.CodeName=I||R.name:N.WBProps.CodeName=I||"ThisWorkbook";break}}else Z||console.error("Missing Info for XLS Record 0x"+X.toString(16)),e.l+=Q}return r.SheetNames=kt(s).sort(function(pr,Fe){return Number(pr)-Number(Fe)}).map(function(pr){return s[pr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&F.forEach(function(pr,Fe){r.Sheets[r.SheetNames[Fe]]["!autofilter"]=pr}),r.Strings=c,r.SSF=ut(Re),K.enc&&(r.Encryption=K.enc),Y&&(r.Themes=Y),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),G.names.length>0&&(N.Names=G.names),r.Workbook=N,r}var Nl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function sD(e,t,r){var n=De.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Np(n,Yf,Nl.DSI);for(var s in a)t[s]=a[s]}catch(u){if(r.WTF)throw u}var l=De.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=Np(l,Jf,Nl.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(Gy(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function iD(e,t){var r=[],n=[],a=[],s=0,l,o=Qx(Yf,"n"),c=Qx(Jf,"n");if(e.Props)for(l=kt(e.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(c,l[s])?n:a).push([l[s],e.Props[l[s]]]);if(e.Custprops)for(l=kt(e.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(o,l[s])?r:Object.prototype.hasOwnProperty.call(c,l[s])?n:a).push([l[s],e.Custprops[l[s]]]);var u=[];for(s=0;s<a.length;++s)e2.indexOf(a[s][0])>-1||Xy.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&De.utils.cfb_add(t,"/SummaryInformation",_p(n,Nl.SI,c,Jf)),(r.length||u.length)&&De.utils.cfb_add(t,"/DocumentSummaryInformation",_p(r,Nl.DSI,o,Yf,u.length?u:null,Nl.UDI))}function q2(e,t){t||(t={}),Yh(t),gh(),t.codepage&&ph(t.codepage);var r,n;if(e.FullPaths){if(De.find(e,"/encryption"))throw new Error("File is password-protected");r=De.find(e,"!CompObj"),n=De.find(e,"/Workbook")||De.find(e,"/Book")}else{switch(t.type){case"base64":e=$r(Kr(e));break;case"binary":e=$r(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Jt(e,0),n={content:e}}var a,s;if(r&&tD(r),t.bookProps&&!t.bookSheets)a={};else{var l=$e?"buffer":"array";if(n&&n.content)a=aD(n.content,t);else if((s=De.find(e,"PerfectOffice_MAIN"))&&s.content)a=hs.to_workbook(s.content,(t.type=l,t));else if((s=De.find(e,"NativeContent_MAIN"))&&s.content)a=hs.to_workbook(s.content,(t.type=l,t));else throw(s=De.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&De.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=y5(e))}var o={};return e.FullPaths&&sD(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function lD(e,t){var r=t||{},n=De.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return De.utils.cfb_add(n,a,Y2(e,r)),r.biff==8&&(e.Props||e.Custprops)&&iD(e,n),r.biff==8&&e.vbaraw&&w5(n,De.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var to={0:{f:AF},1:{f:BF},2:{f:aA},3:{f:GF},4:{f:WF},5:{f:tA},6:{f:cA},7:{f:JF},8:{f:pA},9:{f:xA},10:{f:hA},11:{f:mA},12:{f:zF},13:{f:iA},14:{f:qF},15:{f:HF},16:{f:z2},17:{f:fA},18:{f:ZF},19:{f:Ah},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:f8},40:{},42:{},43:{f:c6},44:{f:l6},45:{f:d6},46:{f:m6},47:{f:h6},48:{},49:{f:PS},50:{},51:{f:K6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:f2},62:{f:oA},63:{f:n5},64:{f:DA},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:mr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:TA},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:LF},148:{f:PF,p:16},151:{f:NA},152:{},153:{f:o8},154:{},155:{},156:{f:i8},157:{},158:{},159:{T:1,f:kT},160:{T:-1},161:{T:1,f:Ps},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:gA},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:X6},336:{T:-1},337:{f:J6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:qf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:u2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:_A},427:{f:kA},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:SA},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:OF},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wA},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:qf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:m5},633:{T:1},634:{T:-1},635:{T:1,f:d5},636:{T:-1},637:{f:MS},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:qA},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:RA},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},nd={6:{f:Iu},10:{f:xa},12:{f:Pt},13:{f:Pt},14:{f:jt},15:{f:jt},16:{f:ur},17:{f:jt},18:{f:jt},19:{f:Pt},20:{f:Cp},21:{f:Cp},23:{f:u2},24:{f:Ap},25:{f:jt},26:{},27:{},28:{f:Rj},29:{},34:{f:jt},35:{f:Fp},38:{f:ur},39:{f:ur},40:{f:ur},41:{f:ur},42:{f:jt},43:{f:jt},47:{f:HT},49:{f:ij},51:{f:Pt},60:{},61:{f:tj},64:{f:jt},65:{f:sj},66:{f:Pt},77:{},80:{},81:{},82:{},85:{f:Pt},89:{},90:{},91:{},92:{f:V3},93:{f:Oj},94:{},95:{f:jt},96:{},97:{},99:{f:jt},125:{f:f2},128:{f:bj},129:{f:X3},130:{f:Pt},131:{f:jt},132:{f:jt},133:{f:G3},134:{},140:{f:Vj},141:{f:Pt},144:{},146:{f:Gj},151:{},152:{},153:{},154:{},155:{},156:{f:Pt},157:{},158:{},160:{f:eT},161:{f:Yj},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:gj},190:{f:vj},193:{f:xa},197:{},198:{},199:{},200:{},201:{},202:{f:jt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Pt},220:{},221:{f:jt},222:{},224:{f:wj},225:{f:W3},226:{f:xa},227:{},229:{f:Pj},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:q3},253:{f:oj},255:{f:J3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:t2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:jt},353:{f:xa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Sj},431:{f:jt},432:{},433:{},434:{},437:{},438:{f:Bj},439:{f:jt},440:{f:Uj},441:{},442:{f:wo},443:{},444:{f:Pt},445:{},446:{},448:{f:xa},449:{f:ej,r:2},450:{f:xa},512:{f:Sp},513:{f:Zj},515:{f:kj},516:{f:uj},517:{f:Tp},519:{f:tT},520:{f:Q3},523:{},545:{f:Dp},549:{f:Ep},566:{},574:{f:nj},638:{f:pj},659:{},1048:{},1054:{f:dj},1084:{},1212:{f:Fj},2048:{f:$j},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Zo},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:xa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Kj,r:12},2173:{f:V6,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:jt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Cj,r:12},2197:{},2198:{f:M6,r:12},2199:{},2200:{},2201:{},2202:{f:Aj,r:12},2203:{f:xa},2204:{},2205:{},2206:{},2207:{},2211:{f:Z3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Pt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Jj},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Xj},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Sp},1:{},2:{f:iT},3:{f:aT},4:{f:nT},5:{f:Tp},7:{f:oT},8:{},9:{f:Zo},11:{},22:{f:Pt},30:{f:mj},31:{},32:{},33:{f:Dp},36:{},37:{f:Ep},50:{f:cT},62:{},52:{},67:{},68:{f:Pt},69:{},86:{},126:{},127:{f:rT},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:uT},223:{},234:{},354:{},421:{},518:{f:Iu},521:{f:Zo},536:{f:Ap},547:{f:Fp},561:{},579:{},1030:{f:Iu},1033:{f:Zo},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ge(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,s),s>0&&Th(r)&&e.push(r)}}function oD(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return ge(e,t,r,a);var s=t;if(!isNaN(s)){for(var l=r.parts||[],o=0,c=0,u=0;u+(l[o]||8224)<=8224;)u+=l[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,s),f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(l[o]||8224)<=8224;)u+=l[o]||8224,o++;f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function ko(e,t,r){return e||(e=oe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function cD(e,t,r,n){var a=oe(9);return ko(a,e,t),r2(r,n||"b",a),a}function uD(e,t,r){var n=oe(8+2*r.length);return ko(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function fD(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Ut(ct(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?ge(e,2,lT(r,n,a)):ge(e,3,sT(r,n,a));return;case"b":case"e":ge(e,5,cD(r,n,t.v,t.t));return;case"s":case"str":ge(e,4,uD(r,n,(t.v||"").slice(0,255)));return}ge(e,1,ko(null,r,n))}function dD(e,t,r,n){var a=Array.isArray(t),s=Ke(t["!ref"]||"A1"),l,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=Be(s)}for(var u=s.s.r;u<=s.e.r;++u){o=Ct(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(c[f]=xt(f)),l=c[f]+o;var d=a?(t[u]||[])[f]:t[l];d&&fD(e,d,u,f)}}}function hD(e,t){for(var r=t||{},n=Or(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ge(n,r.biff==4?1033:r.biff==3?521:9,Mh(e,16,r)),dD(n,e.Sheets[e.SheetNames[a]],a,r),ge(n,10),n.end()}function mD(e,t,r){ge(e,49,lj({sz:12,name:"Arial"},r))}function xD(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ge(e,1054,hj(a,t[a],r))})}function pD(e,t){var r=oe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ge(e,2151,r),r=oe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),l2(Ke(t["!ref"]||"A1"),r),r.write_shift(4,4),ge(e,2152,r)}function gD(e,t){for(var r=0;r<16;++r)ge(e,224,jp({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ge(e,224,jp(n,0,t))})}function vD(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ge(e,440,zj(n)),n[1].Tooltip&&ge(e,2048,Wj(n))}delete t["!links"]}function yD(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&ge(e,125,qj(K0(a,n),a))})}}function wD(e,t,r,n,a){var s=16+Ka(a.cellXfs,t,a);if(t.v==null&&!t.bf){ge(e,513,Ss(r,n,s));return}if(t.bf)ge(e,6,XC(t,r,n,a,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?Ut(ct(t.v)):t.v;ge(e,515,Ej(r,n,l,s));break;case"b":case"e":ge(e,517,_j(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var o=Xh(a.Strings,t.v,a.revStrings);ge(e,253,cj(r,n,o,s))}else ge(e,516,fj(r,n,(t.v||"").slice(0,255),s,a));break;default:ge(e,513,Ss(r,n,s))}}function bD(e,t,r){var n=Or(),a=r.SheetNames[e],s=r.Sheets[a]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,f,d="",h=[],y=Ke(s["!ref"]||"A1"),g=u?65536:16384;if(y.e.c>255||y.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,g-1)}ge(n,2057,Mh(r,16,t)),ge(n,13,rn(1)),ge(n,12,rn(100)),ge(n,15,wr(!0)),ge(n,17,wr(!1)),ge(n,16,ks(.001)),ge(n,95,wr(!0)),ge(n,42,wr(!1)),ge(n,43,wr(!1)),ge(n,130,rn(1)),ge(n,128,Nj()),ge(n,131,wr(!1)),ge(n,132,wr(!1)),u&&yD(n,s["!cols"]),ge(n,512,xj(y,t)),u&&(s["!links"]=[]);for(var m=y.s.r;m<=y.e.r;++m){d=Ct(m);for(var p=y.s.c;p<=y.e.c;++p){m===y.s.r&&(h[p]=xt(p)),f=h[p]+d;var x=c?(s[m]||[])[p]:s[f];x&&(wD(n,x,m,p,t),u&&x.l&&s["!links"].push([f,x.l]))}}var v=o.CodeName||o.name||a;return u&&ge(n,574,aj((l.Views||[])[0])),u&&(s["!merges"]||[]).length&&ge(n,229,Ij(s["!merges"])),u&&vD(n,s),ge(n,442,n2(v)),u&&pD(n,s),ge(n,10),n.end()}function ND(e,t,r){var n=Or(),a=(e||{}).Workbook||{},s=a.Sheets||[],l=a.WBProps||{},o=r.biff==8,c=r.biff==5;if(ge(n,2057,Mh(e,5,r)),r.bookType=="xla"&&ge(n,135),ge(n,225,o?rn(1200):null),ge(n,193,_3(2)),c&&ge(n,191),c&&ge(n,192),ge(n,226),ge(n,92,H3("SheetJS",r)),ge(n,66,rn(o?1200:1252)),o&&ge(n,353,rn(0)),o&&ge(n,448),ge(n,317,Qj(e.SheetNames.length)),o&&e.vbaraw&&ge(n,211),o&&e.vbaraw){var u=l.CodeName||"ThisWorkbook";ge(n,442,n2(u))}ge(n,156,rn(17)),ge(n,25,wr(!1)),ge(n,18,wr(!1)),ge(n,19,rn(0)),o&&ge(n,431,wr(!1)),o&&ge(n,444,rn(0)),ge(n,61,rj()),ge(n,64,wr(!1)),ge(n,141,rn(0)),ge(n,34,wr(e8(e)=="true")),ge(n,14,wr(!0)),o&&ge(n,439,wr(!1)),ge(n,218,rn(0)),mD(n,e,r),xD(n,e.SSF,r),gD(n,r),o&&ge(n,352,wr(!1));var f=n.end(),d=Or();o&&ge(d,140,Hj()),o&&r.Strings&&oD(d,252,Y3(r.Strings)),ge(d,10);var h=d.end(),y=Or(),g=0,m=0;for(m=0;m<e.SheetNames.length;++m)g+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var p=f.length+g+h.length;for(m=0;m<e.SheetNames.length;++m){var x=s[m]||{};ge(y,133,K3({pos:p,hs:x.Hidden||0,dt:0,name:e.SheetNames[m]},r)),p+=t[m].length}var v=y.end();if(g!=v.length)throw new Error("BS8 "+g+" != "+v.length);var w=[];return f.length&&w.push(f),v.length&&w.push(v),h.length&&w.push(h),Wt(w)}function _D(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ut(Re)),e&&e.SSF&&(Pi(),z0(e.SSF),r.revssf=W0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Jh(r),r.cellXfs=[],Ka(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=bD(a,r,e);return n.unshift(ND(e,n,r)),Wt(n)}function Y2(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Mr(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return _D(e,t);case 4:case 3:case 2:return hD(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function $p(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),l=a.index,o=s&&s.index||e.length,c=lS(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,d=0,h=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(l=0;l<c.length;++l){var m=c[l].trim(),p=m.slice(0,3).toLowerCase();if(p=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(p!="<td"&&p!="<th")){var x=m.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var v=x[o].trim();if(v.match(/<t[dh]/i)){for(var w=v,b=0;w.charAt(0)=="<"&&(b=w.indexOf(">"))>-1;)w=w.slice(b+1);for(var _=0;_<g.length;++_){var E=g[_];E.s.c==f&&E.s.r<u&&u<=E.e.r&&(f=E.e.c+1,_=-1)}var N=Oe(v.slice(0,v.indexOf(">")));h=N.colspan?+N.colspan:1,((d=+N.rowspan)>1||h>1)&&g.push({s:{r:u,c:f},e:{r:u+(d||1)-1,c:f+h-1}});var R=N.t||N["data-t"]||"";if(!w.length){f+=h;continue}if(w=wy(w),y.s.r>u&&(y.s.r=u),y.e.r<u&&(y.e.r=u),y.s.c>f&&(y.s.c=f),y.e.c<f&&(y.e.c=f),!w.length){f+=h;continue}var j={t:"s",v:w};r.raw||!w.trim().length||R=="s"||(w==="TRUE"?j={t:"b",v:!0}:w==="FALSE"?j={t:"b",v:!1}:isNaN(kn(w))?isNaN(_i(w).getDate())||(j={t:"d",v:ct(w)},r.cellDates||(j={t:"n",v:Ut(j.v)}),j.z=r.dateNF||Re[14]):j={t:"n",v:kn(w)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=j):n[Pe({r:u,c:f})]=j,f+=h}}}}return n["!ref"]=Be(y),g.length&&(n["!merges"]=g),n}function kD(e,t,r,n){for(var a=e["!merges"]||[],s=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>l)&&!(a[u].e.r<r||a[u].e.c<l)){if(a[u].s.r<r||a[u].s.c<l){o=-1;break}o=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var f=Pe({r,c:l}),d=n.dense?(e[r]||[])[l]:e[f],h=d&&d.v!=null&&(d.h||Eh(d.w||(oa(d),d.w)||""))||"",y={};o>1&&(y.rowspan=o),c>1&&(y.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(y["data-t"]=d&&d.t||"z",d.v!=null&&(y["data-v"]=d.v),d.z!=null&&(y["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),y.id=(n.id||"sjs")+"-"+f,s.push(pe("td",h,y))}}var g="<tr>";return g+s.join("")+"</tr>"}var ED='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',SD="</body></html>";function jD(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ga($p(r[0],t),t);var n=em();return r.forEach(function(a,s){tm(n,$p(a,t),"Sheet"+(s+1))}),n}function TD(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function J2(e,t){var r=t||{},n=r.header!=null?r.header:ED,a=r.footer!=null?r.footer:SD,s=[n],l=Mr(e["!ref"]);r.dense=Array.isArray(e),s.push(TD(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)s.push(kD(e,l,o,r));return s.push("</table>"+a),s.join("")}function Q2(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?pt(n.origin):n.origin;a=l.r,s=l.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var f=Mr(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),a==-1&&(u.e.r=a=f.e.r+1)}var d=[],h=0,y=e["!rows"]||(e["!rows"]=[]),g=0,m=0,p=0,x=0,v=0,w=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&m<c;++g){var b=o[g];if(Wp(b)){if(n.display)continue;y[m]={hidden:!0}}var _=b.children;for(p=x=0;p<_.length;++p){var E=_[p];if(!(n.display&&Wp(E))){var N=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):wy(E.innerHTML),R=E.getAttribute("data-z")||E.getAttribute("z");for(h=0;h<d.length;++h){var j=d[h];j.s.c==x+s&&j.s.r<m+a&&m+a<=j.e.r&&(x=j.e.c+1-s,h=-1)}w=+E.getAttribute("colspan")||1,((v=+E.getAttribute("rowspan")||1)>1||w>1)&&d.push({s:{r:m+a,c:x+s},e:{r:m+a+(v||1)-1,c:x+s+(w||1)-1}});var L={t:"s",v:N},V=E.getAttribute("data-t")||E.getAttribute("t")||"";N!=null&&(N.length==0?L.t=V||"z":n.raw||N.trim().length==0||V=="s"||(N==="TRUE"?L={t:"b",v:!0}:N==="FALSE"?L={t:"b",v:!1}:isNaN(kn(N))?isNaN(_i(N).getDate())||(L={t:"d",v:ct(N)},n.cellDates||(L={t:"n",v:Ut(L.v)}),L.z=n.dateNF||Re[14]):L={t:"n",v:kn(N)})),L.z===void 0&&R!=null&&(L.z=R);var K="",Y=E.getElementsByTagName("A");if(Y&&Y.length)for(var H=0;H<Y.length&&!(Y[H].hasAttribute("href")&&(K=Y[H].getAttribute("href"),K.charAt(0)!="#"));++H);K&&K.charAt(0)!="#"&&(L.l={Target:K}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][x+s]=L):e[Pe({c:x+s,r:m+a})]=L,u.e.c<x+s&&(u.e.c=x+s),x+=w}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,m-1+a),e["!ref"]=Be(u),m>=c&&(e["!fullref"]=Be((u.e.r=o.length-g+m-1+a,u))),e}function Z2(e,t){var r=t||{},n=r.dense?[]:{};return Q2(n,e,t)}function CD(e,t){return Ga(Z2(e,t),t)}function Wp(e){var t="",r=FD(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function FD(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function AD(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ge(t.replace(/<[^>]*>/g,""));return[r]}var Vp={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function ew(e,t){var r=t||{},n=Sh(e),a=[],s,l,o={name:""},c="",u=0,f,d,h={},y=[],g=r.dense?[]:{},m,p,x={value:""},v="",w=0,b=[],_=-1,E=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,j={},L=[],V={},K=0,Y=0,H=[],B=1,J=1,ue=[],le={Names:[]},G={},q=["",""],U=[],S={},z="",F=0,M=!1,W=!1,ie=0;for(ql.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=ql.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?g["!ref"]=Be(N):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(g["!fullref"]=g["!ref"],N.e.r=r.sheetRows-1,g["!ref"]=Be(N)),L.length&&(g["!merges"]=L),H.length&&(g["!rows"]=H),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),y.push(f.name),h[f.name]=g,W=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=Oe(m[0],!1),_=E=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,g=r.dense?[]:{},L=[],H=[],W=!0);break;case"table-row-group":m[1]==="/"?--R:++R;break;case"table-row":case"":if(m[1]==="/"){_+=B,B=1;break}if(d=Oe(m[0],!1),d.?_=d.-1:_==-1&&(_=0),B=+d["number-rows-repeated"]||1,B<10)for(ie=0;ie<B;++ie)R>0&&(H[_+ie]={level:R});E=-1;break;case"covered-table-cell":m[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(g[_]||(g[_]=[]),g[_][E]={t:"z"}):g[Pe({r:_,c:E})]={t:"z"}),v="",b=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++E,x=Oe(m[0],!1),J=parseInt(x["number-columns-repeated"]||"1",10),p={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(p.f=Bp(Ge(x.formula))),(x.||x["value-type"])=="string"&&(p.t="s",p.v=Ge(x["string-value"]||""),r.dense?(g[_]||(g[_]=[]),g[_][E]=p):g[Pe({r:_,c:E})]=p),E+=J-1;else if(m[1]!=="/"){++E,v="",w=0,b=[],J=1;var X=B?_+B-1:_;if(E>N.e.c&&(N.e.c=E),E<N.s.c&&(N.s.c=E),_<N.s.r&&(N.s.r=_),X>N.e.r&&(N.e.r=X),x=Oe(m[0],!1),U=[],S={},p={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=Ge(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(K=parseInt(x["number-matrix-rows-spanned"],10)||0,Y=parseInt(x["number-matrix-columns-spanned"],10)||0,V={s:{r:_,c:E},e:{r:_+K-1,c:E+Y-1}},p.F=Be(V),ue.push([V,p.F])),x.formula)p.f=Bp(x.formula);else for(ie=0;ie<ue.length;++ie)_>=ue[ie][0].s.r&&_<=ue[ie][0].e.r&&E>=ue[ie][0].s.c&&E<=ue[ie][0].e.c&&(p.F=ue[ie][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(K=parseInt(x["number-rows-spanned"],10)||0,Y=parseInt(x["number-columns-spanned"],10)||0,V={s:{r:_,c:E},e:{r:_+K-1,c:E+Y-1}},L.push(V)),x["number-columns-repeated"]&&(J=parseInt(x["number-columns-repeated"],10)),p.t){case"boolean":p.t="b",p.v=lt(x["boolean-value"]);break;case"float":p.t="n",p.v=parseFloat(x.value);break;case"percentage":p.t="n",p.v=parseFloat(x.value);break;case"currency":p.t="n",p.v=parseFloat(x.value);break;case"date":p.t="d",p.v=ct(x["date-value"]),r.cellDates||(p.t="n",p.v=Ut(p.v)),p.z="m/d/yy";break;case"time":p.t="n",p.v=aS(x["time-value"])/86400,r.cellDates&&(p.t="d",p.v=V0(p.v)),p.z="HH:MM:SS";break;case"number":p.t="n",p.v=parseFloat(x.);break;default:if(p.t==="string"||p.t==="text"||!p.t)p.t="s",x["string-value"]!=null&&(v=Ge(x["string-value"]),b=[]);else throw new Error("Unsupported value type "+p.t)}}else{if(M=!1,p.t==="s"&&(p.v=v||"",b.length&&(p.R=b),M=w==0),G.Target&&(p.l=G),U.length>0&&(p.c=U,U=[]),v&&r.cellText!==!1&&(p.w=v),M&&(p.t="z",delete p.v),(!M||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=_))for(var Q=0;Q<B;++Q){if(J=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(g[_+Q]||(g[_+Q]=[]),g[_+Q][E]=Q==0?p:ut(p);--J>0;)g[_+Q][E+J]=ut(p);else for(g[Pe({r:_+Q,c:E})]=p;--J>0;)g[Pe({r:_+Q,c:E+J})]=ut(p);N.e.c<=E&&(N.e.c=E)}J=parseInt(x["number-columns-repeated"]||"1",10),E+=J-1,J=0,p={},v="",b=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s;S.t=v,b.length&&(S.R=b),S.a=z,U.push(S)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);z="",F=0,v="",w=0,b=[];break;case"creator":m[1]==="/"?z=n.slice(F,m.index):F=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);v="",w=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(j[o.name]=c,(s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(c="",o=Oe(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=Oe(m[0],!1),c+=Vp[m[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=Oe(m[0],!1),c+=Vp[m[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,m.index);break}else u=m.index+m[0].length;break;case"named-range":l=Oe(m[0],!1),q=Ou(l["cell-range-address"]);var Z={Name:l.name,Ref:q[0]+"!"+q[1]};W&&(Z.Sheet=y.length),le.Names.push(Z);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!x||!x["string-value"])){var ye=AD(n.slice(w,m.index));v=(v.length>0?v+`
`:"")+ye[0]}else Oe(m[0],!1),w=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{q=Ou(Oe(m[0])["target-range-address"]),h[q[0]]["!autofilter"]={ref:q[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(G=Oe(m[0],!1),!G.href)break;G.Target=Ge(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(q=Ou(G.Target.slice(1)),G.Target="#"+q[0]+"!"+q[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var I={Sheets:h,SheetNames:y,Workbook:le};return r.bookSheets&&delete I.Sheets,I}function Hp(e,t){t=t||{},tn(e,"META-INF/manifest.xml")&&a3(Rt(e,"META-INF/manifest.xml"),t);var r=Wr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=ew(tt(r),t);return tn(e,"meta.xml")&&(n.Props=Vy(Rt(e,"meta.xml"))),n}function Xp(e,t){return ew(e,t)}var DD=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Kl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return At+t}}(),Gp=function(){var e=function(s){return Ze(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,l,o){var c=[];c.push('      <table:table table:name="'+Ze(l.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,d=Mr(s["!ref"]||"A1"),h=s["!merges"]||[],y=0,g=Array.isArray(s);if(s["!cols"])for(f=0;f<=d.e.c;++f)c.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var m="",p=s["!rows"]||[];for(u=0;u<d.s.r;++u)m=p[u]?' table:style-name="ro'+p[u].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=d.e.r;++u){for(m=p[u]?' table:style-name="ro'+p[u].ods+'"':"",c.push("        <table:table-row"+m+`>
`),f=0;f<d.s.c;++f)c.push(t);for(;f<=d.e.c;++f){var x=!1,v={},w="";for(y=0;y!=h.length;++y)if(!(h[y].s.c>f)&&!(h[y].s.r>u)&&!(h[y].e.c<f)&&!(h[y].e.r<u)){(h[y].s.c!=f||h[y].s.r!=u)&&(x=!0),v["table:number-columns-spanned"]=h[y].e.c-h[y].s.c+1,v["table:number-rows-spanned"]=h[y].e.r-h[y].s.r+1;break}if(x){c.push(r);continue}var b=Pe({r:u,c:f}),_=g?(s[u]||[])[f]:s[b];if(_&&_.f&&(v["table:formula"]=Ze(QC(_.f)),_.F&&_.F.slice(0,b.length)==b)){var E=Mr(_.F);v["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,v["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!_){c.push(t);continue}switch(_.t){case"b":w=_.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=_.v?"true":"false";break;case"n":w=_.w||String(_.v||0),v["office:value-type"]="float",v["office:value"]=_.v||0;break;case"s":case"str":w=_.v==null?"":_.v,v["office:value-type"]="string";break;case"d":w=_.w||ct(_.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=ct(_.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var N=e(w);if(_.l&&_.l.Target){var R=_.l.Target;R=R.charAt(0)=="#"?"#"+ZC(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),N=pe("text:a",N,{"xlink:href":R.replace(/&/g,"&amp;")})}c.push("          "+pe("table:table-cell",pe("text:p",N,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var d=u["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Ba(d),d.ods=o;var h=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=c;var d=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,o){var c=[At],u=Kl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Kl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+f+`>
`),c.push(Wy().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,l),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=l.SheetNames.length;++d)c.push(n(l.Sheets[l.SheetNames[d]],l,d));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function tw(e,t){if(t.bookType=="fods")return Gp(e,t);var r=Nh(),n="",a=[],s=[];return n="mimetype",ze(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ze(r,n,Gp(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ze(r,n,DD(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ze(r,n,At+Wy()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ze(r,n,l3(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ze(r,n,s3(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function js(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ad(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):tt(Xa(e))}function RD(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):$r(Mn(e))}function PD(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function za(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Kp(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function ID(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function OD(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function ro(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Je(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function _t(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function qe(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=ro(e,r),s=a&7;a=Math.floor(a/8);var l=0,o;if(a==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=ro(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:s};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function qt(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Je(n*8+a.type)),a.type==2&&t.push(Je(a.data.length)),t.push(a.data))})}),za(t)}function qh(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Zr(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=ro(e,n),s=qe(e.slice(n[0],n[0]+a));n[0]+=a;var l={id:_t(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=qe(o.data),u=_t(c[3][0].data);l.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(l.merge=_t(s[3][0].data)>>>0>0),r.push(l)}return r}function Ms(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Je(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Je(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:Je(l.data.length)}],n[2].push({data:qt(l.meta),type:2})});var s=qt(n);t.push(Je(s.length)),t.push(s),a.forEach(function(l){return t.push(l)})}),za(t)}function LD(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ro(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}a.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[za(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var f=za(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function en(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(LD(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return za(t)}function Bs(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=Je(n),l=s.length;t.push(s),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return za(t)}function MD(e,t,r,n){var a=js(e),s=a.getUint32(4,!0),l=(n>1?12:8)+Kp(s&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,f=new Date(2001,0,1);s&512&&(o=a.getUint32(l,!0),l+=4),l+=Kp(s&(n>1?12288:4096))*4,s&16&&(c=a.getUint32(l,!0),l+=4),s&32&&(u=a.getFloat64(l,!0),l+=8),s&64&&(f.setTime(f.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:t[c]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(c>-1)d={t:"s",v:t[c]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function BD(e,t,r){var n=js(e),a=n.getUint32(8,!0),s=12,l=-1,o=-1,c=NaN,u=NaN,f=new Date(2001,0,1);a&1&&(c=ID(e,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(l=n.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(l>-1)d={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function Mu(e,t){var r=new Uint8Array(32),n=js(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,OD(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Bu(e,t){var r=new Uint8Array(32),n=js(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function UD(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return MD(e,t,r,e[0]);case 5:return BD(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function sr(e){var t=qe(e);return ro(t[1][0].data)}function qp(e,t){var r=qe(t.data),n=_t(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(l){var o=qe(l.data),c=_t(o[1][0].data)>>>0;switch(n){case 1:s[c]=ad(o[3][0].data);break;case 8:{var u=e[sr(o[9][0].data)][0],f=qe(u.data),d=e[sr(f[1][0].data)][0],h=_t(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var y=qe(d.data);s[c]=y[3].map(function(g){return ad(g.data)}).join("")}break}}),s}function zD(e,t){var r,n,a,s,l,o,c,u,f,d,h,y,g,m,p=qe(e),x=_t(p[1][0].data)>>>0,v=_t(p[2][0].data)>>>0,w=((n=(r=p[8])==null?void 0:r[0])==null?void 0:n.data)&&_t(p[8][0].data)>0||!1,b,_;if((s=(a=p[7])==null?void 0:a[0])!=null&&s.data&&t!=0)b=(o=(l=p[7])==null?void 0:l[0])==null?void 0:o.data,_=(u=(c=p[6])==null?void 0:c[0])==null?void 0:u.data;else if((d=(f=p[4])==null?void 0:f[0])!=null&&d.data&&t!=1)b=(y=(h=p[4])==null?void 0:h[0])==null?void 0:y.data,_=(m=(g=p[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=w?4:1,N=js(b),R=[],j=0;j<b.length/2;++j){var L=N.getUint16(j*2,!0);L<65535&&R.push([j,L])}if(R.length!=v)throw"Expected ".concat(v," cells, found ").concat(R.length);var V=[];for(j=0;j<R.length-1;++j)V[R[j][0]]=_.subarray(R[j][1]*E,R[j+1][1]*E);return R.length>=1&&(V[R[R.length-1][0]]=_.subarray(R[R.length-1][1]*E)),{R:x,cells:V}}function $D(e,t){var r,n=qe(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?_t(n[7][0].data)>>>0>0?1:0:-1,s=qh(n[5],function(l){return zD(l,a)});return{nrows:_t(n[4][0].data)>>>0,data:s.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(c,u){if(l[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));l[o.R][u]=c}),l},[])}}function WD(e,t,r){var n,a=qe(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(_t(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(_t(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Be(s);var l=qe(a[4][0].data),o=qp(e,e[sr(l[4][0].data)][0]),c=(n=l[17])!=null&&n[0]?qp(e,e[sr(l[17][0].data)][0]):[],u=qe(l[3][0].data),f=0;u[1].forEach(function(d){var h=qe(d.data),y=e[sr(h[2][0].data)][0],g=_t(y.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=$D(e,y);m.data.forEach(function(p,x){p.forEach(function(v,w){var b=Pe({r:f+x,c:w}),_=UD(v,o,c);_&&(r[b]=_)})}),f+=m.nrows})}function VD(e,t){var r=qe(t.data),n={"!ref":"A1"},a=e[sr(r[2][0].data)],s=_t(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return WD(e,a[0],n),n}function HD(e,t){var r,n=qe(t.data),a={name:(r=n[1])!=null&&r[0]?ad(n[1][0].data):"",sheets:[]},s=qh(n[2],sr);return s.forEach(function(l){e[l].forEach(function(o){var c=_t(o.meta[1][0].data);c==6e3&&a.sheets.push(VD(e,o))})}),a}function XD(e,t){var r=em(),n=qe(t.data),a=qh(n[1],sr);if(a.forEach(function(s){e[s].forEach(function(l){var o=_t(l.meta[1][0].data);if(o==2){var c=HD(e,l);c.sheets.forEach(function(u,f){tm(r,u,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Uu(e){var t,r,n,a,s={},l=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=en(c.content)}catch(d){return console.log("?? "+c.content.length+" "+(d.message||d))}var f;try{f=Zr(u)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){s[d.id]=d.messages,l.push(d.id)})}}),!l.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&_t(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||l.forEach(function(c){s[c].forEach(function(u){var f=_t(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return XD(s,o)}function GD(e,t,r){var n,a,s,l;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(s=e[8])==null?void 0:s[0])==null?void 0:l.data)&&_t(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=js(e[7][0].data),f=0,d=[],h=js(e[4][0].data),y=0,g=[],m=0;m<t.length;++m){if(t[m]==null){u.setUint16(m*2,65535,!0),h.setUint16(m*2,65535);continue}u.setUint16(m*2,f,!0),h.setUint16(m*2,y,!0);var p,x;switch(typeof t[m]){case"string":p=Mu({t:"s",v:t[m]},r),x=Bu({t:"s",v:t[m]},r);break;case"number":p=Mu({t:"n",v:t[m]},r),x=Bu({t:"n",v:t[m]},r);break;case"boolean":p=Mu({t:"b",v:t[m]},r),x=Bu({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}d.push(p),f+=p.length,g.push(x),y+=x.length,++c}for(e[2][0].data=Je(c);m<e[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),h.setUint16(m*2,65535,!0);return e[6][0].data=za(d),e[3][0].data=za(g),c}function KD(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Mr(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Be(n)));var s=f0(r,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(z){return z.forEach(function(F){typeof F=="string"&&l.push(F)})});var o={},c=[],u=De.read(t.numbers,{type:"base64"});u.FileIndex.map(function(z,F){return[z,u.FullPaths[F]]}).forEach(function(z){var F=z[0],M=z[1];if(F.type==2&&F.name.match(/\.iwa/)){var W=F.content,ie=en(W),X=Zr(ie);X.forEach(function(Q){c.push(Q.id),o[Q.id]={deps:[],location:M,type:_t(Q.messages[0].meta[1][0].data)}})}}),c.sort(function(z,F){return z-F});var f=c.filter(function(z){return z>1}).map(function(z){return[z,Je(z)]});u.FileIndex.map(function(z,F){return[z,u.FullPaths[F]]}).forEach(function(z){var F=z[0];if(z[1],!!F.name.match(/\.iwa/)){var M=Zr(en(F.content));M.forEach(function(W){W.messages.forEach(function(ie){f.forEach(function(X){W.messages.some(function(Q){return _t(Q.meta[1][0].data)!=11006&&PD(Q.data,X[1])})&&o[X[0]].deps.push(W.id)})})})}});for(var d=De.find(u,o[1].location),h=Zr(en(d.content)),y,g=0;g<h.length;++g){var m=h[g];m.id==1&&(y=m)}var p=sr(qe(y.messages[0].data)[1][0].data);for(d=De.find(u,o[p].location),h=Zr(en(d.content)),g=0;g<h.length;++g)m=h[g],m.id==p&&(y=m);for(p=sr(qe(y.messages[0].data)[2][0].data),d=De.find(u,o[p].location),h=Zr(en(d.content)),g=0;g<h.length;++g)m=h[g],m.id==p&&(y=m);for(p=sr(qe(y.messages[0].data)[2][0].data),d=De.find(u,o[p].location),h=Zr(en(d.content)),g=0;g<h.length;++g)m=h[g],m.id==p&&(y=m);var x=qe(y.messages[0].data);{x[6][0].data=Je(n.e.r+1),x[7][0].data=Je(n.e.c+1);var v=sr(x[46][0].data),w=De.find(u,o[v].location),b=Zr(en(w.content));{for(var _=0;_<b.length&&b[_].id!=v;++_);if(b[_].id!=v)throw"Bad ColumnRowUIDMapArchive";var E=qe(b[_].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var N=0;N<=n.e.c;++N){var R=[];R[1]=R[2]=[{type:0,data:Je(N+420690)}],E[1].push({type:2,data:qt(R)}),E[2].push({type:0,data:Je(N)}),E[3].push({type:0,data:Je(N)})}E[4]=[],E[5]=[],E[6]=[];for(var j=0;j<=n.e.r;++j)R=[],R[1]=R[2]=[{type:0,data:Je(j+726270)}],E[4].push({type:2,data:qt(R)}),E[5].push({type:0,data:Je(j)}),E[6].push({type:0,data:Je(j)});b[_].messages[0].data=qt(E)}w.content=Bs(Ms(b)),w.size=w.content.length,delete x[46];var L=qe(x[4][0].data);{L[7][0].data=Je(n.e.r+1);var V=qe(L[1][0].data),K=sr(V[2][0].data);w=De.find(u,o[K].location),b=Zr(en(w.content));{if(b[0].id!=K)throw"Bad HeaderStorageBucket";var Y=qe(b[0].messages[0].data);for(j=0;j<s.length;++j){var H=qe(Y[2][0].data);H[1][0].data=Je(j),H[4][0].data=Je(s[j].length),Y[2][j]={type:Y[2][0].type,data:qt(H)}}b[0].messages[0].data=qt(Y)}w.content=Bs(Ms(b)),w.size=w.content.length;var B=sr(L[2][0].data);w=De.find(u,o[B].location),b=Zr(en(w.content));{if(b[0].id!=B)throw"Bad HeaderStorageBucket";for(Y=qe(b[0].messages[0].data),N=0;N<=n.e.c;++N)H=qe(Y[2][0].data),H[1][0].data=Je(N),H[4][0].data=Je(n.e.r+1),Y[2][N]={type:Y[2][0].type,data:qt(H)};b[0].messages[0].data=qt(Y)}w.content=Bs(Ms(b)),w.size=w.content.length;var J=sr(L[4][0].data);(function(){for(var z=De.find(u,o[J].location),F=Zr(en(z.content)),M,W=0;W<F.length;++W){var ie=F[W];ie.id==J&&(M=ie)}var X=qe(M.messages[0].data);{X[3]=[];var Q=[];l.forEach(function(I,ve){Q[1]=[{type:0,data:Je(ve)}],Q[2]=[{type:0,data:Je(1)}],Q[3]=[{type:2,data:RD(I)}],X[3].push({type:2,data:qt(Q)})})}M.messages[0].data=qt(X);var Z=Ms(F),ye=Bs(Z);z.content=ye,z.size=z.content.length})();var ue=qe(L[3][0].data);{var le=ue[1][0];delete ue[2];var G=qe(le.data);{var q=sr(G[2][0].data);(function(){for(var z=De.find(u,o[q].location),F=Zr(en(z.content)),M,W=0;W<F.length;++W){var ie=F[W];ie.id==q&&(M=ie)}var X=qe(M.messages[0].data);{delete X[6],delete ue[7];var Q=new Uint8Array(X[5][0].data);X[5]=[];for(var Z=0,ye=0;ye<=n.e.r;++ye){var I=qe(Q);Z+=GD(I,s[ye],l),I[1][0].data=Je(ye),X[5].push({data:qt(I),type:2})}X[1]=[{type:0,data:Je(n.e.c+1)}],X[2]=[{type:0,data:Je(n.e.r+1)}],X[3]=[{type:0,data:Je(Z)}],X[4]=[{type:0,data:Je(n.e.r+1)}]}M.messages[0].data=qt(X);var ve=Ms(F),Ae=Bs(ve);z.content=Ae,z.size=z.content.length})()}le.data=qt(G)}L[3][0].data=qt(ue)}x[4][0].data=qt(L)}y.messages[0].data=qt(x);var U=Ms(h),S=Bs(U);return d.content=S,d.size=d.content.length,u}function rw(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Yh(e){rw([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Jh(e){rw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function qD(e){return We.WS.indexOf(e)>-1?"sheet":e==We.CS?"chart":e==We.DS?"dialog":e==We.MS?"macro":e&&e.length?e:"sheet"}function YD(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,qD(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function JD(e,t,r,n,a,s,l,o,c,u,f,d){try{s[n]=vl(Wr(e,r,!0),t);var h=Rt(e,t),y;switch(o){case"sheet":y=y8(h,t,a,c,s[n],u,f,d);break;case"chart":if(y=w8(h,t,a,c,s[n],u,f,d),!y||!y["!drawel"])break;var g=al(y["!drawel"].Target,t),m=Yl(g),p=i5(Wr(e,g,!0),vl(Wr(e,m,!0),g)),x=al(p,g),v=Yl(x);y=GA(Wr(e,x,!0),x,c,vl(Wr(e,v,!0),x),u,y);break;case"macro":y=b8(h,t,a,c,s[n],u,f,d);break;case"dialog":y=N8(h,t,a,c,s[n],u,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}l[n]=y;var w=[];s&&s[n]&&kt(s[n]).forEach(function(b){var _="";if(s[n][b].Type==We.CMNT){_=al(s[n][b].Target,t);var E=S8(Rt(e,_,!0),_,c);if(!E||!E.length)return;Pp(y,E,!1)}s[n][b].Type==We.TCMNT&&(_=al(s[n][b].Target,t),w=w.concat(o5(Rt(e,_,!0),c)))}),w&&w.length&&Pp(y,w,!0,c.people||[])}catch(b){if(c.WTF)throw b}}function Jr(e){return e.charAt(0)=="/"?e.slice(1):e}function QD(e,t){if(Pi(),t=t||{},Yh(t),tn(e,"META-INF/manifest.xml")||tn(e,"objectdata.xml"))return Hp(e,t);if(tn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Uu<"u"){if(e.FileIndex)return Uu(e);var r=De.utils.cfb_new();return tp(e).forEach(function(H){ze(r,H,cS(e,H))}),Uu(r)}throw new Error("Unsupported NUMBERS file")}if(!tn(e,"[Content_Types].xml"))throw tn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):tn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=tp(e),a=r3(Wr(e,"[Content_Types].xml")),s=!1,l,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Rt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Rt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(yl=[],a.sst)try{yl=E8(Rt(e,Jr(a.sst)),a.sst,t)}catch(H){if(t.WTF)throw H}t.cellStyles&&a.themes.length&&(c=k8(Wr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=_8(Rt(e,Jr(a.style)),a.style,c,t))}a.links.map(function(H){try{var B=vl(Wr(e,Yl(Jr(H))),H);return T8(Rt(e,Jr(H)),B,H,t)}catch{}});var f=v8(Rt(e,Jr(a.workbooks[0])),a.workbooks[0],t),d={},h="";a.coreprops.length&&(h=Rt(e,Jr(a.coreprops[0]),!0),h&&(d=Vy(h)),a.extprops.length!==0&&(h=Rt(e,Jr(a.extprops[0]),!0),h&&c3(h,d,t)));var y={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=Wr(e,Jr(a.custprops[0]),!0),h&&(y=f3(h,t)));var g={};if((t.bookSheets||t.bookProps)&&(f.Sheets?l=f.Sheets.map(function(B){return B.name}):d.Worksheets&&d.SheetNames.length>0&&(l=d.SheetNames),t.bookProps&&(g.Props=d,g.Custprops=y),t.bookSheets&&typeof l<"u"&&(g.SheetNames=l),t.bookSheets?g.SheetNames:t.bookProps))return g;l={};var m={};t.bookDeps&&a.calcchain&&(m=j8(Rt(e,Jr(a.calcchain)),a.calcchain));var p=0,x={},v,w;{var b=f.Sheets;d.Worksheets=b.length,d.SheetNames=[];for(var _=0;_!=b.length;++_)d.SheetNames[_]=b[_].name}var E=s?"bin":"xml",N=a.workbooks[0].lastIndexOf("/"),R=(a.workbooks[0].slice(0,N+1)+"_rels/"+a.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");tn(e,R)||(R="xl/_rels/workbook."+E+".rels");var j=vl(Wr(e,R,!0),R.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=C8(Rt(e,Jr(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=u5(Rt(e,Jr(a.people[0])),t)),j&&(j=YD(j,f.Sheets));var L=Rt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(p=0;p!=d.Worksheets;++p){var V="sheet";if(j&&j[p]?(v="xl/"+j[p][1].replace(/[\/]?xl\//,""),tn(e,v)||(v=j[p][1]),tn(e,v)||(v=R.replace(/_rels\/.*$/,"")+j[p][1]),V=j[p][2]):(v="xl/worksheets/sheet"+(p+1-L)+"."+E,v=v.replace(/sheet0\./,"sheet.")),w=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(p!=t.sheets)continue e;break;case"string":if(d.SheetNames[p].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var K=!1,Y=0;Y!=t.sheets.length;++Y)typeof t.sheets[Y]=="number"&&t.sheets[Y]==p&&(K=1),typeof t.sheets[Y]=="string"&&t.sheets[Y].toLowerCase()==d.SheetNames[p].toLowerCase()&&(K=1);if(!K)continue e}}JD(e,v,w,d.SheetNames[p],p,x,l,V,t,f,c,u)}return g={Directory:a,Workbook:f,Props:d,Custprops:y,Deps:m,Sheets:l,SheetNames:d.SheetNames,Strings:yl,Styles:u,Themes:c,SSF:ut(Re)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(H,B){H=H.replace(/^Root Entry[\/]/,""),g.keys.push(H),g.files[H]=e.FileIndex[B]}))),t&&t.bookVBA&&(a.vba.length>0?g.vbaraw=Rt(e,Jr(a.vba[0]),!0):a.defaults&&a.defaults.bin===v5&&(g.vbaraw=Rt(e,"xl/vbaProject.bin",!0))),g}function ZD(e,t){var r=t||{},n="Workbook",a=De.find(e,n);try{if(n="/!DataSpaces/Version",a=De.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(CT(a.content),n="/!DataSpaces/DataSpaceMap",a=De.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=AT(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=De.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=DT(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=De.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);PT(a.content)}catch{}if(n="/EncryptionInfo",a=De.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=IT(a.content);if(n="/EncryptedPackage",a=De.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function eR(e,t){return t.bookType=="ods"?tw(e,t):t.bookType=="numbers"?KD(e,t):t.bookType=="xlsb"?tR(e,t):rR(e,t)}function tR(e,t){Zs=1024,e&&!e.SSF&&(e.SSF=ut(Re)),e&&e.SSF&&(Pi(),z0(e.SSF),t.revssf=W0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,wl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=C2.indexOf(t.bookType)>-1,a=Oh();Jh(t=t||{});var s=Nh(),l="",o=0;if(t.cellXfs=[],Ka(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",ze(s,l,Hy(e.Props,t)),a.coreprops.push(l),Qe(t.rels,2,l,We.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,ze(s,l,Ky(e.Props)),a.extprops.push(l),Qe(t.rels,3,l,We.EXT_PROPS),e.Custprops!==e.Props&&kt(e.Custprops||{}).length>0&&(l="docProps/custom.xml",ze(s,l,qy(e.Custprops)),a.custprops.push(l),Qe(t.rels,4,l,We.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,ze(s,l,A8(o-1,l,t,e,f)),a.sheets.push(l),Qe(t.wbrels,-1,"worksheets/sheet"+o+"."+r,We.WS[0])}if(d){var y=d["!comments"],g=!1,m="";y&&y.length>0&&(m="xl/comments"+o+"."+r,ze(s,m,P8(y,m)),a.comments.push(m),Qe(f,-1,"../comments"+o+"."+r,We.CMNT),g=!0),d["!legacy"]&&g&&ze(s,"xl/drawings/vmlDrawing"+o+".vml",j2(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&ze(s,Yl(l),oi(f))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,ze(s,l,R8(t.Strings,l,t)),a.strs.push(l),Qe(t.wbrels,-1,"sharedStrings."+r,We.SST)),l="xl/workbook."+r,ze(s,l,F8(e,l)),a.workbooks.push(l),Qe(t.rels,1,l,We.WB),l="xl/theme/theme1.xml",ze(s,l,$h(e.Themes,t)),a.themes.push(l),Qe(t.wbrels,-1,"theme/theme1.xml",We.THEME),l="xl/styles."+r,ze(s,l,D8(e,l,t)),a.styles.push(l),Qe(t.wbrels,-1,"styles."+r,We.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",ze(s,l,e.vbaraw),a.vba.push(l),Qe(t.wbrels,-1,"vbaProject.bin",We.VBA)),l="xl/metadata."+r,ze(s,l,I8(l)),a.metadata.push(l),Qe(t.wbrels,-1,"metadata."+r,We.XLMETA),ze(s,"[Content_Types].xml",$y(a,t)),ze(s,"_rels/.rels",oi(t.rels)),ze(s,"xl/_rels/workbook."+r+".rels",oi(t.wbrels)),delete t.revssf,delete t.ssf,s}function rR(e,t){Zs=1024,e&&!e.SSF&&(e.SSF=ut(Re)),e&&e.SSF&&(Pi(),z0(e.SSF),t.revssf=W0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,wl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=C2.indexOf(t.bookType)>-1,a=Oh();Jh(t=t||{});var s=Nh(),l="",o=0;if(t.cellXfs=[],Ka(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",ze(s,l,Hy(e.Props,t)),a.coreprops.push(l),Qe(t.rels,2,l,We.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,ze(s,l,Ky(e.Props)),a.extprops.push(l),Qe(t.rels,3,l,We.EXT_PROPS),e.Custprops!==e.Props&&kt(e.Custprops||{}).length>0&&(l="docProps/custom.xml",ze(s,l,qy(e.Custprops)),a.custprops.push(l),Qe(t.rels,4,l,We.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],y=(h||{})["!type"]||"sheet";switch(y){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,ze(s,l,U2(o-1,t,e,d)),a.sheets.push(l),Qe(t.wbrels,-1,"worksheets/sheet"+o+"."+r,We.WS[0])}if(h){var g=h["!comments"],m=!1,p="";if(g&&g.length>0){var x=!1;g.forEach(function(v){v[1].forEach(function(w){w.T==!0&&(x=!0)})}),x&&(p="xl/threadedComments/threadedComment"+o+"."+r,ze(s,p,c5(g,f,t)),a.threadedcomments.push(p),Qe(d,-1,"../threadedComments/threadedComment"+o+"."+r,We.TCMNT)),p="xl/comments"+o+"."+r,ze(s,p,T2(g)),a.comments.push(p),Qe(d,-1,"../comments"+o+"."+r,We.CMNT),m=!0}h["!legacy"]&&m&&ze(s,"xl/drawings/vmlDrawing"+o+".vml",j2(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&ze(s,Yl(l),oi(d))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,ze(s,l,x2(t.Strings,t)),a.strs.push(l),Qe(t.wbrels,-1,"sharedStrings."+r,We.SST)),l="xl/workbook."+r,ze(s,l,H2(e)),a.workbooks.push(l),Qe(t.rels,1,l,We.WB),l="xl/theme/theme1.xml",ze(s,l,$h(e.Themes,t)),a.themes.push(l),Qe(t.wbrels,-1,"theme/theme1.xml",We.THEME),l="xl/styles."+r,ze(s,l,_2(e,t)),a.styles.push(l),Qe(t.wbrels,-1,"styles."+r,We.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",ze(s,l,e.vbaraw),a.vba.push(l),Qe(t.wbrels,-1,"vbaProject.bin",We.VBA)),l="xl/metadata."+r,ze(s,l,S2()),a.metadata.push(l),Qe(t.wbrels,-1,"metadata."+r,We.XLMETA),f.length>1&&(l="xl/persons/person.xml",ze(s,l,f5(f)),a.people.push(l),Qe(t.wbrels,-1,"persons/person.xml",We.PEOPLE)),ze(s,"[Content_Types].xml",$y(a,t)),ze(s,"_rels/.rels",oi(t.rels)),ze(s,"xl/_rels/workbook."+r+".rels",oi(t.wbrels)),delete t.revssf,delete t.ssf,s}function Qh(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Kr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function nR(e,t){return De.find(e,"EncryptedPackage")?ZD(e,t):q2(e,t)}function aR(e,t){var r,n=e,a=t||{};return a.type||(a.type=$e&&Buffer.isBuffer(e)?"buffer":"base64"),r=gy(n,a),QD(r,a)}function nw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return rd(e.slice(r),t);default:break e}return ki.to_workbook(e,t)}function sR(e,t){var r="",n=Qh(e,t);switch(t.type){case"base64":r=Kr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=_s(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=tt(r)),t.type="binary",nw(r,t)}function iR(e,t){var r=e;return t.type=="base64"&&(r=Kr(r)),r=Vl.utils.decode(1200,r.slice(2),"str"),t.type="binary",nw(r,t)}function lR(e){return e.match(/[^\x00-\x7F]/)?Mn(e):e}function zu(e,t,r,n){return n?(r.type="string",ki.to_workbook(e,r)):ki.to_workbook(t,r)}function u0(e,t){gh();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return u0(new Uint8Array(e),(r=ut(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ui={},r.dateNF&&(ui.dateNF=r.dateNF),r.type||(r.type=$e&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=$e?"buffer":"binary",n=tS(e),typeof Uint8Array<"u"&&!$e&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=lR(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=ut(r),r.type="array",u0(vh(n),r)}switch((a=Qh(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return nR(De.read(n,r),r);break;case 9:if(a[1]<=8)return q2(n,r);break;case 60:return rd(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return dT(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return h2.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?aR(n,r):zu(e,n,r,s);case 239:return a[3]===60?rd(n,r):zu(e,n,r,s);case 255:if(a[1]===254)return iR(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return hs.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return hs.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return td.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return w2.to_workbook(n,r);break;case 10:case 13:case 32:return sR(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return fT.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?td.to_workbook(n,r):zu(e,n,r,s)}function aw(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return go(t.file,De.write(e,{type:$e?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return De.write(e,t)}function oR(e,t){var r=ut(t||{}),n=eR(e,r);return cR(n,r)}function cR(e,t){var r={},n=$e?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?De.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(U0(a))}return t.password&&typeof encrypt_agile<"u"?aw(encrypt_agile(a,t.password),t):t.type==="file"?go(t.file,a):t.type=="string"?tt(a):a}function uR(e,t){var r=t||{},n=lD(e,r);return aw(n,r)}function In(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Hl(Mn(n));case"binary":return Mn(n);case"string":return e;case"file":return go(t.file,n,"utf8");case"buffer":return $e?fa(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):In(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function fR(e,t){switch(t.type){case"base64":return Hl(e);case"binary":return e;case"string":return e;case"file":return go(t.file,e,"binary");case"buffer":return $e?fa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function nc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Hl(r):t.type=="string"?tt(r):r;case"file":return go(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function sw(e,t){gh(),n8(e);var r=ut(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=sw(e,r);return r.type="array",U0(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return In(eD(e,r),r);case"slk":case"sylk":return In(d2.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return In(J2(e.Sheets[e.SheetNames[a]],r),r);case"txt":return fR(iw(e.Sheets[e.SheetNames[a]],r),r);case"csv":return In(Zh(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return In(h2.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return nc(td.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return In(ki.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return In(w2.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return In(m2.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return In(tw(e,r),r);case"wk1":return nc(hs.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return nc(hs.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),nc(Y2(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),uR(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return oR(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function dR(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Eo(e,t,r){var n={};return n.type="file",n.file=t,dR(n),sw(e,n)}function hR(e,t,r,n,a,s,l,o){var c=Ct(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!l||e[r])for(var y=t.s.c;y<=t.e.c;++y){var g=l?e[r][y]:e[n[y]+c];if(g===void 0||g.t===void 0){if(u===void 0)continue;s[y]!=null&&(h[s[y]]=u);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[y]!=null){if(m==null)if(g.t=="e"&&m===null)h[s[y]]=null;else if(u!==void 0)h[s[y]]=u;else if(f&&m===null)h[s[y]]=null;else continue;else h[s[y]]=f&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:oa(g,m,o);m!=null&&(d=!1)}}return{row:h,isempty:d}}function f0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],l=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":c=Ke(f);break;case"number":c=Ke(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(a=0);var d=Ct(c.s.r),h=[],y=[],g=0,m=0,p=Array.isArray(e),x=c.s.r,v=0,w={};p&&!e[x]&&(e[x]=[]);var b=u.skipHidden&&e["!cols"]||[],_=u.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(b[v]||{}).hidden)switch(h[v]=xt(v),r=p?e[x][v]:e[h[v]+d],n){case 1:s[v]=v-c.s.c;break;case 2:s[v]=h[v];break;case 3:s[v]=u.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=oa(r,null,u),m=w[l]||0,!m)w[l]=1;else{do o=l+"_"+m++;while(w[o]);w[l]=m,w[o]=1}s[v]=o}for(x=c.s.r+a;x<=c.e.r;++x)if(!(_[x]||{}).hidden){var E=hR(e,c,x,h,n,s,p,u);(E.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(y[g++]=E.row)}return y.length=g,y}var Yp=/"/g;function mR(e,t,r,n,a,s,l,o){for(var c=!0,u=[],f="",d=Ct(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var y=o.dense?(e[r]||[])[h]:e[n[h]+d];if(y==null)f="";else if(y.v!=null){c=!1,f=""+(o.rawNumbers&&y.t=="n"?y.v:oa(y,null,o));for(var g=0,m=0;g!==f.length;++g)if((m=f.charCodeAt(g))===a||m===s||m===34||o.forceQuotes){f='"'+f.replace(Yp,'""')+'"';break}f=="ID"&&(f='"ID"')}else y.f!=null&&!y.F?(c=!1,f="="+y.f,f.indexOf(",")>=0&&(f='"'+f.replace(Yp,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&c?null:u.join(l)}function Zh(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Ke(e["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],y=n.skipHidden&&e["!rows"]||[],g=a.s.c;g<=a.e.c;++g)(h[g]||{}).hidden||(d[g]=xt(g));for(var m=0,p=a.s.r;p<=a.e.r;++p)(y[p]||{}).hidden||(f=mR(e,a,p,d,l,c,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function iw(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Zh(e,t);return r}function xR(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Ke(e["!ref"]),s="",l=[],o,c=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)l[o]=xt(o);for(var f=a.s.r;f<=a.e.r;++f)for(s=Ct(f),o=a.s.c;o<=a.e.c;++o)if(t=l[o]+s,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function lw(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},l=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var c=typeof n.origin=="string"?pt(n.origin):n.origin;l=c.r,o=c.c}var u,f={s:{c:0,r:0},e:{c:o,r:l+t.length-1+a}};if(s["!ref"]){var d=Ke(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),l==-1&&(l=d.e.r+1,f.e.r=l+t.length-1+a)}else l==-1&&(l=0,f.e.r=t.length-1+a);var h=n.header||[],y=0;t.forEach(function(m,p){kt(m).forEach(function(x){(y=h.indexOf(x))==-1&&(h[y=h.length]=x);var v=m[x],w="z",b="",_=Pe({c:o+y,r:l+p+a});u=no(s,_),v&&typeof v=="object"&&!(v instanceof Date)?s[_]=v:(typeof v=="number"?w="n":typeof v=="boolean"?w="b":typeof v=="string"?w="s":v instanceof Date?(w="d",n.cellDates||(w="n",v=Ut(v)),b=n.dateNF||Re[14]):v===null&&n.nullError&&(w="e",v=0),u?(u.t=w,u.v=v,delete u.w,delete u.R,b&&(u.z=b)):s[_]=u={t:w,v},b&&(u.z=b))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var g=Ct(l);if(a)for(y=0;y<h.length;++y)s[xt(y+o)+g]={t:"s",v:h[y]};return s["!ref"]=Be(f),s}function pR(e,t){return lw(null,e,t)}function no(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=pt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?no(e,Pe(t)):no(e,Pe({r:t,c:r||0}))}function gR(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function em(){return{SheetNames:[],Sheets:{}}}function tm(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var l=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=l+a)!=-1;++a);}if(V2(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function vR(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=gR(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function yR(e,t){return e.z=t,e}function ow(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function wR(e,t,r){return ow(e,"#"+t,r)}function bR(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function NR(e,t,r,n){for(var a=typeof t!="string"?t:Ke(t),s=typeof t=="string"?t:Be(t),l=a.s.r;l<=a.e.r;++l)for(var o=a.s.c;o<=a.e.c;++o){var c=no(e,l,o);c.t="n",c.F=s,delete c.v,l==a.s.r&&o==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Mt={encode_col:xt,encode_row:Ct,encode_cell:Pe,encode_range:Be,decode_col:Fh,decode_row:Ch,split_cell:RS,decode_cell:pt,decode_range:Mr,format_cell:oa,sheet_add_aoa:Iy,sheet_add_json:lw,sheet_add_dom:Q2,aoa_to_sheet:Ii,json_to_sheet:pR,table_to_sheet:Z2,table_to_book:CD,sheet_to_csv:Zh,sheet_to_txt:iw,sheet_to_json:f0,sheet_to_html:J2,sheet_to_formulae:xR,sheet_to_row_object_array:f0,sheet_get_cell:no,book_new:em,book_append_sheet:tm,book_set_sheet_visibility:vR,cell_set_number_format:yR,cell_set_hyperlink:ow,cell_set_internal_link:wR,cell_add_comment:bR,sheet_set_array_formula:NR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function _R(){var G;const{decompteId:e}=Wn(),t=Kt(),[r,n]=T.useState(null),[a,s]=T.useState([]),[l,o]=T.useState(null),[c,u]=T.useState([]),[f,d]=T.useState(!0),[h,y]=T.useState(!1),[g,m]=T.useState(null),[p,x]=T.useState(null),[v,w]=T.useState(!1),[b,_]=T.useState(!1),[E,N]=T.useState({compteurId:"",dateReleve:new Date().toISOString().split("T")[0],indexPrecedent:"",indexActuel:"",notes:""});T.useEffect(()=>{R()},[e]);const R=async()=>{try{d(!0),m(null);const q=await $l.getById(e);n(q.data.decompte);const U=await Za.getByDecompte(e);s(U.data.releves||[]);const S=await Za.getTemplate(e);o(S.data.template)}catch(q){console.error("Error loading data:",q),m("Erreur lors du chargement des donnes")}finally{d(!1)}},j=T.useCallback(q=>{q.preventDefault(),q.stopPropagation(),q.type==="dragenter"||q.type==="dragover"?w(!0):q.type==="dragleave"&&w(!1)},[]),L=T.useCallback(q=>{q.preventDefault(),q.stopPropagation(),w(!1),q.dataTransfer.files&&q.dataTransfer.files[0]&&K(q.dataTransfer.files[0])},[]),V=q=>{q.target.files&&q.target.files[0]&&K(q.target.files[0])},K=q=>{m(null),x(null);const U=new FileReader;U.onload=S=>{try{const z=new Uint8Array(S.target.result),F=u0(z,{type:"array"}),M=F.SheetNames[0],W=F.Sheets[M],Q=Mt.sheet_to_json(W).map((ye,I)=>({rowNum:I+2,numeroCompteur:ye["Numro Compteur"]||ye.numero_compteur||"",dateReleve:Y(ye["Date Relev"]||ye.date_releve),indexPrecedent:parseFloat(ye["Index Prcdent"]||ye.index_precedent)||0,indexActuel:parseFloat(ye["Index Actuel"]||ye.index_actuel)||0,notes:ye.Notes||ye.notes||"",valid:!0,error:null})).map(ye=>H(ye));u(Q);const Z=Q.filter(ye=>ye.valid).length;x(`${Z}/${Q.length} lignes valides prtes  importer`)}catch(z){console.error("Error parsing Excel:",z),m("Erreur lors de la lecture du fichier Excel")}},U.readAsArrayBuffer(q)},Y=q=>{if(!q)return new Date().toISOString().split("T")[0];if(typeof q=="number")return new Date((q-25569)*86400*1e3).toISOString().split("T")[0];if(typeof q=="string"){const U=q.split("/");return U.length===3?`${U[2]}-${U[1].padStart(2,"0")}-${U[0].padStart(2,"0")}`:q}return new Date().toISOString().split("T")[0]},H=q=>{const U=[];return q.numeroCompteur||U.push("Numro compteur manquant"),q.indexActuel<q.indexPrecedent&&U.push("Index actuel < index prcdent"),(q.indexActuel<0||q.indexPrecedent<0)&&U.push("Index ngatif"),{...q,valid:U.length===0,error:U.length>0?U.join(", "):null}},B=async()=>{var U,S;const q=c.filter(z=>z.valid);if(q.length===0){m("Aucune ligne valide  importer");return}try{y(!0),m(null);const z=q.map(M=>({numeroCompteur:M.numeroCompteur,dateReleve:M.dateReleve,indexPrecedent:M.indexPrecedent,indexActuel:M.indexActuel,notes:M.notes})),F=await Za.bulkImport(e,z);x(`${F.data.imported} relevs imports avec succs !`),u([]),R()}catch(z){console.error("Import error:",z),m(((S=(U=z.response)==null?void 0:U.data)==null?void 0:S.message)||"Erreur lors de l'import")}finally{y(!1)}},J=()=>{if(!l)return;const q=[l.headers,...l.rows.map(F=>[F.numero_compteur,F.occupant,F.emplacement,new Date().toLocaleDateString("fr-BE"),"","",""])],U=Mt.aoa_to_sheet(q);U["!cols"]=[{wch:15},{wch:25},{wch:20},{wch:12},{wch:15},{wch:15},{wch:30}];const S=Mt.book_new();Mt.book_append_sheet(S,U,"Relevs");const z=`releves_${(r==null?void 0:r.immeuble_nom)||"compteurs"}_${new Date().toISOString().split("T")[0]}.xlsx`;Eo(S,z)},ue=async q=>{var U,S;if(q.preventDefault(),!E.compteurId||!E.indexActuel){m("Veuillez remplir tous les champs obligatoires");return}try{m(null),await Za.create(e,{compteurId:E.compteurId,dateReleve:E.dateReleve,indexPrecedent:parseFloat(E.indexPrecedent)||0,indexActuel:parseFloat(E.indexActuel),notes:E.notes}),x("Relev ajout avec succs !"),_(!1),N({compteurId:"",dateReleve:new Date().toISOString().split("T")[0],indexPrecedent:"",indexActuel:"",notes:""}),R()}catch(z){console.error("Error creating releve:",z),m(((S=(U=z.response)==null?void 0:U.data)==null?void 0:S.message)||"Erreur lors de la cration")}},le=async q=>{if(confirm("Supprimer ce relev ?"))try{await Za.delete(e,q),x("Relev supprim"),R()}catch{m("Erreur lors de la suppression")}};return f?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx(kr,{className:"w-8 h-8 animate-spin text-blue-600"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>t(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:i.jsx(Vn,{className:"w-5 h-5"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Relevs de compteurs"}),i.jsxs("p",{className:"text-gray-600",children:[r==null?void 0:r.immeuble_nom," - ",r==null?void 0:r.annee]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:J,disabled:!l,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:[i.jsx(ch,{className:"w-4 h-4"}),"Modle Excel"]}),i.jsxs("button",{onClick:()=>_(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[i.jsx(Gt,{className:"w-4 h-4"}),"Saisie manuelle"]})]})]}),g&&i.jsxs("div",{className:"flex items-center gap-2 p-4 bg-red-50 text-red-700 rounded-lg",children:[i.jsx(st,{className:"w-5 h-5"}),g]}),p&&i.jsxs("div",{className:"flex items-center gap-2 p-4 bg-green-50 text-green-700 rounded-lg",children:[i.jsx(jn,{className:"w-5 h-5"}),p]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[i.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(L0,{className:"w-5 h-5 text-green-600"}),"Import Excel"]}),i.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${v?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:j,onDragLeave:j,onDragOver:j,onDrop:L,children:[i.jsx(Yv,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),i.jsx("p",{className:"text-gray-600 mb-2",children:"Glissez-dposez votre fichier Excel ici"}),i.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"ou"}),i.jsxs("label",{className:"cursor-pointer",children:[i.jsx("span",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Parcourir..."}),i.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls,.csv",onChange:V})]})]}),c.length>0&&i.jsxs("div",{className:"mt-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"font-medium",children:["Prvisualisation (",c.filter(q=>q.valid).length,"/",c.length," valides)"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>u([]),className:"px-3 py-1 text-gray-600 hover:bg-gray-100 rounded",children:"Annuler"}),i.jsxs("button",{onClick:B,disabled:h||c.filter(q=>q.valid).length===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:[h?i.jsx(kr,{className:"w-4 h-4 animate-spin"}):i.jsx(Hn,{className:"w-4 h-4"}),"Importer ",c.filter(q=>q.valid).length," relevs"]})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"#"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Compteur"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),i.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Index prc."}),i.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Index actuel"}),i.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Conso."}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map((q,U)=>i.jsxs("tr",{className:q.valid?"":"bg-red-50",children:[i.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:q.rowNum}),i.jsx("td",{className:"px-4 py-2 text-sm font-mono",children:q.numeroCompteur}),i.jsx("td",{className:"px-4 py-2 text-sm",children:q.dateReleve}),i.jsx("td",{className:"px-4 py-2 text-sm text-right",children:q.indexPrecedent}),i.jsx("td",{className:"px-4 py-2 text-sm text-right",children:q.indexActuel}),i.jsxs("td",{className:"px-4 py-2 text-sm text-right font-medium",children:[(q.indexActuel-q.indexPrecedent).toFixed(2)," m"]}),i.jsx("td",{className:"px-4 py-2 text-sm",children:q.valid?i.jsx("span",{className:"text-green-600",children:" OK"}):i.jsxs("span",{className:"text-red-600",title:q.error,children:[" ",q.error]})})]},U))})]})})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[i.jsxs("h2",{className:"text-lg font-semibold mb-4",children:["Relevs enregistrs (",a.length,")"]}),a.length===0?i.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun relev enregistr pour ce dcompte"}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Compteur"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Occupant"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),i.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Index prc."}),i.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Index actuel"}),i.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Consommation"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Notes"}),i.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(q=>{var U;return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-3 text-sm font-mono",children:q.numero_compteur}),i.jsx("td",{className:"px-4 py-3 text-sm",children:q.occupant||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(q.date_releve).toLocaleDateString("fr-BE")}),i.jsx("td",{className:"px-4 py-3 text-sm text-right",children:q.index_precedent}),i.jsx("td",{className:"px-4 py-3 text-sm text-right",children:q.index_actuel}),i.jsxs("td",{className:"px-4 py-3 text-sm text-right font-medium text-blue-600",children:[((U=q.consommation)==null?void 0:U.toFixed(2))||(q.index_actuel-q.index_precedent).toFixed(2)," m"]}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:q.notes||"-"}),i.jsx("td",{className:"px-4 py-3 text-right",children:i.jsx("button",{onClick:()=>le(q.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Supprimer",children:i.jsx(La,{className:"w-4 h-4"})})})]},q.id)})})]})})]}),b&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Ajouter un relev"}),i.jsxs("form",{onSubmit:ue,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Compteur *"}),i.jsxs("select",{value:E.compteurId,onChange:q=>N({...E,compteurId:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Slectionner un compteur"}),(G=l==null?void 0:l.rows)==null?void 0:G.map(q=>i.jsxs("option",{value:q.compteur_id,children:[q.numero_compteur," - ",q.occupant]},q.compteur_id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date du relev *"}),i.jsx("input",{type:"date",value:E.dateReleve,onChange:q=>N({...E,dateReleve:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Index prcdent"}),i.jsx("input",{type:"number",step:"0.001",value:E.indexPrecedent,onChange:q=>N({...E,indexPrecedent:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Index actuel *"}),i.jsx("input",{type:"number",step:"0.001",value:E.indexActuel,onChange:q=>N({...E,indexActuel:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),E.indexActuel&&E.indexPrecedent&&i.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:i.jsxs("span",{className:"text-sm text-blue-700",children:["Consommation calcule : ",i.jsxs("strong",{children:[(parseFloat(E.indexActuel)-parseFloat(E.indexPrecedent)).toFixed(3)," m"]})]})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),i.jsx("textarea",{value:E.notes,onChange:q=>N({...E,notes:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2,placeholder:"Observations ventuelles..."})]}),i.jsxs("div",{className:"flex gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>_(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Annuler"}),i.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Enregistrer"})]})]})]})})]})}function kR(){var z,F,M;const{immeubleId:e}=Wn(),t=Kt(),[r,n]=T.useState(null),[a,s]=T.useState([]),[l,o]=T.useState([]),[c,u]=T.useState([]),[f,d]=T.useState([]),[h,y]=T.useState(!0),[g,m]=T.useState(!1),[p,x]=T.useState(null),[v,w]=T.useState(null),[b,_]=T.useState(!1),[E,N]=T.useState(null),[R,j]=T.useState("all");T.useEffect(()=>{L()},[e]);const L=async()=>{try{y(!0),x(null);const W=await Lr.getOne(e);n(W.data.immeuble);const ie=await ss.getAll(e);o(ie.data.fournisseurs||[]);try{const Q=await ss.getCategories(e);u(Q.data.categories||[])}catch{u([{value:"eau",label:"Eau",icon:""},{value:"electricite",label:"lectricit",icon:""},{value:"chauffage",label:"Chauffage",icon:""},{value:"ascenseur",label:"Ascenseur",icon:""},{value:"frais_bancaires",label:"Frais bancaires",icon:""},{value:"autre",label:"Autre",icon:""}])}const X=await is.getAll(e);s(X.data.transactions||[]);try{const Q=await is.getStats(e);N(Q.data.stats)}catch{console.log("Stats not available")}}catch(W){console.error("Error loading data:",W),x("Erreur lors du chargement des donnes")}finally{y(!1)}},V=W=>{var X,Q,Z,ye,I,ve,Ae,Ie;const ie=[];for(let be=0;be<W.length;be++){const de=W[be];if(!de||de.length<11)continue;const se=(X=de[0])==null?void 0:X.toString().trim();if(!se||!se.startsWith("BE"))continue;const Se=(Q=de[1])==null?void 0:Q.toString().trim(),Ee=((Z=de[5])==null?void 0:Z.toString().trim())||((ye=de[8])==null?void 0:ye.toString().trim()),Te=(I=de[8])==null?void 0:I.toString().trim(),Ue=(ve=de[10])==null?void 0:ve.toString().trim(),Ye=((Ae=de[14])==null?void 0:Ae.toString().trim())||Te,nt=(Ie=de[4])==null?void 0:Ie.toString().trim();if(!Se||!Ue)continue;let Et=Ue.replace(/\s/g,"").replace(",",".");Et=parseFloat(Et),!isNaN(Et)&&ie.push({compte:se,dateComptabilisation:Se,nomContrepartie:Ee||Y(Te),compteContrepartie:nt,montant:Ue,communication:Ye,reference:de[2]+"-"+de[3]})}return ie},K=(W,ie)=>{var Ie,be,de,se,Se;const X=ie.map(Ee=>(Ee||"").toString().toLowerCase().trim()),Q=X.findIndex(Ee=>Ee.includes("date")&&(Ee.includes("compta")||Ee.includes("opration")||Ee==="date")),Z=X.findIndex(Ee=>Ee.includes("montant")||Ee.includes("amount")),ye=X.findIndex(Ee=>Ee.includes("contrepartie")||Ee.includes("nom")||Ee.includes("beneficiaire")||Ee.includes("name")),I=X.findIndex(Ee=>Ee.includes("communication")||Ee.includes("description")||Ee.includes("libell")||Ee.includes("motif")),ve=X.findIndex(Ee=>Ee.includes("compte")&&Ee.includes("contrepartie")),Ae=[];for(let Ee=0;Ee<W.length;Ee++){const Te=W[Ee];if(!Te||Te.length<2)continue;const Ue=Q>=0?(Ie=Te[Q])==null?void 0:Ie.toString().trim():null,Ye=Z>=0?(be=Te[Z])==null?void 0:be.toString().trim():null;!Ue||!Ye||/\d{1,2}[-\/]\d{1,2}[-\/]\d{2,4}/.test(Ue)&&Ae.push({dateComptabilisation:Ue,nomContrepartie:ye>=0?(de=Te[ye])==null?void 0:de.toString().trim():"",montant:Ye,communication:I>=0?(se=Te[I])==null?void 0:se.toString().trim():"",compteContrepartie:ve>=0?(Se=Te[ve])==null?void 0:Se.toString().trim():""})}return Ae},Y=W=>{if(!W)return"";const ie=[/VERS\s+[\w\d\s]+\s+(.+?)\s+(?:REF|VAL|\+\+\+)/i,/DE\s+[\w\d\s]+\s+(.+?)\s+(?:REF|VAL)/i,/VIREMENT.*VERS\s+[\w\d\s]+\s+(.+?)\s+/i];for(const X of ie){const Q=W.match(X);if(Q)return Q[1].trim()}return""},H=T.useCallback(W=>{W.preventDefault(),W.stopPropagation(),W.type==="dragenter"||W.type==="dragover"?_(!0):W.type==="dragleave"&&_(!1)},[]),B=T.useCallback(W=>{W.preventDefault(),W.stopPropagation(),_(!1),W.dataTransfer.files&&W.dataTransfer.files[0]&&ue(W.dataTransfer.files[0])},[l]),J=W=>{W.target.files&&W.target.files[0]&&ue(W.target.files[0])},ue=W=>{x(null),w(null);const ie=new FileReader;ie.onload=X=>{try{let Q=[];if(W.name.endsWith(".csv"))Q=X.target.result.split(/\r?\n/).map(se=>se.includes(";")?se.split(";"):se.split(","));else{const be=new Uint8Array(X.target.result),de=u0(be,{type:"array"}),se=de.SheetNames[0],Se=de.Sheets[se];Q=Mt.sheet_to_json(Se,{header:1})}let Z=[];if(Q.slice(0,15).map(be=>(be[0]||"").toString().toLowerCase()).some(be=>be.includes("date de comptabilisation")))Z=V(Q);else{let be=Q.findIndex(de=>{const se=(de||[]).join(" ").toLowerCase();return se.includes("date")&&(se.includes("montant")||se.includes("amount"))});be>=0?Z=K(Q.slice(be+1),Q[be]):Z=K(Q.slice(1),Q[0])}if(Z.length===0){x("Aucune transaction trouve dans le fichier. Vrifiez le format.");return}const ve=Z.map((be,de)=>{const se=le(be),Se=G(be.nomContrepartie,be.communication);return{...be,rowNum:de+1,...se,...Se,montantParsed:parseFloat((be.montant||"0").toString().replace(/\s/g,"").replace(",","."))}});d(ve);const Ae=ve.filter(be=>be.valid).length,Ie=ve.filter(be=>be.fournisseurId||be.categorieAuto).length;w(`${Ae} transactions valides (${Ie} reconnues automatiquement)`)}catch(Q){console.error("Error parsing file:",Q),x("Erreur lors de la lecture du fichier: "+Q.message)}},W.name.endsWith(".csv")?ie.readAsText(W,"UTF-8"):ie.readAsArrayBuffer(W)},le=W=>{const ie=[];W.dateComptabilisation||ie.push("Date manquante");const X=parseFloat((W.montant||"0").toString().replace(/\s/g,"").replace(",","."));return(isNaN(X)||X===0)&&ie.push("Montant invalide"),{valid:ie.length===0,error:ie.join(", ")}},G=(W,ie)=>{if(!W&&!ie)return{fournisseurId:null,fournisseurNom:null,categorieAuto:null};const X=((W||"")+" "+(ie||"")).toUpperCase();for(const Q of l){if(Q.nom&&X.includes(Q.nom.toUpperCase()))return{fournisseurId:Q.id,fournisseurNom:Q.nom,categorieAuto:Q.type};if(Q.tags&&Array.isArray(Q.tags)){for(const Z of Q.tags)if(Z&&X.includes(Z.toUpperCase()))return{fournisseurId:Q.id,fournisseurNom:Q.nom,categorieAuto:Q.type}}}return X.includes("FRAIS DE GESTION")||X.includes("FRAIS SUR ORDRE")||X.includes("FRAIS DE TENUE")||X.includes("DROIT DE TIMBRE")||X.includes("PARTICIPATION AUX FRAIS")?{fournisseurId:null,fournisseurNom:"Frais bancaires",categorieAuto:"frais_bancaires"}:X.includes("INTERETS")||X.includes("INTRTS")?{fournisseurId:null,fournisseurNom:"Intrts",categorieAuto:"frais_bancaires"}:{fournisseurId:null,fournisseurNom:null,categorieAuto:null}},q=async()=>{var ie,X;const W=f.filter(Q=>Q.valid);if(W.length===0){x("Aucune transaction valide  importer");return}try{m(!0),x(null);const Q=W.map(ye=>({dateComptabilisation:ye.dateComptabilisation,montant:ye.montant,nomContrepartie:ye.nomContrepartie||"",compteContrepartie:ye.compteContrepartie||"",communication:ye.communication||"",reference:ye.reference||""})),Z=await is.import(e,Q);w(`${Z.data.imported} transactions importes (${Z.data.autoRecognized} reconnues automatiquement)`),d([]),L()}catch(Q){console.error("Import error:",Q),x(((X=(ie=Q.response)==null?void 0:ie.data)==null?void 0:X.message)||"Erreur lors de l'import")}finally{m(!1)}},U=()=>{const W=[["Date de comptabilisation","Montant","Nom contrepartie","Communication"],["01/01/2025","-150.00","VIVAQUA","Facture eau T1"],["05/01/2025","500.00","DUPONT Jean","Charges janvier"],["10/01/2025","-200.00","CHAUFFAGE SA","Acompte chauffage"],["15/01/2025","-50.00","","FRAIS DE GESTION ADMINISTRATIVE"]],ie=Mt.aoa_to_sheet(W);ie["!cols"]=[{wch:22},{wch:12},{wch:25},{wch:40}];const X=Mt.book_new();Mt.book_append_sheet(X,ie,"Transactions"),Eo(X,`modele_transactions_${new Date().toISOString().split("T")[0]}.xlsx`)},S=a.filter(W=>R==="all"?!0:R==="charge"?W.type==="charge":R==="versement"?W.type==="versement":!0);return h?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx(kr,{className:"w-8 h-8 animate-spin text-blue-600"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>t(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:i.jsx(Vn,{className:"w-5 h-5"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Extraits bancaires"}),i.jsxs("p",{className:"text-gray-600 flex items-center gap-2",children:[i.jsx(fr,{className:"w-4 h-4"}),r==null?void 0:r.nom]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:U,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[i.jsx(ch,{className:"w-4 h-4"}),"Modle Excel"]}),i.jsxs("button",{onClick:()=>t(`/immeubles/${e}/fournisseurs`),className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[i.jsx(Jc,{className:"w-4 h-4"}),"Fournisseurs"]})]})]}),E&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Recettes"}),i.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[((z=E.totalVersements)==null?void 0:z.toFixed(2))||"0.00"," "]})]}),i.jsx(B0,{className:"w-8 h-8 text-green-200"})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Dpenses"}),i.jsxs("p",{className:"text-2xl font-bold text-red-600",children:[((F=E.totalCharges)==null?void 0:F.toFixed(2))||"0.00"," "]})]}),i.jsx(fh,{className:"w-8 h-8 text-red-200"})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Trsorerie"}),i.jsxs("p",{className:`text-2xl font-bold ${E.tresorerie>=0?"text-blue-600":"text-red-600"}`,children:[((M=E.tresorerie)==null?void 0:M.toFixed(2))||"0.00"," "]})]}),i.jsx(fr,{className:"w-8 h-8 text-blue-200"})]})})]}),p&&i.jsxs("div",{className:"flex items-center gap-2 p-4 bg-red-50 text-red-700 rounded-lg",children:[i.jsx(st,{className:"w-5 h-5 flex-shrink-0"}),p]}),v&&i.jsxs("div",{className:"flex items-center gap-2 p-4 bg-green-50 text-green-700 rounded-lg",children:[i.jsx(jn,{className:"w-5 h-5 flex-shrink-0"}),v]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[i.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(L0,{className:"w-5 h-5 text-green-600"}),"Import extrait bancaire"]}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Formats supports : CSV Belfius, Excel (.xlsx), CSV gnrique"}),i.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${b?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:H,onDragLeave:H,onDragOver:H,onDrop:B,children:[i.jsx(Yv,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),i.jsx("p",{className:"text-gray-600 mb-2",children:"Glissez-dposez votre extrait bancaire ici"}),i.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"ou"}),i.jsxs("label",{className:"cursor-pointer",children:[i.jsx("span",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Parcourir..."}),i.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls,.csv",onChange:J})]})]}),f.length>0&&i.jsxs("div",{className:"mt-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"font-medium",children:["Prvisualisation (",f.filter(W=>W.valid).length,"/",f.length," valides)"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>d([]),className:"px-3 py-1 text-gray-600 hover:bg-gray-100 rounded",children:"Annuler"}),i.jsxs("button",{onClick:q,disabled:g||f.filter(W=>W.valid).length===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:[g?i.jsx(kr,{className:"w-4 h-4 animate-spin"}):i.jsx(Hn,{className:"w-4 h-4"}),"Importer ",f.filter(W=>W.valid).length," transactions"]})]})]}),i.jsx("div",{className:"overflow-x-auto max-h-96",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50 sticky top-0",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"#"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Contrepartie"}),i.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Montant"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Reconnaissance"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map((W,ie)=>{var X;return i.jsxs("tr",{className:W.valid?"":"bg-red-50",children:[i.jsx("td",{className:"px-3 py-2 text-sm text-gray-500",children:W.rowNum}),i.jsx("td",{className:"px-3 py-2 text-sm",children:W.dateComptabilisation}),i.jsx("td",{className:"px-3 py-2 text-sm",children:i.jsx("div",{className:"max-w-xs truncate",title:W.nomContrepartie||W.communication,children:W.nomContrepartie||W.communication||"-"})}),i.jsxs("td",{className:`px-3 py-2 text-sm text-right font-medium ${W.montantParsed<0?"text-red-600":"text-green-600"}`,children:[(X=W.montantParsed)==null?void 0:X.toFixed(2)," "]}),i.jsx("td",{className:"px-3 py-2 text-sm",children:W.fournisseurNom||W.categorieAuto?i.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded text-xs",children:[i.jsx($k,{className:"w-3 h-3"}),W.fournisseurNom||W.categorieAuto]}):i.jsx("span",{className:"text-gray-400",children:"-"})}),i.jsx("td",{className:"px-3 py-2 text-sm",children:W.valid?i.jsx("span",{className:"text-green-600",children:" OK"}):i.jsxs("span",{className:"text-red-600",title:W.error,children:[" ",W.error]})})]},ie)})})]})})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h2",{className:"text-lg font-semibold",children:["Transactions (",S.length,")"]}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("select",{value:R,onChange:W=>j(W.target.value),className:"px-3 py-1 border border-gray-300 rounded-lg text-sm",children:[i.jsx("option",{value:"all",children:"Tous"}),i.jsx("option",{value:"charge",children:"Dpenses"}),i.jsx("option",{value:"versement",children:"Recettes"})]})})]}),S.length===0?i.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune transaction enregistre"}):i.jsxs("div",{className:"overflow-x-auto",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),i.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Montant"}),i.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.slice(0,50).map(W=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(W.date_transaction).toLocaleDateString("fr-BE")}),i.jsx("td",{className:"px-4 py-3 text-sm",children:i.jsx("div",{className:"max-w-md truncate",title:W.description,children:W.description||"-"})}),i.jsx("td",{className:"px-4 py-3 text-sm",children:i.jsx("span",{className:`inline-flex px-2 py-1 rounded text-xs font-medium ${W.type==="charge"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:W.type==="charge"?"Dpense":"Recette"})}),i.jsxs("td",{className:`px-4 py-3 text-sm text-right font-medium ${W.type==="charge"?"text-red-600":"text-green-600"}`,children:[W.type==="charge"?"-":"+",parseFloat(W.montant).toFixed(2)," "]}),i.jsx("td",{className:"px-4 py-3 text-right",children:i.jsx("button",{onClick:async()=>{if(confirm("Supprimer cette transaction ?"))try{await is.delete(e,W.id),L()}catch{x("Erreur lors de la suppression")}},className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Supprimer",children:i.jsx(La,{className:"w-4 h-4"})})})]},W.id))})]}),S.length>50&&i.jsx("p",{className:"text-center text-gray-500 py-4",children:"Affichage limit aux 50 premires transactions"})]})]})]})}const ac={eau:{icon:zn,color:"text-blue-600",bg:"bg-blue-100",label:"Eau"},electricite:{icon:rE,color:"text-yellow-600",bg:"bg-yellow-100",label:"lectricit"},gaz:{icon:Mx,color:"text-orange-600",bg:"bg-orange-100",label:"Gaz"},chauffage:{icon:Mx,color:"text-red-600",bg:"bg-red-100",label:"Chauffage"},ascenseur:{icon:zk,color:"text-gray-600",bg:"bg-gray-100",label:"Ascenseur"},nettoyage:{icon:ju,color:"text-green-600",bg:"bg-green-100",label:"Nettoyage"},assurance:{icon:Qk,color:"text-purple-600",bg:"bg-purple-100",label:"Assurance"},syndic:{icon:fr,color:"text-indigo-600",bg:"bg-indigo-100",label:"Syndic"},entretien:{icon:ju,color:"text-teal-600",bg:"bg-teal-100",label:"Entretien"},reparations:{icon:ju,color:"text-amber-600",bg:"bg-amber-100",label:"Rparations"},frais_bancaires:{icon:Bx,color:"text-slate-600",bg:"bg-slate-100",label:"Frais bancaires"},taxes:{icon:Bx,color:"text-rose-600",bg:"bg-rose-100",label:"Taxes"},autre:{icon:qk,color:"text-gray-600",bg:"bg-gray-100",label:"Autre"}},ER=[{value:"eau",label:"Eau",emoji:""},{value:"electricite",label:"lectricit",emoji:""},{value:"gaz",label:"Gaz",emoji:""},{value:"chauffage",label:"Chauffage",emoji:""},{value:"ascenseur",label:"Ascenseur",emoji:""},{value:"nettoyage",label:"Nettoyage",emoji:""},{value:"assurance",label:"Assurance",emoji:""},{value:"syndic",label:"Syndic",emoji:""},{value:"entretien",label:"Entretien",emoji:""},{value:"reparations",label:"Rparations",emoji:""},{value:"frais_bancaires",label:"Frais bancaires",emoji:""},{value:"taxes",label:"Taxes",emoji:""},{value:"autre",label:"Autre",emoji:""}];function SR(){const{immeubleId:e}=Wn(),t=Kt(),[r,n]=T.useState(null),[a,s]=T.useState([]),[l,o]=T.useState(!0),[c,u]=T.useState(!1),[f,d]=T.useState(null),[h,y]=T.useState(null),[g,m]=T.useState(!1),[p,x]=T.useState(null),[v,w]=T.useState({nom:"",type:"autre",email:"",telephone:"",iban:"",tags:[]}),[b,_]=T.useState("");T.useEffect(()=>{E()},[e]);const E=async()=>{try{o(!0),d(null);const[H,B]=await Promise.all([Lr.getOne(e),ss.getAll(e)]);n(H.data.immeuble),s(B.data.fournisseurs||[])}catch(H){console.error("Error loading data:",H),d("Erreur lors du chargement des donnes")}finally{o(!1)}},N=()=>{x(null),w({nom:"",type:"autre",email:"",telephone:"",iban:"",tags:[]}),m(!0)},R=H=>{x(H.id),w({nom:H.nom||"",type:H.type||"autre",email:H.email||"",telephone:H.telephone||"",iban:H.iban||"",tags:H.tags||[]}),m(!0)},j=()=>{b.trim()&&!v.tags.includes(b.trim().toUpperCase())&&(w({...v,tags:[...v.tags,b.trim().toUpperCase()]}),_(""))},L=H=>{w({...v,tags:v.tags.filter(B=>B!==H)})},V=async H=>{var B,J;if(H.preventDefault(),!v.nom.trim()){d("Le nom est obligatoire");return}try{u(!0),d(null);const ue=v.tags.includes(v.nom.toUpperCase())?v.tags:[v.nom.toUpperCase(),...v.tags],le={nom:v.nom,type:v.type,email:v.email||null,telephone:v.telephone||null,iban:v.iban||null,tags:ue};p?(await ss.update(e,p,le),y("Fournisseur modifi avec succs")):(await ss.create(e,le),y("Fournisseur ajout avec succs")),m(!1),E()}catch(ue){console.error("Error saving fournisseur:",ue),d(((J=(B=ue.response)==null?void 0:B.data)==null?void 0:J.message)||"Erreur lors de la sauvegarde")}finally{u(!1)}},K=async H=>{var B,J;if(confirm("Supprimer ce fournisseur ?"))try{await ss.delete(e,H),y("Fournisseur supprim"),E()}catch(ue){d(((J=(B=ue.response)==null?void 0:B.data)==null?void 0:J.message)||"Erreur lors de la suppression")}},Y=H=>{const B=ac[H]||ac.autre,J=B.icon;return i.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${B.bg} ${B.color}`,children:[i.jsx(J,{className:"w-3 h-3"}),B.label]})};return l?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx(kr,{className:"w-8 h-8 animate-spin text-blue-600"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>t(`/immeubles/${e}`),className:"p-2 hover:bg-gray-100 rounded-lg",children:i.jsx(Vn,{className:"w-5 h-5"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Fournisseurs"}),i.jsxs("p",{className:"text-gray-600 flex items-center gap-2",children:[i.jsx(fr,{className:"w-4 h-4"}),r==null?void 0:r.nom]})]})]}),i.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[i.jsx(Gt,{className:"w-4 h-4"}),"Ajouter Fournisseur"]})]}),f&&i.jsxs("div",{className:"flex items-center gap-2 p-4 bg-red-50 text-red-700 rounded-lg",children:[i.jsx(st,{className:"w-5 h-5 flex-shrink-0"}),f,i.jsx("button",{onClick:()=>d(null),className:"ml-auto",children:i.jsx(br,{className:"w-4 h-4"})})]}),h&&i.jsxs("div",{className:"flex items-center gap-2 p-4 bg-green-50 text-green-700 rounded-lg",children:[i.jsx(jn,{className:"w-5 h-5 flex-shrink-0"}),h,i.jsx("button",{onClick:()=>y(null),className:"ml-auto",children:i.jsx(br,{className:"w-4 h-4"})})]}),i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(Jc,{className:"w-5 h-5 text-blue-600 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium text-blue-900",children:"Reconnaissance automatique"}),i.jsx("p",{className:"text-sm text-blue-700 mt-1",children:`Les tags permettent de reconnatre automatiquement les fournisseurs lors de l'import d'extraits bancaires. Ajoutez des variantes du nom (ex: "VIVAQUA", "VIVAQUA SA", "VIVAQUA BRUXELLES").`})]})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:a.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Jc,{className:"w-12 h-12 mx-auto text-gray-300 mb-4"}),i.jsx("p",{className:"text-gray-500",children:"Aucun fournisseur configur"}),i.jsx("button",{onClick:N,className:"mt-4 text-blue-600 hover:text-blue-700",children:"+ Ajouter un fournisseur"})]}):i.jsx("div",{className:"divide-y divide-gray-200",children:a.map(H=>i.jsxs("div",{className:"p-4 hover:bg-gray-50 transition-colors",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 rounded-lg bg-gray-100 flex items-center justify-center",children:(()=>{const B=ac[H.type]||ac.autre,J=B.icon;return i.jsx(J,{className:`w-6 h-6 ${B.color}`})})()}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:H.nom}),i.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[Y(H.type),H.email&&i.jsx("span",{className:"text-sm text-gray-500",children:H.email})]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>R(H),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Modifier",children:i.jsx(po,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>K(H.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Supprimer",children:i.jsx(La,{className:"w-4 h-4"})})]})]}),H.tags&&H.tags.length>0&&i.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:H.tags.map((B,J)=>i.jsx("span",{className:"inline-flex items-center px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs",children:B},J))})]},H.id))})}),g&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsx("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold",children:p?"Modifier le fournisseur":"Nouveau fournisseur"}),i.jsx("button",{onClick:()=>m(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:i.jsx(br,{className:"w-5 h-5"})})]}),i.jsxs("form",{onSubmit:V,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom du fournisseur *"}),i.jsx("input",{type:"text",value:v.nom,onChange:H=>w({...v,nom:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ex: VIVAQUA",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Catgorie *"}),i.jsx("select",{value:v.type,onChange:H=>w({...v,type:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:ER.map(H=>i.jsxs("option",{value:H.value,children:[H.emoji," ",H.label]},H.value))})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",value:v.email,onChange:H=>w({...v,email:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"contact@..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tlphone"}),i.jsx("input",{type:"tel",value:v.telephone,onChange:H=>w({...v,telephone:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"02/..."})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IBAN"}),i.jsx("input",{type:"text",value:v.iban,onChange:H=>w({...v,iban:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"BE..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags de reconnaissance"}),i.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Mots-cls pour identifier ce fournisseur dans les extraits bancaires"}),i.jsxs("div",{className:"flex gap-2 mb-2",children:[i.jsx("input",{type:"text",value:b,onChange:H=>_(H.target.value),onKeyPress:H=>H.key==="Enter"&&(H.preventDefault(),j()),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ajouter un tag..."}),i.jsx("button",{type:"button",onClick:j,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:i.jsx(Gt,{className:"w-4 h-4"})})]}),v.tags.length>0&&i.jsx("div",{className:"flex flex-wrap gap-2",children:v.tags.map((H,B)=>i.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 rounded text-sm",children:[H,i.jsx("button",{type:"button",onClick:()=>L(H),className:"hover:text-blue-900",children:i.jsx(br,{className:"w-3 h-3"})})]},B))})]}),i.jsxs("div",{className:"flex gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Annuler"}),i.jsxs("button",{type:"submit",disabled:c,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[c?i.jsx(kr,{className:"w-4 h-4 animate-spin"}):i.jsx(Hn,{className:"w-4 h-4"}),p?"Modifier":"Ajouter"]})]})]})]})})})]})}const Jp=[{border:"border-l-cyan-500",bg:"bg-cyan-50",text:"text-cyan-700",accent:"cyan"},{border:"border-l-purple-500",bg:"bg-purple-50",text:"text-purple-700",accent:"purple"},{border:"border-l-amber-500",bg:"bg-amber-50",text:"text-amber-700",accent:"amber"},{border:"border-l-emerald-500",bg:"bg-emerald-50",text:"text-emerald-700",accent:"emerald"},{border:"border-l-rose-500",bg:"bg-rose-50",text:"text-rose-700",accent:"rose"},{border:"border-l-blue-500",bg:"bg-blue-50",text:"text-blue-700",accent:"blue"},{border:"border-l-orange-500",bg:"bg-orange-50",text:"text-orange-700",accent:"orange"},{border:"border-l-indigo-500",bg:"bg-indigo-50",text:"text-indigo-700",accent:"indigo"}];function jR(){const{id:e,propId:t}=Wn(),r=Kt(),[n,a]=T.useState(!0),[s,l]=T.useState(null),[o,c]=T.useState(null),[u,f]=T.useState(null),[d,h]=T.useState([]),[y,g]=T.useState([]),[m,p]=T.useState([]),[x,v]=T.useState([]),[w,b]=T.useState({}),[_,E]=T.useState(new Date().getFullYear()),[N,R]=T.useState({}),[j,L]=T.useState("decompte"),[V,K]=T.useState(!1),[Y,H]=T.useState({}),[B,J]=T.useState(!1),ue=T.useRef(null),le=new Date().getFullYear(),G=[le,le-1,le-2,le-3,le-4];T.useEffect(()=>{q()},[e,t]),T.useEffect(()=>{U(_)},[_,x]);const q=async()=>{try{a(!0),l(null);const[se,Se,Ee,Te,Ue,Ye]=await Promise.all([Lr.getOne(e),Xr.getOne(e,t),Xr.getByImmeuble(e),is.getAll(e,{limit:1e3}),Oa.getByImmeuble(e),ii.getAll(e).catch(()=>({data:{exercices:[]}}))]);c(se.data.immeuble),f(Se.data.proprietaire),h(Ee.data.proprietaires||[]),g(Te.data.transactions||[]),p(Ue.data.locataires||[]),v(Ye.data.exercices||[]),H(Se.data.proprietaire||{})}catch(se){console.error("Error loading data:",se),l("Erreur lors du chargement des donnes")}finally{a(!1)}},U=async se=>{var Ee;const Se=x.find(Te=>Te.annee===se);if(Se)try{const Ue=((Ee=(await ii.getOne(e,Se.id)).data.exercice)==null?void 0:Ee.soldes)||[],Ye={};Ue.forEach(nt=>{Ye[nt.proprietaire_id]=parseFloat(nt.solde_debut||0)}),b(Ye)}catch{b({})}else b({})},S=async()=>{try{J(!0),await Xr.update(e,t,Y),f(Y),K(!1)}catch(se){console.error("Error saving profile:",se),alert("Erreur lors de la sauvegarde")}finally{J(!1)}},z=T.useMemo(()=>{if(!u||!d.length)return 0;const se=d.findIndex(Se=>Se.id===u.id);return se>=0?se:0},[u,d]),F=Jp[z%Jp.length],M=se=>{const Se=(se.description||se.communication||"").toLowerCase();return Se.includes("frais")||Se.includes("non-execute")||Se.includes("non execute")||Se.includes("participation aux frais")},W=se=>{if(!u||se.type==="charge")return!1;if(se.proprietaire_id===u.id)return!0;const Se=(se.nom_contrepartie||"").toLowerCase(),Ee=(se.communication||se.description||"").toLowerCase(),Te=u.nom.toLowerCase(),Ue=(u.prenom||"").toLowerCase();return Se.includes(Te)||Ee.includes(Te)||Se.includes(`${Ue} ${Te}`)||Ee.includes(`${Ue} ${Te}`)},ie=se=>y.filter(Se=>{const Ee=Se.date_transaction||Se.date_comptabilisation||Se.created_at;return!Ee||new Date(Ee).getFullYear()!==se?!1:Se.type==="charge"?!0:W(Se)}),X=T.useMemo(()=>ie(_),[y,_,u]),Q=se=>{if(!u||!d.length)return{charges:0,depots:0,frais:0,soldeFinal:0,ran:0};const Se=ie(se),Ee=d.reduce((Fe,He)=>Fe+(He.nombre_parts||He.milliemes||0),0),Te=u.nombre_parts||u.milliemes||0,Ue=Ee>0?Te/Ee:0,Ye=Se.filter(Fe=>Fe.type==="charge"&&!M(Fe)).reduce((Fe,He)=>Fe+Math.abs(parseFloat(He.montant||0)),0),nt=Se.filter(Fe=>Fe.type==="charge"&&M(Fe)).reduce((Fe,He)=>Fe+Math.abs(parseFloat(He.montant||0)),0),Et=Ye*Ue,jr=nt*Ue,mn=Se.filter(Fe=>Fe.type!=="charge"&&W(Fe)).reduce((Fe,He)=>Fe+Math.abs(parseFloat(He.montant||0)),0),St=se===_&&w[u.id]||0,pr=St+mn-Et-jr;return{charges:Et,depots:mn,frais:jr,soldeFinal:pr,ran:St,pourcentage:(Ue*100).toFixed(2),parts:Te,totalParts:Ee}},Z=T.useMemo(()=>Q(_),[_,X,w]),ye=T.useMemo(()=>u?m.filter(se=>se.proprietaire_id===u.id):[],[m,u]),I=T.useMemo(()=>{if(!u)return[];const se=d.reduce((Te,Ue)=>Te+(Ue.nombre_parts||Ue.milliemes||0),0),Se=u.nombre_parts||u.milliemes||0,Ee=se>0?Se/se:0;return X.map(Te=>{const Ue=Te.type==="charge",Ye=Math.abs(parseFloat(Te.montant||0)),nt=Ue?Ye*Ee:Ye,Et=Ue?M(Te)?"Frais":"Charge":"Dpt";return{...Te,type:Ue?M(Te)?"frais":"charge":"depot",displayType:Et,montantTotal:Ue?Ye:null,montantProprietaire:nt,dateFormatted:Ae(Te.date_transaction||Te.date_comptabilisation)}}).sort((Te,Ue)=>{const Ye=new Date(Te.date_transaction||Te.date_comptabilisation);return new Date(Ue.date_transaction||Ue.date_comptabilisation)-Ye})},[u,d,X]),ve=se=>new Intl.NumberFormat("fr-BE",{minimumFractionDigits:2,maximumFractionDigits:2}).format(se||0)+" ",Ae=se=>se?new Date(se).toLocaleDateString("fr-BE"):"-",Ie=()=>{const se=I.map(Te=>({Date:Te.dateFormatted,Description:Te.description||Te.communication||"",Type:Te.displayType,"Montant total":Te.montantTotal?ve(Te.montantTotal):"-","Ma part":ve(Te.montantProprietaire)}));se.push({}),se.push({Date:"",Description:"RCAPITULATIF",Type:"","Montant total":"","Ma part":""}),Z.ran!==0&&se.push({Date:"",Description:"Report  Nouveau",Type:"","Montant total":"","Ma part":ve(Z.ran)}),se.push({Date:"",Description:"Total Dpts",Type:"","Montant total":"","Ma part":ve(Z.depots)}),se.push({Date:"",Description:"Total Charges",Type:"","Montant total":"","Ma part":ve(-Z.charges)}),se.push({Date:"",Description:"Total Frais",Type:"","Montant total":"","Ma part":ve(-Z.frais)}),se.push({Date:"",Description:"SOLDE FINAL",Type:"","Montant total":"","Ma part":ve(Z.soldeFinal)});const Se=Mt.json_to_sheet(se),Ee=Mt.book_new();Mt.book_append_sheet(Ee,Se,`Dcompte ${_}`),Eo(Ee,`decompte_${u.nom}_${_}.xlsx`)},be=()=>{window.print()};if(n)return i.jsx("div",{className:"flex items-center justify-center min-h-96",children:i.jsx(kr,{className:"h-8 w-8 animate-spin text-primary-600"})});if(s||!u)return i.jsxs("div",{className:"text-center py-12",children:[i.jsx(st,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s||"Propritaire introuvable"}),i.jsx("button",{onClick:()=>r(`/immeubles/${e}`),className:"mt-4 text-primary-600 hover:text-primary-700",children:"Retour  l'immeuble"})]});const de=Z.ran!==0;return i.jsxs("div",{className:"max-w-5xl mx-auto p-4 sm:p-6",children:[i.jsx("style",{children:`
        @media print {
          body * { visibility: hidden; }
          .print-area, .print-area * { visibility: visible; }
          .print-area { position: absolute; left: 0; top: 0; width: 100%; }
          .no-print { display: none !important; }
        }
      `}),i.jsxs("div",{className:"flex items-center justify-between mb-6 no-print",children:[i.jsxs("button",{onClick:()=>r(`/immeubles/${e}`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900",children:[i.jsx(Vn,{className:"h-5 w-5"}),i.jsx("span",{children:"Retour  l'immeuble"})]}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("button",{onClick:()=>K(!0),className:"flex items-center gap-2 px-3 py-2 border rounded-lg hover:bg-gray-50",children:[i.jsx(po,{className:"h-4 w-4"}),"Modifier"]})})]}),i.jsx("div",{className:`bg-white rounded-xl shadow-sm border-l-4 ${F.border} p-4 sm:p-6 mb-6`,children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:`w-14 h-14 ${F.bg} rounded-full flex items-center justify-center flex-shrink-0`,children:i.jsx(qc,{className:`h-8 w-8 ${F.text}`})}),i.jsxs("div",{children:[i.jsxs("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:[u.prenom," ",u.nom]}),i.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 mt-2 text-sm text-gray-600",children:[u.email&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(bi,{className:"h-4 w-4"}),u.email]}),u.telephone&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Ni,{className:"h-4 w-4"}),u.telephone]})]}),i.jsx("div",{className:"mt-2",children:i.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${F.bg} ${F.text}`,children:[Z.parts,"/",Z.totalParts," millimes (",Z.pourcentage,"%)"]})})]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("p",{className:"text-sm text-gray-500",children:["Solde ",_]}),i.jsx("p",{className:`text-2xl font-bold ${Z.soldeFinal>=0?"text-green-600":"text-red-600"}`,children:ve(Z.soldeFinal)}),Z.soldeFinal>=0?i.jsxs("span",{className:"text-sm text-green-600 flex items-center justify-end gap-1",children:[i.jsx(jn,{className:"h-4 w-4"}),"  jour"]}):i.jsxs("span",{className:"text-sm text-red-600 flex items-center justify-end gap-1",children:[i.jsx(xo,{className:"h-4 w-4"}),"  rgulariser"]})]})]})}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[i.jsxs("div",{className:"border-b flex no-print",children:[i.jsxs("button",{onClick:()=>L("decompte"),className:`flex-1 px-4 py-3 text-sm font-medium ${j==="decompte"?"text-primary-600 border-b-2 border-primary-600 bg-primary-50":"text-gray-500 hover:text-gray-700"}`,children:[i.jsx(Hk,{className:"h-4 w-4 inline mr-2"}),"Dcompte ",_]}),i.jsxs("button",{onClick:()=>L("historique"),className:`flex-1 px-4 py-3 text-sm font-medium ${j==="historique"?"text-primary-600 border-b-2 border-primary-600 bg-primary-50":"text-gray-500 hover:text-gray-700"}`,children:[i.jsx(fn,{className:"h-4 w-4 inline mr-2"}),"Historique"]}),i.jsxs("button",{onClick:()=>L("locataires"),className:`flex-1 px-4 py-3 text-sm font-medium ${j==="locataires"?"text-primary-600 border-b-2 border-primary-600 bg-primary-50":"text-gray-500 hover:text-gray-700"}`,children:[i.jsx(Vt,{className:"h-4 w-4 inline mr-2"}),"Locataires (",ye.length,")"]})]}),j==="decompte"&&i.jsxs("div",{className:"print-area",ref:ue,children:[i.jsxs("div",{className:"p-4 bg-gray-50 border-b flex flex-wrap items-center justify-between gap-3 no-print",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Anne :"}),i.jsx("div",{className:"flex gap-1",children:G.map(se=>i.jsx("button",{onClick:()=>E(se),className:`px-3 py-1 text-sm rounded-lg ${_===se?"bg-primary-600 text-white":"bg-white border hover:bg-gray-100"}`,children:se},se))})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:Ie,className:"flex items-center gap-1 px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-100",children:[i.jsx(L0,{className:"h-4 w-4"}),"Excel"]}),i.jsxs("button",{onClick:be,className:"flex items-center gap-1 px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-100",children:[i.jsx(uh,{className:"h-4 w-4"}),"PDF"]})]})]}),i.jsxs("div",{className:"hidden print:block p-6 border-b",children:[i.jsxs("h1",{className:"text-xl font-bold",children:["Dcompte Annuel ",_]}),i.jsxs("p",{className:"text-gray-600",children:[u.prenom," ",u.nom," - ",o==null?void 0:o.nom]}),i.jsxs("p",{className:"text-sm text-gray-500",children:[Z.parts,"/",Z.totalParts," millimes (",Z.pourcentage,"%)"]})]}),i.jsxs("div",{className:"p-4 sm:p-6",children:[i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[i.jsxs("h3",{className:"font-medium text-gray-700 mb-3",children:["Rcapitulatif ",_]}),i.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 text-sm",children:[de&&i.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Report (RAN)"}),i.jsx("p",{className:`font-bold ${Z.ran>=0?"text-blue-600":"text-orange-600"}`,children:ve(Z.ran)})]}),i.jsxs("div",{className:"p-3 bg-green-50 rounded-lg text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Dpts"}),i.jsxs("p",{className:"font-bold text-green-600",children:["+",ve(Z.depots)]})]}),i.jsxs("div",{className:"p-3 bg-red-50 rounded-lg text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Charges"}),i.jsxs("p",{className:"font-bold text-red-600",children:["-",ve(Z.charges)]})]}),i.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Frais"}),i.jsxs("p",{className:"font-bold text-amber-600",children:["-",ve(Z.frais)]})]})]}),i.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:i.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 text-sm font-mono",children:[de&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:Z.ran>=0?"text-blue-600":"text-orange-600",children:ve(Z.ran)}),i.jsx("span",{children:"+"})]}),i.jsx("span",{className:"text-green-600",children:ve(Z.depots)}),i.jsx("span",{children:"-"}),i.jsx("span",{className:"text-red-600",children:ve(Z.charges+Z.frais)}),i.jsx("span",{children:"="}),i.jsx("span",{className:`font-bold text-lg ${Z.soldeFinal>=0?"text-green-600":"text-red-600"}`,children:ve(Z.soldeFinal)})]})})]}),i.jsxs("h3",{className:"font-medium text-gray-700 mb-3",children:["Dtail des mouvements (",I.length,")"]}),I.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(bs,{className:"h-12 w-12 mx-auto text-gray-300 mb-2"}),i.jsxs("p",{children:["Aucun mouvement pour ",_]})]}):i.jsx("div",{className:"overflow-x-auto border rounded-lg",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-500",children:"Date"}),i.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-500",children:"Description"}),i.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-500",children:"Type"}),i.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:"Total"}),i.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:"Ma part"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-100",children:I.map(se=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-gray-600",children:se.dateFormatted}),i.jsx("td",{className:"px-3 py-2",children:i.jsx("div",{className:"truncate max-w-[250px]",title:se.description||se.communication,children:se.description||se.communication||"-"})}),i.jsx("td",{className:"px-3 py-2 text-center",children:i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded ${se.type==="depot"?"bg-green-100 text-green-700":se.type==="frais"?"bg-amber-100 text-amber-700":"bg-red-100 text-red-700"}`,children:se.displayType})}),i.jsx("td",{className:"px-3 py-2 text-right text-gray-500",children:se.montantTotal?ve(se.montantTotal):"-"}),i.jsxs("td",{className:`px-3 py-2 text-right font-medium ${se.type==="depot"?"text-green-600":"text-red-600"}`,children:[se.type==="depot"?"+":"-",ve(se.montantProprietaire)]})]},se.id))}),i.jsx("tfoot",{className:"bg-gray-100",children:i.jsxs("tr",{className:"font-semibold",children:[i.jsx("td",{colSpan:"4",className:"px-3 py-2 text-right",children:"SOLDE FINAL"}),i.jsx("td",{className:`px-3 py-2 text-right ${Z.soldeFinal>=0?"text-green-600":"text-red-600"}`,children:ve(Z.soldeFinal)})]})})]})}),i.jsx("div",{className:"hidden print:block mt-8 pt-4 border-t text-sm text-gray-500",children:i.jsxs("p",{children:["Document gnr le ",new Date().toLocaleDateString("fr-BE")," - Copro Manager"]})})]})]}),j==="historique"&&i.jsxs("div",{className:"p-4 sm:p-6",children:[i.jsx("h3",{className:"font-medium text-gray-700 mb-4",children:"Historique complet"}),G.map(se=>{const Se=Q(se),Ee=ie(se);if(Ee.length===0)return null;const Te=N[se];return i.jsxs("div",{className:"mb-3 border rounded-lg overflow-hidden",children:[i.jsxs("button",{onClick:()=>R(Ue=>({...Ue,[se]:!Ue[se]})),className:"w-full p-4 bg-gray-50 flex items-center justify-between hover:bg-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"text-lg font-semibold",children:se}),i.jsxs("span",{className:"text-sm text-gray-500",children:["(",Ee.length," mouvements)"]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("span",{className:`font-semibold ${Se.soldeFinal>=0?"text-green-600":"text-red-600"}`,children:ve(Se.soldeFinal)}),Te?i.jsx(oh,{className:"h-5 w-5"}):i.jsx(lh,{className:"h-5 w-5"})]})]}),Te&&i.jsxs("div",{className:"p-4 border-t",children:[i.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[i.jsxs("div",{className:"p-2 bg-red-50 rounded text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Charges"}),i.jsx("p",{className:"font-bold text-red-600",children:ve(Se.charges)})]}),i.jsxs("div",{className:"p-2 bg-green-50 rounded text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Dpts"}),i.jsx("p",{className:"font-bold text-green-600",children:ve(Se.depots)})]}),i.jsxs("div",{className:`p-2 rounded text-center ${Se.soldeFinal>=0?"bg-green-100":"bg-red-100"}`,children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Solde"}),i.jsx("p",{className:`font-bold ${Se.soldeFinal>=0?"text-green-600":"text-red-600"}`,children:ve(Se.soldeFinal)})]})]}),i.jsx("button",{onClick:()=>{E(se),L("decompte")},className:"w-full text-center text-sm text-primary-600 hover:text-primary-700 py-2",children:"Voir le dtail complet "})]})]},se)})]}),j==="locataires"&&i.jsxs("div",{className:"p-4 sm:p-6",children:[i.jsx("h3",{className:"font-medium text-gray-700 mb-4",children:"Locataires du propritaire"}),ye.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(Vt,{className:"h-12 w-12 mx-auto text-gray-300 mb-2"}),i.jsx("p",{children:"Aucun locataire enregistr"})]}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ye.map(se=>i.jsx("div",{className:"border rounded-lg p-4 hover:shadow-md cursor-pointer",onClick:()=>r(`/immeubles/${e}/locataires/${se.id}`),children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-medium text-gray-900",children:[se.prenom," ",se.nom]}),se.email&&i.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-1 mt-1",children:[i.jsx(bi,{className:"h-3 w-3"}),se.email]}),se.telephone&&i.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-1 mt-1",children:[i.jsx(Ni,{className:"h-3 w-3"}),se.telephone]})]}),se.nombre_habitants&&i.jsxs("span",{className:"px-2 py-1 bg-gray-100 rounded text-sm",children:[se.nombre_habitants," hab."]})]})},se.id))})]})]}),V&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[i.jsx("h2",{className:"text-lg font-semibold",children:"Modifier le profil"}),i.jsx("button",{onClick:()=>K(!1),className:"p-1 hover:bg-gray-100 rounded",children:i.jsx(br,{className:"h-5 w-5"})})]}),i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prnom"}),i.jsx("input",{type:"text",value:Y.prenom||"",onChange:se=>H({...Y,prenom:se.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom"}),i.jsx("input",{type:"text",value:Y.nom||"",onChange:se=>H({...Y,nom:se.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{type:"email",value:Y.email||"",onChange:se=>H({...Y,email:se.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tlphone"}),i.jsx("input",{type:"tel",value:Y.telephone||"",onChange:se=>H({...Y,telephone:se.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adresse"}),i.jsx("input",{type:"text",value:Y.adresse||"",onChange:se=>H({...Y,adresse:se.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Millimes / Parts"}),i.jsx("input",{type:"number",value:Y.nombre_parts||Y.milliemes||"",onChange:se=>H({...Y,nombre_parts:parseInt(se.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]})]}),i.jsxs("div",{className:"p-4 border-t flex gap-2",children:[i.jsxs("button",{onClick:S,disabled:B,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:[B?i.jsx(kr,{className:"h-4 w-4 animate-spin"}):i.jsx(Hn,{className:"h-4 w-4"}),"Sauvegarder"]}),i.jsx("button",{onClick:()=>K(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Annuler"})]})]})})]})}function TR(){const{id:e,locId:t}=Wn(),r=Kt(),[n,a]=T.useState(!0),[s,l]=T.useState(null),[o,c]=T.useState(null),[u,f]=T.useState(null),[d,h]=T.useState(null),[y,g]=T.useState([]);T.useEffect(()=>{m()},[e,t]);const m=async()=>{var v;try{a(!0),l(null);const[w,b,_]=await Promise.all([Lr.getOne(e),Oa.getOne(e,t),wi.getByImmeuble(e)]);c(w.data.immeuble),f(b.data.locataire);const E=_.data.compteurs||[];if(g(E.filter(N=>N.locataire_id===parseInt(t))),(v=b.data.locataire)!=null&&v.proprietaire_id)try{const N=await Xr.getOne(e,b.data.locataire.proprietaire_id);h(N.data.proprietaire)}catch{console.log("Propritaire not found")}}catch(w){console.error("Error loading data:",w),l("Erreur lors du chargement des donnes")}finally{a(!1)}},p=v=>v?new Date(v).toLocaleDateString("fr-BE"):"-";if(n)return i.jsx("div",{className:"flex items-center justify-center min-h-96",children:i.jsx(kr,{className:"h-8 w-8 animate-spin text-primary-600"})});if(s||!u)return i.jsxs("div",{className:"text-center py-12",children:[i.jsx(st,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s||"Locataire introuvable"}),i.jsx("button",{onClick:()=>r(`/immeubles/${e}`),className:"mt-4 text-primary-600 hover:text-primary-700",children:"Retour  l'immeuble"})]});const x=`${u.prenom||""} ${u.nom}`.trim();return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("button",{onClick:()=>r(`/immeubles/${e}`),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors mt-1",children:i.jsx(Vn,{className:"h-5 w-5"})}),i.jsx("div",{className:"w-2 h-16 rounded bg-green-500"}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:x}),i.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mt-1",children:[i.jsx(fr,{className:"h-4 w-4"}),i.jsx("span",{children:o==null?void 0:o.nom})]}),i.jsxs("div",{className:"flex flex-wrap gap-3 mt-3 text-sm",children:[i.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full bg-green-100 text-green-800",children:[i.jsx(Vt,{className:"h-3.5 w-3.5 mr-1.5"}),"Locataire"]}),u.nombre_habitants>0&&i.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full bg-blue-100 text-blue-800",children:[i.jsx(Wl,{className:"h-3.5 w-3.5 mr-1.5"}),u.nombre_habitants," habitant",u.nombre_habitants>1?"s":""]})]})]})]}),i.jsx("button",{onClick:()=>r(`/immeubles/${e}/locataires/${t}/edit`),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Modifier",children:i.jsx(po,{className:"h-5 w-5 text-gray-500"})})]}),i.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.email&&i.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[i.jsx(bi,{className:"h-4 w-4"}),i.jsx("a",{href:`mailto:${u.email}`,className:"hover:text-primary-600",children:u.email})]}),u.telephone&&i.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[i.jsx(Ni,{className:"h-4 w-4"}),i.jsx("a",{href:`tel:${u.telephone}`,className:"hover:text-primary-600",children:u.telephone})]}),u.date_entree&&i.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[i.jsx(fn,{className:"h-4 w-4"}),i.jsxs("span",{children:["Entre: ",p(u.date_entree)]})]})]})]}),d&&i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(qc,{className:"h-5 w-5 text-purple-600"}),"Propritaire"]}),i.jsx("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer hover:border-purple-300",onClick:()=>r(`/immeubles/${e}/proprietaires/${d.id}`),children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"font-medium text-gray-900",children:[d.prenom," ",d.nom]}),i.jsxs("div",{className:"flex flex-wrap gap-4 mt-2 text-sm text-gray-600",children:[d.email&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(bi,{className:"h-3 w-3"}),d.email]}),d.telephone&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Ni,{className:"h-3 w-3"}),d.telephone]})]})]}),i.jsx("span",{className:"text-sm text-primary-600",children:"Voir le dcompte "})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(zn,{className:"h-5 w-5 text-cyan-600"}),"Compteurs d'eau"]}),y.length===0?i.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-300 rounded-lg",children:[i.jsx(zn,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-500",children:"Aucun compteur assign"})]}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map(v=>i.jsxs("div",{className:"border rounded-lg p-4 bg-cyan-50 border-cyan-200",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"font-medium text-cyan-800",children:v.numero_compteur||`Compteur #${v.id}`}),i.jsx("span",{className:"px-2 py-1 bg-cyan-100 text-cyan-700 rounded text-xs",children:v.type_compteur||"Individuel"})]}),v.emplacement&&i.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[i.jsx(M0,{className:"h-3 w-3 inline mr-1"}),v.emplacement]}),v.dernier_releve!==void 0&&i.jsxs("div",{className:"mt-2 pt-2 border-t border-cyan-200",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Dernier relev"}),i.jsxs("p",{className:"font-semibold text-cyan-700",children:[v.dernier_releve," m"]}),v.date_dernier_releve&&i.jsx("p",{className:"text-xs text-gray-400",children:p(v.date_dernier_releve)})]})]},v.id))})]}),u.notes&&i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[i.jsx(bs,{className:"h-5 w-5 text-gray-600"}),"Notes"]}),i.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:u.notes})]})]})}const Qp=[{border:"border-l-cyan-500",bg:"bg-cyan-50",text:"text-cyan-700"},{border:"border-l-purple-500",bg:"bg-purple-50",text:"text-purple-700"},{border:"border-l-amber-500",bg:"bg-amber-50",text:"text-amber-700"},{border:"border-l-emerald-500",bg:"bg-emerald-50",text:"text-emerald-700"},{border:"border-l-rose-500",bg:"bg-rose-50",text:"text-rose-700"},{border:"border-l-blue-500",bg:"bg-blue-50",text:"text-blue-700"},{border:"border-l-orange-500",bg:"bg-orange-50",text:"text-orange-700"},{border:"border-l-indigo-500",bg:"bg-indigo-50",text:"text-indigo-700"}];function CR(){const{immeubleId:e}=Wn(),t=Kt(),[r,n]=T.useState(!0),[a,s]=T.useState(null),[l,o]=T.useState(null),[c,u]=T.useState([]),[f,d]=T.useState([]),[h,y]=T.useState(new Date().getFullYear()),[g,m]=T.useState({}),[p,x]=T.useState([]),[v,w]=T.useState(!1);T.useRef(null);const b=new Date().getFullYear(),_=[b,b-1,b-2,b-3,b-4];T.useEffect(()=>{E()},[e]);const E=async()=>{try{n(!0),s(null);const[U,S,z]=await Promise.all([Lr.getOne(e),Xr.getByImmeuble(e),is.getAll(e,{limit:1e3})]);o(U.data.immeuble),u(S.data.proprietaires||[]),d(z.data.transactions||[]),x((S.data.proprietaires||[]).map(F=>F.id))}catch(U){console.error("Error loading data:",U),s("Erreur lors du chargement des donnes")}finally{n(!1)}},N=U=>{const S=(U.description||U.communication||"").toLowerCase();return S.includes("frais")||S.includes("non-execute")||S.includes("non execute")||S.includes("participation aux frais")},R=T.useMemo(()=>f.filter(U=>{const S=U.date_transaction||U.date_comptabilisation||U.created_at;return S?new Date(S).getFullYear()===h:!1}),[f,h]),j=T.useMemo(()=>{const U=c.reduce((F,M)=>F+(M.nombre_parts||M.milliemes||0),0),S=R.filter(F=>F.type==="charge"&&!N(F)).reduce((F,M)=>F+Math.abs(parseFloat(M.montant||0)),0),z=R.filter(F=>F.type==="charge"&&N(F)).reduce((F,M)=>F+Math.abs(parseFloat(M.montant||0)),0);return R.filter(F=>F.type!=="charge").reduce((F,M)=>F+Math.abs(parseFloat(M.montant||0)),0),c.map((F,M)=>{const W=F.nombre_parts||F.milliemes||0,ie=U>0?W/U:0,X=S*ie,Q=z*ie,Z=R.filter(ve=>{if(ve.type==="charge")return!1;const Ae=(ve.nom_contrepartie||"").toLowerCase(),Ie=(ve.communication||ve.description||"").toLowerCase();return Ae.includes(F.nom.toLowerCase())||Ie.includes(F.nom.toLowerCase())}).reduce((ve,Ae)=>ve+Math.abs(parseFloat(Ae.montant||0)),0),ye=Z-X-Q,I=R.map(ve=>{const Ae=ve.type==="charge",Ie=Math.abs(parseFloat(ve.montant||0));if(!Ae){const be=(ve.nom_contrepartie||"").toLowerCase(),de=(ve.communication||ve.description||"").toLowerCase();return be.includes(F.nom.toLowerCase())||de.includes(F.nom.toLowerCase())?{...ve,montantProprietaire:Ie,type:"depot",displayType:"Dpt"}:null}return{...ve,montantProprietaire:Ie*ie,montantTotal:Ie,type:N(ve)?"frais":"charge",displayType:N(ve)?"Frais":"Charge"}}).filter(Boolean).sort((ve,Ae)=>{const Ie=new Date(ve.date_transaction||ve.date_comptabilisation),be=new Date(Ae.date_transaction||Ae.date_comptabilisation);return Ie-be});return{id:F.id,nom:`${F.prenom||""} ${F.nom}`.trim(),email:F.email,telephone:F.telephone,adresse:F.adresse,parts:W,totalParts:U,pourcentage:(ie*100).toFixed(2),charges:X,frais:Q,depots:Z,soldeFinal:ye,statut:ye>=0?"a_jour":"attention",transactions:I,color:Qp[M%Qp.length]}})},[c,R]),L=T.useMemo(()=>j.reduce((U,S)=>({charges:U.charges+S.charges,frais:U.frais+S.frais,depots:U.depots+S.depots,soldeFinal:U.soldeFinal+S.soldeFinal}),{charges:0,frais:0,depots:0,soldeFinal:0}),[j]),V=U=>new Intl.NumberFormat("fr-BE",{minimumFractionDigits:2,maximumFractionDigits:2}).format(U||0)+" ",K=U=>U?new Date(U).toLocaleDateString("fr-BE"):"-",Y=U=>{m(S=>({...S,[U]:!S[U]}))},H=U=>{x(S=>S.includes(U)?S.filter(z=>z!==U):[...S,U])},B=()=>{x(j.map(U=>U.id))},J=()=>{x([])},ue=()=>{const U=Mt.book_new(),S=[["DCOMPTE ANNUEL - "+(l==null?void 0:l.nom)],["Anne: "+h],[""],["Propritaire","Millimes","%","Charges","Frais","Dpts","Solde","Statut"]];j.forEach(F=>{p.includes(F.id)&&S.push([F.nom,`${F.parts}/${F.totalParts}`,F.pourcentage+"%",V(F.charges),V(F.frais),V(F.depots),V(F.soldeFinal),F.statut==="a_jour"?" jour":"Attention"])}),S.push([]),S.push(["TOTAUX","","",V(L.charges),V(L.frais),V(L.depots),V(L.soldeFinal)]);const z=Mt.aoa_to_sheet(S);Mt.book_append_sheet(U,z,"Rsum"),j.forEach(F=>{if(p.includes(F.id)){const M=[[`DCOMPTE ${h} - ${F.nom}`],[`Millimes: ${F.parts}/${F.totalParts} (${F.pourcentage}%)`],[""],["Date","Description","Type","Total","Quote-part"]];F.transactions.forEach(X=>{M.push([K(X.date_transaction||X.date_comptabilisation),X.description||X.communication||"-",X.displayType,X.montantTotal?V(X.montantTotal):"-",(X.type==="depot"?"+":"-")+V(X.montantProprietaire)])}),M.push([]),M.push(["","","","Charges:",V(F.charges)]),M.push(["","","","Frais:",V(F.frais)]),M.push(["","","","Dpts:",V(F.depots)]),M.push(["","","","SOLDE:",V(F.soldeFinal)]);const W=Mt.aoa_to_sheet(M),ie=F.nom.substring(0,31).replace(/[\\\/\*\?\[\]]/g,"");Mt.book_append_sheet(U,W,ie)}}),Eo(U,`decomptes_${l==null?void 0:l.nom}_${h}.xlsx`)},le=()=>{w(!0),setTimeout(()=>{window.print()},100)};if(r)return i.jsx("div",{className:"flex items-center justify-center min-h-96",children:i.jsx(kr,{className:"h-8 w-8 animate-spin text-primary-600"})});if(a)return i.jsxs("div",{className:"text-center py-12",children:[i.jsx(st,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:a})]});const G=j.filter(U=>U.statut==="a_jour").length,q=j.filter(U=>U.statut==="attention").length;return i.jsxs("div",{className:"space-y-6",children:[i.jsx("style",{children:`
        @media screen {
          #print-area { display: none; }
        }
        @media print {
          body { margin: 0; padding: 0; }
          .no-print { display: none !important; }
          #print-area { display: block !important; }
          .print-break { page-break-before: always; }
          .print-avoid-break { page-break-inside: avoid; }
        }
      `}),i.jsx("div",{className:"bg-white rounded-lg shadow p-6 no-print",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:()=>t(`/immeubles/${e}`),className:"p-2 hover:bg-gray-100 rounded-lg",children:i.jsx(Vn,{className:"h-5 w-5"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dcomptes Annuels"}),i.jsxs("p",{className:"text-gray-600 flex items-center gap-2",children:[i.jsx(fr,{className:"h-4 w-4"}),l==null?void 0:l.nom]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(fn,{className:"h-5 w-5 text-gray-400"}),i.jsx("select",{value:h,onChange:U=>y(parseInt(U.target.value)),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white font-semibold text-primary-700",children:_.map(U=>i.jsx("option",{value:U,children:U},U))})]})]})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 no-print",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow p-4 text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Propritaires"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.length})]}),i.jsxs("div",{className:"bg-red-50 rounded-lg shadow p-4 text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Total Charges"}),i.jsx("p",{className:"text-xl font-bold text-red-600",children:V(L.charges)})]}),i.jsxs("div",{className:"bg-green-50 rounded-lg shadow p-4 text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Total Dpts"}),i.jsx("p",{className:"text-xl font-bold text-green-600",children:V(L.depots)})]}),i.jsxs("div",{className:"bg-green-50 rounded-lg shadow p-4 text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:" jour"}),i.jsx("p",{className:"text-2xl font-bold text-green-600",children:G})]}),i.jsxs("div",{className:"bg-amber-50 rounded-lg shadow p-4 text-center",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Attention"}),i.jsx("p",{className:"text-2xl font-bold text-amber-600",children:q})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-4 no-print",children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("span",{className:"text-sm text-gray-600",children:[p.length,"/",j.length," slectionns"]}),i.jsx("button",{onClick:B,className:"text-sm text-primary-600 hover:text-primary-700",children:"Tout slectionner"}),i.jsx("button",{onClick:J,className:"text-sm text-gray-500 hover:text-gray-700",children:"Aucun"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:ue,disabled:p.length===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:[i.jsx(L0,{className:"h-4 w-4"}),"Export Excel"]}),i.jsxs("button",{onClick:le,disabled:p.length===0,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:[i.jsx(uh,{className:"h-4 w-4"}),"Imprimer PDF"]})]})]})}),i.jsx("div",{className:"space-y-4 no-print",children:j.map(U=>i.jsxs("div",{className:`bg-white rounded-lg shadow overflow-hidden ${U.soldeFinal<0?"border-l-4 border-red-500":""}`,children:[i.jsxs("div",{className:"p-4 flex items-center gap-4",children:[i.jsx("input",{type:"checkbox",checked:p.includes(U.id),onChange:()=>H(U.id),className:"h-5 w-5 text-primary-600 rounded"}),i.jsx("div",{className:`w-1 h-12 rounded ${U.color.border.replace("border-l-","bg-")}`}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:U.nom}),U.statut==="a_jour"?i.jsx(jn,{className:"h-4 w-4 text-green-500"}):i.jsx(xo,{className:"h-4 w-4 text-amber-500"})]}),i.jsxs("p",{className:"text-sm text-gray-500",children:[U.parts,"/",U.totalParts," millimes (",U.pourcentage,"%)"]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("p",{className:`text-xl font-bold ${U.soldeFinal>=0?"text-green-600":"text-red-600"}`,children:V(U.soldeFinal)}),i.jsxs("p",{className:"text-xs text-gray-500",children:["Solde ",h]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>t(`/immeubles/${e}/proprietaires/${U.id}`),className:"p-2 text-primary-600 hover:bg-primary-50 rounded-lg",title:"Voir le dtail",children:i.jsx(O0,{className:"h-5 w-5"})}),i.jsx("button",{onClick:()=>Y(U.id),className:"p-2 hover:bg-gray-100 rounded-lg",children:g[U.id]?i.jsx(oh,{className:"h-5 w-5"}):i.jsx(lh,{className:"h-5 w-5"})})]})]}),g[U.id]&&i.jsxs("div",{className:"border-t bg-gray-50 p-4",children:[i.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[i.jsxs("div",{className:"text-center p-2 bg-white rounded",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Charges"}),i.jsx("p",{className:"font-bold text-red-600",children:V(U.charges)})]}),i.jsxs("div",{className:"text-center p-2 bg-white rounded",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Frais"}),i.jsx("p",{className:"font-bold text-amber-600",children:V(U.frais)})]}),i.jsxs("div",{className:"text-center p-2 bg-white rounded",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Dpts"}),i.jsx("p",{className:"font-bold text-green-600",children:V(U.depots)})]}),i.jsxs("div",{className:`text-center p-2 rounded ${U.soldeFinal>=0?"bg-green-100":"bg-red-100"}`,children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Solde"}),i.jsx("p",{className:`font-bold ${U.soldeFinal>=0?"text-green-600":"text-red-600"}`,children:V(U.soldeFinal)})]})]}),U.transactions.length>0&&i.jsxs("div",{className:"bg-white rounded-lg overflow-hidden",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Date"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Description"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Type"}),i.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500",children:"Quote-part"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:U.transactions.slice(0,10).map((S,z)=>i.jsxs("tr",{className:S.type==="depot"?"bg-green-50/50":S.type==="frais"?"bg-amber-50/50":"bg-red-50/50",children:[i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-gray-600",children:K(S.date_transaction||S.date_comptabilisation)}),i.jsx("td",{className:"px-3 py-2",children:i.jsx("span",{className:"truncate block max-w-xs",title:S.description||S.communication,children:S.description||S.communication||"-"})}),i.jsx("td",{className:"px-3 py-2",children:i.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${S.type==="depot"?"bg-green-500 text-white":S.type==="frais"?"bg-amber-500 text-white":"bg-red-500 text-white"}`,children:S.displayType})}),i.jsxs("td",{className:`px-3 py-2 text-right font-medium ${S.type==="depot"?"text-green-600":"text-red-600"}`,children:[S.type==="depot"?"+":"-",V(S.montantProprietaire)]})]},z))})]}),U.transactions.length>10&&i.jsxs("div",{className:"p-2 text-center text-sm text-gray-500 bg-gray-50",children:["+",U.transactions.length-10," autres transactions"]})]})]})]},U.id))}),i.jsxs("div",{id:"print-area",children:[i.jsxs("div",{className:"p-8",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("h1",{className:"text-3xl font-bold",children:l==null?void 0:l.nom}),i.jsx("p",{className:"text-gray-600",children:l==null?void 0:l.adresse}),i.jsx("div",{className:"mt-6 inline-block px-6 py-2 bg-primary-100 rounded-lg",children:i.jsxs("p",{className:"text-2xl font-bold text-primary-700",children:["Dcomptes de charges ",h]})})]}),i.jsxs("div",{className:"mt-8",children:[i.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Rsum gnral"}),i.jsxs("table",{className:"w-full border-collapse border",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-100",children:[i.jsx("th",{className:"border p-2 text-left",children:"Propritaire"}),i.jsx("th",{className:"border p-2 text-center",children:"Millimes"}),i.jsx("th",{className:"border p-2 text-right",children:"Charges"}),i.jsx("th",{className:"border p-2 text-right",children:"Dpts"}),i.jsx("th",{className:"border p-2 text-right",children:"Solde"})]})}),i.jsx("tbody",{children:j.filter(U=>p.includes(U.id)).map(U=>i.jsxs("tr",{children:[i.jsx("td",{className:"border p-2",children:U.nom}),i.jsxs("td",{className:"border p-2 text-center",children:[U.parts,"/",U.totalParts]}),i.jsx("td",{className:"border p-2 text-right",children:V(U.charges+U.frais)}),i.jsx("td",{className:"border p-2 text-right",children:V(U.depots)}),i.jsx("td",{className:`border p-2 text-right font-bold ${U.soldeFinal>=0?"text-green-700":"text-red-700"}`,children:V(U.soldeFinal)})]},U.id))}),i.jsx("tfoot",{children:i.jsxs("tr",{className:"bg-gray-100 font-bold",children:[i.jsx("td",{className:"border p-2",children:"TOTAUX"}),i.jsx("td",{className:"border p-2"}),i.jsx("td",{className:"border p-2 text-right",children:V(L.charges+L.frais)}),i.jsx("td",{className:"border p-2 text-right",children:V(L.depots)}),i.jsx("td",{className:`border p-2 text-right ${L.soldeFinal>=0?"text-green-700":"text-red-700"}`,children:V(L.soldeFinal)})]})})]})]}),i.jsx("div",{className:"mt-8 text-sm text-gray-500",children:i.jsxs("p",{children:["Document gnr le ",new Date().toLocaleDateString("fr-BE")]})})]}),j.filter(U=>p.includes(U.id)).map((U,S)=>i.jsx("div",{className:S>0?"print-break":"",children:i.jsxs("div",{className:"p-8 print-avoid-break",children:[i.jsxs("div",{className:"flex justify-between items-start mb-6",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold",children:U.nom}),i.jsxs("p",{className:"text-gray-600",children:[U.parts,"/",U.totalParts," millimes (",U.pourcentage,"%)"]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("p",{className:"text-sm text-gray-500",children:["Dcompte ",h]}),i.jsx("p",{className:"text-xl font-bold",children:l==null?void 0:l.nom})]})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6 text-center",children:[i.jsxs("div",{className:"p-3 bg-gray-100 rounded",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Charges"}),i.jsx("p",{className:"font-bold",children:V(U.charges)})]}),i.jsxs("div",{className:"p-3 bg-gray-100 rounded",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Frais"}),i.jsx("p",{className:"font-bold",children:V(U.frais)})]}),i.jsxs("div",{className:"p-3 bg-gray-100 rounded",children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Dpts"}),i.jsx("p",{className:"font-bold",children:V(U.depots)})]}),i.jsxs("div",{className:`p-3 rounded ${U.soldeFinal>=0?"bg-green-100":"bg-red-100"}`,children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Solde"}),i.jsx("p",{className:`font-bold ${U.soldeFinal>=0?"text-green-700":"text-red-700"}`,children:V(U.soldeFinal)})]})]}),i.jsxs("table",{className:"w-full border-collapse border text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-100",children:[i.jsx("th",{className:"border p-2 text-left",children:"Date"}),i.jsx("th",{className:"border p-2 text-left",children:"Description"}),i.jsx("th",{className:"border p-2 text-center",children:"Type"}),i.jsx("th",{className:"border p-2 text-right",children:"Total"}),i.jsx("th",{className:"border p-2 text-right",children:"Quote-part"})]})}),i.jsx("tbody",{children:U.transactions.map((z,F)=>i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1",children:K(z.date_transaction||z.date_comptabilisation)}),i.jsx("td",{className:"border p-1 max-w-xs truncate",children:z.description||z.communication||"-"}),i.jsx("td",{className:"border p-1 text-center",children:z.displayType}),i.jsx("td",{className:"border p-1 text-right",children:z.montantTotal?V(z.montantTotal):"-"}),i.jsxs("td",{className:`border p-1 text-right font-medium ${z.type==="depot"?"text-green-700":"text-red-700"}`,children:[z.type==="depot"?"+":"-",V(z.montantProprietaire)]})]},F))}),i.jsx("tfoot",{children:i.jsxs("tr",{className:"bg-gray-100 font-bold",children:[i.jsx("td",{colSpan:"4",className:"border p-2 text-right",children:"SOLDE FINAL"}),i.jsx("td",{className:`border p-2 text-right ${U.soldeFinal>=0?"text-green-700":"text-red-700"}`,children:V(U.soldeFinal)})]})})]})]})},U.id))]})]})}const Zp={brouillon:{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-300"},ouvert:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-300"},cloture:{bg:"bg-green-100",text:"text-green-700",border:"border-green-300"},archive:{bg:"bg-purple-100",text:"text-purple-700",border:"border-purple-300"}},FR={brouillon:"Brouillon",ouvert:"Ouvert",cloture:"Cltur",archive:"Archiv"};function eg(){const{immeubleId:e}=Wn(),t=Kt(),[r,n]=T.useState(!0),[a,s]=T.useState(null),[l,o]=T.useState(null),[c,u]=T.useState([]),[f,d]=T.useState([]),[h,y]=T.useState(null),[g,m]=T.useState(null),[p,x]=T.useState(!1),[v,w]=T.useState(!1),[b,_]=T.useState(""),[E,N]=T.useState({annee:new Date().getFullYear(),dateDebut:`${new Date().getFullYear()}-01-01`,dateFin:`${new Date().getFullYear()}-12-31`,budgetPrevisionnel:0,budgetFondsReserve:0});T.useEffect(()=>{R()},[e]);const R=async()=>{try{n(!0),s(null);const[B,J,ue]=await Promise.all([Lr.getOne(e),ii.getAll(e),Xr.getByImmeuble(e)]);o(B.data.immeuble),u(J.data.exercices||[]),d(ue.data.proprietaires||[]);const le=(J.data.exercices||[]).find(G=>G.statut==="ouvert");le&&(y(le),m(le.id))}catch(B){console.error("Error loading data:",B),s("Erreur lors du chargement des donnes")}finally{n(!1)}},j=async()=>{var B,J;try{n(!0),await ii.create(e,E),x(!1),R()}catch(ue){console.error("Error creating exercice:",ue),s(((J=(B=ue.response)==null?void 0:B.data)==null?void 0:J.message)||"Erreur lors de la cration")}finally{n(!1)}},L=()=>!h||!l?"":`CLOTURER ${h.annee}`,V=async()=>{var B,J;if(h&&b===L())try{n(!0),await ii.cloturer(e,h.id),w(!1),_(""),R()}catch(ue){console.error("Error closing exercice:",ue),s(((J=(B=ue.response)==null?void 0:B.data)==null?void 0:J.message)||"Erreur lors de la clture")}finally{n(!1)}},K=B=>{t(`/immeubles/${e}?tab=comptabilite&year=${B.annee}`)},Y=B=>new Intl.NumberFormat("fr-BE",{style:"currency",currency:"EUR"}).format(B||0),H=B=>B?new Date(B).toLocaleDateString("fr-BE"):"-";return r&&!l?i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx(kr,{className:"w-8 h-8 animate-spin text-primary-600"})}):i.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[i.jsxs("div",{className:"mb-6",children:[i.jsxs("button",{onClick:()=>t(`/immeubles/${e}`),className:"flex items-center text-gray-600 hover:text-gray-900 mb-4",children:[i.jsx(Vn,{className:"w-4 h-4 mr-2"}),"Retour  l'immeuble"]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center",children:i.jsx(fn,{className:"w-6 h-6 text-primary-600"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Exercices Comptables"}),i.jsxs("p",{className:"text-gray-600",children:[l==null?void 0:l.nom," - Report  Nouveau"]})]})]}),i.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[i.jsx(Gt,{className:"w-4 h-4"}),"Nouvel exercice"]})]})]}),a&&i.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3",children:[i.jsx(st,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),i.jsx("span",{className:"text-red-700",children:a})]}),i.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsxs("h3",{className:"font-medium text-blue-800 mb-2 flex items-center gap-2",children:[i.jsx(Hf,{className:"w-4 h-4"}),"Report  Nouveau (RAN)"]}),i.jsx("p",{className:"text-sm text-blue-700",children:"Le solde de chaque propritaire en fin d'exercice est automatiquement report comme solde initial de l'exercice suivant. Un propritaire avec +300 en 2024 commencera 2025 avec ce mme solde."})]}),c.length===0?i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-8 text-center",children:[i.jsx(fn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun exercice comptable"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Crez votre premier exercice pour commencer le suivi comptable avec Report  Nouveau."}),i.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[i.jsx(Gt,{className:"w-4 h-4"}),"Crer l'exercice ",new Date().getFullYear()]})]}):i.jsx("div",{className:"space-y-4",children:c.map(B=>{var G;const J=Zp[B.statut]||Zp.brouillon,ue=g===B.id,le=parseFloat(B.solde_global||0);return i.jsxs("div",{className:`bg-white rounded-xl shadow-sm border overflow-hidden ${(h==null?void 0:h.id)===B.id?"ring-2 ring-primary-500":""}`,children:[i.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-50",onClick:()=>{y(B),m(ue?null:B.id)},children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${J.bg}`,children:B.statut==="cloture"||B.statut==="archive"?i.jsx(bc,{className:`w-5 h-5 ${J.text}`}):i.jsx(Zk,{className:`w-5 h-5 ${J.text}`})}),i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Exercice ",B.annee]}),i.jsxs("p",{className:"text-sm text-gray-500",children:[H(B.date_debut)," - ",H(B.date_fin)]})]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${J.bg} ${J.text}`,children:FR[B.statut]})]}),i.jsxs("div",{className:"flex items-center gap-6",children:[i.jsxs("div",{className:"text-right hidden sm:block",children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Provisions"}),i.jsx("p",{className:"font-medium text-green-600",children:Y(B.total_provisions)})]}),i.jsxs("div",{className:"text-right hidden sm:block",children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Charges"}),i.jsx("p",{className:"font-medium text-red-600",children:Y(B.total_charges)})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Solde global"}),i.jsx("p",{className:`font-bold ${le>=0?"text-green-600":"text-red-600"}`,children:Y(le)})]}),ue?i.jsx(oh,{className:"w-5 h-5 text-gray-400"}):i.jsx(lh,{className:"w-5 h-5 text-gray-400"})]})]})}),ue&&i.jsxs("div",{className:"border-t bg-gray-50 p-4",children:[i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[i.jsxs("h4",{className:"font-medium text-gray-700 mb-2 flex items-center gap-2",children:[i.jsx(Bk,{className:"w-4 h-4"}),"Budget prvisionnel"]}),i.jsx("p",{className:"text-2xl font-bold text-primary-600",children:Y(B.budget_previsionnel)}),i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Fonds de rserve: ",Y(B.budget_fonds_reserve)]})]}),i.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[i.jsxs("h4",{className:"font-medium text-gray-700 mb-2 flex items-center gap-2",children:[i.jsx(Vt,{className:"w-4 h-4"}),"Propritaires"]}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.nb_proprietaires||f.length}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"copropritaires actifs"})]}),i.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[i.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Actions"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("button",{onClick:()=>K(B),className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 text-sm",children:[i.jsx(O0,{className:"w-4 h-4"}),"Voir les dcomptes"]}),B.statut==="ouvert"&&i.jsxs("button",{onClick:()=>{y(B),_(""),w(!0)},className:"w-full flex items-center justify-center gap-2 px-3 py-2 border border-orange-300 text-orange-700 rounded-lg hover:bg-orange-50 text-sm",children:[i.jsx(bc,{className:"w-4 h-4"}),"Clturer l'exercice"]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg border overflow-hidden",children:[i.jsx("div",{className:"px-4 py-3 bg-gray-100 border-b",children:i.jsx("h4",{className:"font-medium text-gray-700",children:"Soldes par propritaire"})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Propritaire"}),i.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Millimes"}),i.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:i.jsxs("span",{className:"inline-flex items-center gap-1",children:[i.jsx(Hf,{className:"w-3 h-3"}),"Report (RAN)"]})}),i.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Provisions"}),i.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Charges"}),i.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Solde final"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:(G=B.soldes)==null?void 0:G.map(q=>{const U=parseFloat(q.solde_fin||0),S=parseFloat(q.solde_debut||0);return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsxs("td",{className:"px-4 py-3",children:[i.jsxs("div",{className:"font-medium text-gray-900",children:[q.proprietaire_prenom," ",q.proprietaire_nom]}),i.jsxs("div",{className:"text-sm text-gray-500",children:["Apt. ",q.numero_appartement]})]}),i.jsx("td",{className:"px-4 py-3 text-center",children:i.jsxs("span",{className:"px-2 py-1 bg-gray-100 rounded text-sm",children:[q.milliemes,"/1000"]})}),i.jsx("td",{className:"px-4 py-3 text-right",children:i.jsx("span",{className:`font-medium ${S>=0?"text-blue-600":"text-orange-600"}`,children:Y(S)})}),i.jsxs("td",{className:"px-4 py-3 text-right text-green-600",children:["+",Y(q.total_provisions)]}),i.jsxs("td",{className:"px-4 py-3 text-right text-red-600",children:["-",Y(q.total_charges)]}),i.jsxs("td",{className:"px-4 py-3 text-right",children:[i.jsx("span",{className:`font-bold ${U>=0?"text-green-600":"text-red-600"}`,children:Y(U)}),U>=0?i.jsx(B0,{className:"w-4 h-4 inline ml-1 text-green-500"}):i.jsx(fh,{className:"w-4 h-4 inline ml-1 text-red-500"})]})]},q.proprietaire_id)})})]})})]})]})]},B.id)})}),p&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4 p-6",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Crer un nouvel exercice"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Anne"}),i.jsx("input",{type:"number",value:E.annee,onChange:B=>{const J=parseInt(B.target.value);N({...E,annee:J,dateDebut:`${J}-01-01`,dateFin:`${J}-12-31`})},className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date dbut"}),i.jsx("input",{type:"date",value:E.dateDebut,onChange:B=>N({...E,dateDebut:B.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date fin"}),i.jsx("input",{type:"date",value:E.dateFin,onChange:B=>N({...E,dateFin:B.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Budget prvisionnel ()"}),i.jsx("input",{type:"number",step:"0.01",value:E.budgetPrevisionnel,onChange:B=>N({...E,budgetPrevisionnel:parseFloat(B.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Budget fonds de rserve ()"}),i.jsx("input",{type:"number",step:"0.01",value:E.budgetFondsReserve,onChange:B=>N({...E,budgetFondsReserve:parseFloat(B.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),i.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg text-sm text-blue-700",children:[i.jsx("strong",{children:"Note:"})," Les soldes de l'exercice ",E.annee-1," seront automatiquement reports comme Report  Nouveau."]})]}),i.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[i.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-900",children:"Annuler"}),i.jsx("button",{onClick:j,disabled:r,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:r?"Cration...":"Crer l'exercice"})]})]})}),v&&h&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4 p-6",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:i.jsx(bc,{className:"w-5 h-5 text-orange-600"})}),i.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Clturer l'exercice ",h.annee]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-gray-600",children:"La clture de l'exercice va :"}),i.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 space-y-1",children:[i.jsx("li",{children:"Finaliser tous les soldes propritaires"}),i.jsx("li",{children:"Empcher toute modification ultrieure"}),i.jsx("li",{children:"Prparer le Report  Nouveau pour le prochain exercice"})]}),i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(xo,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-red-800",children:"Action irrversible"}),i.jsx("p",{className:"text-sm text-red-700 mt-1",children:"Pour confirmer, tapez exactement :"}),i.jsx("p",{className:"font-mono font-bold text-red-800 mt-2 p-2 bg-red-100 rounded",children:L()})]})]})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmation"}),i.jsx("input",{type:"text",value:b,onChange:B=>_(B.target.value.toUpperCase()),placeholder:L(),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-orange-500 font-mono ${b&&b!==L()?"border-red-300 bg-red-50":b===L()?"border-green-300 bg-green-50":""}`}),b&&b!==L()&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Le texte ne correspond pas"}),b===L()&&i.jsxs("p",{className:"text-xs text-green-600 mt-1 flex items-center gap-1",children:[i.jsx(jn,{className:"w-3 h-3"}),"Confirmation valide"]})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[i.jsx("button",{onClick:()=>{w(!1),_("")},className:"px-4 py-2 text-gray-600 hover:text-gray-900",children:"Annuler"}),i.jsx("button",{onClick:V,disabled:r||b!==L(),className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Clture...":"Confirmer la clture"})]})]})})]})}function AR(){var v,w,b,_,E,N,R,j,L,V,K,Y,H,B,J,ue,le,G,q,U,S,z,F,M,W,ie;const{immeubleId:e,exerciceId:t,proprietaireId:r}=Wn(),n=Kt(),a=T.useRef(null),[s,l]=T.useState(!0),[o,c]=T.useState(null),[u,f]=T.useState(null);T.useEffect(()=>{d()},[e,t,r]);const d=async()=>{try{l(!0),c(null);const X=await ii.getDecompteAnnuel(e,t,r);f(X.data.decompte)}catch(X){console.error("Error loading decompte:",X),c("Erreur lors du chargement du dcompte")}finally{l(!1)}},h=X=>new Intl.NumberFormat("fr-BE",{style:"currency",currency:"EUR"}).format(X||0),y=X=>X?new Date(X).toLocaleDateString("fr-BE"):"-",g=()=>{window.print()},m=()=>{var I,ve,Ae,Ie,be,de,se,Se,Ee,Te,Ue,Ye,nt,Et,jr,mn,St,pr,Fe,He,gr,wt,Cn,Li,So,jo;if(!u)return;const X=[["DCOMPTE ANNUEL DE CHARGES"],[""],["Immeuble:",(I=u.immeuble)==null?void 0:I.nom],["Adresse:",(ve=u.immeuble)==null?void 0:ve.adresse],[""],["Exercice:",(Ae=u.exercice)==null?void 0:Ae.annee],["Priode:",`${y((Ie=u.exercice)==null?void 0:Ie.dateDebut)} - ${y((be=u.exercice)==null?void 0:be.dateFin)}`],[""],["PROPRITAIRE"],["Nom:",`${((de=u.proprietaire)==null?void 0:de.prenom)||""} ${(se=u.proprietaire)==null?void 0:se.nom}`],["Appartement:",(Se=u.proprietaire)==null?void 0:Se.appartement],["Millimes:",`${(Ee=u.proprietaire)==null?void 0:Ee.milliemes}/1000 (${(Te=u.proprietaire)==null?void 0:Te.pourcentage}%)`],[""],[""],[""],["A. REPORT  NOUVEAU (solde exercice prcdent)"],["Solde report:",h((Ue=u.reportANouveau)==null?void 0:Ue.solde)],["Type:",(Ye=u.reportANouveau)==null?void 0:Ye.type],[""],["B. CHARGES DE L'EXERCICE"],...((Et=(nt=u.charges)==null?void 0:nt.detail)==null?void 0:Et.map(Fn=>[Fn.categorie,h(Fn.total)]))||[],["TOTAL CHARGES:",h((jr=u.charges)==null?void 0:jr.total)],[""],["C. VERSEMENTS (PROVISIONS)"],...((St=(mn=u.versements)==null?void 0:mn.detail)==null?void 0:St.map(Fn=>[Fn.libelle,y(Fn.date_appel),h(Fn.montant_du),h(Fn.montant_paye)]))||[],["TOTAL VERSEMENTS:",h((pr=u.versements)==null?void 0:pr.total)],[""],["D. AJUSTEMENTS"],["Ajustements:",h(u.ajustements)],[""],[""],[""],["E. SOLDE FINAL"],["Calcul:",`${h((Fe=u.reportANouveau)==null?void 0:Fe.solde)} + ${h((He=u.versements)==null?void 0:He.total)} - ${h((gr=u.charges)==null?void 0:gr.total)}`],["SOLDE:",h((wt=u.soldeFinal)==null?void 0:wt.montant)],["Status:",(Cn=u.soldeFinal)==null?void 0:Cn.type],[""],[(Li=u.soldeFinal)==null?void 0:Li.message],[""],["Document gnr le:",new Date().toLocaleDateString("fr-BE")]],Q=Mt.aoa_to_sheet(X),Z=Mt.book_new();Mt.book_append_sheet(Z,Q,"Dcompte");const ye=`decompte_${(So=u.exercice)==null?void 0:So.annee}_${(jo=u.proprietaire)==null?void 0:jo.nom}.xlsx`;Eo(Z,ye)};if(s)return i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx(kr,{className:"w-8 h-8 animate-spin text-primary-600"})});if(o||!u)return i.jsx("div",{className:"p-6 max-w-4xl mx-auto",children:i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-3",children:[i.jsx(st,{className:"w-5 h-5 text-red-500"}),i.jsx("span",{className:"text-red-700",children:o||"Dcompte non trouv"})]})});const p=((v=u.reportANouveau)==null?void 0:v.solde)||0,x=((w=u.soldeFinal)==null?void 0:w.montant)||0;return i.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[i.jsxs("div",{className:"mb-6 print:hidden",children:[i.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-gray-600 hover:text-gray-900 mb-4",children:[i.jsx(Vn,{className:"w-4 h-4 mr-2"}),"Retour"]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center",children:i.jsx(bs,{className:"w-6 h-6 text-primary-600"})}),i.jsxs("div",{children:[i.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Dcompte Annuel ",(b=u.exercice)==null?void 0:b.annee]}),i.jsxs("p",{className:"text-gray-600",children:[(_=u.proprietaire)==null?void 0:_.prenom," ",(E=u.proprietaire)==null?void 0:E.nom]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[i.jsx(ch,{className:"w-4 h-4"}),"Excel"]}),i.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-3 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[i.jsx(uh,{className:"w-4 h-4"}),"Imprimer"]})]})]})]}),i.jsxs("div",{ref:a,className:"bg-white rounded-xl shadow-sm border overflow-hidden print:shadow-none print:border-none",children:[i.jsx("div",{className:"p-6 border-b bg-gray-50 print:bg-white",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-1",children:(N=u.immeuble)==null?void 0:N.nom}),i.jsx("p",{className:"text-gray-600",children:(R=u.immeuble)==null?void 0:R.adresse})]}),i.jsx("div",{className:"text-right",children:i.jsxs("div",{className:"inline-block px-4 py-2 bg-primary-100 rounded-lg print:bg-gray-100",children:[i.jsxs("p",{className:"text-lg font-bold text-primary-700 print:text-gray-800",children:["Dcompte ",(j=u.exercice)==null?void 0:j.annee]}),i.jsxs("p",{className:"text-sm text-primary-600 print:text-gray-600",children:[y((L=u.exercice)==null?void 0:L.dateDebut)," - ",y((V=u.exercice)==null?void 0:V.dateFin)]})]})})]})}),i.jsx("div",{className:"p-6 border-b",children:i.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[i.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center",children:i.jsx(Jv,{className:"w-5 h-5 text-gray-600"})}),i.jsxs("div",{children:[i.jsxs("h3",{className:"font-semibold text-gray-900",children:[(K=u.proprietaire)==null?void 0:K.prenom," ",(Y=u.proprietaire)==null?void 0:Y.nom]}),i.jsxs("p",{className:"text-sm text-gray-500",children:["Appartement ",(H=u.proprietaire)==null?void 0:H.appartement," ",(B=u.proprietaire)==null?void 0:B.milliemes,"/1000 millimes (",(J=u.proprietaire)==null?void 0:J.pourcentage,"%)"]})]})]})}),i.jsxs("div",{className:"p-6 border-b",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Hf,{className:"w-5 h-5 text-blue-600"}),i.jsx("h4",{className:"font-semibold text-gray-900",children:"A. Report  Nouveau"}),i.jsxs("span",{className:"text-sm text-gray-500",children:["(Solde exercice ",((ue=u.exercice)==null?void 0:ue.annee)-1,")"]})]}),i.jsxs("div",{className:`p-4 rounded-lg ${p>=0?"bg-blue-50":"bg-orange-50"}`,children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-700",children:"Solde report de l'exercice prcdent"}),i.jsx("span",{className:`text-xl font-bold ${p>=0?"text-blue-600":"text-orange-600"}`,children:h(p)})]}),i.jsx("p",{className:`text-sm mt-1 ${p>=0?"text-blue-600":"text-orange-600"}`,children:p>=0?" Solde crditeur":" Solde dbiteur  rgulariser"})]})]}),i.jsxs("div",{className:"p-6 border-b",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Yk,{className:"w-5 h-5 text-red-600"}),i.jsx("h4",{className:"font-semibold text-gray-900",children:"B. Charges de l'exercice"})]}),((G=(le=u.charges)==null?void 0:le.detail)==null?void 0:G.length)>0?i.jsxs("table",{className:"w-full mb-4",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b",children:[i.jsx("th",{className:"text-left py-2 text-sm text-gray-500",children:"Catgorie"}),i.jsx("th",{className:"text-right py-2 text-sm text-gray-500",children:"Nb factures"}),i.jsx("th",{className:"text-right py-2 text-sm text-gray-500",children:"Quote-part"})]})}),i.jsx("tbody",{children:u.charges.detail.map((X,Q)=>i.jsxs("tr",{className:"border-b border-gray-100",children:[i.jsx("td",{className:"py-2 text-gray-700",children:X.categorie||"Autres"}),i.jsx("td",{className:"py-2 text-right text-gray-500",children:X.nb_factures}),i.jsx("td",{className:"py-2 text-right text-red-600",children:h(X.total)})]},Q))})]}):i.jsx("p",{className:"text-gray-500 italic mb-4",children:"Aucune charge enregistre"}),i.jsxs("div",{className:"flex justify-between items-center p-3 bg-red-50 rounded-lg",children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Total des charges"}),i.jsxs("span",{className:"text-lg font-bold text-red-600",children:["-",h((q=u.charges)==null?void 0:q.total)]})]})]}),i.jsxs("div",{className:"p-6 border-b",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Xk,{className:"w-5 h-5 text-green-600"}),i.jsx("h4",{className:"font-semibold text-gray-900",children:"C. Versements (Provisions)"})]}),((S=(U=u.versements)==null?void 0:U.detail)==null?void 0:S.length)>0?i.jsxs("table",{className:"w-full mb-4",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b",children:[i.jsx("th",{className:"text-left py-2 text-sm text-gray-500",children:"Appel"}),i.jsx("th",{className:"text-center py-2 text-sm text-gray-500",children:"Date"}),i.jsx("th",{className:"text-right py-2 text-sm text-gray-500",children:"D"}),i.jsx("th",{className:"text-right py-2 text-sm text-gray-500",children:"Pay"})]})}),i.jsx("tbody",{children:u.versements.detail.map((X,Q)=>i.jsxs("tr",{className:"border-b border-gray-100",children:[i.jsx("td",{className:"py-2 text-gray-700",children:X.libelle}),i.jsx("td",{className:"py-2 text-center text-gray-500",children:y(X.date_paiement)}),i.jsx("td",{className:"py-2 text-right text-gray-500",children:h(X.montant_du)}),i.jsx("td",{className:"py-2 text-right text-green-600",children:h(X.montant_paye)})]},Q))})]}):i.jsx("p",{className:"text-gray-500 italic mb-4",children:"Aucun versement enregistr"}),i.jsxs("div",{className:"flex justify-between items-center p-3 bg-green-50 rounded-lg",children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Total des versements"}),i.jsxs("span",{className:"text-lg font-bold text-green-600",children:["+",h((z=u.versements)==null?void 0:z.total)]})]})]}),u.ajustements!==0&&i.jsxs("div",{className:"p-6 border-b",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(eE,{className:"w-5 h-5 text-purple-600"}),i.jsx("h4",{className:"font-semibold text-gray-900",children:"D. Ajustements"})]}),i.jsxs("div",{className:"flex justify-between items-center p-3 bg-purple-50 rounded-lg",children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Rgularisations"}),i.jsxs("span",{className:`text-lg font-bold ${u.ajustements>=0?"text-green-600":"text-red-600"}`,children:[u.ajustements>=0?"+":"",h(u.ajustements)]})]})]}),i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(jn,{className:"w-5 h-5 text-primary-600"}),i.jsx("h4",{className:"font-semibold text-gray-900",children:"E. Solde Final"})]}),i.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 font-mono text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("span",{className:"text-gray-600",children:"Report  Nouveau"}),i.jsx("span",{className:"text-right",children:h(p)}),i.jsx("span",{className:"text-gray-600",children:"+ Versements"}),i.jsxs("span",{className:"text-right text-green-600",children:["+",h((F=u.versements)==null?void 0:F.total)]}),i.jsx("span",{className:"text-gray-600",children:"- Charges"}),i.jsxs("span",{className:"text-right text-red-600",children:["-",h((M=u.charges)==null?void 0:M.total)]}),u.ajustements!==0&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-gray-600",children:" Ajustements"}),i.jsx("span",{className:"text-right",children:h(u.ajustements)})]}),i.jsx("div",{className:"col-span-2 border-t border-gray-300 my-2"}),i.jsx("span",{className:"font-bold",children:"= SOLDE FINAL"}),i.jsx("span",{className:`text-right font-bold ${x>=0?"text-green-600":"text-red-600"}`,children:h(x)})]})}),i.jsx("div",{className:`p-6 rounded-xl ${x>=0?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("p",{className:`text-lg font-semibold ${x>=0?"text-green-800":"text-red-800"}`,children:["Solde ",(W=u.soldeFinal)==null?void 0:W.type]}),i.jsx("p",{className:`text-sm ${x>=0?"text-green-600":"text-red-600"}`,children:(ie=u.soldeFinal)==null?void 0:ie.message})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[x>=0?i.jsx(B0,{className:"w-8 h-8 text-green-500"}):i.jsx(fh,{className:"w-8 h-8 text-red-500"}),i.jsx("span",{className:`text-3xl font-bold ${x>=0?"text-green-600":"text-red-600"}`,children:h(x)})]})]})})]}),u.comparaison&&i.jsxs("div",{className:"p-6 bg-gray-50 border-t",children:[i.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Comparaison avec l'immeuble"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Total charges immeuble"}),i.jsx("p",{className:"font-medium",children:h(u.comparaison.totalChargesImmeuble)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Votre part"}),i.jsxs("p",{className:"font-medium",children:[u.comparaison.partProprietaire,"%"]})]})]})]}),i.jsxs("div",{className:"p-4 bg-gray-100 text-center text-sm text-gray-500 print:bg-white",children:["Document gnr le ",new Date().toLocaleDateString("fr-BE"),"  ",new Date().toLocaleTimeString("fr-BE")]})]}),i.jsx("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          #root {
            visibility: visible;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:shadow-none {
            box-shadow: none !important;
          }
          .print\\:border-none {
            border: none !important;
          }
          .print\\:bg-white {
            background-color: white !important;
          }
          .print\\:text-gray-800 {
            color: #1f2937 !important;
          }
          .print\\:text-gray-600 {
            color: #4b5563 !important;
          }
          .print\\:bg-gray-100 {
            background-color: #f3f4f6 !important;
          }
        }
      `})]})}function DR(){return i.jsxs(WN,{children:[i.jsx(rt,{path:"/",element:i.jsx(Mf,{to:"/login",replace:!0})}),i.jsx(rt,{path:"/login",element:i.jsx(nE,{})}),i.jsx(rt,{path:"/register",element:i.jsx(aE,{})}),i.jsxs(rt,{path:"/",element:i.jsx(Ya,{children:i.jsx(cE,{})}),children:[i.jsx(rt,{path:"dashboard",element:i.jsx(iE,{})}),i.jsx(rt,{path:"immeubles",element:i.jsx(oE,{})}),i.jsx(rt,{path:"proprietaires",element:i.jsx(uE,{})}),i.jsx(rt,{path:"locataires",element:i.jsx(fE,{})}),i.jsx(rt,{path:"/decomptes",element:i.jsx(Ya,{children:i.jsx(hE,{})})}),i.jsx(rt,{path:"/decomptes/:id",element:i.jsx(Ya,{children:i.jsx(xE,{})})}),i.jsx(rt,{path:"/immeubles/:id",element:i.jsx(Ya,{children:i.jsx(NE,{})})}),i.jsx(rt,{path:"/decomptes/:decompteId/releves",element:i.jsx(Ya,{children:i.jsx(_R,{})})}),i.jsx(rt,{path:"/immeubles/:immeubleId/transactions",element:i.jsx(Ya,{children:i.jsx(kR,{})})}),i.jsx(rt,{path:"/immeubles/:immeubleId/fournisseurs",element:i.jsx(Ya,{children:i.jsx(SR,{})})}),i.jsx(rt,{path:"/immeubles/:id/proprietaires/:propId",element:i.jsx(jR,{})}),i.jsx(rt,{path:"/immeubles/:id/proprietaires/:propId/edit",element:i.jsx(hh,{})}),i.jsx(rt,{path:"/immeubles/:id/locataires/:locId",element:i.jsx(TR,{})}),i.jsx(rt,{path:"/immeubles/:id/locataires/:locId/edit",element:i.jsx(mh,{})}),i.jsx(rt,{path:"/immeubles/:immeubleId/decomptes",element:i.jsx(CR,{})}),i.jsx(rt,{path:"/immeubles/:immeubleId/exercices",element:i.jsx(eg,{})}),i.jsx(rt,{path:"/immeubles/:immeubleId/exercices/:exerciceId/decomptes",element:i.jsx(eg,{})}),i.jsx(rt,{path:"/immeubles/:immeubleId/exercices/:exerciceId/proprietaires/:proprietaireId/decompte",element:i.jsx(AR,{})}),i.jsx(rt,{path:"locataires",element:i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Locataires"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Page en construction..."})]})}),i.jsx(rt,{path:"decomptes",element:i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Dcomptes"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Page en construction..."})]})}),i.jsx(rt,{path:"settings",element:i.jsxs("div",{className:"p-6 bg-white rounded-lg shadow",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Paramtres"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Page en construction..."})]})})]}),i.jsx(rt,{path:"*",element:i.jsx(Mf,{to:"/login",replace:!0})})]})}$u.createRoot(document.getElementById("root")).render(i.jsx(fg.StrictMode,{children:i.jsx(JN,{children:i.jsx(Ik,{children:i.jsx(sE,{children:i.jsx(DR,{})})})})}));export{xo as A,fr as B,Hk as C,ch as D,bs as F,po as P,kr as R,Hn as S,br as X,dh as a,fn as b,je as c,qc as d,jn as e,oh as f,fg as g,lh as h,Mt as i,i as j,T as r,is as t,Kt as u,Eo as w};
